var CryptoJS=CryptoJS||function(t,e){var n={},i=n.lib={},r=function(){},o=i.Base={extend:function(t){r.prototype=this;var e=new r;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=o.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var r=0;t>r;r++)e[i+r>>>2]|=(n[r>>>2]>>>24-8*(r%4)&255)<<24-8*((i+r)%4);else if(65535<n.length)for(r=0;t>r;r+=4)e[i+r>>>2]=n[r>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-8*(n%4),e.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],i=0;e>i;i+=4)n.push(4294967296*t.random()|0);return new a.init(n,e)}}),s=n.enc={},u=s.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;t>i;i++){var r=e[i>>>2]>>>24-8*(i%4)&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;e>i;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-4*(i%8);return new a.init(n,e/2)}},c=s.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;t>i;i++)n.push(String.fromCharCode(e[i>>>2]>>>24-8*(i%4)&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;e>i;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-8*(i%4);return new a.init(n,e)}},h=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,o=this.blockSize,s=r/(4*o),s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0);if(e=s*o,r=t.min(4*e,r),e){for(var u=0;e>u;u+=o)this._doProcessBlock(i,u);u=i.splice(0,e),n.sigBytes-=r}return new a.init(u,r)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=l.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new f.HMAC.init(t,n).finalize(e)}}});var f=n.algo={};return n}(Math);!function(t){function e(t,e,n,i,r,o,a){return t=t+(e&n|~e&i)+r+a,(t<<o|t>>>32-o)+e}function n(t,e,n,i,r,o,a){return t=t+(e&i|n&~i)+r+a,(t<<o|t>>>32-o)+e}function i(t,e,n,i,r,o,a){return t=t+(e^n^i)+r+a,(t<<o|t>>>32-o)+e}function r(t,e,n,i,r,o,a){return t=t+(n^(e|~i))+r+a,(t<<o|t>>>32-o)+e}for(var o=CryptoJS,a=o.lib,s=a.WordArray,u=a.Hasher,a=o.algo,c=[],h=0;64>h;h++)c[h]=4294967296*t.abs(t.sin(h+1))|0;a=a.MD5=u.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,o){for(var a=0;16>a;a++){var s=o+a,u=t[s];t[s]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var a=this._hash.words,s=t[o+0],u=t[o+1],h=t[o+2],l=t[o+3],f=t[o+4],d=t[o+5],p=t[o+6],g=t[o+7],m=t[o+8],v=t[o+9],b=t[o+10],y=t[o+11],x=t[o+12],w=t[o+13],_=t[o+14],S=t[o+15],E=a[0],T=a[1],A=a[2],C=a[3],E=e(E,T,A,C,s,7,c[0]),C=e(C,E,T,A,u,12,c[1]),A=e(A,C,E,T,h,17,c[2]),T=e(T,A,C,E,l,22,c[3]),E=e(E,T,A,C,f,7,c[4]),C=e(C,E,T,A,d,12,c[5]),A=e(A,C,E,T,p,17,c[6]),T=e(T,A,C,E,g,22,c[7]),E=e(E,T,A,C,m,7,c[8]),C=e(C,E,T,A,v,12,c[9]),A=e(A,C,E,T,b,17,c[10]),T=e(T,A,C,E,y,22,c[11]),E=e(E,T,A,C,x,7,c[12]),C=e(C,E,T,A,w,12,c[13]),A=e(A,C,E,T,_,17,c[14]),T=e(T,A,C,E,S,22,c[15]),E=n(E,T,A,C,u,5,c[16]),C=n(C,E,T,A,p,9,c[17]),A=n(A,C,E,T,y,14,c[18]),T=n(T,A,C,E,s,20,c[19]),E=n(E,T,A,C,d,5,c[20]),C=n(C,E,T,A,b,9,c[21]),A=n(A,C,E,T,S,14,c[22]),T=n(T,A,C,E,f,20,c[23]),E=n(E,T,A,C,v,5,c[24]),C=n(C,E,T,A,_,9,c[25]),A=n(A,C,E,T,l,14,c[26]),T=n(T,A,C,E,m,20,c[27]),E=n(E,T,A,C,w,5,c[28]),C=n(C,E,T,A,h,9,c[29]),A=n(A,C,E,T,g,14,c[30]),T=n(T,A,C,E,x,20,c[31]),E=i(E,T,A,C,d,4,c[32]),C=i(C,E,T,A,m,11,c[33]),A=i(A,C,E,T,y,16,c[34]),T=i(T,A,C,E,_,23,c[35]),E=i(E,T,A,C,u,4,c[36]),C=i(C,E,T,A,f,11,c[37]),A=i(A,C,E,T,g,16,c[38]),T=i(T,A,C,E,b,23,c[39]),E=i(E,T,A,C,w,4,c[40]),C=i(C,E,T,A,s,11,c[41]),A=i(A,C,E,T,l,16,c[42]),T=i(T,A,C,E,p,23,c[43]),E=i(E,T,A,C,v,4,c[44]),C=i(C,E,T,A,x,11,c[45]),A=i(A,C,E,T,S,16,c[46]),T=i(T,A,C,E,h,23,c[47]),E=r(E,T,A,C,s,6,c[48]),C=r(C,E,T,A,g,10,c[49]),A=r(A,C,E,T,_,15,c[50]),T=r(T,A,C,E,d,21,c[51]),E=r(E,T,A,C,x,6,c[52]),C=r(C,E,T,A,l,10,c[53]),A=r(A,C,E,T,b,15,c[54]),T=r(T,A,C,E,u,21,c[55]),E=r(E,T,A,C,m,6,c[56]),C=r(C,E,T,A,S,10,c[57]),A=r(A,C,E,T,p,15,c[58]),T=r(T,A,C,E,w,21,c[59]),E=r(E,T,A,C,f,6,c[60]),C=r(C,E,T,A,y,10,c[61]),A=r(A,C,E,T,h,15,c[62]),T=r(T,A,C,E,v,21,c[63]);a[0]=a[0]+E|0,a[1]=a[1]+T|0,a[2]=a[2]+A|0,a[3]=a[3]+C|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;n[r>>>5]|=128<<24-r%32;var o=t.floor(i/4294967296);for(n[(r+64>>>9<<4)+15]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[(r+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(n.length+1),this._process(),e=this._hash,n=e.words,i=0;4>i;i++)r=n[i],n[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var t=u.clone.call(this);return t._hash=this._hash.clone(),t}}),o.MD5=u._createHelper(a),o.HmacMD5=u._createHmacHelper(a)}(Math),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.PIXI=t()}}(function(){var t;return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[a]={exports:{}};t[a][0].call(h.exports,function(e){var n=t[a][1][e];return r(n?n:e)},h,h.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,n,i){(function(e,i){!function(){function r(){}function o(t){return t}function a(t){return!!t}function s(t){return!t}function u(t){return function(){if(null===t)throw new Error("Callback was already called.");t.apply(this,arguments),t=null}}function c(t){return function(){null!==t&&(t.apply(this,arguments),t=null)}}function h(t){return U(t)||"number"==typeof t.length&&t.length>=0&&t.length%1===0}function l(t,e){for(var n=-1,i=t.length;++n<i;)e(t[n],n,t)}function f(t,e){for(var n=-1,i=t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function d(t){return f(Array(t),function(t,e){return e})}function p(t,e,n){return l(t,function(t,i,r){n=e(n,t,i,r)}),n}function g(t,e){l(G(t),function(n){e(t[n],n)})}function m(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function v(t){var e,n,i=-1;return h(t)?(e=t.length,function(){return i++,e>i?i:null}):(n=G(t),e=n.length,function(){return i++,e>i?n[i]:null})}function b(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),i=Array(n),r=0;n>r;r++)i[r]=arguments[r+e];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i)}}}function y(t){return function(e,n,i){return t(e,i)}}function x(t){return function(e,n,i){i=c(i||r),e=e||[];var o=v(e);if(0>=t)return i(null);var a=!1,s=0,h=!1;!function l(){if(a&&0>=s)return i(null);for(;t>s&&!h;){var r=o();if(null===r)return a=!0,void(0>=s&&i(null));s+=1,n(e[r],r,u(function(t){s-=1,t?(i(t),h=!0):l()}))}}()}}function w(t){return function(e,n,i){return t(N.eachOf,e,n,i)}}function _(t){return function(e,n,i,r){return t(x(n),e,i,r)}}function S(t){return function(e,n,i){return t(N.eachOfSeries,e,n,i)}}function E(t,e,n,i){i=c(i||r),e=e||[];var o=h(e)?[]:{};t(e,function(t,e,i){n(t,function(t,n){o[e]=n,i(t)})},function(t){i(t,o)})}function T(t,e,n,i){var r=[];t(e,function(t,e,i){n(t,function(n){n&&r.push({index:e,value:t}),i()})},function(){i(f(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})}function A(t,e,n,i){T(t,e,function(t,e){n(t,function(t){e(!t)})},i)}function C(t,e,n){return function(i,r,o,a){function s(){a&&a(n(!1,void 0))}function u(t,i,r){return a?void o(t,function(i){a&&e(i)&&(a(n(!0,t)),a=o=!1),r()}):r()}arguments.length>3?t(i,r,u,s):(a=o,o=r,t(i,u,s))}}function P(t,e){return e}function I(t,e,n){n=n||r;var i=h(e)?[]:{};t(e,function(t,e,n){t(b(function(t,r){r.length<=1&&(r=r[0]),i[e]=r,n(t)}))},function(t){n(t,i)})}function R(t,e,n,i){var r=[];t(e,function(t,e,i){n(t,function(t,e){r=r.concat(e||[]),i(t)})},function(t){i(t,r)})}function M(t,e,n){function i(t,e,n,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");return t.started=!0,U(e)||(e=[e]),0===e.length&&t.idle()?N.setImmediate(function(){t.drain()}):(l(e,function(e){var o={data:e,callback:i||r};n?t.tasks.unshift(o):t.tasks.push(o),t.tasks.length===t.concurrency&&t.saturated()}),void N.setImmediate(t.process))}function o(t,e){return function(){a-=1;var n=!1,i=arguments;l(e,function(t){l(s,function(e,i){e!==t||n||(s.splice(i,1),n=!0)}),t.callback.apply(t,i)}),t.tasks.length+a===0&&t.drain(),t.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var a=0,s=[],c={tasks:[],concurrency:e,payload:n,saturated:r,empty:r,drain:r,started:!1,paused:!1,push:function(t,e){i(c,t,!1,e)},kill:function(){c.drain=r,c.tasks=[]},unshift:function(t,e){i(c,t,!0,e)},process:function(){for(;!c.paused&&a<c.concurrency&&c.tasks.length;){var e=c.payload?c.tasks.splice(0,c.payload):c.tasks.splice(0,c.tasks.length),n=f(e,function(t){return t.data});0===c.tasks.length&&c.empty(),a+=1,s.push(e[0]);var i=u(o(c,e));t(n,i)}},length:function(){return c.tasks.length},running:function(){return a},workersList:function(){return s},idle:function(){return c.tasks.length+a===0},pause:function(){c.paused=!0},resume:function(){if(c.paused!==!1){c.paused=!1;for(var t=Math.min(c.concurrency,c.tasks.length),e=1;t>=e;e++)N.setImmediate(c.process)}}};return c}function k(t){return b(function(e,n){e.apply(null,n.concat([b(function(e,n){"object"==typeof console&&(e?console.error&&console.error(e):console[t]&&l(n,function(e){console[t](e)}))})]))})}function O(t){return function(e,n,i){t(d(e),n,i)}}function D(t){return b(function(e,n){var i=b(function(n){var i=this,r=n.pop();return t(e,function(t,e,r){t.apply(i,n.concat([r]))},r)});return n.length?i.apply(this,n):i})}function L(t){return b(function(e){var n=e.pop();e.push(function(){var t=arguments;i?N.setImmediate(function(){n.apply(null,t)}):n.apply(null,t)});var i=!0;t.apply(this,e),i=!1})}var B,N={},F="object"==typeof self&&self.self===self&&self||"object"==typeof i&&i.global===i&&i||this;null!=F&&(B=F.async),N.noConflict=function(){return F.async=B,N};var j=Object.prototype.toString,U=Array.isArray||function(t){return"[object Array]"===j.call(t)},z=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},G=Object.keys||function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e},H="function"==typeof setImmediate&&setImmediate,W=H?function(t){H(t)}:function(t){setTimeout(t,0)};"object"==typeof e&&"function"==typeof e.nextTick?N.nextTick=e.nextTick:N.nextTick=W,N.setImmediate=H?W:N.nextTick,N.forEach=N.each=function(t,e,n){return N.eachOf(t,y(e),n)},N.forEachSeries=N.eachSeries=function(t,e,n){return N.eachOfSeries(t,y(e),n)},N.forEachLimit=N.eachLimit=function(t,e,n,i){return x(e)(t,y(n),i)},N.forEachOf=N.eachOf=function(t,e,n){function i(t){s--,t?n(t):null===o&&0>=s&&n(null)}n=c(n||r),t=t||[];for(var o,a=v(t),s=0;null!=(o=a());)s+=1,e(t[o],o,u(i));0===s&&n(null)},N.forEachOfSeries=N.eachOfSeries=function(t,e,n){function i(){var r=!0;return null===a?n(null):(e(t[a],a,u(function(t){if(t)n(t);else{if(a=o(),null===a)return n(null);r?N.setImmediate(i):i()}})),void(r=!1))}n=c(n||r),t=t||[];var o=v(t),a=o();i()},N.forEachOfLimit=N.eachOfLimit=function(t,e,n,i){x(e)(t,n,i)},N.map=w(E),N.mapSeries=S(E),N.mapLimit=_(E),N.inject=N.foldl=N.reduce=function(t,e,n,i){N.eachOfSeries(t,function(t,i,r){n(e,t,function(t,n){e=n,r(t)})},function(t){i(t,e)})},N.foldr=N.reduceRight=function(t,e,n,i){var r=f(t,o).reverse();N.reduce(r,e,n,i)},N.transform=function(t,e,n,i){3===arguments.length&&(i=n,n=e,e=U(t)?[]:{}),N.eachOf(t,function(t,i,r){n(e,t,i,r)},function(t){i(t,e)})},N.select=N.filter=w(T),N.selectLimit=N.filterLimit=_(T),N.selectSeries=N.filterSeries=S(T),N.reject=w(A),N.rejectLimit=_(A),N.rejectSeries=S(A),N.any=N.some=C(N.eachOf,a,o),N.someLimit=C(N.eachOfLimit,a,o),N.all=N.every=C(N.eachOf,s,s),N.everyLimit=C(N.eachOfLimit,s,s),N.detect=C(N.eachOf,o,P),N.detectSeries=C(N.eachOfSeries,o,P),N.detectLimit=C(N.eachOfLimit,o,P),N.sortBy=function(t,e,n){function i(t,e){var n=t.criteria,i=e.criteria;return i>n?-1:n>i?1:0}N.map(t,function(t,n){e(t,function(e,i){e?n(e):n(null,{value:t,criteria:i})})},function(t,e){return t?n(t):void n(null,f(e.sort(i),function(t){return t.value}))})},N.auto=function(t,e,n){function i(t){v.unshift(t)}function o(t){var e=m(v,t);e>=0&&v.splice(e,1)}function a(){u--,l(v.slice(0),function(t){t()})}"function"==typeof arguments[1]&&(n=e,e=null),n=c(n||r);var s=G(t),u=s.length;if(!u)return n(null);e||(e=u);var h={},f=0,d=!1,v=[];i(function(){u||n(null,h)}),l(s,function(r){function s(){return e>f&&p(y,function(t,e){return t&&h.hasOwnProperty(e)},!0)&&!h.hasOwnProperty(r)}function u(){s()&&(f++,o(u),l[l.length-1](v,h))}if(!d){for(var c,l=U(t[r])?t[r]:[t[r]],v=b(function(t,e){if(f--,e.length<=1&&(e=e[0]),t){var i={};g(h,function(t,e){i[e]=t}),i[r]=e,d=!0,n(t,i)}else h[r]=e,N.setImmediate(a)}),y=l.slice(0,l.length-1),x=y.length;x--;){if(!(c=t[y[x]]))throw new Error("Has nonexistent dependency in "+y.join(", "));if(U(c)&&m(c,r)>=0)throw new Error("Has cyclic dependencies")}s()?(f++,l[l.length-1](v,h)):i(u)}})},N.retry=function(t,e,n){function i(t,e){if("number"==typeof e)t.times=parseInt(e,10)||o;else{if("object"!=typeof e)throw new Error("Unsupported argument type for 'times': "+typeof e);t.times=parseInt(e.times,10)||o,t.interval=parseInt(e.interval,10)||a}}function r(t,e){function n(t,n){return function(i){t(function(t,e){i(!t||n,{err:t,result:e})},e)}}function i(t){return function(e){setTimeout(function(){e(null)},t)}}for(;u.times;){var r=!(u.times-=1);s.push(n(u.task,r)),!r&&u.interval>0&&s.push(i(u.interval))}N.series(s,function(e,n){n=n[n.length-1],(t||u.callback)(n.err,n.result)})}var o=5,a=0,s=[],u={times:o,interval:a},c=arguments.length;if(1>c||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=c&&"function"==typeof t&&(n=e,e=t),"function"!=typeof t&&i(u,t),u.callback=n,u.task=e,u.callback?r():r},N.waterfall=function(t,e){function n(t){return b(function(i,r){if(i)e.apply(null,[i].concat(r));else{var o=t.next();o?r.push(n(o)):r.push(e),L(t).apply(null,r)}})}if(e=c(e||r),!U(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}return t.length?void n(N.iterator(t))():e()},N.parallel=function(t,e){I(N.eachOf,t,e)},N.parallelLimit=function(t,e,n){I(x(e),t,n)},N.series=function(t,e){I(N.eachOfSeries,t,e)},N.iterator=function(t){function e(n){function i(){return t.length&&t[n].apply(null,arguments),i.next()}return i.next=function(){return n<t.length-1?e(n+1):null},i}return e(0)},N.apply=b(function(t,e){return b(function(n){return t.apply(null,e.concat(n))})}),N.concat=w(R),N.concatSeries=S(R),N.whilst=function(t,e,n){if(n=n||r,t()){var i=b(function(r,o){r?n(r):t.apply(this,o)?e(i):n.apply(null,[null].concat(o))});e(i)}else n(null)},N.doWhilst=function(t,e,n){var i=0;return N.whilst(function(){return++i<=1||e.apply(this,arguments)},t,n)},N.until=function(t,e,n){return N.whilst(function(){return!t.apply(this,arguments)},e,n)},N.doUntil=function(t,e,n){return N.doWhilst(t,function(){return!e.apply(this,arguments)},n)},N.during=function(t,e,n){n=n||r;var i=b(function(e,i){e?n(e):(i.push(o),t.apply(this,i))}),o=function(t,r){t?n(t):r?e(i):n(null)};t(o)},N.doDuring=function(t,e,n){var i=0;N.during(function(t){i++<1?t(null,!0):e.apply(this,arguments)},t,n)},N.queue=function(t,e){var n=M(function(e,n){t(e[0],n)},e,1);return n},N.priorityQueue=function(t,e){function n(t,e){return t.priority-e.priority}function i(t,e,n){for(var i=-1,r=t.length-1;r>i;){var o=i+(r-i+1>>>1);n(e,t[o])>=0?i=o:r=o-1}return i}function o(t,e,o,a){if(null!=a&&"function"!=typeof a)throw new Error("task callback must be a function");return t.started=!0,U(e)||(e=[e]),0===e.length?N.setImmediate(function(){t.drain()}):void l(e,function(e){var s={data:e,priority:o,callback:"function"==typeof a?a:r};t.tasks.splice(i(t.tasks,s,n)+1,0,s),t.tasks.length===t.concurrency&&t.saturated(),N.setImmediate(t.process)})}var a=N.queue(t,e);return a.push=function(t,e,n){o(a,t,e,n)},delete a.unshift,a},N.cargo=function(t,e){return M(t,1,e)},N.log=k("log"),N.dir=k("dir"),N.memoize=function(t,e){var n={},i={},r=Object.prototype.hasOwnProperty;e=e||o;var a=b(function(o){var a=o.pop(),s=e.apply(null,o);r.call(n,s)?N.setImmediate(function(){a.apply(null,n[s])}):r.call(i,s)?i[s].push(a):(i[s]=[a],t.apply(null,o.concat([b(function(t){n[s]=t;var e=i[s];delete i[s];for(var r=0,o=e.length;o>r;r++)e[r].apply(null,t)})])))});return a.memo=n,a.unmemoized=t,a},N.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},N.times=O(N.map),N.timesSeries=O(N.mapSeries),N.timesLimit=function(t,e,n,i){return N.mapLimit(d(t),e,n,i)},N.seq=function(){var t=arguments;return b(function(e){var n=this,i=e[e.length-1];"function"==typeof i?e.pop():i=r,N.reduce(t,e,function(t,e,i){e.apply(n,t.concat([b(function(t,e){i(t,e)})]))},function(t,e){i.apply(n,[t].concat(e))})})},N.compose=function(){return N.seq.apply(null,Array.prototype.reverse.call(arguments))},N.applyEach=D(N.eachOf),N.applyEachSeries=D(N.eachOfSeries),N.forever=function(t,e){function n(t){return t?i(t):void o(n)}var i=u(e||r),o=L(t);n()},N.ensureAsync=L,N.constant=b(function(t){var e=[null].concat(t);return function(t){return t.apply(this,e)}}),N.wrapSync=N.asyncify=function(t){return b(function(e){var n,i=e.pop();try{n=t.apply(this,e)}catch(r){return i(r)}z(n)&&"function"==typeof n.then?n.then(function(t){i(null,t)})["catch"](function(t){i(t.message?t:new Error(t))}):i(null,n)})},"object"==typeof n&&n.exports?n.exports=N:"function"==typeof t&&t.amd?t([],function(){return N}):F.async=N}()}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],2:[function(t,e,n){(function(t){function e(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return r.exec(t).slice(1)};n.resolve=function(){for(var n="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,r="/"===a.charAt(0))}return n=e(i(n.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+n||"."},n.normalize=function(t){var r=n.isAbsolute(t),o="/"===a(t,-1);return t=e(i(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(i(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var r=i(t.split("/")),o=i(e.split("/")),a=Math.min(r.length,o.length),s=a,u=0;a>u;u++)if(r[u]!==o[u]){s=u;break}for(var c=[],u=s;u<r.length;u++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=o(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},n.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return o(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return 0>e&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:3}],3:[function(t,e,n){function i(){h=!1,s.length?c=s.concat(c):l=-1,c.length&&r()}function r(){if(!h){var t=setTimeout(i);h=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,h=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function a(){}var s,u=e.exports={},c=[],h=!1,l=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new o(t,e)),1!==c.length||h||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=a,u.addListener=a,u.once=a,u.off=a,u.removeListener=a,u.removeAllListeners=a,u.emit=a,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],4:[function(e,n,i){(function(e){!function(r){function o(t){throw new RangeError(D[t])}function a(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function s(t,e){var n=t.split("@"),i="";n.length>1&&(i=n[0]+"@",t=n[1]),t=t.replace(O,".");var r=t.split("."),o=a(r,e).join(".");return i+o}function u(t){for(var e,n,i=[],r=0,o=t.length;o>r;)e=t.charCodeAt(r++),e>=55296&&56319>=e&&o>r?(n=t.charCodeAt(r++),56320==(64512&n)?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--)):i.push(e);return i}function c(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=N(t>>>10&1023|55296),t=56320|1023&t),e+=N(t)}).join("")}function h(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:S}function l(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function f(t,e,n){var i=0;for(t=n?B(t/C):t>>1,t+=B(t/e);t>L*T>>1;i+=S)t=B(t/L);return B(i+(L+1)*t/(t+A))}function d(t){var e,n,i,r,a,s,u,l,d,p,g=[],m=t.length,v=0,b=I,y=P;for(n=t.lastIndexOf(R),0>n&&(n=0),i=0;n>i;++i)t.charCodeAt(i)>=128&&o("not-basic"),g.push(t.charCodeAt(i));for(r=n>0?n+1:0;m>r;){for(a=v,s=1,u=S;r>=m&&o("invalid-input"),l=h(t.charCodeAt(r++)),(l>=S||l>B((_-v)/s))&&o("overflow"),v+=l*s,d=y>=u?E:u>=y+T?T:u-y,!(d>l);u+=S)p=S-d,s>B(_/p)&&o("overflow"),s*=p;e=g.length+1,y=f(v-a,e,0==a),B(v/e)>_-b&&o("overflow"),b+=B(v/e),v%=e,g.splice(v++,0,b)}return c(g)}function p(t){var e,n,i,r,a,s,c,h,d,p,g,m,v,b,y,x=[];for(t=u(t),m=t.length,e=I,n=0,a=P,s=0;m>s;++s)g=t[s],128>g&&x.push(N(g));for(i=r=x.length,r&&x.push(R);m>i;){for(c=_,s=0;m>s;++s)g=t[s],g>=e&&c>g&&(c=g);for(v=i+1,c-e>B((_-n)/v)&&o("overflow"),n+=(c-e)*v,e=c,s=0;m>s;++s)if(g=t[s],e>g&&++n>_&&o("overflow"),g==e){for(h=n,d=S;p=a>=d?E:d>=a+T?T:d-a,!(p>h);d+=S)y=h-p,b=S-p,x.push(N(l(p+y%b,0))),h=B(y/b);x.push(N(l(h,0))),a=f(n,v,i==r),n=0,++i}++n,++e}return x.join("")}function g(t){return s(t,function(t){return M.test(t)?d(t.slice(4).toLowerCase()):t})}function m(t){return s(t,function(t){return k.test(t)?"xn--"+p(t):t})}var v="object"==typeof i&&i&&!i.nodeType&&i,b="object"==typeof n&&n&&!n.nodeType&&n,y="object"==typeof e&&e;(y.global===y||y.window===y||y.self===y)&&(r=y);var x,w,_=2147483647,S=36,E=1,T=26,A=38,C=700,P=72,I=128,R="-",M=/^xn--/,k=/[^\x20-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=S-E,B=Math.floor,N=String.fromCharCode;if(x={version:"1.3.2",ucs2:{decode:u,encode:c},decode:d,encode:p,toASCII:m,toUnicode:g},"function"==typeof t&&"object"==typeof t.amd&&t.amd)t("punycode",function(){return x});else if(v&&b)if(n.exports==v)b.exports=x;else for(w in x)x.hasOwnProperty(w)&&(v[w]=x[w]);else r.punycode=x}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var h=0;c>h;++h){var l,f,d,p,g=t[h].replace(s,"%20"),m=g.indexOf(n);m>=0?(l=g.substr(0,m),f=g.substr(m+1)):(l=g,f=""),d=decodeURIComponent(l),p=decodeURIComponent(f),i(a,d)?r(a[d])?a[d].push(p):a[d]=[a[d],p]:a[d]=p}return a};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],6:[function(t,e,n){"use strict";function i(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?i(a(t),function(a){var s=encodeURIComponent(r(a))+n;return o(t[a])?i(t[a],function(t){return s+encodeURIComponent(r(t))}).join(e):s+encodeURIComponent(r(t[a]))}).join(e):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],7:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":5,"./encode":6}],8:[function(t,e,n){function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(t,e,n){if(t&&c(t)&&t instanceof i)return t;var r=new i;return r.parse(t,e,n),r}function o(t){return u(t)&&(t=r(t)),t instanceof i?t.format():i.prototype.format.call(t)}function a(t,e){return r(t,!1,!0).resolve(e)}function s(t,e){return t?r(t,!1,!0).resolveObject(e):e}function u(t){return"string"==typeof t}function c(t){return"object"==typeof t&&null!==t}function h(t){return null===t}function l(t){return null==t}var f=t("punycode");n.parse=r,n.resolve=a,n.resolveObject=s,n.format=o,n.Url=i;var d=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,g=["<",">",'"',"`"," ","\r","\n","	"],m=["{","}","|","\\","^","`"].concat(g),v=["'"].concat(m),b=["%","/","?",";","#"].concat(v),y=["/","?","#"],x=255,w=/^[a-z0-9A-Z_-]{0,63}$/,_=/^([a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=t("querystring");i.prototype.parse=function(t,e,n){if(!u(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t;i=i.trim();var r=d.exec(i);if(r){r=r[0];var o=r.toLowerCase();this.protocol=o,i=i.substr(r.length)}if(n||r||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===i.substr(0,2);!a||r&&E[r]||(i=i.substr(2),this.slashes=!0)}if(!E[r]&&(a||r&&!T[r])){for(var s=-1,c=0;c<y.length;c++){var h=i.indexOf(y[c]);-1!==h&&(-1===s||s>h)&&(s=h)}var l,p;p=-1===s?i.lastIndexOf("@"):i.lastIndexOf("@",s),-1!==p&&(l=i.slice(0,p),i=i.slice(p+1),this.auth=decodeURIComponent(l)),s=-1;for(var c=0;c<b.length;c++){var h=i.indexOf(b[c]);-1!==h&&(-1===s||s>h)&&(s=h)}-1===s&&(s=i.length),this.host=i.slice(0,s),i=i.slice(s),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var m=this.hostname.split(/\./),c=0,C=m.length;C>c;c++){var P=m[c];if(P&&!P.match(w)){for(var I="",R=0,M=P.length;M>R;R++)I+=P.charCodeAt(R)>127?"x":P[R];if(!I.match(w)){var k=m.slice(0,c),O=m.slice(c+1),D=P.match(_);D&&(k.push(D[1]),O.unshift(D[2])),O.length&&(i="/"+O.join(".")+i),this.hostname=k.join(".");break}}}if(this.hostname.length>x?this.hostname="":this.hostname=this.hostname.toLowerCase(),!g){for(var L=this.hostname.split("."),B=[],c=0;c<L.length;++c){var N=L[c];B.push(N.match(/[^A-Za-z0-9_-]/)?"xn--"+f.encode(N):N)}this.hostname=B.join(".")}var F=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+F,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!S[o])for(var c=0,C=v.length;C>c;c++){var U=v[c],z=encodeURIComponent(U);z===U&&(z=escape(U)),i=i.split(U).join(z)}var G=i.indexOf("#");-1!==G&&(this.hash=i.substr(G),i=i.slice(0,G));var H=i.indexOf("?");if(-1!==H?(this.search=i.substr(H),this.query=i.substr(H+1),e&&(this.query=A.parse(this.query)),i=i.slice(0,H)):e&&(this.search="",this.query={}),i&&(this.pathname=i),T[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",N=this.search||"";this.path=F+N}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(o=A.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||T[e])&&r!==!1?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),a=a.replace("#","%23"),e+r+n+a+i},i.prototype.resolve=function(t){return this.resolveObject(r(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if(u(t)){var e=new i;e.parse(t,!1,!0),t=e}var n=new i;if(Object.keys(this).forEach(function(t){n[t]=this[t]},this),n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(n[e]=t[e])}),T[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(t.protocol&&t.protocol!==n.protocol){if(!T[t.protocol])return Object.keys(t).forEach(function(e){n[e]=t[e]}),n.href=n.format(),n;if(n.protocol=t.protocol,t.host||E[t.protocol])n.pathname=t.pathname;else{for(var r=(t.pathname||"").split("/");r.length&&!(t.host=r.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var o=n.pathname||"",a=n.search||"";n.path=o+a}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var s=n.pathname&&"/"===n.pathname.charAt(0),c=t.host||t.pathname&&"/"===t.pathname.charAt(0),f=c||s||n.host&&t.pathname,d=f,p=n.pathname&&n.pathname.split("/")||[],r=t.pathname&&t.pathname.split("/")||[],g=n.protocol&&!T[n.protocol];
if(g&&(n.hostname="",n.port=null,n.host&&(""===p[0]?p[0]=n.host:p.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===r[0]?r[0]=t.host:r.unshift(t.host)),t.host=null),f=f&&(""===r[0]||""===p[0])),c)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,p=r;else if(r.length)p||(p=[]),p.pop(),p=p.concat(r),n.search=t.search,n.query=t.query;else if(!l(t.search)){if(g){n.hostname=n.host=p.shift();var m=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;m&&(n.auth=m.shift(),n.host=n.hostname=m.shift())}return n.search=t.search,n.query=t.query,h(n.pathname)&&h(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!p.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var v=p.slice(-1)[0],b=(n.host||t.host)&&("."===v||".."===v)||""===v,y=0,x=p.length;x>=0;x--)v=p[x],"."==v?p.splice(x,1):".."===v?(p.splice(x,1),y++):y&&(p.splice(x,1),y--);if(!f&&!d)for(;y--;y)p.unshift("..");!f||""===p[0]||p[0]&&"/"===p[0].charAt(0)||p.unshift(""),b&&"/"!==p.join("/").substr(-1)&&p.push("");var w=""===p[0]||p[0]&&"/"===p[0].charAt(0);if(g){n.hostname=n.host=w?"":p.length?p.shift():"";var m=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;m&&(n.auth=m.shift(),n.host=n.hostname=m.shift())}return f=f||n.host&&p.length,f&&!w&&p.unshift(""),p.length?n.pathname=p.join("/"):(n.pathname=null,n.path=null),h(n.pathname)&&h(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=p.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:4,querystring:7}],9:[function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i=e&&e.length,o=i?e[0]*n:t.length,s=r(t,0,o,n,!0),u=[];if(!s)return u;var c,h,f,d,p,g,m;if(i&&(s=l(t,e,s,n)),t.length>80*n){c=f=t[0],h=d=t[1];for(var v=n;o>v;v+=n)p=t[v],g=t[v+1],c>p&&(c=p),h>g&&(h=g),p>f&&(f=p),g>d&&(d=g);m=Math.max(f-c,d-h)}return a(s,u,n,c,h,m),u}function r(t,e,n,i,r){var o,a,s,u=0;for(o=e,a=n-i;n>o;o+=i)u+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;if(r===u>0)for(o=e;n>o;o+=i)s=P(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=P(o,t[o],t[o+1],s);return s}function o(t,e){if(!t)return t;e||(e=t);var n,i=t;do if(n=!1,i.steiner||!_(i,i.next)&&0!==w(i.prev,i,i.next))i=i.next;else{if(I(i),i=e=i.prev,i===i.next)return null;n=!0}while(n||i!==e);return e}function a(t,e,n,i,r,l,f){if(t){!f&&l&&g(t,i,r,l);for(var d,p,m=t;t.prev!==t.next;)if(d=t.prev,p=t.next,l?u(t,i,r,l):s(t))e.push(d.i/n),e.push(t.i/n),e.push(p.i/n),I(t),t=p.next,m=p.next;else if(t=p,t===m){f?1===f?(t=c(t,e,n),a(t,e,n,i,r,l,2)):2===f&&h(t,e,n,i,r,l):a(o(t),e,n,i,r,l,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(w(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(y(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&w(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(t,e,n,i){var r=t.prev,o=t,a=t.next;if(w(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,u=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,h=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,l=v(s,u,e,n,i),f=v(c,h,e,n,i),d=t.nextZ;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=l;){if(d!==t.prev&&d!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function c(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;S(r,i,i.next,o)&&T(r,o)&&T(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),I(i),I(i.next),i=t=o),i=i.next}while(i!==t);return i}function h(t,e,n,i,r,s){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&x(u,c)){var h=C(u,c);return u=o(u,u.next),h=o(h,h.next),a(u,e,n,i,r,s),void a(h,e,n,i,r,s)}c=c.next}u=u.next}while(u!==t)}function l(t,e,n,i){var a,s,u,c,h,l=[];for(a=0,s=e.length;s>a;a++)u=e[a]*i,c=s-1>a?e[a+1]*i:t.length,h=r(t,u,c,i,!1),h===h.next&&(h.steiner=!0),l.push(b(h));for(l.sort(f),a=0;a<l.length;a++)d(l[a],n),n=o(n,n.next);return n}function f(t,e){return t.x-e.x}function d(t,e){if(e=p(t,e)){var n=C(e,t);o(n,n.next)}}function p(t,e){var n,i=e,r=t.x,o=t.y,a=-(1/0);do{if(o<=i.y&&o>=i.next.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);r>=s&&s>a&&(a=s,n=i.x<i.next.x?i:i.next)}i=i.next}while(i!==e);if(!n)return null;if(t.x===n.x)return n.prev;var u,c=n,h=1/0;for(i=n.next;i!==c;)r>=i.x&&i.x>=n.x&&y(o<n.y?r:a,o,n.x,n.y,o<n.y?a:r,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(r-i.x),(h>u||u===h&&i.x>n.x)&&T(i,t)&&(n=i,h=u)),i=i.next;return n}function g(t,e,n,i){var r=t;do null===r.z&&(r.z=v(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,m(r)}function m(t){var e,n,i,r,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;c>e&&(s++,i=i.nextZ,i);e++);for(u=c;s>0||u>0&&i;)0===s?(r=i,i=i.nextZ,u--):0!==u&&i?n.z<=i.z?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,u--):(r=n,n=n.nextZ,s--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1);return t}function v(t,e,n,i,r){return t=32767*(t-n)/r,e=32767*(e-i)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function b(t){var e=t,n=t;do e.x<n.x&&(n=e),e=e.next;while(e!==t);return n}function y(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function x(t,e){return _(t,e)||t.next.i!==e.i&&t.prev.i!==e.i&&!E(t,e)&&T(t,e)&&T(e,t)&&A(t,e)}function w(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function S(t,e,n,i){return w(t,e,n)>0!=w(t,e,i)>0&&w(n,i,t)>0!=w(n,i,e)>0}function E(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&S(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function T(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function A(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function C(t,e){var n=new R(t.i,t.x,t.y),i=new R(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function P(t,e,n,i){var r=new R(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function I(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function R(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}e.exports=i},{}],10:[function(t,e,n){"use strict";function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){}var o="function"!=typeof Object.create?"~":!1;r.prototype._events=void 0,r.prototype.listeners=function(t,e){var n=o?o+t:t,i=this._events&&this._events[n];if(e)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,s=new Array(a);a>r;r++)s[r]=i[r].fn;return s},r.prototype.emit=function(t,e,n,i,r,a){var s=o?o+t:t;if(!this._events||!this._events[s])return!1;var u,c,h=this._events[s],l=arguments.length;if("function"==typeof h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,i),!0;case 5:return h.fn.call(h.context,e,n,i,r),!0;case 6:return h.fn.call(h.context,e,n,i,r,a),!0}for(c=1,u=new Array(l-1);l>c;c++)u[c-1]=arguments[c];h.fn.apply(h.context,u)}else{var f,d=h.length;for(c=0;d>c;c++)switch(h[c].once&&this.removeListener(t,h[c].fn,void 0,!0),l){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,e);break;case 3:h[c].fn.call(h[c].context,e,n);break;default:if(!u)for(f=1,u=new Array(l-1);l>f;f++)u[f-1]=arguments[f];h[c].fn.apply(h[c].context,u)}}return!0},r.prototype.on=function(t,e,n){var r=new i(e,n||this),a=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):this._events[a]=r,this},r.prototype.once=function(t,e,n){var r=new i(e,n||this,!0),a=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):this._events[a]=r,this},r.prototype.removeListener=function(t,e,n,i){var r=o?o+t:t;if(!this._events||!this._events[r])return this;var a=this._events[r],s=[];if(e)if(a.fn)(a.fn!==e||i&&!a.once||n&&a.context!==n)&&s.push(a);else for(var u=0,c=a.length;c>u;u++)(a[u].fn!==e||i&&!a[u].once||n&&a[u].context!==n)&&s.push(a[u]);return s.length?this._events[r]=1===s.length?s[0]:s:delete this._events[r],this},r.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[o?o+t:t]:this._events=o?{}:Object.create(null),this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=o,"undefined"!=typeof e&&(e.exports=r)},{}],11:[function(t,e,n){"use strict";function i(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(t,e){for(var n,a,s=i(t),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var c in n)r.call(n,c)&&(s[c]=n[c]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(n);for(var h=0;h<a.length;h++)o.call(n,a[h])&&(s[a[h]]=n[a[h]])}}return s}},{}],12:[function(e,n,i){(function(e){!function(){function i(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(r,arguments)}}var r,o,a={};r=this,null!=r&&(o=r.async),a.noConflict=function(){return r.async=o,a};var s=Object.prototype.toString,u=Array.isArray||function(t){return"[object Array]"===s.call(t)},c=function(t,e){for(var n=0;n<t.length;n+=1)e(t[n],n,t)},h=function(t,e){if(t.map)return t.map(e);var n=[];return c(t,function(t,i,r){n.push(e(t,i,r))}),n},l=function(t,e,n){return t.reduce?t.reduce(e,n):(c(t,function(t,i,r){n=e(n,t,i,r)}),n)},f=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};"undefined"!=typeof e&&e.nextTick?(a.nextTick=e.nextTick,"undefined"!=typeof setImmediate?a.setImmediate=function(t){setImmediate(t)}:a.setImmediate=a.nextTick):"function"==typeof setImmediate?(a.nextTick=function(t){setImmediate(t)},a.setImmediate=a.nextTick):(a.nextTick=function(t){setTimeout(t,0)},a.setImmediate=a.nextTick),a.each=function(t,e,n){function r(e){e?(n(e),n=function(){}):(o+=1,o>=t.length&&n())}if(n=n||function(){},!t.length)return n();var o=0;c(t,function(t){e(t,i(r))})},a.forEach=a.each,a.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var i=0,r=function(){e(t[i],function(e){e?(n(e),n=function(){}):(i+=1,i>=t.length?n():r())})};r()},a.forEachSeries=a.eachSeries,a.eachLimit=function(t,e,n,i){var r=d(e);r.apply(null,[t,n,i])},a.forEachLimit=a.eachLimit;var d=function(t){return function(e,n,i){if(i=i||function(){},!e.length||0>=t)return i();var r=0,o=0,a=0;!function s(){if(r>=e.length)return i();for(;t>a&&o<e.length;)o+=1,a+=1,n(e[o-1],function(t){t?(i(t),i=function(){}):(r+=1,a-=1,r>=e.length?i():s())})}()}},p=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.each].concat(e))}},g=function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[d(t)].concat(n))}},m=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.eachSeries].concat(e))}},v=function(t,e,n,i){if(e=h(e,function(t,e){return{index:e,value:t}}),i){var r=[];t(e,function(t,e){n(t.value,function(n,i){r[t.index]=i,e(n)})},function(t){i(t,r)})}else t(e,function(t,e){n(t.value,function(t){e(t)})})};a.map=p(v),a.mapSeries=m(v),a.mapLimit=function(t,e,n,i){return b(e)(t,n,i)};var b=function(t){return g(t,v)};a.reduce=function(t,e,n,i){a.eachSeries(t,function(t,i){n(e,t,function(t,n){e=n,i(t)})},function(t){i(t,e)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(t,e,n,i){var r=h(t,function(t){return t}).reverse();a.reduce(r,e,n,i)},a.foldr=a.reduceRight;var y=function(t,e,n,i){var r=[];e=h(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n&&r.push(t),e()})},function(t){i(h(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.filter=p(y),a.filterSeries=m(y),a.select=a.filter,a.selectSeries=a.filterSeries;var x=function(t,e,n,i){var r=[];e=h(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n||r.push(t),e()})},function(t){i(h(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.reject=p(x),a.rejectSeries=m(x);var w=function(t,e,n,i){t(e,function(t,e){n(t,function(n){n?(i(t),i=function(){}):e()})},function(t){i()})};a.detect=p(w),a.detectSeries=m(w),a.some=function(t,e,n){a.each(t,function(t,i){e(t,function(t){t&&(n(!0),n=function(){}),i()})},function(t){n(!1)})},a.any=a.some,a.every=function(t,e,n){a.each(t,function(t,i){e(t,function(t){t||(n(!1),n=function(){}),i()})},function(t){n(!0)})},a.all=a.every,a.sortBy=function(t,e,n){a.map(t,function(t,n){e(t,function(e,i){e?n(e):n(null,{value:t,criteria:i})})},function(t,e){if(t)return n(t);var i=function(t,e){var n=t.criteria,i=e.criteria;return i>n?-1:n>i?1:0};n(null,h(e.sort(i),function(t){return t.value}))})},a.auto=function(t,e){e=e||function(){};var n=f(t),i=n.length;if(!i)return e();var r={},o=[],s=function(t){o.unshift(t)},h=function(t){for(var e=0;e<o.length;e+=1)if(o[e]===t)return void o.splice(e,1)},d=function(){i--,c(o.slice(0),function(t){t()})};s(function(){if(!i){var t=e;e=function(){},t(null,r)}}),c(n,function(n){var i=u(t[n])?t[n]:[t[n]],o=function(t){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),t){var o={};c(f(r),function(t){o[t]=r[t]}),o[n]=i,e(t,o),e=function(){}}else r[n]=i,a.setImmediate(d)},p=i.slice(0,Math.abs(i.length-1))||[],g=function(){return l(p,function(t,e){return t&&r.hasOwnProperty(e)},!0)&&!r.hasOwnProperty(n)};if(g())i[i.length-1](o,r);else{var m=function(){g()&&(h(m),i[i.length-1](o,r))};s(m)}})},a.retry=function(t,e,n){var i=5,r=[];"function"==typeof t&&(n=e,e=t,t=i),t=parseInt(t,10)||i;var o=function(i,o){for(var s=function(t,e){return function(n){t(function(t,i){n(!t||e,{err:t,result:i})},o)}};t;)r.push(s(e,!(t-=1)));a.series(r,function(t,e){e=e[e.length-1],(i||n)(e.err,e.result)})};return n?o():o},a.waterfall=function(t,e){if(e=e||function(){},!u(t)){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();var i=function(t){return function(n){if(n)e.apply(null,arguments),e=function(){};else{var r=Array.prototype.slice.call(arguments,1),o=t.next();o?r.push(i(o)):r.push(e),a.setImmediate(function(){t.apply(null,r)})}}};i(a.iterator(t))()};var _=function(t,e,n){if(n=n||function(){},u(e))t.map(e,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},n);else{var i={};t.each(f(e),function(t,n){e[t](function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),i[t]=r,n(e)})},function(t){n(t,i)})}};a.parallel=function(t,e){_({map:a.map,each:a.each},t,e)},a.parallelLimit=function(t,e,n){_({map:b(e),each:d(e)},t,n)},a.series=function(t,e){if(e=e||function(){},u(t))a.mapSeries(t,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},e);else{var n={};a.eachSeries(f(t),function(e,i){t[e](function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),n[e]=r,i(t)})},function(t){e(t,n)})}},a.iterator=function(t){var e=function(n){var i=function(){return t.length&&t[n].apply(null,arguments),i.next()};return i.next=function(){return n<t.length-1?e(n+1):null},i};return e(0)},a.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var S=function(t,e,n,i){var r=[];t(e,function(t,e){n(t,function(t,n){r=r.concat(n||[]),e(t)})},function(t){i(t,r)})};a.concat=p(S),a.concatSeries=m(S),a.whilst=function(t,e,n){t()?e(function(i){return i?n(i):void a.whilst(t,e,n)}):n()},a.doWhilst=function(t,e,n){t(function(i){if(i)return n(i);var r=Array.prototype.slice.call(arguments,1);e.apply(null,r)?a.doWhilst(t,e,n):n()})},a.until=function(t,e,n){t()?n():e(function(i){return i?n(i):void a.until(t,e,n)})},a.doUntil=function(t,e,n){t(function(i){if(i)return n(i);var r=Array.prototype.slice.call(arguments,1);e.apply(null,r)?n():a.doUntil(t,e,n)})},a.queue=function(t,e){function n(t,e,n,i){return t.started||(t.started=!0),u(e)||(e=[e]),0==e.length?a.setImmediate(function(){t.drain&&t.drain()}):void c(e,function(e){var r={data:e,callback:"function"==typeof i?i:null};n?t.tasks.unshift(r):t.tasks.push(r),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),a.setImmediate(t.process)})}void 0===e&&(e=1);var r=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){n(o,t,!1,e)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(t,e){n(o,t,!0,e)},process:function(){if(!o.paused&&r<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),r+=1;var n=function(){r-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+r===0&&o.drain(),o.process()},a=i(n);t(e.data,a)}},length:function(){return o.tasks.length},running:function(){return r},idle:function(){return o.tasks.length+r===0},pause:function(){o.paused!==!0&&(o.paused=!0)},resume:function(){if(o.paused!==!1){o.paused=!1;for(var t=1;t<=o.concurrency;t++)a.setImmediate(o.process)}}};return o},a.priorityQueue=function(t,e){function n(t,e){return t.priority-e.priority}function i(t,e,n){for(var i=-1,r=t.length-1;r>i;){var o=i+(r-i+1>>>1);n(e,t[o])>=0?i=o:r=o-1}return i}function r(t,e,r,o){return t.started||(t.started=!0),u(e)||(e=[e]),0==e.length?a.setImmediate(function(){t.drain&&t.drain()}):void c(e,function(e){var s={data:e,priority:r,callback:"function"==typeof o?o:null};t.tasks.splice(i(t.tasks,s,n)+1,0,s),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),a.setImmediate(t.process)})}var o=a.queue(t,e);return o.push=function(t,e,n){r(o,t,e,n)},delete o.unshift,o},a.cargo=function(t,e){var n=!1,i=[],r={tasks:i,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,n){u(t)||(t=[t]),c(t,function(t){i.push({data:t,callback:"function"==typeof n?n:null}),r.drained=!1,r.saturated&&i.length===e&&r.saturated()}),a.setImmediate(r.process)},process:function o(){if(!n){if(0===i.length)return r.drain&&!r.drained&&r.drain(),void(r.drained=!0);var a="number"==typeof e?i.splice(0,e):i.splice(0,i.length),s=h(a,function(t){return t.data});r.empty&&r.empty(),n=!0,t(s,function(){n=!1;var t=arguments;c(a,function(e){e.callback&&e.callback.apply(null,t)}),o()})}},length:function(){return i.length},running:function(){return n}};return r};var E=function(t){return function(e){var n=Array.prototype.slice.call(arguments,1);e.apply(null,n.concat([function(e){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&c(n,function(e){console[t](e)}))}]))}};a.log=E("log"),a.dir=E("dir"),a.memoize=function(t,e){var n={},i={};e=e||function(t){return t};var r=function(){var r=Array.prototype.slice.call(arguments),o=r.pop(),s=e.apply(null,r);s in n?a.nextTick(function(){o.apply(null,n[s])}):s in i?i[s].push(o):(i[s]=[o],t.apply(null,r.concat([function(){n[s]=arguments;var t=i[s];delete i[s];for(var e=0,r=t.length;r>e;e++)t[e].apply(null,arguments)}])))};return r.memo=n,r.unmemoized=t,r},a.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},a.times=function(t,e,n){for(var i=[],r=0;t>r;r++)i.push(r);return a.map(i,e,n)},a.timesSeries=function(t,e,n){for(var i=[],r=0;t>r;r++)i.push(r);return a.mapSeries(i,e,n)},a.seq=function(){var t=arguments;return function(){var e=this,n=Array.prototype.slice.call(arguments),i=n.pop();a.reduce(t,n,function(t,n,i){n.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);i(t,e)}]))},function(t,n){i.apply(e,[t].concat(n))})}},a.compose=function(){return a.seq.apply(null,Array.prototype.reverse.call(arguments))};var T=function(t,e){var n=function(){var n=this,i=Array.prototype.slice.call(arguments),r=i.pop();return t(e,function(t,e){t.apply(n,i.concat([e]))},r)};if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return n.apply(this,i)}return n};a.applyEach=p(T),a.applyEachSeries=m(T),a.forever=function(t,e){function n(i){if(i){if(e)return e(i);throw i}t(n)}n()},"undefined"!=typeof n&&n.exports?n.exports=a:"undefined"!=typeof t&&t.amd?t([],function(){return a}):r.async=a}()}).call(this,e("_process"))},{_process:3}],13:[function(t,e,n){function i(t,e){s.call(this),e=e||10,this.baseUrl=t||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=r.queue(this._boundLoadResource,e),this.resources={}}var r=t("async"),o=t("url"),a=t("./Resource"),s=t("eventemitter3");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.add=i.prototype.enqueue=function(t,e,n,i){if(Array.isArray(t)){for(var r=0;r<t.length;++r)this.add(t[r]);return this}if("object"==typeof t&&(i=e||t.callback||t.onComplete,n=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(i=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof n&&(i=n,n=null),this.resources[t])throw new Error('Resource with name "'+t+'" already exists.');return e=this._handleBaseUrl(e),this.resources[t]=new a(t,e,n),"function"==typeof i&&this.resources[t].once("afterMiddleware",i),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[t]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[t]),this._progressChunk=100/this._buffer.length),this},i.prototype._handleBaseUrl=function(t){var e=o.parse(t);return e.protocol||0===e.pathname.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t},i.prototype.before=i.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},i.prototype.after=i.prototype.use=function(t){return this._afterMiddleware.push(t),this},i.prototype.reset=function(){this.progress=0,this.loading=!1,this._progressChunk=0,this._buffer.length=0,this._numToLoad=0,this._queue.kill(),this._queue.started=!1,this.resources={}},i.prototype.load=function(t){if("function"==typeof t&&this.once("complete",t),this._queue.started)return this;this.emit("start",this);for(var e=0;e<this._buffer.length;++e)this._queue.push(this._buffer[e]);return this._buffer.length=0,this},i.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,this._runMiddleware(t,this._beforeMiddleware,function(){t.load(n._boundOnLoad)})},i.prototype._onComplete=function(){this.emit("complete",this,this.resources)},i.prototype._onLoad=function(t){this.progress+=this._progressChunk,this.emit("progress",this,t),this._runMiddleware(t,this._afterMiddleware,function(){t.emit("afterMiddleware",t),this._numToLoad--,0===this._numToLoad&&(this.progress=100,this._onComplete()),t.error?this.emit("error",t.error,this,t):this.emit("load",this,t)}),t._dequeue()},i.prototype._runMiddleware=function(t,e,n){var i=this;r.eachSeries(e,function(e,n){e.call(i,t,n)},n.bind(this,t))},i.LOAD_TYPE=a.LOAD_TYPE,i.XHR_READY_STATE=a.XHR_READY_STATE,i.XHR_RESPONSE_TYPE=a.XHR_RESPONSE_TYPE},{"./Resource":14,async:12,eventemitter3:10,url:8}],14:[function(t,e,n){function i(t,e,n){if(a.call(this),n=n||{},"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");this.name=t,this.url=e,this.isDataUrl=0===this.url.indexOf("data:"),this.data=null,this.crossOrigin=n.crossOrigin===!0?"anonymous":n.crossOrigin,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.isJson=!1,this.isXml=!1,this.isImage=!1,this.isAudio=!1,this.isVideo=!1,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function r(t){return t.toString().replace("object ","")}function o(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}var a=t("eventemitter3"),s=t("url"),u=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),c=null;i.prototype=Object.create(a.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},i.prototype.load=function(t){switch(this.emit("start",this),t&&this.once("complete",t),(this.crossOrigin===!1||"string"!=typeof this.crossOrigin)&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case i.LOAD_TYPE.IMAGE:this._loadImage();break;case i.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case i.LOAD_TYPE.VIDEO:this._loadElement("video");break;case i.LOAD_TYPE.XHR:default:u&&this.crossOrigin?this._loadXdr():this._loadXhr()}},i.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.data.src=this.url,this.isImage=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},i.prototype._loadElement=function(t){if("audio"===t&&"undefined"!=typeof Audio?this.data=new Audio:this.data=document.createElement(t),null===this.data)return this.error=new Error("Unsupported element "+t),void this.complete();if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=0;e<this.url.length;++e)this.data.appendChild(this._createSource(t,this.url[e]));else this.data.appendChild(this._createSource(t,this.url));this["is"+t[0].toUpperCase()+t.substring(1)]=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},i.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),this.xhrType===i.XHR_RESPONSE_TYPE.JSON||this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=i.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},i.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){t.send()},0)},i.prototype._createSource=function(t,e,n){n||(n=t+"/"+e.substr(e.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=e,i.type=n,i},i.prototype._onError=function(t){this.error=new Error("Failed to load element using "+t.target.nodeName),this.complete()},i.prototype._onProgress=function(t){t&&t.lengthComputable&&this.emit("progress",this,t.loaded/t.total)},i.prototype._xhrOnError=function(){this.error=new Error(r(this.xhr)+" Request failed. Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"'),this.complete()},i.prototype._xhrOnAbort=function(){this.error=new Error(r(this.xhr)+" Request was aborted by the user."),this.complete()},i.prototype._xdrOnTimeout=function(){this.error=new Error(r(this.xhr)+" Request timed out."),this.complete()},i.prototype._xhrOnLoad=function(){var t=this.xhr,e=void 0!==t.status?t.status:200;if(200===e||204===e||0===e&&t.responseText.length>0)if(this.xhrType===i.XHR_RESPONSE_TYPE.TEXT)this.data=t.responseText;else if(this.xhrType===i.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t.responseText),this.isJson=!0}catch(n){this.error=new Error("Error trying to parse loaded json:",n)}else if(this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(t.responseText,"text/xml")}else{var o=document.createElement("div");o.innerHTML=t.responseText,this.data=o}this.isXml=!0}catch(n){this.error=new Error("Error trying to parse loaded xml:",n)}else this.data=t.response||t.responseText;else this.error=new Error("["+t.status+"]"+t.statusText+":"+t.responseURL);this.complete()},i.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,c||(c=document.createElement("a")),c.href=t,t=s.parse(c.href);var n=!t.port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&n&&t.protocol===e.protocol?"":"anonymous"},i.prototype._determineXhrType=function(){return i._xhrTypeMap[this._getExtension()]||i.XHR_RESPONSE_TYPE.TEXT},i.prototype._determineLoadType=function(){return i._loadTypeMap[this._getExtension()]||i.LOAD_TYPE.XHR},i.prototype._getExtension=function(){var t,e=this.url;if(this.isDataUrl){var n=e.indexOf("/");t=e.substring(n+1,e.indexOf(";",n))}else{var i=e.indexOf("?");-1!==i&&(e=e.substring(0,i)),t=e.substring(e.lastIndexOf(".")+1)}return t},i.prototype._getMimeFromXhrType=function(t){switch(t){case i.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case i.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case i.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case i.XHR_RESPONSE_TYPE.JSON:return"application/json";case i.XHR_RESPONSE_TYPE.DEFAULT:case i.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},i.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},i.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},i._loadTypeMap={gif:i.LOAD_TYPE.IMAGE,png:i.LOAD_TYPE.IMAGE,bmp:i.LOAD_TYPE.IMAGE,jpg:i.LOAD_TYPE.IMAGE,jpeg:i.LOAD_TYPE.IMAGE,tif:i.LOAD_TYPE.IMAGE,tiff:i.LOAD_TYPE.IMAGE,webp:i.LOAD_TYPE.IMAGE,tga:i.LOAD_TYPE.IMAGE},i._xhrTypeMap={xhtml:i.XHR_RESPONSE_TYPE.DOCUMENT,html:i.XHR_RESPONSE_TYPE.DOCUMENT,
htm:i.XHR_RESPONSE_TYPE.DOCUMENT,xml:i.XHR_RESPONSE_TYPE.DOCUMENT,tmx:i.XHR_RESPONSE_TYPE.DOCUMENT,tsx:i.XHR_RESPONSE_TYPE.DOCUMENT,svg:i.XHR_RESPONSE_TYPE.DOCUMENT,gif:i.XHR_RESPONSE_TYPE.BLOB,png:i.XHR_RESPONSE_TYPE.BLOB,bmp:i.XHR_RESPONSE_TYPE.BLOB,jpg:i.XHR_RESPONSE_TYPE.BLOB,jpeg:i.XHR_RESPONSE_TYPE.BLOB,tif:i.XHR_RESPONSE_TYPE.BLOB,tiff:i.XHR_RESPONSE_TYPE.BLOB,webp:i.XHR_RESPONSE_TYPE.BLOB,tga:i.XHR_RESPONSE_TYPE.BLOB,json:i.XHR_RESPONSE_TYPE.JSON,text:i.XHR_RESPONSE_TYPE.TEXT,txt:i.XHR_RESPONSE_TYPE.TEXT},i.setExtensionLoadType=function(t,e){o(i._loadTypeMap,t,e)},i.setExtensionXhrType=function(t,e){o(i._xhrTypeMap,t,e)}},{eventemitter3:10,url:8}],15:[function(t,e,n){e.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(t){for(var e,n="",i=new Array(4),r=0,o=0,a=0;r<t.length;){for(e=new Array(3),o=0;o<e.length;o++)r<t.length?e[o]=255&t.charCodeAt(r++):e[o]=0;switch(i[0]=e[0]>>2,i[1]=(3&e[0])<<4|e[1]>>4,i[2]=(15&e[1])<<2|e[2]>>6,i[3]=63&e[2],a=r-(t.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(o=0;o<i.length;o++)n+=this._keyStr.charAt(i[o])}return n}}},{}],16:[function(t,e,n){e.exports=t("./Loader"),e.exports.Resource=t("./Resource"),e.exports.middleware={caching:{memory:t("./middlewares/caching/memory")},parsing:{blob:t("./middlewares/parsing/blob")}}},{"./Loader":13,"./Resource":14,"./middlewares/caching/memory":17,"./middlewares/parsing/blob":18}],17:[function(t,e,n){var i={};e.exports=function(){return function(t,e){i[t.url]?(t.data=i[t.url],t.complete()):t.once("complete",function(){i[this.url]=this.data}),e()}}},{}],18:[function(t,e,n){var i=t("../../Resource"),r=t("../../b64");window.URL=window.URL||window.webkitURL,e.exports=function(){return function(t,e){if(!t.data)return e();if(t.xhr&&t.xhrType===i.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var n=URL.createObjectURL(t.data);t.blob=t.data,t.data=new Image,t.data.src=n,t.isImage=!0,t.data.onload=function(){URL.revokeObjectURL(n),t.data.onload=null,e()}}}else{var o=t.xhr.getResponseHeader("content-type");o&&0===o.indexOf("image")&&(t.data=new Image,t.data.src="data:"+o+";base64,"+r.encodeBinary(t.xhr.responseText),t.isImage=!0,t.data.onload=function(){t.data.onload=null,e()})}else e()}}},{"../../Resource":14,"../../b64":15}],19:[function(t,e,n){function i(t){var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,window.addEventListener("keydown",this._onKeyDown,!1)}var r=t("../core");Object.assign(r.DisplayObject.prototype,t("./accessibleTarget")),i.prototype.constructor=i,e.exports=i,i.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode.appendChild(this.div))},i.prototype.deactivate=function(){this.isActive&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode.removeChild(this.div))},i.prototype.updateAccessibleObjects=function(t){if(t.visible&&(t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId),t.interactiveChildren))for(var e=t.children,n=e.length-1;n>=0;n--)this.updateAccessibleObjects(e[n])},i.prototype.update=function(){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,n=t.height/this.renderer.height,i=this.div;i.style.left=t.left+"px",i.style.top=t.top+"px",i.style.width=this.renderer.width+"px",i.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var a=this.children[o];if(a.renderId!==this.renderId)a._accessibleActive=!1,r.utils.removeItems(this.children,o,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,o--,0===this.children.length&&this.deactivate();else{i=a._accessibleDiv;var s=a.hitArea,u=a.worldTransform;a.hitArea?(i.style.left=(u.tx+s.x*u.a)*e+"px",i.style.top=(u.ty+s.y*u.d)*n+"px",i.style.width=s.width*u.a*e+"px",i.style.height=s.height*u.d*n+"px"):(s=a.getBounds(),this.capHitArea(s),i.style.left=s.x*e+"px",i.style.top=s.y*n+"px",i.style.width=s.width*e+"px",i.style.height=s.height*n+"px")}}this.renderId++},i.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},i.prototype.addChild=function(t){var e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.title=t.accessibleTitle||"displayObject "+this.tabIndex,t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},i.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},i.prototype._onFocus=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},i.prototype._onFocusOut=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},i.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},i.prototype._onMouseMove=function(){this.deactivate()},i.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},r.WebGLRenderer.registerPlugin("accessibility",i),r.CanvasRenderer.registerPlugin("accessibility",i)},{"../core":29,"./accessibleTarget":20}],20:[function(t,e,n){var i={accessible:!1,accessibleTitle:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1};e.exports=i},{}],21:[function(t,e,n){e.exports={accessibleTarget:t("./accessibleTarget"),AccessibilityManager:t("./AccessibilityManager")}},{"./AccessibilityManager":19,"./accessibleTarget":20}],22:[function(t,e,n){var i={VERSION:"3.0.10",PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,TARGET_FPMS:.06,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3};e.exports=i},{}],23:[function(t,e,n){function i(){a.call(this),this.children=[]}var r=t("../math"),o=t("../utils"),a=t("./DisplayObject"),s=t("../textures/RenderTexture"),u=new r.Matrix;i.prototype=Object.create(a.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;0!==e?this.scale.x=t/e:this.scale.x=1,this._width=t}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;0!==e?this.scale.y=t/e:this.scale.y=1,this._height=t}}}),i.prototype.onChildrenChange=function(){},i.prototype.addChild=function(t){var e=arguments.length;if(e>1)for(var n=0;e>n;n++)this.addChild(arguments[n]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.children.push(t),this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},i.prototype.addChildAt=function(t,e){if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.onChildrenChange(e),t.emit("added",this),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},i.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),i=this.getChildIndex(e);if(0>n||0>i)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[n]=e,this.children[i]=t,this.onChildrenChange(i>n?n:i)}},i.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},i.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var n=this.getChildIndex(t);o.removeItems(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},i.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[t]},i.prototype.removeChild=function(t){var e=arguments.length;if(e>1)for(var n=0;e>n;n++)this.removeChild(arguments[n]);else{var i=this.children.indexOf(t);if(-1===i)return;t.parent=null,o.removeItems(this.children,i,1),this.onChildrenChange(i),t.emit("removed",this)}return t},i.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,o.removeItems(this.children,t,1),this.onChildrenChange(t),e.emit("removed",this),e},i.prototype.removeChildren=function(t,e){var n,i,r=t||0,o="number"==typeof e?e:this.children.length,a=o-r;if(a>0&&o>=a){for(n=this.children.splice(r,a),i=0;i<n.length;++i)n[i].parent=null;for(this.onChildrenChange(t),i=0;i<n.length;++i)n[i].emit("removed",this);return n}if(0===a&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},i.prototype.generateTexture=function(t,e,n){var i=this.getLocalBounds(),r=new s(t,0|i.width,0|i.height,n,e);return u.tx=-i.x,u.ty=-i.y,r.render(this,u),r},i.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var t=0,e=this.children.length;e>t;++t)this.children[t].updateTransform()}},i.prototype.containerUpdateTransform=i.prototype.updateTransform,i.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return r.Rectangle.EMPTY;for(var t,e,n,i=1/0,o=1/0,a=-(1/0),s=-(1/0),u=!1,c=0,h=this.children.length;h>c;++c){var l=this.children[c];l.visible&&(u=!0,t=this.children[c].getBounds(),i=i<t.x?i:t.x,o=o<t.y?o:t.y,e=t.width+t.x,n=t.height+t.y,a=a>e?a:e,s=s>n?s:n)}if(!u)return r.Rectangle.EMPTY;var f=this._bounds;f.x=i,f.y=o,f.width=a-i,f.height=s-o,this._currentBounds=f}return this._currentBounds},i.prototype.containerGetBounds=i.prototype.getBounds,i.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=r.Matrix.IDENTITY;for(var e=0,n=this.children.length;n>e;++e)this.children[e].updateTransform();return this.worldTransform=t,this._currentBounds=null,this.getBounds(r.Matrix.IDENTITY)},i.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var e,n;if(this._mask||this._filters){for(t.currentRenderer.flush(),this._filters&&this._filters.length&&t.filterManager.pushFilter(this,this._filters),this._mask&&t.maskManager.pushMask(this,this._mask),t.currentRenderer.start(),this._renderWebGL(t),e=0,n=this.children.length;n>e;e++)this.children[e].renderWebGL(t);t.currentRenderer.flush(),this._mask&&t.maskManager.popMask(this,this._mask),this._filters&&t.filterManager.popFilter(),t.currentRenderer.start()}else for(this._renderWebGL(t),e=0,n=this.children.length;n>e;++e)this.children[e].renderWebGL(t)}},i.prototype._renderWebGL=function(t){},i.prototype._renderCanvas=function(t){},i.prototype.renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask,t),this._renderCanvas(t);for(var e=0,n=this.children.length;n>e;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},i.prototype.destroy=function(t){if(a.prototype.destroy.call(this),t)for(var e=0,n=this.children.length;n>e;++e)this.children[e].destroy(t);this.removeChildren(),this.children=null}},{"../math":33,"../textures/RenderTexture":71,"../utils":77,"./DisplayObject":24}],24:[function(t,e,n){function i(){a.call(this),this.position=new r.Point,this.scale=new r.Point(1,1),this.pivot=new r.Point(0,0),this.skew=new r.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new r.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new r.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var r=t("../math"),o=t("../textures/RenderTexture"),a=t("eventemitter3"),s=t("../const"),u=new r.Matrix,c={worldTransform:new r.Matrix,worldAlpha:1,children:[]};i.prototype=Object.create(a.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}}),i.prototype.updateTransform=function(){var t,e,n,i,r,o,a=this.parent.worldTransform,c=this.worldTransform;this.skew.x||this.skew.y?(u.setTransform(this.position.x,this.position.y,this.pivot.x,this.pivot.y,this.scale.x,this.scale.y,this.rotation,this.skew.x,this.skew.y),c.a=u.a*a.a+u.b*a.c,c.b=u.a*a.b+u.b*a.d,c.c=u.c*a.a+u.d*a.c,c.d=u.c*a.b+u.d*a.d,c.tx=u.tx*a.a+u.ty*a.c+a.tx,c.ty=u.tx*a.b+u.ty*a.d+a.ty):this.rotation%s.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,e=this._sr*this.scale.x,n=-this._sr*this.scale.y,i=this._cr*this.scale.y,r=this.position.x,o=this.position.y,(this.pivot.x||this.pivot.y)&&(r-=this.pivot.x*t+this.pivot.y*n,o-=this.pivot.x*e+this.pivot.y*i),c.a=t*a.a+e*a.c,c.b=t*a.b+e*a.d,c.c=n*a.a+i*a.c,c.d=n*a.b+i*a.d,c.tx=r*a.a+o*a.c+a.tx,c.ty=r*a.b+o*a.d+a.ty):(t=this.scale.x,i=this.scale.y,r=this.position.x-this.pivot.x*t,o=this.position.y-this.pivot.y*i,c.a=t*a.a,c.b=t*a.b,c.c=i*a.c,c.d=i*a.d,c.tx=r*a.a+o*a.c+a.tx,c.ty=r*a.b+o*a.d+a.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},i.prototype.displayObjectUpdateTransform=i.prototype.updateTransform,i.prototype.getBounds=function(t){return r.Rectangle.EMPTY},i.prototype.getLocalBounds=function(){return this.getBounds(r.Matrix.IDENTITY)},i.prototype.toGlobal=function(t){return this.parent?this.displayObjectUpdateTransform():(this.parent=c,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.apply(t)},i.prototype.toLocal=function(t,e,n){return e&&(t=e.toGlobal(t)),this.parent?this.displayObjectUpdateTransform():(this.parent=c,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.applyInverse(t,n)},i.prototype.renderWebGL=function(t){},i.prototype.renderCanvas=function(t){},i.prototype.generateTexture=function(t,e,n){var i=this.getLocalBounds(),r=new o(t,0|i.width,0|i.height,e,n);return u.tx=-i.x,u.ty=-i.y,r.render(this,u),r},i.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},i.prototype.setTransform=function(t,e,n,i,r,o,a,s,u){return this.position.x=t||0,this.position.y=e||0,this.scale.x=n?n:1,this.scale.y=i?i:1,this.rotation=r||0,this.skew.x=o||0,this.skew.y=a||0,this.pivot.x=s||0,this.pivot.y=u||0,this},i.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.skew=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null}},{"../const":22,"../math":33,"../textures/RenderTexture":71,eventemitter3:10}],25:[function(t,e,n){function i(){r.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=h.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new c.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.boundsDirty=!0,this.cachedSpriteDirty=!1}var r=t("../display/Container"),o=t("../textures/Texture"),a=t("../renderers/canvas/utils/CanvasBuffer"),s=t("../renderers/canvas/utils/CanvasGraphics"),u=t("./GraphicsData"),c=t("../math"),h=t("../const"),l=new c.Point;i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.clone=function(){var t=new i;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=!0,t.glDirty=!0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},i.prototype.lineStyle=function(t,e,n){if(this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0===n?1:n,this.currentPath)if(this.currentPath.shape.points.length){var i=new c.Polygon(this.currentPath.shape.points.slice(-2));i.closed=!1,this.drawShape(i)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},i.prototype.moveTo=function(t,e){var n=new c.Polygon([t,e]);return n.closed=!1,this.drawShape(n),this},i.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty=!0,this},i.prototype.quadraticCurveTo=function(t,e,n,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r,o,a=20,s=this.currentPath.shape.points;0===s.length&&this.moveTo(0,0);for(var u=s[s.length-2],c=s[s.length-1],h=0,l=1;a>=l;++l)h=l/a,r=u+(t-u)*h,o=c+(e-c)*h,s.push(r+(t+(n-t)*h-r)*h,o+(e+(i-e)*h-o)*h);return this.dirty=this.boundsDirty=!0,this},i.prototype.bezierCurveTo=function(t,e,n,i,r,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var a,s,u,c,h,l=20,f=this.currentPath.shape.points,d=f[f.length-2],p=f[f.length-1],g=0,m=1;l>=m;++m)g=m/l,a=1-g,s=a*a,u=s*a,c=g*g,h=c*g,f.push(u*d+3*s*g*t+3*a*c*n+h*r,u*p+3*s*g*e+3*a*c*i+h*o);return this.dirty=this.boundsDirty=!0,this},i.prototype.arcTo=function(t,e,n,i,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o=this.currentPath.shape.points,a=o[o.length-2],s=o[o.length-1],u=s-e,c=a-t,h=i-e,l=n-t,f=Math.abs(u*l-c*h);if(1e-8>f||0===r)(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e);else{var d=u*u+c*c,p=h*h+l*l,g=u*h+c*l,m=r*Math.sqrt(d)/f,v=r*Math.sqrt(p)/f,b=m*g/d,y=v*g/p,x=m*l+v*c,w=m*h+v*u,_=c*(v+b),S=u*(v+b),E=l*(m+y),T=h*(m+y),A=Math.atan2(S-w,_-x),C=Math.atan2(T-w,E-x);this.arc(x+t,w+e,r,A,C,c*h>l*u)}return this.dirty=this.boundsDirty=!0,this},i.prototype.arc=function(t,e,n,i,r,o){if(o=o||!1,i===r)return this;!o&&i>=r?r+=2*Math.PI:o&&r>=i&&(i+=2*Math.PI);var a=o?-1*(i-r):r-i,s=40*Math.ceil(Math.abs(a)/(2*Math.PI));if(0===a)return this;var u=t+Math.cos(i)*n,c=e+Math.sin(i)*n;this.currentPath?this.currentPath.shape.points.push(u,c):this.moveTo(u,c);for(var h=this.currentPath.shape.points,l=a/(2*s),f=2*l,d=Math.cos(l),p=Math.sin(l),g=s-1,m=g%1/g,v=0;g>=v;v++){var b=v+m*v,y=l+i+f*b,x=Math.cos(y),w=-Math.sin(y);h.push((d*x+p*w)*n+t,(d*-w+p*x)*n+e)}return this.dirty=this.boundsDirty=!0,this},i.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},i.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},i.prototype.drawRect=function(t,e,n,i){return this.drawShape(new c.Rectangle(t,e,n,i)),this},i.prototype.drawRoundedRect=function(t,e,n,i,r){return this.drawShape(new c.RoundedRectangle(t,e,n,i,r)),this},i.prototype.drawCircle=function(t,e,n){return this.drawShape(new c.Circle(t,e,n)),this},i.prototype.drawEllipse=function(t,e,n,i){return this.drawShape(new c.Ellipse(t,e,n,i)),this},i.prototype.drawPolygon=function(t){var e=t,n=!0;if(e instanceof c.Polygon&&(n=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var i=0;i<e.length;++i)e[i]=arguments[i]}var r=new c.Polygon(e);return r.closed=n,this.drawShape(r),this},i.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},i.prototype.generateTexture=function(t,e,n){e=e||1;var i=this.getLocalBounds(),r=new a(i.width*e,i.height*e),u=o.fromCanvas(r.canvas,n);return u.baseTexture.resolution=e,r.context.scale(e,e),r.context.translate(-i.x,-i.y),s.renderGraphics(this,r.context),u},i.prototype._renderWebGL=function(t){this.glDirty&&(this.dirty=!0,this.glDirty=!1),t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this)},i.prototype._renderCanvas=function(t){if(this.isMask!==!0){this._prevTint!==this.tint&&(this.dirty=!0);var e=t.context,n=this.worldTransform,i=t.blendModes[this.blendMode];i!==e.globalCompositeOperation&&(e.globalCompositeOperation=i);var r=t.resolution;e.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*r,n.ty*r),s.renderGraphics(this,e)}},i.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return c.Rectangle.EMPTY;this.boundsDirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.boundsDirty=!1);var e=this._localBounds,n=e.x,i=e.width+e.x,r=e.y,o=e.height+e.y,a=t||this.worldTransform,s=a.a,u=a.b,h=a.c,l=a.d,f=a.tx,d=a.ty,p=s*i+h*o+f,g=l*o+u*i+d,m=s*n+h*o+f,v=l*o+u*n+d,b=s*n+h*r+f,y=l*r+u*n+d,x=s*i+h*r+f,w=l*r+u*i+d,_=p,S=g,E=p,T=g;E=E>m?m:E,E=E>b?b:E,E=E>x?x:E,T=T>v?v:T,T=T>y?y:T,T=T>w?w:T,_=m>_?m:_,_=b>_?b:_,_=x>_?x:_,S=v>S?v:S,S=y>S?y:S,S=w>S?w:S,this._bounds.x=E,this._bounds.width=_-E,this._bounds.y=T,this._bounds.height=S-T,this._currentBounds=this._bounds}return this._currentBounds},i.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,l);for(var e=this.graphicsData,n=0;n<e.length;n++){var i=e[n];if(i.fill&&i.shape&&i.shape.contains(l.x,l.y))return!0}return!1},i.prototype.updateLocalBounds=function(){var t=1/0,e=-(1/0),n=1/0,i=-(1/0);if(this.graphicsData.length)for(var r,o,a,s,u,c,l=0;l<this.graphicsData.length;l++){var f=this.graphicsData[l],d=f.type,p=f.lineWidth;if(r=f.shape,d===h.SHAPES.RECT||d===h.SHAPES.RREC)a=r.x-p/2,s=r.y-p/2,u=r.width+p,c=r.height+p,t=t>a?a:t,e=a+u>e?a+u:e,n=n>s?s:n,i=s+c>i?s+c:i;else if(d===h.SHAPES.CIRC)a=r.x,s=r.y,u=r.radius+p/2,c=r.radius+p/2,t=t>a-u?a-u:t,e=a+u>e?a+u:e,n=n>s-c?s-c:n,i=s+c>i?s+c:i;else if(d===h.SHAPES.ELIP)a=r.x,s=r.y,u=r.width+p/2,c=r.height+p/2,t=t>a-u?a-u:t,e=a+u>e?a+u:e,n=n>s-c?s-c:n,i=s+c>i?s+c:i;else{o=r.points;for(var g=0;g<o.length;g+=2)a=o[g],s=o[g+1],t=t>a-p?a-p:t,e=a+p>e?a+p:e,n=n>s-p?s-p:n,i=s+p>i?s+p:i}}else t=0,e=0,n=0,i=0;var m=this.boundsPadding;this._localBounds.x=t-m,this._localBounds.width=e-t+2*m,this._localBounds.y=n-m,this._localBounds.height=i-n+2*m},i.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new u(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(e),e.type===h.SHAPES.POLY&&(e.shape.closed=e.shape.closed||this.filling,this.currentPath=e),this.dirty=this.boundsDirty=!0,e},i.prototype.destroy=function(){r.prototype.destroy.apply(this,arguments);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var e in this._webgl)for(var n=0;n<this._webgl[e].data.length;++n)this._webgl[e].data[n].destroy();this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null}},{"../const":22,"../display/Container":23,"../math":33,"../renderers/canvas/utils/CanvasBuffer":45,"../renderers/canvas/utils/CanvasGraphics":46,"../textures/Texture":72,"./GraphicsData":26}],26:[function(t,e,n){function i(t,e,n,i,r,o,a){this.lineWidth=t,this.lineColor=e,this.lineAlpha=n,this._lineTint=e,this.fillColor=i,this.fillAlpha=r,this._fillTint=i,this.fill=o,this.shape=a,this.type=a.type}i.prototype.constructor=i,e.exports=i,i.prototype.clone=function(){return new i(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},i.prototype.destroy=function(){this.shape=null}},{}],27:[function(t,e,n){function i(t){s.call(this,t),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null,this.maximumSimplePolySize=200}var r=t("../../utils"),o=t("../../math"),a=t("../../const"),s=t("../../renderers/webgl/utils/ObjectRenderer"),u=t("../../renderers/webgl/WebGLRenderer"),c=t("./WebGLGraphicsData"),h=t("earcut");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,e.exports=i,u.registerPlugin("graphics",i),i.prototype.onContextChange=function(){},i.prototype.destroy=function(){s.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},i.prototype.render=function(t){var e,n=this.renderer,i=n.gl,o=n.shaderManager.plugins.primitiveShader;(t.dirty||!t._webGL[i.id])&&this.updateGraphics(t);var a=t._webGL[i.id];n.blendModeManager.setBlendMode(t.blendMode);for(var s=0,u=a.data.length;u>s;s++)e=a.data[s],1===a.data[s].mode?(n.stencilManager.pushStencil(t,e),i.uniform1f(n.shaderManager.complexPrimitiveShader.uniforms.alpha._location,t.worldAlpha*e.alpha),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(e.indices.length-4)),n.stencilManager.popStencil(t,e)):(o=n.shaderManager.primitiveShader,n.shaderManager.setShader(o),i.uniformMatrix3fv(o.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),i.uniformMatrix3fv(o.uniforms.projectionMatrix._location,!1,n.currentRenderTarget.projectionMatrix.toArray(!0)),i.uniform3fv(o.uniforms.tint._location,r.hex2rgb(t.tint)),i.uniform1f(o.uniforms.alpha._location,t.worldAlpha),i.bindBuffer(i.ARRAY_BUFFER,e.buffer),i.vertexAttribPointer(o.attributes.aVertexPosition,2,i.FLOAT,!1,24,0),i.vertexAttribPointer(o.attributes.aColor,4,i.FLOAT,!1,24,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.indexBuffer),i.drawElements(i.TRIANGLE_STRIP,e.indices.length,i.UNSIGNED_SHORT,0)),n.drawCount++},i.prototype.updateGraphics=function(t){var e=this.renderer.gl,n=t._webGL[e.id];n||(n=t._webGL[e.id]={lastIndex:0,data:[],gl:e}),t.dirty=!1;var i;if(t.clearDirty){for(t.clearDirty=!1,i=0;i<n.data.length;i++){var r=n.data[i];r.reset(),this.graphicsDataPool.push(r)}n.data=[],n.lastIndex=0}var o;for(i=n.lastIndex;i<t.graphicsData.length;i++){var s=t.graphicsData[i];if(s.type===a.SHAPES.POLY){if(s.points=s.shape.points.slice(),s.shape.closed&&(s.points[0]!==s.points[s.points.length-2]||s.points[1]!==s.points[s.points.length-1])&&s.points.push(s.points[0],s.points[1]),s.fill&&s.points.length>=6)if(s.points.length<2*this.maximumSimplePolySize){o=this.switchMode(n,0);var u=this.buildPoly(s,o);u||(o=this.switchMode(n,1),this.buildComplexPoly(s,o))}else o=this.switchMode(n,1),this.buildComplexPoly(s,o);s.lineWidth>0&&(o=this.switchMode(n,0),this.buildLine(s,o))}else o=this.switchMode(n,0),s.type===a.SHAPES.RECT?this.buildRectangle(s,o):s.type===a.SHAPES.CIRC||s.type===a.SHAPES.ELIP?this.buildCircle(s,o):s.type===a.SHAPES.RREC&&this.buildRoundedRectangle(s,o);n.lastIndex++}for(i=0;i<n.data.length;i++)o=n.data[i],o.dirty&&o.upload()},i.prototype.switchMode=function(t,e){var n;return t.data.length?(n=t.data[t.data.length-1],(n.points.length>32e4||n.mode!==e||1===e)&&(n=this.graphicsDataPool.pop()||new c(t.gl),n.mode=e,t.data.push(n))):(n=this.graphicsDataPool.pop()||new c(t.gl),n.mode=e,t.data.push(n)),n.dirty=!0,n},i.prototype.buildRectangle=function(t,e){var n=t.shape,i=n.x,o=n.y,a=n.width,s=n.height;if(t.fill){var u=r.hex2rgb(t.fillColor),c=t.fillAlpha,h=u[0]*c,l=u[1]*c,f=u[2]*c,d=e.points,p=e.indices,g=d.length/6;d.push(i,o),d.push(h,l,f,c),d.push(i+a,o),d.push(h,l,f,c),d.push(i,o+s),d.push(h,l,f,c),d.push(i+a,o+s),d.push(h,l,f,c),p.push(g,g,g+1,g+2,g+3,g+3)}if(t.lineWidth){var m=t.points;t.points=[i,o,i+a,o,i+a,o+s,i,o+s,i,o],this.buildLine(t,e),t.points=m}},i.prototype.buildRoundedRectangle=function(t,e){var n=t.shape,i=n.x,o=n.y,a=n.width,s=n.height,u=n.radius,c=[];if(c.push(i,o+u),this.quadraticBezierCurve(i,o+s-u,i,o+s,i+u,o+s,c),this.quadraticBezierCurve(i+a-u,o+s,i+a,o+s,i+a,o+s-u,c),this.quadraticBezierCurve(i+a,o+u,i+a,o,i+a-u,o,c),this.quadraticBezierCurve(i+u,o,i,o,i,o+u+1e-10,c),t.fill){var l=r.hex2rgb(t.fillColor),f=t.fillAlpha,d=l[0]*f,p=l[1]*f,g=l[2]*f,m=e.points,v=e.indices,b=m.length/6,y=h(c,null,2),x=0;for(x=0;x<y.length;x+=3)v.push(y[x]+b),v.push(y[x]+b),v.push(y[x+1]+b),v.push(y[x+2]+b),v.push(y[x+2]+b);for(x=0;x<c.length;x++)m.push(c[x],c[++x],d,p,g,f)}if(t.lineWidth){var w=t.points;t.points=c,this.buildLine(t,e),t.points=w}},i.prototype.quadraticBezierCurve=function(t,e,n,i,r,o,a){function s(t,e,n){var i=e-t;return t+i*n}for(var u,c,h,l,f,d,p=20,g=a||[],m=0,v=0;p>=v;v++)m=v/p,u=s(t,n,m),c=s(e,i,m),h=s(n,r,m),l=s(i,o,m),f=s(u,h,m),d=s(c,l,m),g.push(f,d);return g},i.prototype.buildCircle=function(t,e){var n,i,o=t.shape,s=o.x,u=o.y;t.type===a.SHAPES.CIRC?(n=o.radius,i=o.radius):(n=o.width,i=o.height);var c=Math.floor(30*Math.sqrt(o.radius))||Math.floor(15*Math.sqrt(o.width+o.height)),h=2*Math.PI/c,l=0;if(t.fill){var f=r.hex2rgb(t.fillColor),d=t.fillAlpha,p=f[0]*d,g=f[1]*d,m=f[2]*d,v=e.points,b=e.indices,y=v.length/6;for(b.push(y),l=0;c+1>l;l++)v.push(s,u,p,g,m,d),v.push(s+Math.sin(h*l)*n,u+Math.cos(h*l)*i,p,g,m,d),b.push(y++,y++);b.push(y-1)}if(t.lineWidth){var x=t.points;for(t.points=[],l=0;c+1>l;l++)t.points.push(s+Math.sin(h*l)*n,u+Math.cos(h*l)*i);this.buildLine(t,e),t.points=x}},i.prototype.buildLine=function(t,e){var n=0,i=t.points;if(0!==i.length){var a=new o.Point(i[0],i[1]),s=new o.Point(i[i.length-2],i[i.length-1]);if(a.x===s.x&&a.y===s.y){i=i.slice(),i.pop(),i.pop(),s=new o.Point(i[i.length-2],i[i.length-1]);var u=s.x+.5*(a.x-s.x),c=s.y+.5*(a.y-s.y);i.unshift(u,c),i.push(u,c)}var h,l,f,d,p,g,m,v,b,y,x,w,_,S,E,T,A,C,P,I,R,M,k,O=e.points,D=e.indices,L=i.length/2,B=i.length,N=O.length/6,F=t.lineWidth/2,j=r.hex2rgb(t.lineColor),U=t.lineAlpha,z=j[0]*U,G=j[1]*U,H=j[2]*U;for(f=i[0],d=i[1],p=i[2],g=i[3],b=-(d-g),y=f-p,k=Math.sqrt(b*b+y*y),b/=k,y/=k,b*=F,y*=F,O.push(f-b,d-y,z,G,H,U),O.push(f+b,d+y,z,G,H,U),n=1;L-1>n;n++)f=i[2*(n-1)],d=i[2*(n-1)+1],p=i[2*n],g=i[2*n+1],m=i[2*(n+1)],
v=i[2*(n+1)+1],b=-(d-g),y=f-p,k=Math.sqrt(b*b+y*y),b/=k,y/=k,b*=F,y*=F,x=-(g-v),w=p-m,k=Math.sqrt(x*x+w*w),x/=k,w/=k,x*=F,w*=F,E=-y+d-(-y+g),T=-b+p-(-b+f),A=(-b+f)*(-y+g)-(-b+p)*(-y+d),C=-w+v-(-w+g),P=-x+p-(-x+m),I=(-x+m)*(-w+g)-(-x+p)*(-w+v),R=E*P-C*T,Math.abs(R)<.1?(R+=10.1,O.push(p-b,g-y,z,G,H,U),O.push(p+b,g+y,z,G,H,U)):(h=(T*I-P*A)/R,l=(C*A-E*I)/R,M=(h-p)*(h-p)+(l-g)*(l-g),M>19600?(_=b-x,S=y-w,k=Math.sqrt(_*_+S*S),_/=k,S/=k,_*=F,S*=F,O.push(p-_,g-S),O.push(z,G,H,U),O.push(p+_,g+S),O.push(z,G,H,U),O.push(p-_,g-S),O.push(z,G,H,U),B++):(O.push(h,l),O.push(z,G,H,U),O.push(p-(h-p),g-(l-g)),O.push(z,G,H,U)));for(f=i[2*(L-2)],d=i[2*(L-2)+1],p=i[2*(L-1)],g=i[2*(L-1)+1],b=-(d-g),y=f-p,k=Math.sqrt(b*b+y*y),b/=k,y/=k,b*=F,y*=F,O.push(p-b,g-y),O.push(z,G,H,U),O.push(p+b,g+y),O.push(z,G,H,U),D.push(N),n=0;B>n;n++)D.push(N++);D.push(N-1)}},i.prototype.buildComplexPoly=function(t,e){var n=t.points.slice();if(!(n.length<6)){var i=e.indices;e.points=n,e.alpha=t.fillAlpha,e.color=r.hex2rgb(t.fillColor);for(var o,a,s=1/0,u=-(1/0),c=1/0,h=-(1/0),l=0;l<n.length;l+=2)o=n[l],a=n[l+1],s=s>o?o:s,u=o>u?o:u,c=c>a?a:c,h=a>h?a:h;n.push(s,c,u,c,u,h,s,h);var f=n.length/2;for(l=0;f>l;l++)i.push(l)}},i.prototype.buildPoly=function(t,e){var n=t.points;if(!(n.length<6)){var i=e.points,o=e.indices,a=n.length/2,s=r.hex2rgb(t.fillColor),u=t.fillAlpha,c=s[0]*u,l=s[1]*u,f=s[2]*u,d=h(n,null,2);if(!d)return!1;var p=i.length/6,g=0;for(g=0;g<d.length;g+=3)o.push(d[g]+p),o.push(d[g]+p),o.push(d[g+1]+p),o.push(d[g+2]+p),o.push(d[g+2]+p);for(g=0;a>g;g++)i.push(n[2*g],n[2*g+1],c,l,f,u);return!0}}},{"../../const":22,"../../math":33,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63,"../../utils":77,"./WebGLGraphicsData":28,earcut:9}],28:[function(t,e,n){function i(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0,this.glPoints=null,this.glIndices=null}i.prototype.constructor=i,e.exports=i,i.prototype.reset=function(){this.points.length=0,this.indices.length=0},i.prototype.upload=function(){var t=this.gl;this.glPoints=new Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndices,t.STATIC_DRAW),this.dirty=!1},i.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.gl.deleteBuffer(this.buffer),this.gl.deleteBuffer(this.indexBuffer),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null}},{}],29:[function(t,e,n){var i=e.exports=Object.assign(t("./const"),t("./math"),{utils:t("./utils"),ticker:t("./ticker"),DisplayObject:t("./display/DisplayObject"),Container:t("./display/Container"),Sprite:t("./sprites/Sprite"),ParticleContainer:t("./particles/ParticleContainer"),SpriteRenderer:t("./sprites/webgl/SpriteRenderer"),ParticleRenderer:t("./particles/webgl/ParticleRenderer"),Text:t("./text/Text"),Graphics:t("./graphics/Graphics"),GraphicsData:t("./graphics/GraphicsData"),GraphicsRenderer:t("./graphics/webgl/GraphicsRenderer"),Texture:t("./textures/Texture"),BaseTexture:t("./textures/BaseTexture"),RenderTexture:t("./textures/RenderTexture"),VideoBaseTexture:t("./textures/VideoBaseTexture"),TextureUvs:t("./textures/TextureUvs"),CanvasRenderer:t("./renderers/canvas/CanvasRenderer"),CanvasGraphics:t("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:t("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:t("./renderers/webgl/WebGLRenderer"),WebGLManager:t("./renderers/webgl/managers/WebGLManager"),ShaderManager:t("./renderers/webgl/managers/ShaderManager"),Shader:t("./renderers/webgl/shaders/Shader"),TextureShader:t("./renderers/webgl/shaders/TextureShader"),PrimitiveShader:t("./renderers/webgl/shaders/PrimitiveShader"),ComplexPrimitiveShader:t("./renderers/webgl/shaders/ComplexPrimitiveShader"),ObjectRenderer:t("./renderers/webgl/utils/ObjectRenderer"),RenderTarget:t("./renderers/webgl/utils/RenderTarget"),AbstractFilter:t("./renderers/webgl/filters/AbstractFilter"),FXAAFilter:t("./renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:t("./renderers/webgl/filters/SpriteMaskFilter"),autoDetectRenderer:function(t,e,n,r){return t=t||800,e=e||600,!r&&i.utils.isWebGLSupported()?new i.WebGLRenderer(t,e,n):new i.CanvasRenderer(t,e,n)}})},{"./const":22,"./display/Container":23,"./display/DisplayObject":24,"./graphics/Graphics":25,"./graphics/GraphicsData":26,"./graphics/webgl/GraphicsRenderer":27,"./math":33,"./particles/ParticleContainer":39,"./particles/webgl/ParticleRenderer":41,"./renderers/canvas/CanvasRenderer":44,"./renderers/canvas/utils/CanvasBuffer":45,"./renderers/canvas/utils/CanvasGraphics":46,"./renderers/webgl/WebGLRenderer":49,"./renderers/webgl/filters/AbstractFilter":50,"./renderers/webgl/filters/FXAAFilter":51,"./renderers/webgl/filters/SpriteMaskFilter":52,"./renderers/webgl/managers/ShaderManager":56,"./renderers/webgl/managers/WebGLManager":58,"./renderers/webgl/shaders/ComplexPrimitiveShader":59,"./renderers/webgl/shaders/PrimitiveShader":60,"./renderers/webgl/shaders/Shader":61,"./renderers/webgl/shaders/TextureShader":62,"./renderers/webgl/utils/ObjectRenderer":63,"./renderers/webgl/utils/RenderTarget":65,"./sprites/Sprite":67,"./sprites/webgl/SpriteRenderer":68,"./text/Text":69,"./textures/BaseTexture":70,"./textures/RenderTexture":71,"./textures/Texture":72,"./textures/TextureUvs":73,"./textures/VideoBaseTexture":74,"./ticker":76,"./utils":77}],30:[function(t,e,n){function i(t){return 0>t?-1:t>0?1:0}function r(){for(var t=0;16>t;t++){var e=[];l.push(e);for(var n=0;16>n;n++)for(var r=i(o[t]*o[n]+s[t]*a[n]),f=i(a[t]*o[n]+u[t]*a[n]),d=i(o[t]*s[n]+s[t]*u[n]),p=i(a[t]*s[n]+u[t]*u[n]),g=0;16>g;g++)if(o[g]===r&&a[g]===f&&s[g]===d&&u[g]===p){e.push(g);break}}for(t=0;16>t;t++){var m=new h;m.set(o[t],a[t],s[t],u[t],0,0),c.push(m)}}var o=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],a=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],s=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],u=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],c=[],h=t("./Matrix"),l=[];r();var f={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return o[t]},uY:function(t){return a[t]},vX:function(t){return s[t]},vY:function(t){return u[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return l[t][e]},sub:function(t,e){return l[t][f.inv(e)]},rotate180:function(t){return 4^t},isSwapWidthHeight:function(t){return 2===(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?f.S:f.N:2*Math.abs(e)<=Math.abs(t)?t>0?f.E:f.W:e>0?t>0?f.SE:f.SW:t>0?f.NE:f.NW},matrixAppendRotationInv:function(t,e,n,i){var r=c[f.inv(e)];n=n||0,i=i||0,r.tx=n,r.ty=i,t.append(r)}};e.exports=f},{"./Matrix":31}],31:[function(t,e,n){function i(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var r=t("./Point");i.prototype.constructor=i,e.exports=i,i.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},i.prototype.set=function(t,e,n,i,r,o){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=o,this},i.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},i.prototype.apply=function(t,e){e=e||new r;var n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e},i.prototype.applyInverse=function(t,e){e=e||new r;var n=1/(this.a*this.d+this.c*-this.b),i=t.x,o=t.y;return e.x=this.d*n*i+-this.c*n*o+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*o+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e},i.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},i.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},i.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,o=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this},i.prototype.append=function(t){var e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this},i.prototype.setTransform=function(t,e,n,i,r,o,a,s,u){var c,h,l,f,d,p,g,m,v,b;return d=Math.sin(a),p=Math.cos(a),g=Math.cos(u),m=Math.sin(u),v=-Math.sin(s),b=Math.cos(s),c=p*r,h=d*r,l=-d*o,f=p*o,this.a=g*c+m*l,this.b=g*h+m*f,this.c=v*c+b*l,this.d=v*h+b*f,this.tx=t+(n*c+i*l),this.ty=e+(n*h+i*f),this},i.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},i.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,o=t*i-e*n;return this.a=i/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-i*r)/o,this.ty=-(t*this.ty-e*r)/o,this},i.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},i.prototype.clone=function(){var t=new i;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},i.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},i.IDENTITY=new i,i.TEMP_MATRIX=new i},{"./Point":32}],32:[function(t,e,n){function i(t,e){this.x=t||0,this.y=e||0}i.prototype.constructor=i,e.exports=i,i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.copy=function(t){this.set(t.x,t.y)},i.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},i.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)}},{}],33:[function(t,e,n){e.exports={Point:t("./Point"),Matrix:t("./Matrix"),GroupD8:t("./GroupD8"),Circle:t("./shapes/Circle"),Ellipse:t("./shapes/Ellipse"),Polygon:t("./shapes/Polygon"),Rectangle:t("./shapes/Rectangle"),RoundedRectangle:t("./shapes/RoundedRectangle")}},{"./GroupD8":30,"./Matrix":31,"./Point":32,"./shapes/Circle":34,"./shapes/Ellipse":35,"./shapes/Polygon":36,"./shapes/Rectangle":37,"./shapes/RoundedRectangle":38}],34:[function(t,e,n){function i(t,e,n){this.x=t||0,this.y=e||0,this.radius=n||0,this.type=o.SHAPES.CIRC}var r=t("./Rectangle"),o=t("../../const");i.prototype.constructor=i,e.exports=i,i.prototype.clone=function(){return new i(this.x,this.y,this.radius)},i.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.x-t,i=this.y-e,r=this.radius*this.radius;return n*=n,i*=i,r>=n+i},i.prototype.getBounds=function(){return new r(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":22,"./Rectangle":37}],35:[function(t,e,n){function i(t,e,n,i){this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0,this.type=o.SHAPES.ELIP}var r=t("./Rectangle"),o=t("../../const");i.prototype.constructor=i,e.exports=i,i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return n*=n,i*=i,1>=n+i},i.prototype.getBounds=function(){return new r(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":22,"./Rectangle":37}],36:[function(t,e,n){function i(t){var e=t;if(!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}if(e[0]instanceof r){for(var i=[],a=0,s=e.length;s>a;a++)i.push(e[a].x,e[a].y);e=i}this.closed=!0,this.points=e,this.type=o.SHAPES.POLY}var r=t("../Point"),o=t("../../const");i.prototype.constructor=i,e.exports=i,i.prototype.clone=function(){return new i(this.points.slice())},i.prototype.contains=function(t,e){for(var n=!1,i=this.points.length/2,r=0,o=i-1;i>r;o=r++){var a=this.points[2*r],s=this.points[2*r+1],u=this.points[2*o],c=this.points[2*o+1],h=s>e!=c>e&&(u-a)*(e-s)/(c-s)+a>t;h&&(n=!n)}return n}},{"../../const":22,"../Point":32}],37:[function(t,e,n){function i(t,e,n,i){this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0,this.type=r.SHAPES.RECT}var r=t("../../const");i.prototype.constructor=i,e.exports=i,i.EMPTY=new i(0,0,0,0),i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height?!0:!1}},{"../../const":22}],38:[function(t,e,n){function i(t,e,n,i,o){this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0,this.radius=o||20,this.type=r.SHAPES.RREC}var r=t("../../const");i.prototype.constructor=i,e.exports=i,i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.radius)},i.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height?!0:!1}},{"../../const":22}],39:[function(t,e,n){function i(t,e,n){r.call(this),n=n||15e3,t=t||15e3;var i=16384;n>i&&(n=i),n>t&&(n=t),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=n,this._buffers=null,this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=o.BLEND_MODES.NORMAL,this.roundPixels=!0,this.setProperties(e)}var r=t("../display/Container"),o=t("../const");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},i.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},i.prototype.renderWebGL=function(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},i.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},i.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,n=this.worldTransform,i=!0,r=0,o=0,a=0,s=0,u=t.blendModes[this.blendMode];u!==e.globalCompositeOperation&&(e.globalCompositeOperation=u),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var c=0;c<this.children.length;++c){var h=this.children[c];if(h.visible){var l=h.texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)===0)i&&(e.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),i=!1),r=h.anchor.x*(-l.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-l.height*h.scale.y)+h.position.y+.5,a=l.width*h.scale.x,s=l.height*h.scale.y;else{i||(i=!0),h.displayObjectUpdateTransform();var f=h.worldTransform;t.roundPixels?e.setTransform(f.a,f.b,f.c,f.d,0|f.tx,0|f.ty):e.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),r=h.anchor.x*-l.width+.5,o=h.anchor.y*-l.height+.5,a=l.width,s=l.height}e.drawImage(h.texture.baseTexture.source,l.x,l.y,l.width,l.height,r,o,a,s)}}}},i.prototype.destroy=function(){if(r.prototype.destroy.apply(this,arguments),this._buffers)for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._properties=null,this._buffers=null}},{"../const":22,"../display/Container":23}],40:[function(t,e,n){function i(t,e,n,i){this.gl=t,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<e.length;r++){var o=e[r];n[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}i.prototype.constructor=i,e.exports=i,i.prototype.initBuffers=function(){var t,e,n=this.gl,i=0;for(this.dynamicStride=0,t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],e.offset=i,i+=e.size,this.dynamicStride+=e.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.dynamicBuffer),n.bufferData(n.ARRAY_BUFFER,this.dynamicData,n.DYNAMIC_DRAW);var r=0;for(this.staticStride=0,t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],e.offset=r,r+=e.size,this.staticStride+=e.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.staticBuffer),n.bufferData(n.ARRAY_BUFFER,this.staticData,n.DYNAMIC_DRAW)},i.prototype.uploadDynamic=function(t,e,n){for(var i=this.gl,r=0;r<this.dynamicProperties.length;r++){var o=this.dynamicProperties[r];o.uploadFunction(t,e,n,this.dynamicData,this.dynamicStride,o.offset)}i.bindBuffer(i.ARRAY_BUFFER,this.dynamicBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.dynamicData)},i.prototype.uploadStatic=function(t,e,n){for(var i=this.gl,r=0;r<this.staticProperties.length;r++){var o=this.staticProperties[r];o.uploadFunction(t,e,n,this.staticData,this.staticStride,o.offset)}i.bindBuffer(i.ARRAY_BUFFER,this.staticBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.staticData)},i.prototype.bind=function(){var t,e,n=this.gl;for(n.bindBuffer(n.ARRAY_BUFFER,this.dynamicBuffer),t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],n.vertexAttribPointer(e.attribute,e.size,n.FLOAT,!1,4*this.dynamicStride,4*e.offset);for(n.bindBuffer(n.ARRAY_BUFFER,this.staticBuffer),t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],n.vertexAttribPointer(e.attribute,e.size,n.FLOAT,!1,4*this.staticStride,4*e.offset)},i.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.gl.deleteBuffer(this.dynamicBuffer),this.staticProperties=null,this.staticData=null,this.gl.deleteBuffer(this.staticBuffer)}},{}],41:[function(t,e,n){function i(t){r.call(this,t);var e=98304;this.indices=new Uint16Array(e);for(var n=0,i=0;e>n;n+=6,i+=4)this.indices[n+0]=i+0,this.indices[n+1]=i+1,this.indices[n+2]=i+2,this.indices[n+3]=i+0,this.indices[n+4]=i+2,this.indices[n+5]=i+3;this.shader=null,this.indexBuffer=null,this.properties=null,this.tempMatrix=new u.Matrix}var r=t("../../renderers/webgl/utils/ObjectRenderer"),o=t("../../renderers/webgl/WebGLRenderer"),a=t("./ParticleShader"),s=t("./ParticleBuffer"),u=t("../../math");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,o.registerPlugin("particle",i),i.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new a(this.renderer.shaderManager),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},i.prototype.start=function(){var t=this.renderer.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.shader;this.renderer.shaderManager.setShader(e)},i.prototype.render=function(t){var e=t.children,n=e.length,i=t._maxSize,r=t._batchSize;if(0!==n){n>i&&(n=i),t._buffers||(t._buffers=this.generateBuffers(t)),this.renderer.blendModeManager.setBlendMode(t.blendMode);var o=this.renderer.gl,a=t.worldTransform.copy(this.tempMatrix);a.prepend(this.renderer.currentRenderTarget.projectionMatrix),o.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,a.toArray(!0)),o.uniform1f(this.shader.uniforms.uAlpha._location,t.worldAlpha);var s=e[0]._texture.baseTexture;if(s._glTextures[o.id])o.bindTexture(o.TEXTURE_2D,s._glTextures[o.id]);else{if(!this.renderer.updateTexture(s))return;t._properties[0]&&t._properties[3]||(t._bufferToUpdate=0)}for(var u=0,c=0;n>u;u+=r,c+=1){var h=n-u;h>r&&(h=r);var l=t._buffers[c];l.uploadDynamic(e,u,h),t._bufferToUpdate===c&&(l.uploadStatic(e,u,h),t._bufferToUpdate=c+1),l.bind(this.shader),o.drawElements(o.TRIANGLES,6*h,o.UNSIGNED_SHORT,0),this.renderer.drawCount++}}},i.prototype.generateBuffers=function(t){var e,n=this.renderer.gl,i=[],r=t._maxSize,o=t._batchSize,a=t._properties;for(e=0;r>e;e+=o)i.push(new s(n,this.properties,a,o));return i},i.prototype.uploadVertices=function(t,e,n,i,r,o){for(var a,s,u,c,h,l,f,d,p,g=0;n>g;g++)a=t[e+g],s=a._texture,c=a.scale.x,h=a.scale.y,s.trim?(u=s.trim,f=u.x-a.anchor.x*u.width,l=f+s.crop.width,p=u.y-a.anchor.y*u.height,d=p+s.crop.height):(l=s._frame.width*(1-a.anchor.x),f=s._frame.width*-a.anchor.x,d=s._frame.height*(1-a.anchor.y),p=s._frame.height*-a.anchor.y),i[o]=f*c,i[o+1]=p*h,i[o+r]=l*c,i[o+r+1]=p*h,i[o+2*r]=l*c,i[o+2*r+1]=d*h,i[o+3*r]=f*c,i[o+3*r+1]=d*h,o+=4*r},i.prototype.uploadPosition=function(t,e,n,i,r,o){for(var a=0;n>a;a++){var s=t[e+a].position;i[o]=s.x,i[o+1]=s.y,i[o+r]=s.x,i[o+r+1]=s.y,i[o+2*r]=s.x,i[o+2*r+1]=s.y,i[o+3*r]=s.x,i[o+3*r+1]=s.y,o+=4*r}},i.prototype.uploadRotation=function(t,e,n,i,r,o){for(var a=0;n>a;a++){var s=t[e+a].rotation;i[o]=s,i[o+r]=s,i[o+2*r]=s,i[o+3*r]=s,o+=4*r}},i.prototype.uploadUvs=function(t,e,n,i,r,o){for(var a=0;n>a;a++){var s=t[e+a]._texture._uvs;s?(i[o]=s.x0,i[o+1]=s.y0,i[o+r]=s.x1,i[o+r+1]=s.y1,i[o+2*r]=s.x2,i[o+2*r+1]=s.y2,i[o+3*r]=s.x3,i[o+3*r+1]=s.y3,o+=4*r):(i[o]=0,i[o+1]=0,i[o+r]=0,i[o+r+1]=0,i[o+2*r]=0,i[o+2*r+1]=0,i[o+3*r]=0,i[o+3*r+1]=0,o+=4*r)}},i.prototype.uploadAlpha=function(t,e,n,i,r,o){for(var a=0;n>a;a++){var s=t[e+a].alpha;i[o]=s,i[o+r]=s,i[o+2*r]=s,i[o+3*r]=s,o+=4*r}},i.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),r.prototype.destroy.apply(this,arguments),this.shader.destroy(),this.indices=null,this.tempMatrix=null}},{"../../math":33,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63,"./ParticleBuffer":40,"./ParticleShader":42}],42:[function(t,e,n){function i(t){r.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n"),{uAlpha:{type:"1f",value:1}},{aPositionCoord:0,aRotation:0})}var r=t("../../renderers/webgl/shaders/TextureShader");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i},{"../../renderers/webgl/shaders/TextureShader":62}],43:[function(t,e,n){function i(t,e,n,i){if(s.call(this),r.sayHello(t),i)for(var u in a.DEFAULT_RENDER_OPTIONS)"undefined"==typeof i[u]&&(i[u]=a.DEFAULT_RENDER_OPTIONS[u]);else i=a.DEFAULT_RENDER_OPTIONS;this.type=a.RENDERER_TYPE.UNKNOWN,this.width=e||800,this.height=n||600,this.view=i.view||document.createElement("canvas"),this.resolution=i.resolution,this.transparent=i.transparent,this.autoResize=i.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.clearBeforeRender=i.clearBeforeRender,this.roundPixels=i.roundPixels,this._backgroundColor=0,this._backgroundColorRgb=[0,0,0],this._backgroundColorString="#000000",this.backgroundColor=i.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new o.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var r=t("../utils"),o=t("../math"),a=t("../const"),s=t("eventemitter3");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=r.hex2string(t),r.hex2rgb(t,this._backgroundColorRgb)}}}),i.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},i.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=a.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null}},{"../const":22,"../math":33,"../utils":77,eventemitter3:10}],44:[function(t,e,n){function i(t,e,n){n=n||{},r.call(this,"Canvas",t,e,n),this.type=u.RENDERER_TYPE.CANVAS,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new o,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new s.Matrix,worldAlpha:1},this.resize(t,e)}var r=t("../SystemRenderer"),o=t("./utils/CanvasMaskManager"),a=t("../../utils"),s=t("../../math"),u=t("../../const");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,a.pluginTarget.mixin(i),i.prototype.render=function(t){this.emit("prerender");var e=t.parent;this._lastObjectRendered=t,t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.context.globalCompositeOperation=this.blendModes[u.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t,this.context),this.emit("postrender")},i.prototype.destroy=function(t){this.destroyPlugins(),r.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},i.prototype.renderDisplayObject=function(t,e){var n=this.context;this.context=e,t.renderCanvas(this),this.context=n},i.prototype.resize=function(t,e){r.prototype.resize.call(this,t,e),this.smoothProperty&&(this.context[this.smoothProperty]=u.SCALE_MODES.DEFAULT===u.SCALE_MODES.LINEAR)},i.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},a.canUseNewCanvasBlendModes()?(this.blendModes[u.BLEND_MODES.NORMAL]="source-over",this.blendModes[u.BLEND_MODES.ADD]="lighter",this.blendModes[u.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[u.BLEND_MODES.SCREEN]="screen",this.blendModes[u.BLEND_MODES.OVERLAY]="overlay",this.blendModes[u.BLEND_MODES.DARKEN]="darken",this.blendModes[u.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[u.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[u.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[u.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[u.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[u.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[u.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[u.BLEND_MODES.HUE]="hue",this.blendModes[u.BLEND_MODES.SATURATION]="saturate",this.blendModes[u.BLEND_MODES.COLOR]="color",this.blendModes[u.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[u.BLEND_MODES.NORMAL]="source-over",this.blendModes[u.BLEND_MODES.ADD]="lighter",this.blendModes[u.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[u.BLEND_MODES.SCREEN]="source-over",this.blendModes[u.BLEND_MODES.OVERLAY]="source-over",this.blendModes[u.BLEND_MODES.DARKEN]="source-over",this.blendModes[u.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[u.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[u.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[u.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[u.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[u.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[u.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[u.BLEND_MODES.HUE]="source-over",this.blendModes[u.BLEND_MODES.SATURATION]="source-over",this.blendModes[u.BLEND_MODES.COLOR]="source-over",this.blendModes[u.BLEND_MODES.LUMINOSITY]="source-over"))}},{"../../const":22,"../../math":33,"../../utils":77,"../SystemRenderer":43,"./utils/CanvasMaskManager":47}],45:[function(t,e,n){function i(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e}i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}}),i.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},i.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e},i.prototype.destroy=function(){this.context=null,this.canvas=null}},{}],46:[function(t,e,n){var i=t("../../../const"),r={};e.exports=r,r.renderGraphics=function(t,e){var n=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var r=0;r<t.graphicsData.length;r++){var o=t.graphicsData[r],a=o.shape,s=o._fillTint,u=o._lineTint;if(e.lineWidth=o.lineWidth,o.type===i.SHAPES.POLY){e.beginPath();var c=a.points;e.moveTo(c[0],c[1]);for(var h=1;h<c.length/2;h++)e.lineTo(c[2*h],c[2*h+1]);a.closed&&e.lineTo(c[0],c[1]),c[0]===c[c.length-2]&&c[1]===c[c.length-1]&&e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke())}else if(o.type===i.SHAPES.RECT)(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fillRect(a.x,a.y,a.width,a.height)),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.strokeRect(a.x,a.y,a.width,a.height));else if(o.type===i.SHAPES.CIRC)e.beginPath(),e.arc(a.x,a.y,a.radius,0,2*Math.PI),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke());else if(o.type===i.SHAPES.ELIP){var l=2*a.width,f=2*a.height,d=a.x-l/2,p=a.y-f/2;
e.beginPath();var g=.5522848,m=l/2*g,v=f/2*g,b=d+l,y=p+f,x=d+l/2,w=p+f/2;e.moveTo(d,w),e.bezierCurveTo(d,w-v,x-m,p,x,p),e.bezierCurveTo(x+m,p,b,w-v,b,w),e.bezierCurveTo(b,w+v,x+m,y,x,y),e.bezierCurveTo(x-m,y,d,w+v,d,w),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke())}else if(o.type===i.SHAPES.RREC){var _=a.x,S=a.y,E=a.width,T=a.height,A=a.radius,C=Math.min(E,T)/2|0;A=A>C?C:A,e.beginPath(),e.moveTo(_,S+A),e.lineTo(_,S+T-A),e.quadraticCurveTo(_,S+T,_+A,S+T),e.lineTo(_+E-A,S+T),e.quadraticCurveTo(_+E,S+T,_+E,S+T-A),e.lineTo(_+E,S+A),e.quadraticCurveTo(_+E,S,_+E-A,S),e.lineTo(_+A,S),e.quadraticCurveTo(_,S,_,S+A),e.closePath(),(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*n,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*n,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke())}}},r.renderGraphicsMask=function(t,e){var n=t.graphicsData.length;if(0!==n){e.beginPath();for(var r=0;n>r;r++){var o=t.graphicsData[r],a=o.shape;if(o.type===i.SHAPES.POLY){var s=a.points;e.moveTo(s[0],s[1]);for(var u=1;u<s.length/2;u++)e.lineTo(s[2*u],s[2*u+1]);s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&e.closePath()}else if(o.type===i.SHAPES.RECT)e.rect(a.x,a.y,a.width,a.height),e.closePath();else if(o.type===i.SHAPES.CIRC)e.arc(a.x,a.y,a.radius,0,2*Math.PI),e.closePath();else if(o.type===i.SHAPES.ELIP){var c=2*a.width,h=2*a.height,l=a.x-c/2,f=a.y-h/2,d=.5522848,p=c/2*d,g=h/2*d,m=l+c,v=f+h,b=l+c/2,y=f+h/2;e.moveTo(l,y),e.bezierCurveTo(l,y-g,b-p,f,b,f),e.bezierCurveTo(b+p,f,m,y-g,m,y),e.bezierCurveTo(m,y+g,b+p,v,b,v),e.bezierCurveTo(b-p,v,l,y+g,l,y),e.closePath()}else if(o.type===i.SHAPES.RREC){var x=a.x,w=a.y,_=a.width,S=a.height,E=a.radius,T=Math.min(_,S)/2|0;E=E>T?T:E,e.moveTo(x,w+E),e.lineTo(x,w+S-E),e.quadraticCurveTo(x,w+S,x+E,w+S),e.lineTo(x+_-E,w+S),e.quadraticCurveTo(x+_,w+S,x+_,w+S-E),e.lineTo(x+_,w+E),e.quadraticCurveTo(x+_,w,x+_-E,w),e.lineTo(x+E,w),e.quadraticCurveTo(x,w,x,w+E),e.closePath()}}}},r.updateGraphicsTint=function(t){if(16777215!==t.tint||t._prevTint!==t.tint){t._prevTint=t.tint;for(var e=(t.tint>>16&255)/255,n=(t.tint>>8&255)/255,i=(255&t.tint)/255,r=0;r<t.graphicsData.length;r++){var o=t.graphicsData[r],a=0|o.fillColor,s=0|o.lineColor;o._fillTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*n*255<<8)+(255&a)/255*i*255,o._lineTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*n*255<<8)+(255&s)/255*i*255}}}},{"../../../const":22}],47:[function(t,e,n){function i(){}var r=t("./CanvasGraphics");i.prototype.constructor=i,e.exports=i,i.prototype.pushMask=function(t,e){e.context.save();var n=t.alpha,i=t.worldTransform,o=e.resolution;e.context.setTransform(i.a*o,i.b*o,i.c*o,i.d*o,i.tx*o,i.ty*o),t.texture||(r.renderGraphicsMask(t,e.context),e.context.clip()),t.worldAlpha=n},i.prototype.popMask=function(t){t.context.restore()},i.prototype.destroy=function(){}},{"./CanvasGraphics":46}],48:[function(t,e,n){var i=t("../../../utils"),r={};e.exports=r,r.getTintedTexture=function(t,e){var n=t.texture;e=r.roundColor(e);var i="#"+("00000"+(0|e).toString(16)).substr(-6);if(n.tintCache=n.tintCache||{},n.tintCache[i])return n.tintCache[i];var o=r.canvas||document.createElement("canvas");if(r.tintMethod(n,e,o),r.convertTintToImage){var a=new Image;a.src=o.toDataURL(),n.tintCache[i]=a}else n.tintCache[i]=o,r.canvas=null;return o},r.tintWithMultiply=function(t,e,n){var i=n.getContext("2d"),r=t.baseTexture.resolution,o=t.crop.clone();o.x*=r,o.y*=r,o.width*=r,o.height*=r,n.width=o.width,n.height=o.height,i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,o.width,o.height),i.globalCompositeOperation="multiply",i.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},r.tintWithOverlay=function(t,e,n){var i=n.getContext("2d"),r=t.baseTexture.resolution,o=t.crop.clone();o.x*=r,o.y*=r,o.width*=r,o.height*=r,n.width=o.width,n.height=o.height,i.globalCompositeOperation="copy",i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,o.width,o.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},r.tintWithPerPixel=function(t,e,n){var r=n.getContext("2d"),o=t.baseTexture.resolution,a=t.crop.clone();a.x*=o,a.y*=o,a.width*=o,a.height*=o,n.width=a.width,n.height=a.height,r.globalCompositeOperation="copy",r.drawImage(t.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height);for(var s=i.hex2rgb(e),u=s[0],c=s[1],h=s[2],l=r.getImageData(0,0,a.width,a.height),f=l.data,d=0;d<f.length;d+=4)f[d+0]*=u,f[d+1]*=c,f[d+2]*=h;r.putImageData(l,0,0)},r.roundColor=function(t){var e=r.cacheStepsPerColorChannel,n=i.hex2rgb(t);return n[0]=Math.min(255,n[0]/e*e),n[1]=Math.min(255,n[1]/e*e),n[2]=Math.min(255,n[2]/e*e),i.rgb2hex(n)},r.cacheStepsPerColorChannel=8,r.convertTintToImage=!1,r.canUseMultiply=i.canUseNewCanvasBlendModes(),r.tintMethod=r.canUseMultiply?r.tintWithMultiply:r.tintWithPerPixel},{"../../../utils":77}],49:[function(t,e,n){function i(t,e,n){n=n||{},r.call(this,"WebGL",t,e,n),this.type=p.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!n.forceFXAA&&n.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:n.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new o(this),this.maskManager=new a(this),this.stencilManager=new s(this),this.filterManager=new u(this),this.blendModeManager=new c(this),this.currentRenderTarget=null,this.currentRenderer=new l(this),this.initPlugins(),this._createContext(),this._initContext(),this._mapGlModes(),this._managedTextures=[],this._renderTargetStack=[]}var r=t("../SystemRenderer"),o=t("./managers/ShaderManager"),a=t("./managers/MaskManager"),s=t("./managers/StencilManager"),u=t("./managers/FilterManager"),c=t("./managers/BlendModeManager"),h=t("./utils/RenderTarget"),l=t("./utils/ObjectRenderer"),f=t("./filters/FXAAFilter"),d=t("../../utils"),p=t("../../const");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,d.pluginTarget.mixin(i),i.glContextId=0,i.prototype._createContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=t,!t)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=i.glContextId++,t.id=this.glContextId,t.renderer=this},i.prototype._initContext=function(){var t=this.gl;t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.renderTarget=new h(t,this.width,this.height,null,this.resolution,!0),this.setRenderTarget(this.renderTarget),this.emit("context",t),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!t.getContextAttributes().antialias),this._useFXAA&&(window.console.warn("FXAA antialiasing being used instead of native antialiasing"),this._FXAAFilter=[new f])},i.prototype.render=function(t){if(this.emit("prerender"),!this.gl.isContextLost()){this.drawCount=0,this._lastObjectRendered=t,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,t.filterArea=this.renderTarget.size,t.filters=this._FXAAFilter);var e=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e;var n=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?n.clearColor(0,0,0,0):n.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),n.clear(n.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.renderTarget),this.emit("postrender")}},i.prototype.renderDisplayObject=function(t,e,n){this.setRenderTarget(e),n&&e.clear(),this.filterManager.setFilterStack(e.filterStack),t.renderWebGL(this),this.currentRenderer.flush()},i.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},i.prototype.setRenderTarget=function(t){this.currentRenderTarget!==t&&(this.currentRenderTarget=t,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(t.stencilMaskStack))},i.prototype.resize=function(t,e){r.prototype.resize.call(this,t,e),this.filterManager.resize(t,e),this.renderTarget.resize(t,e),this.currentRenderTarget===this.renderTarget&&(this.renderTarget.activate(),this.gl.viewport(0,0,this.width,this.height))},i.prototype.updateTexture=function(t){if(t=t.baseTexture||t,t.hasLoaded){var e=this.gl;return t._glTextures[e.id]||(t._glTextures[e.id]=e.createTexture(),t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t)),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===p.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.mipmap&&t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===p.SCALE_MODES.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===p.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),t._glTextures[e.id]}},i.prototype.destroyTexture=function(t,e){if(t=t.baseTexture||t,t.hasLoaded&&t._glTextures[this.gl.id]&&(this.gl.deleteTexture(t._glTextures[this.gl.id]),delete t._glTextures[this.gl.id],!e)){var n=this._managedTextures.indexOf(t);-1!==n&&d.removeItems(this._managedTextures,n,1)}},i.prototype.handleContextLost=function(t){t.preventDefault()},i.prototype.handleContextRestored=function(){this._initContext();for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.gl.id]&&delete e._glTextures[this.gl.id]}},i.prototype.destroy=function(t){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);for(var e=0;e<this._managedTextures.length;++e){var n=this._managedTextures[e];this.destroyTexture(n,!0),n.off("update",this.updateTexture,this),n.off("dispose",this.destroyTexture,this)}r.prototype.destroy.call(this,t),this.uid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.blendModeManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this._managedTextures=null,this.drawCount=0,this.gl.useProgram(null),this.gl=null},i.prototype._mapGlModes=function(){var t=this.gl;this.blendModes||(this.blendModes={},this.blendModes[p.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],this.blendModes[p.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],this.blendModes[p.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA]),this.drawModes||(this.drawModes={},this.drawModes[p.DRAW_MODES.POINTS]=t.POINTS,this.drawModes[p.DRAW_MODES.LINES]=t.LINES,this.drawModes[p.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,this.drawModes[p.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,this.drawModes[p.DRAW_MODES.TRIANGLES]=t.TRIANGLES,this.drawModes[p.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,this.drawModes[p.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN)}},{"../../const":22,"../../utils":77,"../SystemRenderer":43,"./filters/FXAAFilter":51,"./managers/BlendModeManager":53,"./managers/FilterManager":54,"./managers/MaskManager":55,"./managers/ShaderManager":56,"./managers/StencilManager":57,"./utils/ObjectRenderer":63,"./utils/RenderTarget":65}],50:[function(t,e,n){function i(t,e,n){this.shaders=[],this.padding=0,this.uniforms=n||{},this.vertexSrc=t||r.defaultVertexSrc,this.fragmentSrc=e||r.defaultFragmentSrc}var r=t("../shaders/TextureShader");i.prototype.constructor=i,e.exports=i,i.prototype.getShader=function(t){var e=t.gl,n=this.shaders[e.id];return n||(n=new r(t.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[e.id]=n),n},i.prototype.applyFilter=function(t,e,n,i){var r=this.getShader(t);t.filterManager.applyFilter(r,e,n,i)},i.prototype.syncUniform=function(t){for(var e=0,n=this.shaders.length;n>e;++e)this.shaders[e].syncUniform(t)}},{"../shaders/TextureShader":62}],51:[function(t,e,n){function i(){r.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{resolution:{type:"v2",value:{x:1,y:1}}})}var r=t("./AbstractFilter");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n){var i=t.filterManager,r=this.getShader(t);i.applyFilter(r,e,n)}},{"./AbstractFilter":50}],52:[function(t,e,n){function i(t){var e=new o.Matrix;r.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:t._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:e.toArray(!0)}}),this.maskSprite=t,this.maskMatrix=e}var r=t("./AbstractFilter"),o=t("../../../math");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n){var i=t.filterManager;this.uniforms.mask.value=this.maskSprite._texture,i.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var r=this.getShader(t);i.applyFilter(r,e,n)},Object.defineProperties(i.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}},offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}})},{"../../../math":33,"./AbstractFilter":50}],53:[function(t,e,n){function i(t){r.call(this,t),this.currentBlendMode=99999}var r=t("./WebGLManager");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var e=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(e[0],e[1]),!0}},{"./WebGLManager":58}],54:[function(t,e,n){function i(t){r.call(this,t),this.filterStack=[],this.filterStack.push({renderTarget:t.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new u.Rectangle(0,0,t.width,t.height),this.currentFrame=null}var r=t("./WebGLManager"),o=t("../utils/RenderTarget"),a=t("../../../const"),s=t("../utils/Quad"),u=t("../../../math");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.onContextChange=function(){this.texturePool.length=0;var t=this.renderer.gl;this.quad=new s(t)},i.prototype.setFilterStack=function(t){this.filterStack=t},i.prototype.pushFilter=function(t,e){var n=t.filterArea?t.filterArea.clone():t.getBounds();n.x=0|n.x,n.y=0|n.y,n.width=0|n.width,n.height=0|n.height;var i=0|e[0].padding;if(n.x-=i,n.y-=i,n.width+=2*i,n.height+=2*i,this.renderer.currentRenderTarget.transform){var r=this.renderer.currentRenderTarget.transform;n.x+=r.tx,n.y+=r.ty,this.capFilterArea(n),n.x-=r.tx,n.y-=r.ty}else this.capFilterArea(n);if(n.width>0&&n.height>0){this.currentFrame=n;var o=this.getRenderTarget();this.renderer.setRenderTarget(o),o.clear(),this.filterStack.push({renderTarget:o,filter:e})}else this.filterStack.push({renderTarget:null,filter:e})},i.prototype.popFilter=function(){var t=this.filterStack.pop(),e=this.filterStack[this.filterStack.length-1],n=t.renderTarget;if(t.renderTarget){var i=e.renderTarget,r=this.renderer.gl;this.currentFrame=n.frame,this.quad.map(this.textureSize,n.frame),r.bindBuffer(r.ARRAY_BUFFER,this.quad.vertexBuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var o=t.filter;if(r.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,r.FLOAT,!1,0,0),r.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,r.FLOAT,!1,0,32),r.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,r.FLOAT,!1,0,64),this.renderer.blendModeManager.setBlendMode(a.BLEND_MODES.NORMAL),1===o.length)o[0].uniforms.dimensions&&(o[0].uniforms.dimensions.value[0]=this.renderer.width,o[0].uniforms.dimensions.value[1]=this.renderer.height,o[0].uniforms.dimensions.value[2]=this.quad.vertices[0],o[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),o[0].applyFilter(this.renderer,n,i),this.returnRenderTarget(n);else{for(var s=n,u=this.getRenderTarget(!0),c=0;c<o.length-1;c++){var h=o[c];h.uniforms.dimensions&&(h.uniforms.dimensions.value[0]=this.renderer.width,h.uniforms.dimensions.value[1]=this.renderer.height,h.uniforms.dimensions.value[2]=this.quad.vertices[0],h.uniforms.dimensions.value[3]=this.quad.vertices[5]),h.applyFilter(this.renderer,s,u);var l=s;s=u,u=l}o[o.length-1].applyFilter(this.renderer,s,i),this.returnRenderTarget(s),this.returnRenderTarget(u)}return t.filter}},i.prototype.getRenderTarget=function(t){var e=this.texturePool.pop()||new o(this.renderer.gl,this.textureSize.width,this.textureSize.height,a.SCALE_MODES.LINEAR,this.renderer.resolution*a.FILTER_RESOLUTION);return e.frame=this.currentFrame,t&&e.clear(!0),e},i.prototype.returnRenderTarget=function(t){this.texturePool.push(t)},i.prototype.applyFilter=function(t,e,n,i){var r=this.renderer.gl;this.renderer.setRenderTarget(n),i&&n.clear(),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e.texture),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),this.renderer.drawCount++},i.prototype.calculateMappedMatrix=function(t,e,n){var i=e.worldTransform.copy(u.Matrix.TEMP_MATRIX),r=e._texture.baseTexture,o=n.identity(),a=this.textureSize.height/this.textureSize.width;o.translate(t.x/this.textureSize.width,t.y/this.textureSize.height),o.scale(1,a);var s=this.textureSize.width/r.width,c=this.textureSize.height/r.height;return i.tx/=r.width*s,i.ty/=r.width*s,i.invert(),o.prepend(i),o.scale(1,1/a),o.scale(s,c),o.translate(e.anchor.x,e.anchor.y),o},i.prototype.capFilterArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.textureSize.width&&(t.width=this.textureSize.width-t.x),t.y+t.height>this.textureSize.height&&(t.height=this.textureSize.height-t.y)},i.prototype.resize=function(t,e){this.textureSize.width=t,this.textureSize.height=e;for(var n=0;n<this.texturePool.length;n++)this.texturePool[n].resize(t,e)},i.prototype.destroy=function(){this.quad.destroy(),r.prototype.destroy.call(this),this.filterStack=null,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null}},{"../../../const":22,"../../../math":33,"../utils/Quad":64,"../utils/RenderTarget":65,"./WebGLManager":58}],55:[function(t,e,n){function i(t){r.call(this,t),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var r=t("./WebGLManager"),o=t("../filters/SpriteMaskFilter");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.pushMask=function(t,e){e.texture?this.pushSpriteMask(t,e):this.pushStencilMask(t,e)},i.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.popStencilMask(t,e)},i.prototype.pushSpriteMask=function(t,e){var n=this.alphaMaskPool.pop();n||(n=[new o(e)]),n[0].maskSprite=e,this.renderer.filterManager.pushFilter(t,n)},i.prototype.popSpriteMask=function(){var t=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(t)},i.prototype.pushStencilMask=function(t,e){this.renderer.stencilManager.pushMask(e)},i.prototype.popStencilMask=function(t,e){this.renderer.stencilManager.popMask(e)}},{"../filters/SpriteMaskFilter":52,"./WebGLManager":58}],56:[function(t,e,n){function i(t){r.call(this,t),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var r=t("./WebGLManager"),o=t("../shaders/TextureShader"),a=t("../shaders/ComplexPrimitiveShader"),s=t("../shaders/PrimitiveShader"),u=t("../../../utils");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,u.pluginTarget.mixin(i),e.exports=i,i.prototype.onContextChange=function(){this.initPlugins();var t=this.renderer.gl;this.maxAttibs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.defaultShader=new o(this),this.primitiveShader=new s(this),this.complexPrimitiveShader=new a(this)},i.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(var n in t)this.tempAttribState[t[n]]=!0;var i=this.renderer.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.attribState[e]?i.enableVertexAttribArray(e):i.disableVertexAttribArray(e))},i.prototype.setShader=function(t){return this._currentId===t.uid?!1:(this._currentId=t.uid,this.currentShader=t,this.renderer.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},i.prototype.destroy=function(){this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),r.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null}},{"../../../utils":77,"../shaders/ComplexPrimitiveShader":59,"../shaders/PrimitiveShader":60,"../shaders/TextureShader":62,"./WebGLManager":58}],57:[function(t,e,n){function i(t){r.call(this,t),this.stencilMaskStack=null}var r=t("./WebGLManager"),o=t("../../../utils");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.stencilStack.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},i.prototype.pushStencil=function(t,e){this.renderer.currentRenderTarget.attachStencilBuffer();var n=this.renderer.gl,i=this.stencilMaskStack;this.bindGraphics(t,e),0===i.stencilStack.length&&(n.enable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),i.reverse=!0,i.count=0),i.stencilStack.push(e);var r=i.count;n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.ALWAYS,0,255),n.stencilOp(n.KEEP,n.KEEP,n.INVERT),1===e.mode?(n.drawElements(n.TRIANGLE_FAN,e.indices.length-4,n.UNSIGNED_SHORT,0),i.reverse?(n.stencilFunc(n.EQUAL,255-r,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)):(n.stencilFunc(n.EQUAL,r,255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(e.indices.length-4)),i.reverse?n.stencilFunc(n.EQUAL,255-(r+1),255):n.stencilFunc(n.EQUAL,r+1,255),i.reverse=!i.reverse):(i.reverse?(n.stencilFunc(n.EQUAL,r,255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)):(n.stencilFunc(n.EQUAL,255-r,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)),n.drawElements(n.TRIANGLE_STRIP,e.indices.length,n.UNSIGNED_SHORT,0),i.reverse?n.stencilFunc(n.EQUAL,r+1,255):n.stencilFunc(n.EQUAL,255-(r+1),255)),n.colorMask(!0,!0,!0,!0),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),i.count++},i.prototype.bindGraphics=function(t,e){var n,i=this.renderer.gl;1===e.mode?(n=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(n),i.uniformMatrix3fv(n.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),
i.uniformMatrix3fv(n.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),i.uniform3fv(n.uniforms.tint._location,o.hex2rgb(t.tint)),i.uniform3fv(n.uniforms.color._location,e.color),i.uniform1f(n.uniforms.alpha._location,t.worldAlpha),i.bindBuffer(i.ARRAY_BUFFER,e.buffer),i.vertexAttribPointer(n.attributes.aVertexPosition,2,i.FLOAT,!1,8,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.indexBuffer)):(n=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(n),i.uniformMatrix3fv(n.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),i.uniformMatrix3fv(n.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),i.uniform3fv(n.uniforms.tint._location,o.hex2rgb(t.tint)),i.uniform1f(n.uniforms.alpha._location,t.worldAlpha),i.bindBuffer(i.ARRAY_BUFFER,e.buffer),i.vertexAttribPointer(n.attributes.aVertexPosition,2,i.FLOAT,!1,24,0),i.vertexAttribPointer(n.attributes.aColor,4,i.FLOAT,!1,24,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.indexBuffer))},i.prototype.popStencil=function(t,e){var n=this.renderer.gl,i=this.stencilMaskStack;if(i.stencilStack.pop(),i.count--,0===i.stencilStack.length)n.disable(n.STENCIL_TEST);else{var r=i.count;this.bindGraphics(t,e),n.colorMask(!1,!1,!1,!1),1===e.mode?(i.reverse=!i.reverse,i.reverse?(n.stencilFunc(n.EQUAL,255-(r+1),255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)):(n.stencilFunc(n.EQUAL,r+1,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(e.indices.length-4)),n.stencilFunc(n.ALWAYS,0,255),n.stencilOp(n.KEEP,n.KEEP,n.INVERT),n.drawElements(n.TRIANGLE_FAN,e.indices.length-4,n.UNSIGNED_SHORT,0),this.renderer.drawCount+=2,i.reverse?n.stencilFunc(n.EQUAL,r,255):n.stencilFunc(n.EQUAL,255-r,255)):(i.reverse?(n.stencilFunc(n.EQUAL,r+1,255),n.stencilOp(n.KEEP,n.KEEP,n.DECR)):(n.stencilFunc(n.EQUAL,255-(r+1),255),n.stencilOp(n.KEEP,n.KEEP,n.INCR)),n.drawElements(n.TRIANGLE_STRIP,e.indices.length,n.UNSIGNED_SHORT,0),this.renderer.drawCount++,i.reverse?n.stencilFunc(n.EQUAL,r,255):n.stencilFunc(n.EQUAL,255-r,255)),n.colorMask(!0,!0,!0,!0),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)}},i.prototype.destroy=function(){r.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},i.prototype.pushMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),t.dirty&&this.renderer.plugins.graphics.updateGraphics(t,this.renderer.gl),t._webGL[this.renderer.gl.id].data.length&&this.pushStencil(t,t._webGL[this.renderer.gl.id].data[0])},i.prototype.popMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(t,t._webGL[this.renderer.gl.id].data[0])}},{"../../../utils":77,"./WebGLManager":58}],58:[function(t,e,n){function i(t){this.renderer=t,this.renderer.on("context",this.onContextChange,this)}i.prototype.constructor=i,e.exports=i,i.prototype.onContextChange=function(){},i.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null}},{}],59:[function(t,e,n){function i(t){r.call(this,t,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var r=t("./Shader");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i},{"./Shader":61}],60:[function(t,e,n){function i(t){r.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var r=t("./Shader");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i},{"./Shader":61}],61:[function(t,e,n){function i(t,e,n,i,o){if(!e||!n)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uid=r.uid(),this.gl=t.renderer.gl,this.shaderManager=t,this.program=null,this.uniforms=i||{},this.attributes=o||{},this.textureCount=1,this.vertexSrc=e,this.fragmentSrc=n,this.init()}var r=t("../../../utils");i.prototype.constructor=i,e.exports=i,i.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations(Object.keys(this.uniforms)),this.cacheAttributeLocations(Object.keys(this.attributes))},i.prototype.cacheUniformLocations=function(t){for(var e=0;e<t.length;++e)this.uniforms[t[e]]._location=this.gl.getUniformLocation(this.program,t[e])},i.prototype.cacheAttributeLocations=function(t){for(var e=0;e<t.length;++e)this.attributes[t[e]]=this.gl.getAttribLocation(this.program,t[e])},i.prototype.compile=function(){var t=this.gl,e=this._glCompile(t.VERTEX_SHADER,this.vertexSrc),n=this._glCompile(t.FRAGMENT_SHADER,this.fragmentSrc),i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(i,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(i)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(i)),t.deleteProgram(i),i=null),t.deleteShader(e),t.deleteShader(n),this.program=i},i.prototype.syncUniform=function(t){var e,n,i=t._location,o=t.value,a=this.gl;switch(t.type){case"b":case"bool":case"boolean":a.uniform1i(i,o?1:0);break;case"i":case"1i":a.uniform1i(i,o);break;case"f":case"1f":a.uniform1f(i,o);break;case"2f":a.uniform2f(i,o[0],o[1]);break;case"3f":a.uniform3f(i,o[0],o[1],o[2]);break;case"4f":a.uniform4f(i,o[0],o[1],o[2],o[3]);break;case"v2":a.uniform2f(i,o.x,o.y);break;case"v3":a.uniform3f(i,o.x,o.y,o.z);break;case"v4":a.uniform4f(i,o.x,o.y,o.z,o.w);break;case"1iv":a.uniform1iv(i,o);break;case"2iv":a.uniform2iv(i,o);break;case"3iv":a.uniform3iv(i,o);break;case"4iv":a.uniform4iv(i,o);break;case"1fv":a.uniform1fv(i,o);break;case"2fv":a.uniform2fv(i,o);break;case"3fv":a.uniform3fv(i,o);break;case"4fv":a.uniform4fv(i,o);break;case"m2":case"mat2":case"Matrix2fv":a.uniformMatrix2fv(i,t.transpose,o);break;case"m3":case"mat3":case"Matrix3fv":a.uniformMatrix3fv(i,t.transpose,o);break;case"m4":case"mat4":case"Matrix4fv":a.uniformMatrix4fv(i,t.transpose,o);break;case"c":"number"==typeof o&&(o=r.hex2rgb(o)),a.uniform3f(i,o[0],o[1],o[2]);break;case"iv1":a.uniform1iv(i,o);break;case"iv":a.uniform3iv(i,o);break;case"fv1":a.uniform1fv(i,o);break;case"fv":a.uniform3fv(i,o);break;case"v2v":for(t._array||(t._array=new Float32Array(2*o.length)),e=0,n=o.length;n>e;++e)t._array[2*e]=o[e].x,t._array[2*e+1]=o[e].y;a.uniform2fv(i,t._array);break;case"v3v":for(t._array||(t._array=new Float32Array(3*o.length)),e=0,n=o.length;n>e;++e)t._array[3*e]=o[e].x,t._array[3*e+1]=o[e].y,t._array[3*e+2]=o[e].z;a.uniform3fv(i,t._array);break;case"v4v":for(t._array||(t._array=new Float32Array(4*o.length)),e=0,n=o.length;n>e;++e)t._array[4*e]=o[e].x,t._array[4*e+1]=o[e].y,t._array[4*e+2]=o[e].z,t._array[4*e+3]=o[e].w;a.uniform4fv(i,t._array);break;case"t":case"sampler2D":if(!t.value||!t.value.baseTexture.hasLoaded)break;a.activeTexture(a["TEXTURE"+this.textureCount]);var s=t.value.baseTexture._glTextures[a.id];s||(this.initSampler2D(t),s=t.value.baseTexture._glTextures[a.id]),a.bindTexture(a.TEXTURE_2D,s),a.uniform1i(t._location,this.textureCount),this.textureCount++;break;default:console.warn("Pixi.js Shader Warning: Unknown uniform type: "+t.type)}},i.prototype.syncUniforms=function(){this.textureCount=1;for(var t in this.uniforms)this.syncUniform(this.uniforms[t])},i.prototype.initSampler2D=function(t){var e=this.gl,n=t.value.baseTexture;if(n.hasLoaded)if(t.textureData){var i=t.textureData;n._glTextures[e.id]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,n._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,i.luminance?e.LUMINANCE:e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.magFilter?i.magFilter:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.wrapS?i.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrapS?i.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrapT?i.wrapT:e.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(n)},i.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},i.prototype._glCompile=function(t,e){var n=this.gl.createShader(t);return this.gl.shaderSource(n,e),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)?n:(console.log(this.gl.getShaderInfoLog(n)),null)}},{"../../../utils":77}],62:[function(t,e,n){function i(t,e,n,o,a){var s={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array([1,0,0,0,1,0,0,0,1])}};if(o)for(var u in o)s[u]=o[u];var c={aVertexPosition:0,aTextureCoord:0,aColor:0};if(a)for(var h in a)c[h]=a[h];e=e||i.defaultVertexSrc,n=n||i.defaultFragmentSrc,r.call(this,t,e,n,s,c)}var r=t("./Shader");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),i.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":61}],63:[function(t,e,n){function i(t){r.call(this,t)}var r=t("../managers/WebGLManager");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.start=function(){},i.prototype.stop=function(){this.flush()},i.prototype.flush=function(){},i.prototype.render=function(t){}},{"../managers/WebGLManager":58}],64:[function(t,e,n){function i(t){this.gl=t,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,128,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.upload()}i.prototype.constructor=i,i.prototype.map=function(t,e){var n=0,i=0;this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.upload()},i.prototype.upload=function(){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices),t.bufferSubData(t.ARRAY_BUFFER,32,this.uvs),t.bufferSubData(t.ARRAY_BUFFER,64,this.colors)},i.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},e.exports=i},{}],65:[function(t,e,n){var i=t("../../../math"),r=t("../../../utils"),o=t("../../../const"),a=t("./StencilMaskStack"),s=function(t,e,n,s,u,c){if(this.gl=t,this.frameBuffer=null,this.texture=null,this.size=new i.Rectangle(0,0,1,1),this.resolution=u||o.RESOLUTION,this.projectionMatrix=new i.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new a,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=s||o.SCALE_MODES.DEFAULT,this.root=c,!this.root){this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,s===o.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,s===o.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST);var h=r.isPowerOfTwo(e,n);h?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}this.resize(e,n)};s.prototype.constructor=s,e.exports=s,s.prototype.clear=function(t){var e=this.gl;t&&e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},s.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var t=this.gl;this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},s.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);var e=this.frame||this.size;this.calculateProjection(e),this.transform&&this.projectionMatrix.append(this.transform),t.viewport(0,0,e.width*this.resolution,e.height*this.resolution)},s.prototype.calculateProjection=function(t){var e=this.projectionMatrix;e.identity(),this.root?(e.a=1/t.width*2,e.d=-1/t.height*2,e.tx=-1-t.x*e.a,e.ty=1-t.y*e.d):(e.a=1/t.width*2,e.d=1/t.height*2,e.tx=-1-t.x*e.a,e.ty=-1-t.y*e.d)},s.prototype.resize=function(t,e){if(t=0|t,e=0|e,this.size.width!==t||this.size.height!==e){if(this.size.width=t,this.size.height=e,!this.root){var n=this.gl;n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t*this.resolution,e*this.resolution,0,n.RGBA,n.UNSIGNED_BYTE,null),this.stencilBuffer&&(n.bindRenderbuffer(n.RENDERBUFFER,this.stencilBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t*this.resolution,e*this.resolution))}var i=this.frame||this.size;this.calculateProjection(i)}},s.prototype.destroy=function(){var t=this.gl;t.deleteRenderbuffer(this.stencilBuffer),t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null}},{"../../../const":22,"../../../math":33,"../../../utils":77,"./StencilMaskStack":66}],66:[function(t,e,n){function i(){this.stencilStack=[],this.reverse=!0,this.count=0}i.prototype.constructor=i,e.exports=i},{}],67:[function(t,e,n){function i(t){a.call(this),this.anchor=new r.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=c.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=t||o.EMPTY}var r=t("../math"),o=t("../textures/Texture"),a=t("../display/Container"),s=t("../renderers/canvas/utils/CanvasTinter"),u=t("../utils"),c=t("../const"),h=new r.Point,l=r.GroupD8,f=new r.Matrix;i.prototype=Object.create(a.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture._frame.width},set:function(t){var e=u.sign(this.scale.x)||1;this.scale.x=e*t/this.texture._frame.width,this._width=t}},height:{get:function(){return Math.abs(this.scale.y)*this.texture._frame.height},set:function(t){var e=u.sign(this.scale.y)||1;this.scale.y=e*t/this.texture._frame.height,this._height=t}},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),i.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=u.sign(this.scale.x)*this._width/this.texture.frame.width),this._height&&(this.scale.y=u.sign(this.scale.y)*this._height/this.texture.frame.height)},i.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this)},i.prototype.getBounds=function(t){if(!this._currentBounds){var e,n,i,r,o=this._texture._frame.width,a=this._texture._frame.height,s=o*(1-this.anchor.x),u=o*-this.anchor.x,c=a*(1-this.anchor.y),h=a*-this.anchor.y,l=t||this.worldTransform,f=l.a,d=l.b,p=l.c,g=l.d,m=l.tx,v=l.ty,b=f*u+p*h+m,y=g*h+d*u+v,x=f*s+p*h+m,w=g*h+d*s+v,_=f*s+p*c+m,S=g*c+d*s+v,E=f*u+p*c+m,T=g*c+d*u+v;if(e=b,e=e>x?x:e,e=e>_?_:e,e=e>E?E:e,i=y,i=i>w?w:i,i=i>S?S:i,i=i>T?T:i,n=b,n=x>n?x:n,n=_>n?_:n,n=E>n?E:n,r=y,r=w>r?w:r,r=S>r?S:r,r=T>r?T:r,this.children.length){var A=this.containerGetBounds();s=A.x,u=A.x+A.width,c=A.y,h=A.y+A.height,e=s>e?e:s,i=c>i?i:c,n=n>u?n:u,r=r>h?r:h}var C=this._bounds;C.x=e,C.width=n-e,C.y=i,C.height=r-i,this._currentBounds=C}return this._currentBounds},i.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},i.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,h);var e,n=this._texture._frame.width,i=this._texture._frame.height,r=-n*this.anchor.x;return h.x>r&&h.x<r+n&&(e=-i*this.anchor.y,h.y>e&&h.y<e+i)?!0:!1},i.prototype._renderCanvas=function(t){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)){var e=t.blendModes[this.blendMode];if(e!==t.context.globalCompositeOperation&&(t.context.globalCompositeOperation=e),this.texture.valid){var n,i,r=this._texture,o=this.worldTransform,a=r.crop.width,u=r.crop.height;t.context.globalAlpha=this.worldAlpha;var h=r.baseTexture.scaleMode===c.SCALE_MODES.LINEAR;t.smoothProperty&&t.context[t.smoothProperty]!==h&&(t.context[t.smoothProperty]=h),2===(3&r.rotate)&&(a=r.crop.height,u=r.crop.width),r.trim?(n=r.crop.width/2+r.trim.x-this.anchor.x*r.trim.width,i=r.crop.height/2+r.trim.y-this.anchor.y*r.trim.height):(n=(.5-this.anchor.x)*r._frame.width,i=(.5-this.anchor.y)*r._frame.height),r.rotate&&(o.copy(f),o=f,l.matrixAppendRotationInv(o,r.rotate,n,i),n=0,i=0),n-=a/2,i-=u/2,t.roundPixels?(t.context.setTransform(o.a,o.b,o.c,o.d,o.tx*t.resolution|0,o.ty*t.resolution|0),n=0|n,i=0|i):t.context.setTransform(o.a,o.b,o.c,o.d,o.tx*t.resolution,o.ty*t.resolution);var d=r.baseTexture.resolution;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=s.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,a*d,u*d,n*t.resolution,i*t.resolution,a*t.resolution,u*t.resolution)):t.context.drawImage(r.baseTexture.source,r.crop.x*d,r.crop.y*d,a*d,u*d,n*t.resolution,i*t.resolution,a*t.resolution,u*t.resolution)}}},i.prototype.destroy=function(t,e){a.prototype.destroy.call(this),this.anchor=null,t&&this._texture.destroy(e),this._texture=null,this.shader=null},i.fromFrame=function(t){var e=u.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new i(e)},i.fromImage=function(t,e,n){return new i(o.fromImage(t,e,n))}},{"../const":22,"../display/Container":23,"../math":33,"../renderers/canvas/utils/CanvasTinter":48,"../textures/Texture":72,"../utils":77}],68:[function(t,e,n){function i(t){r.call(this,t),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=a.SPRITE_BATCH_SIZE;var e=4*this.size*this.vertByteSize,n=6*this.size;this.vertices=new ArrayBuffer(e),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(n);for(var i=0,o=0;n>i;i+=6,o+=4)this.indices[i+0]=o+0,this.indices[i+1]=o+1,this.indices[i+2]=o+2,this.indices[i+3]=o+0,this.indices[i+4]=o+2,this.indices[i+5]=o+3;this.currentBatchSize=0,this.sprites=[],this.shader=null}var r=t("../../renderers/webgl/utils/ObjectRenderer"),o=t("../../renderers/webgl/WebGLRenderer"),a=t("../../const");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,o.registerPlugin("sprite",i),i.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},i.prototype.render=function(t){var e=t._texture;this.currentBatchSize>=this.size&&this.flush();var n=e._uvs;if(n){var i,r,o,a,s=t.anchor.x,u=t.anchor.y;if(e.trim&&void 0===t.tileScale){var c=e.trim;r=c.x-s*c.width,i=r+e.crop.width,a=c.y-u*c.height,o=a+e.crop.height}else i=e._frame.width*(1-s),r=e._frame.width*-s,o=e._frame.height*(1-u),a=e._frame.height*-u;var h=this.currentBatchSize*this.vertByteSize,l=t.worldTransform,f=l.a,d=l.b,p=l.c,g=l.d,m=l.tx,v=l.ty,b=this.colors,y=this.positions;if(this.renderer.roundPixels){var x=this.renderer.resolution;y[h]=((f*r+p*a+m)*x|0)/x,y[h+1]=((g*a+d*r+v)*x|0)/x,y[h+5]=((f*i+p*a+m)*x|0)/x,y[h+6]=((g*a+d*i+v)*x|0)/x,y[h+10]=((f*i+p*o+m)*x|0)/x,y[h+11]=((g*o+d*i+v)*x|0)/x,y[h+15]=((f*r+p*o+m)*x|0)/x,y[h+16]=((g*o+d*r+v)*x|0)/x}else y[h]=f*r+p*a+m,y[h+1]=g*a+d*r+v,y[h+5]=f*i+p*a+m,y[h+6]=g*a+d*i+v,y[h+10]=f*i+p*o+m,y[h+11]=g*o+d*i+v,y[h+15]=f*r+p*o+m,y[h+16]=g*o+d*r+v;y[h+2]=n.x0,y[h+3]=n.y0,y[h+7]=n.x1,y[h+8]=n.y1,y[h+12]=n.x2,y[h+13]=n.y2,y[h+17]=n.x3,y[h+18]=n.y3;var w=t.tint;b[h+4]=b[h+9]=b[h+14]=b[h+19]=(w>>16)+(65280&w)+((255&w)<<16)+(255*t.worldAlpha<<24),this.sprites[this.currentBatchSize++]=t}},i.prototype.flush=function(){if(0!==this.currentBatchSize){var t,e=this.renderer.gl;if(this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var n=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);e.bufferSubData(e.ARRAY_BUFFER,0,n)}for(var i,r,o,a,s=0,u=0,c=null,h=this.renderer.blendModeManager.currentBlendMode,l=null,f=!1,d=!1,p=0,g=this.currentBatchSize;g>p;p++)a=this.sprites[p],i=a._texture.baseTexture,r=a.blendMode,o=a.shader||this.shader,f=h!==r,d=l!==o,(c!==i||f||d)&&(this.renderBatch(c,s,u),u=p,s=0,c=i,f&&(h=r,this.renderer.blendModeManager.setBlendMode(h)),d&&(l=o,t=l.shaders?l.shaders[e.id]:l,t||(t=l.getShader(this.renderer)),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),e.activeTexture(e.TEXTURE0))),s++;this.renderBatch(c,s,u),this.currentBatchSize=0}},i.prototype.renderBatch=function(t,e,n){if(0!==e){var i=this.renderer.gl;t._glTextures[i.id]?i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]):this.renderer.updateTexture(t),i.drawElements(i.TRIANGLES,6*e,i.UNSIGNED_SHORT,6*n*2),this.renderer.drawCount++}},i.prototype.start=function(){var t=this.renderer.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.vertByteSize;t.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,t.FLOAT,!1,e,8),t.vertexAttribPointer(this.shader.attributes.aColor,4,t.UNSIGNED_BYTE,!0,e,16)},i.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),r.prototype.destroy.call(this),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.sprites=null,this.shader=null}},{"../../const":22,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63}],69:[function(t,e,n){function i(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||u.RESOLUTION,this._text=null,this._style=null;var i=o.fromCanvas(this.canvas);i.trim=new a.Rectangle,r.call(this,i),this.text=t,this.style=e}var r=t("../sprites/Sprite"),o=t("../textures/Texture"),a=t("../math"),s=t("../utils"),u=t("../const");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.fontPropertiesCache={},i.fontPropertiesCanvas=document.createElement("canvas"),i.fontPropertiesContext=i.fontPropertiesCanvas.getContext("2d"),Object.defineProperties(i.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture._frame.width},set:function(t){this.scale.x=t/this._texture._frame.width,this._width=t}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture._frame.height},set:function(t){this.scale.y=t/this._texture._frame.height,this._height=t}},style:{get:function(){return this._style},set:function(t){t=t||{},"number"==typeof t.fill&&(t.fill=s.hex2string(t.fill)),"number"==typeof t.stroke&&(t.stroke=s.hex2string(t.stroke)),"number"==typeof t.dropShadowColor&&(t.dropShadowColor=s.hex2string(t.dropShadowColor)),t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowColor=t.dropShadowColor||"#000000",t.dropShadowAngle=void 0!==t.dropShadowAngle?t.dropShadowAngle:Math.PI/6,t.dropShadowDistance=void 0!==t.dropShadowDistance?t.dropShadowDistance:5,t.dropShadowBlur=void 0!==t.dropShadowBlur?t.dropShadowBlur:0,t.padding=t.padding||0,t.textBaseline=t.textBaseline||"alphabetic",t.lineJoin=t.lineJoin||"miter",t.miterLimit=t.miterLimit||10,this._style=t,this.dirty=!0}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),i.prototype.updateText=function(){var t=this._style;this.context.font=t.font;for(var e=t.wordWrap?this.wordWrap(this._text):this._text,n=e.split(/(?:\r\n|\r|\n)/),i=new Array(n.length),r=0,o=this.determineFontProperties(t.font),a=0;a<n.length;a++){var s=this.context.measureText(n[a]).width;i[a]=s,r=Math.max(r,s)}var u=r+t.strokeThickness;t.dropShadow&&(u+=t.dropShadowDistance),this.canvas.width=(u+this.context.lineWidth)*this.resolution;var c=this.style.lineHeight||o.fontSize+t.strokeThickness,h=c*n.length;t.dropShadow&&(h+=t.dropShadowDistance),this.canvas.height=(h+2*this._style.padding)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=t.font,this.context.strokeStyle=t.stroke,this.context.lineWidth=t.strokeThickness,this.context.textBaseline=t.textBaseline,this.context.lineJoin=t.lineJoin,this.context.miterLimit=t.miterLimit;var l,f;if(t.dropShadow){t.dropShadowBlur>0?(this.context.shadowColor=t.dropShadowColor,this.context.shadowBlur=t.dropShadowBlur):this.context.fillStyle=t.dropShadowColor;var d=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,p=Math.sin(t.dropShadowAngle)*t.dropShadowDistance;for(a=0;a<n.length;a++)l=t.strokeThickness/2,f=t.strokeThickness/2+a*c+o.ascent,"right"===t.align?l+=r-i[a]:"center"===t.align&&(l+=(r-i[a])/2),t.fill&&this.context.fillText(n[a],l+d,f+p+this._style.padding)}for(this.context.fillStyle=t.fill,a=0;a<n.length;a++)l=t.strokeThickness/2,f=t.strokeThickness/2+a*c+o.ascent,"right"===t.align?l+=r-i[a]:"center"===t.align&&(l+=(r-i[a])/2),t.stroke&&t.strokeThickness&&this.context.strokeText(n[a],l,f+this._style.padding),t.fill&&this.context.fillText(n[a],l,f+this._style.padding);this.updateTexture()},i.prototype.updateTexture=function(){var t=this._texture;t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.width=this.canvas.width/this.resolution,t.baseTexture.height=this.canvas.height/this.resolution,t.crop.width=t._frame.width=this.canvas.width/this.resolution,t.crop.height=t._frame.height=this.canvas.height/this.resolution,t.trim.x=0,t.trim.y=-this._style.padding,t.trim.width=t._frame.width,t.trim.height=t._frame.height-2*this._style.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,t.baseTexture.emit("update",t.baseTexture),this.dirty=!1},i.prototype.renderWebGL=function(t){this.dirty&&this.updateText(),r.prototype.renderWebGL.call(this,t)},i.prototype._renderCanvas=function(t){this.dirty&&this.updateText(),r.prototype._renderCanvas.call(this,t)},i.prototype.determineFontProperties=function(t){var e=i.fontPropertiesCache[t];if(!e){e={};var n=i.fontPropertiesCanvas,r=i.fontPropertiesContext;r.font=t;var o=Math.ceil(r.measureText("|Mq").width),a=Math.ceil(r.measureText("M").width),s=2*a;a=1.4*a|0,n.width=o,n.height=s,r.fillStyle="#f00",r.fillRect(0,0,o,s),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText("|Mq",0,a);var u,c,h=r.getImageData(0,0,o,s).data,l=h.length,f=4*o,d=0,p=!1;for(u=0;a>u;u++){for(c=0;f>c;c+=4)if(255!==h[d+c]){p=!0;break}if(p)break;d+=f}for(e.ascent=a-u,d=l-f,p=!1,u=s;u>a;u--){for(c=0;f>c;c+=4)if(255!==h[d+c]){p=!0;break}if(p)break;d-=f}e.descent=u-a,e.fontSize=e.ascent+e.descent,i.fontPropertiesCache[t]=e}return e},i.prototype.wordWrap=function(t){for(var e="",n=t.split("\n"),i=this._style.wordWrapWidth,r=0;r<n.length;r++){for(var o=i,a=n[r].split(" "),s=0;s<a.length;s++){var u=this.context.measureText(a[s]).width,c=u+this.context.measureText(" ").width;0===s||c>o?(s>0&&(e+="\n"),e+=a[s],o=i-u):(o-=c,e+=" "+a[s])}r<n.length-1&&(e+="\n")}return e},i.prototype.getBounds=function(t){return this.dirty&&this.updateText(),r.prototype.getBounds.call(this,t)},i.prototype.destroy=function(t){this.context=null,this.canvas=null,this._style=null,this._texture.destroy(void 0===t?!0:t)}},{"../const":22,"../math":33,"../sprites/Sprite":67,"../textures/Texture":72,"../utils":77}],70:[function(t,e,n){function i(t,e,n){a.call(this),this.uid=r.uid(),this.resolution=n||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=e||o.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures={},t&&this.loadSource(t)}var r=t("../utils"),o=t("../const"),a=t("eventemitter3");i.prototype=Object.create(a.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=r.isPowerOfTwo(this.realWidth,this.realHeight),this.emit("update",this)},i.prototype.loadSource=function(t){var e=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,
this.source.onerror=null),this.source=t,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!t.getContext){this.isLoading=!0;var n=this;t.onload=function(){t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n._sourceLoaded(),n.emit("loaded",n))},t.onerror=function(){t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n.emit("error",n))},t.complete&&t.src&&(this.isLoading=!1,t.onload=null,t.onerror=null,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this))}},i.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},i.prototype.destroy=function(){this.imageUrl?(delete r.BaseTextureCache[this.imageUrl],delete r.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete r.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},i.prototype.dispose=function(){this.emit("dispose",this)},i.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},i.fromImage=function(t,e,n){var o=r.BaseTextureCache[t];if(void 0===e&&0!==t.indexOf("data:")&&(e=!0),!o){var a=new Image;e&&(a.crossOrigin=""),o=new i(a,n),o.imageUrl=t,a.src=t,r.BaseTextureCache[t]=o,o.resolution=r.getResolutionOfUrl(t)}return o},i.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+r.uid());var n=r.BaseTextureCache[t._pixiId];return n||(n=new i(t,e),r.BaseTextureCache[t._pixiId]=n),n}},{"../const":22,"../utils":77,eventemitter3:10}],71:[function(t,e,n){function i(t,e,n,i,l){if(!t)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");e=e||100,n=n||100,l=l||h.RESOLUTION;var f=new r;if(f.width=e,f.height=n,f.resolution=l,f.scaleMode=i||h.SCALE_MODES.DEFAULT,f.hasLoaded=!0,o.call(this,f,new c.Rectangle(0,0,e,n)),this.width=e,this.height=n,this.resolution=l,this.render=null,this.renderer=t,this.renderer.type===h.RENDERER_TYPE.WEBGL){var d=this.renderer.gl;this.textureBuffer=new a(d,this.width,this.height,f.scaleMode,this.resolution),this.baseTexture._glTextures[d.id]=this.textureBuffer.texture,this.filterManager=new s(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(e,n),this.render=this.renderWebGL,this.renderer.currentRenderer.start(),this.renderer.currentRenderTarget.activate()}else this.render=this.renderCanvas,this.textureBuffer=new u(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var r=t("./BaseTexture"),o=t("./Texture"),a=t("../renderers/webgl/utils/RenderTarget"),s=t("../renderers/webgl/managers/FilterManager"),u=t("../renderers/canvas/utils/CanvasBuffer"),c=t("../math"),h=t("../const"),l=new c.Matrix;i.prototype=Object.create(o.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.resize=function(t,e,n){(t!==this.width||e!==this.height)&&(this.valid=t>0&&e>0,this.width=this._frame.width=this.crop.width=t,this.height=this._frame.height=this.crop.height=e,n&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.valid&&(this.textureBuffer.resize(this.width,this.height),this.filterManager&&this.filterManager.resize(this.width,this.height)))},i.prototype.clear=function(){this.valid&&(this.renderer.type===h.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},i.prototype.renderWebGL=function(t,e,n,i){if(this.valid){if(i=void 0!==i?i:!0,this.textureBuffer.transform=e,this.textureBuffer.activate(),t.worldAlpha=1,i){t.worldTransform.identity(),t.currentBounds=null;var r,o,a=t.children;for(r=0,o=a.length;o>r;++r)a[r].updateTransform()}var s=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(t,this.textureBuffer,n),this.renderer.filterManager=s}},i.prototype.renderCanvas=function(t,e,n,i){if(this.valid){i=!!i;var r=l;r.identity(),e&&r.append(e);var o=t.worldTransform;t.worldTransform=r,t.worldAlpha=1;var a,s,u=t.children;for(a=0,s=u.length;s>a;++a)u[a].updateTransform();n&&this.textureBuffer.clear();var c=this.textureBuffer.context,h=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,c),this.renderer.resolution=h,t.worldTransform===r&&(t.worldTransform=o)}},i.prototype.destroy=function(){o.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},i.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},i.prototype.getBase64=function(){return this.getCanvas().toDataURL()},i.prototype.getCanvas=function(){if(this.renderer.type===h.RENDERER_TYPE.WEBGL){var t=this.renderer.gl,e=this.textureBuffer.size.width,n=this.textureBuffer.size.height,i=new Uint8Array(4*e*n);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,n,t.RGBA,t.UNSIGNED_BYTE,i),t.bindFramebuffer(t.FRAMEBUFFER,null);var r=new u(e,n),o=r.context.getImageData(0,0,e,n);return o.data.set(i),r.context.putImageData(o,0,0),r.canvas}return this.textureBuffer.canvas},i.prototype.getPixels=function(){var t,e;if(this.renderer.type===h.RENDERER_TYPE.WEBGL){var n=this.renderer.gl;t=this.textureBuffer.size.width,e=this.textureBuffer.size.height;var i=new Uint8Array(4*t*e);return n.bindFramebuffer(n.FRAMEBUFFER,this.textureBuffer.frameBuffer),n.readPixels(0,0,t,e,n.RGBA,n.UNSIGNED_BYTE,i),n.bindFramebuffer(n.FRAMEBUFFER,null),i}return t=this.textureBuffer.canvas.width,e=this.textureBuffer.canvas.height,this.textureBuffer.canvas.getContext("2d").getImageData(0,0,t,e).data},i.prototype.getPixel=function(t,e){if(this.renderer.type===h.RENDERER_TYPE.WEBGL){var n=this.renderer.gl,i=new Uint8Array(4);return n.bindFramebuffer(n.FRAMEBUFFER,this.textureBuffer.frameBuffer),n.readPixels(t,e,1,1,n.RGBA,n.UNSIGNED_BYTE,i),n.bindFramebuffer(n.FRAMEBUFFER,null),i}return this.textureBuffer.canvas.getContext("2d").getImageData(t,e,1,1).data}},{"../const":22,"../math":33,"../renderers/canvas/utils/CanvasBuffer":45,"../renderers/webgl/managers/FilterManager":54,"../renderers/webgl/utils/RenderTarget":65,"./BaseTexture":70,"./Texture":72}],72:[function(t,e,n){function i(t,e,n,r,o){if(s.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new u.Rectangle(0,0,1,1)),t instanceof i&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=n||e,this._rotate=+(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw"attempt to use diamond-shaped UVs. If you are sure, set rotation manually";t.hasLoaded?(this.noFrame&&(e=new u.Rectangle(0,0,t.width,t.height),t.on("update",this.onBaseTextureUpdated,this)),this.frame=e):t.once("loaded",this.onBaseTextureLoaded,this)}var r=t("./BaseTexture"),o=t("./VideoBaseTexture"),a=t("./TextureUvs"),s=t("eventemitter3"),u=t("../math"),c=t("../utils");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{frame:{get:function(){return this._frame},set:function(t){if(this._frame=t,this.noFrame=!1,this.width=t.width,this.height=t.height,!this.trim&&!this.rotate&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width,this.height=this.trim.height,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=t,this.valid&&this._updateUvs()}},rotate:{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}}}),i.prototype.update=function(){this.baseTexture.update()},i.prototype.onBaseTextureLoaded=function(t){this.noFrame?this.frame=new u.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.emit("update",this)},i.prototype.onBaseTextureUpdated=function(t){this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},i.prototype.destroy=function(t){this.baseTexture&&(t&&this.baseTexture.destroy(),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.crop=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this)},i.prototype.clone=function(){return new i(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},i.prototype._updateUvs=function(){this._uvs||(this._uvs=new a),this._uvs.set(this.crop,this.baseTexture,this.rotate)},i.fromImage=function(t,e,n){var o=c.TextureCache[t];return o||(o=new i(r.fromImage(t,e,n)),c.TextureCache[t]=o),o},i.fromFrame=function(t){var e=c.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},i.fromCanvas=function(t,e){return new i(r.fromCanvas(t,e))},i.fromVideo=function(t,e){return"string"==typeof t?i.fromVideoUrl(t,e):new i(o.fromVideo(t,e))},i.fromVideoUrl=function(t,e){return new i(o.fromUrl(t,e))},i.addTextureToCache=function(t,e){c.TextureCache[e]=t},i.removeTextureFromCache=function(t){var e=c.TextureCache[t];return delete c.TextureCache[t],delete c.BaseTextureCache[t],e},i.EMPTY=new i(new r)},{"../math":33,"../utils":77,"./BaseTexture":70,"./TextureUvs":73,"./VideoBaseTexture":74,eventemitter3:10}],73:[function(t,e,n){function i(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1}e.exports=i;var r=t("../math/GroupD8");i.prototype.set=function(t,e,n){var i=e.width,o=e.height;if(n){var a=r.isSwapWidthHeight(n),s=(a?t.height:t.width)/2/i,u=(a?t.width:t.height)/2/o,c=t.x/i+s,h=t.y/o+u;n=r.add(n,r.NW),this.x0=c+s*r.uX(n),this.y0=h+u*r.uY(n),n=r.add(n,2),this.x1=c+s*r.uX(n),this.y1=h+u*r.uY(n),n=r.add(n,2),this.x2=c+s*r.uX(n),this.y2=h+u*r.uY(n),n=r.add(n,2),this.x3=c+s*r.uX(n),this.y3=h+u*r.uY(n)}else this.x0=t.x/i,this.y0=t.y/o,this.x1=(t.x+t.width)/i,this.y1=t.y/o,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/o,this.x3=t.x/i,this.y3=(t.y+t.height)/o}},{"../math/GroupD8":30}],74:[function(t,e,n){function i(t,e){if(!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),o.call(this,t,e),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),t.complete||(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function r(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var n=document.createElement("source");return n.src=t,n.type=e,n}var o=t("./BaseTexture"),a=t("../utils");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,e.exports=i,i.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},i.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},i.prototype._onPlayStop=function(){this.autoUpdate=!1},i.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},i.prototype.destroy=function(){this.source&&this.source._pixiId&&(delete a.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),o.prototype.destroy.call(this)},i.fromVideo=function(t,e){t._pixiId||(t._pixiId="video_"+a.uid());var n=a.BaseTextureCache[t._pixiId];return n||(n=new i(t,e),a.BaseTextureCache[t._pixiId]=n),n},i.fromUrl=function(t,e){var n=document.createElement("video");if(Array.isArray(t))for(var o=0;o<t.length;++o)n.appendChild(r(t[o].src||t[o],t[o].mime));else n.appendChild(r(t.src||t,t.mime));return n.load(),n.play(),i.fromVideo(n,e)},i.fromUrls=i.fromUrl},{"../utils":77,"./BaseTexture":70}],75:[function(t,e,n){function i(){var t=this;this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._emitter.listeners(a,!0)&&(t._requestId=requestAnimationFrame(t._tick)))},this._emitter=new o,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/r.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var r=t("../const"),o=t("eventemitter3"),a="tick";Object.defineProperties(i.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,r.TARGET_FPMS);this._maxElapsedMS=1/e}}}),i.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(a,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},i.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},i.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},i.prototype.add=function(t,e){return this._emitter.on(a,t,e),this._startIfPossible(),this},i.prototype.addOnce=function(t,e){return this._emitter.once(a,t,e),this._startIfPossible(),this},i.prototype.remove=function(t,e){return this._emitter.off(a,t,e),this._emitter.listeners(a,!0)||this._cancelIfNeeded(),this},i.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},i.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},i.prototype.update=function(t){var e;t=t||performance.now(),e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*r.TARGET_FPMS*this.speed,this._emitter.emit(a,this.deltaTime),this.lastTime=t},e.exports=i},{"../const":22,eventemitter3:10}],76:[function(t,e,n){var i=t("./Ticker"),r=new i;r.autoStart=!0,e.exports={shared:r,Ticker:i}},{"./Ticker":75}],77:[function(t,e,n){var i=t("../const"),r=e.exports={_uid:0,_saidHello:!1,EventEmitter:t("eventemitter3"),pluginTarget:t("./pluginTarget"),async:t("async"),uid:function(){return++r._uid},hex2rgb:function(t,e){return e=e||[],e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},hex2string:function(t){return t=t.toString(16),t="000000".substr(0,6-t.length)+t,"#"+t},rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",n=new Image;n.src=t+"AP804Oa6"+e;var i=new Image;i.src=t+"/wCKxvRF"+e;var r=document.createElement("canvas");r.width=6,r.height=1;var o=r.getContext("2d");o.globalCompositeOperation="multiply",o.drawImage(n,0,0),o.drawImage(i,2,0);var a=o.getImageData(2,0,1,1).data;return 255===a[0]&&0===a[1]&&0===a[2]},getNextPowerOfTwo:function(t){if(t>0&&0===(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},isPowerOfTwo:function(t,e){return t>0&&0===(t&t-1)&&e>0&&0===(e&e-1)},getResolutionOfUrl:function(t){var e=i.RETINA_PREFIX.exec(t);return e?parseFloat(e[1]):1},sayHello:function(t){if(!r._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c Pixi.js "+i.VERSION+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("Pixi.js "+i.VERSION+" - "+t+" - http://www.pixijs.com/");r._saidHello=!0}},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!n||!n.getContextAttributes().stencil)}catch(i){return!1}},sign:function(t){return t?0>t?-1:1:0},removeItems:function(t,e,n){var i=t.length;if(!(e>=i||0===n)){n=e+n>i?i-e:n;for(var r=e,o=i-n;o>r;++r)t[r]=t[r+n];t.length=o}},TextureCache:{},BaseTextureCache:{}}},{"../const":22,"./pluginTarget":78,async:1,eventemitter3:10}],78:[function(t,e,n){function i(t){t.__plugins={},t.registerPlugin=function(e,n){t.__plugins[e]=n},t.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var e in t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}e.exports={mixin:function(t){i(t)}}},{}],79:[function(t,e,n){var i=t("./core"),r=t("./mesh"),o=t("./extras"),a=t("./filters");i.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},i.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},Object.defineProperties(i,{Stage:{get:function(){return console.warn("You do not need to use a PIXI Stage any more, you can simply render any container."),i.Container}},DisplayObjectContainer:{get:function(){return console.warn("DisplayObjectContainer has been shortened to Container, please use Container from now on."),i.Container}},Strip:{get:function(){return console.warn("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),r.Mesh}},Rope:{get:function(){return console.warn("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),r.Rope}},MovieClip:{get:function(){return console.warn("The MovieClip class has been moved to extras.MovieClip, please use extras.MovieClip from now on."),o.MovieClip}},TilingSprite:{get:function(){return console.warn("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),o.TilingSprite}},BitmapText:{get:function(){return console.warn("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),o.BitmapText}},blendModes:{get:function(){return console.warn("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),i.BLEND_MODES}},scaleModes:{get:function(){return console.warn("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),i.SCALE_MODES}},BaseTextureCache:{get:function(){return console.warn("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),i.utils.BaseTextureCache}},TextureCache:{get:function(){return console.warn("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),i.utils.TextureCache}},math:{get:function(){return console.warn("The math namespace is deprecated, please access members already accessible on PIXI."),i}}}),i.Sprite.prototype.setTexture=function(t){this.texture=t,console.warn("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},o.BitmapText.prototype.setText=function(t){this.text=t,console.warn("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")},i.Text.prototype.setText=function(t){this.text=t,console.warn("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},i.Text.prototype.setStyle=function(t){this.style=t,console.warn("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},i.Texture.prototype.setFrame=function(t){this.frame=t,console.warn("setFrame is now deprecated, please use the frame property, e.g : myTexture.frame = frame;")},Object.defineProperties(a,{AbstractFilter:{get:function(){return console.warn("filters.AbstractFilter is an undocumented alias, please use AbstractFilter from now on."),i.AbstractFilter}},FXAAFilter:{get:function(){return console.warn("filters.FXAAFilter is an undocumented alias, please use FXAAFilter from now on."),i.FXAAFilter}},SpriteMaskFilter:{get:function(){return console.warn("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),i.SpriteMaskFilter}}}),i.utils.uuid=function(){return console.warn("utils.uuid() is deprecated, please use utils.uid() from now on."),i.utils.uid()}},{"./core":29,"./extras":86,"./filters":103,"./mesh":128}],80:[function(t,e,n){function i(t,e){r.Container.call(this),e=e||{},this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==e.tint?e.tint:16777215,align:e.align||"left",name:null,size:0},this.font=e.font,this._text=t,this.maxWidth=0,this.maxLineHeight=0,this.dirty=!1,this.updateText()}var r=t("../core");i.prototype=Object.create(r.Container.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{tint:{get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},font:{get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):i.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),i.prototype.updateText=function(){for(var t=i.fonts[this._font.name],e=new r.Point,n=null,o=[],a=0,s=0,u=[],c=0,h=this._font.size/t.size,l=-1,f=0,d=0;d<this.text.length;d++){var p=this.text.charCodeAt(d);if(l=/(\s)/.test(this.text.charAt(d))?d:l,/(?:\r\n|\r|\n)/.test(this.text.charAt(d)))u.push(a),s=Math.max(s,a),c++,e.x=0,e.y+=t.lineHeight,n=null;else if(-1!==l&&this.maxWidth>0&&e.x*h>this.maxWidth)r.utils.removeItems(o,l,d-l),d=l,l=-1,u.push(a),s=Math.max(s,a),c++,e.x=0,e.y+=t.lineHeight,n=null;else{var g=t.chars[p];g&&(n&&g.kerning[n]&&(e.x+=g.kerning[n]),o.push({texture:g.texture,line:c,charCode:p,position:new r.Point(e.x+g.xOffset,e.y+g.yOffset)}),a=e.x+(g.texture.width+g.xOffset),e.x+=g.xAdvance,f=Math.max(f,g.yOffset+g.texture.height),n=p)}}u.push(a),s=Math.max(s,a);var m=[];for(d=0;c>=d;d++){var v=0;"right"===this._font.align?v=s-u[d]:"center"===this._font.align&&(v=(s-u[d])/2),m.push(v)}var b=o.length,y=this.tint;for(d=0;b>d;d++){var x=this._glyphs[d];x?x.texture=o[d].texture:(x=new r.Sprite(o[d].texture),this._glyphs.push(x)),x.position.x=(o[d].position.x+m[o[d].line])*h,x.position.y=o[d].position.y*h,x.scale.x=x.scale.y=h,x.tint=y,x.parent||this.addChild(x)}for(d=b;d<this._glyphs.length;++d)this.removeChild(this._glyphs[d]);this.textWidth=s*h,this.textHeight=(e.y+t.lineHeight)*h,this.maxLineHeight=f*h},i.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},i.prototype.getLocalBounds=function(){return this.validate(),r.Container.prototype.getLocalBounds.call(this)},i.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},i.fonts={}},{"../core":29}],81:[function(t,e,n){function i(t){r.Sprite.call(this,t[0]instanceof r.Texture?t[0]:t[0].texture),this._textures=null,this._durations=null,this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this._currentTime=0,this.playing=!1}var r=t("../core");i.prototype=Object.create(r.Sprite.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(t){if(t[0]instanceof r.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}}},currentFrame:{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return 0>t&&(t+=this._textures.length),t}}}),i.prototype.stop=function(){this.playing&&(this.playing=!1,r.ticker.shared.remove(this.update,this))},i.prototype.play=function(){this.playing||(this.playing=!0,r.ticker.shared.add(this.update,this))},i.prototype.gotoAndStop=function(t){this.stop(),this._currentTime=t,this._texture=this._textures[this.currentFrame]},i.prototype.gotoAndPlay=function(t){this._currentTime=t,this.play()},i.prototype.update=function(t){var e=this.animationSpeed*t;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;0>n;)this._currentTime--,n+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):this._texture=this._textures[this.currentFrame]},i.prototype.destroy=function(){this.stop(),r.Sprite.prototype.destroy.call(this)},i.fromFrames=function(t){for(var e=[],n=0;n<t.length;++n)e.push(new r.Texture.fromFrame(t[n]));return new i(e)},i.fromImages=function(t){for(var e=[],n=0;n<t.length;++n)e.push(new r.Texture.fromImage(t[n]));return new i(e)}},{"../core":29}],82:[function(t,e,n){function i(t,e,n){r.Sprite.call(this,t),this.tileScale=new r.Point(1,1),this.tilePosition=new r.Point(0,0),this._width=e||100,this._height=n||100,this._uvs=new r.TextureUvs,this._canvasPattern=null,this.shader=new r.AbstractFilter(["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","uniform vec4 uFrame;","uniform vec4 uTransform;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vec2 coord = aTextureCoord;","   coord -= uTransform.xy;","   coord /= uTransform.zw;","   vTextureCoord = coord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform vec4 uFrame;","uniform vec2 uPixelSize;","void main(void){","   vec2 coord = mod(vTextureCoord, uFrame.zw);","   coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);","   coord += uFrame.xy;","   gl_FragColor =  texture2D(uSampler, coord) * vColor ;","}"].join("\n"),{uFrame:{type:"4fv",value:[0,0,1,1]},uTransform:{type:"4fv",value:[0,0,1,1]},uPixelSize:{type:"2fv",value:[1,1]}})}var r=t("../core"),o=new r.Point,a=t("../core/renderers/canvas/utils/CanvasTinter");i.prototype=Object.create(r.Sprite.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t}},height:{get:function(){return this._height},set:function(t){this._height=t}}}),i.prototype._onTextureUpdate=function(){},i.prototype._renderWebGL=function(t){var e=this._texture;if(e&&e._uvs){var n=e._uvs,i=e._frame.width,r=e._frame.height,o=e.baseTexture.width,a=e.baseTexture.height;e._uvs=this._uvs,e._frame.width=this.width,e._frame.height=this.height,this.shader.uniforms.uPixelSize.value[0]=1/o,this.shader.uniforms.uPixelSize.value[1]=1/a,this.shader.uniforms.uFrame.value[0]=n.x0,this.shader.uniforms.uFrame.value[1]=n.y0,this.shader.uniforms.uFrame.value[2]=n.x1-n.x0,this.shader.uniforms.uFrame.value[3]=n.y2-n.y0,this.shader.uniforms.uTransform.value[0]=this.tilePosition.x%(i*this.tileScale.x)/this._width,this.shader.uniforms.uTransform.value[1]=this.tilePosition.y%(r*this.tileScale.y)/this._height,this.shader.uniforms.uTransform.value[2]=o/this._width*this.tileScale.x,this.shader.uniforms.uTransform.value[3]=a/this._height*this.tileScale.y,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this),e._uvs=n,e._frame.width=i,e._frame.height=r}},i.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var n=t.context,i=this.worldTransform,o=t.resolution,s=e.baseTexture,u=this.tilePosition.x/this.tileScale.x%e._frame.width,c=this.tilePosition.y/this.tileScale.y%e._frame.height;if(!this._canvasPattern){var h=new r.CanvasBuffer(e._frame.width,e._frame.height);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=a.getTintedTexture(this,this.tint)),h.context.drawImage(this.tintedTexture,0,0)):h.context.drawImage(s.source,-e._frame.x,-e._frame.y),this._canvasPattern=h.context.createPattern(h.canvas,"repeat")}n.globalAlpha=this.worldAlpha,n.setTransform(i.a*o,i.b*o,i.c*o,i.d*o,i.tx*o,i.ty*o),n.scale(this.tileScale.x,this.tileScale.y),n.translate(u+this.anchor.x*-this._width,c+this.anchor.y*-this._height);var l=t.blendModes[this.blendMode];l!==t.context.globalCompositeOperation&&(n.globalCompositeOperation=l),n.fillStyle=this._canvasPattern,n.fillRect(-u,-c,this._width/this.tileScale.x,this._height/this.tileScale.y)}},i.prototype.getBounds=function(){var t,e,n,i,r=this._width,o=this._height,a=r*(1-this.anchor.x),s=r*-this.anchor.x,u=o*(1-this.anchor.y),c=o*-this.anchor.y,h=this.worldTransform,l=h.a,f=h.b,d=h.c,p=h.d,g=h.tx,m=h.ty,v=l*s+d*c+g,b=p*c+f*s+m,y=l*a+d*c+g,x=p*c+f*a+m,w=l*a+d*u+g,_=p*u+f*a+m,S=l*s+d*u+g,E=p*u+f*s+m;t=v,t=t>y?y:t,t=t>w?w:t,t=t>S?S:t,n=b,n=n>x?x:n,n=n>_?_:n,n=n>E?E:n,e=v,e=y>e?y:e,e=w>e?w:e,e=S>e?S:e,i=b,i=x>i?x:i,i=_>i?_:i,i=E>i?E:i;var T=this._bounds;return T.x=t,T.width=e-t,T.y=n,T.height=i-n,this._currentBounds=T,T},i.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,o);var e,n=this._width,i=this._height,r=-n*this.anchor.x;return o.x>r&&o.x<r+n&&(e=-i*this.anchor.y,o.y>e&&o.y<e+i)?!0:!1},i.prototype.destroy=function(){r.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},i.fromFrame=function(t,e,n){var o=r.utils.TextureCache[t];if(!o)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new i(o,e,n)},i.fromImage=function(t,e,n,o,a){return new i(r.Texture.fromImage(t,o,a),e,n)}},{"../core":29,"../core/renderers/canvas/utils/CanvasTinter":48}],83:[function(t,e,n){var i=t("../core"),r=i.DisplayObject,o=new i.Matrix;r.prototype._cacheAsBitmap=!1,r.prototype._originalRenderWebGL=null,r.prototype._originalRenderCanvas=null,r.prototype._originalUpdateTransform=null,r.prototype._originalHitTest=null,r.prototype._originalDestroy=null,r.prototype._cachedSprite=null,Object.defineProperties(r.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalDestroy=this.destroy,this._originalContainsPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,
this.destroy=this._originalDestroy,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),r.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cachedSprite.worldAlpha=this.worldAlpha,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this._cachedSprite))},r.prototype._initCachedDisplayObject=function(t){if(!this._cachedSprite){t.currentRenderer.flush();var e=this.getLocalBounds().clone();if(this._filters){var n=this._filters[0].padding;e.x-=n,e.y-=n,e.width+=2*n,e.height+=2*n}var r=t.currentRenderTarget,a=t.filterManager.filterStack,s=new i.RenderTexture(t,0|e.width,0|e.height),u=o;u.tx=-e.x,u.ty=-e.y,this.renderWebGL=this._originalRenderWebGL,s.render(this,u,!0,!0),t.setRenderTarget(r),t.filterManager.filterStack=a,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new i.Sprite(s),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},r.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(t))},r.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cachedSprite){var e=this.getLocalBounds(),n=t.context,r=new i.RenderTexture(t,0|e.width,0|e.height),a=o;a.tx=-e.x,a.ty=-e.y,this.renderCanvas=this._originalRenderCanvas,r.render(this,a,!0),t.context=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new i.Sprite(r),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},r.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds()},r.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(),this._cachedSprite=null},r.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this._originalDestroy()}},{"../core":29}],84:[function(t,e,n){var i=t("../core");i.DisplayObject.prototype.name=null,i.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":29}],85:[function(t,e,n){var i=t("../core");i.DisplayObject.prototype.getGlobalPosition=function(t){return t=t||new i.Point,this.parent?(this.displayObjectUpdateTransform(),t.x=this.worldTransform.tx,t.y=this.worldTransform.ty):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":29}],86:[function(t,e,n){t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition"),e.exports={MovieClip:t("./MovieClip"),TilingSprite:t("./TilingSprite"),BitmapText:t("./BitmapText")}},{"./BitmapText":80,"./MovieClip":81,"./TilingSprite":82,"./cacheAsBitmap":83,"./getChildByName":84,"./getGlobalPosition":85}],87:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":29}],88:[function(t,e,n){function i(){r.AbstractFilter.call(this),this.blurXFilter=new o,this.blurYFilter=new a,this.defaultFilter=new r.AbstractFilter}var r=t("../../core"),o=t("../blur/BlurXFilter"),a=t("../blur/BlurYFilter");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n){var i=t.filterManager.getRenderTarget(!0);this.defaultFilter.applyFilter(t,e,n),this.blurXFilter.applyFilter(t,e,i),t.blendModeManager.setBlendMode(r.BLEND_MODES.SCREEN),this.blurYFilter.applyFilter(t,i,n),t.blendModeManager.setBlendMode(r.BLEND_MODES.NORMAL),t.filterManager.returnRenderTarget(i)},Object.defineProperties(i.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":29,"../blur/BlurXFilter":91,"../blur/BlurYFilter":92}],89:[function(t,e,n){function i(t,e){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform float dirX;\nuniform float dirY;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[3];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[0] = aTextureCoord + vec2( (0.004 * strength) * dirX, (0.004 * strength) * dirY );\n    vBlurTexCoords[1] = aTextureCoord + vec2( (0.008 * strength) * dirX, (0.008 * strength) * dirY );\n    vBlurTexCoords[2] = aTextureCoord + vec2( (0.012 * strength) * dirX, (0.012 * strength) * dirY );\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[3];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vTextureCoord     ) * 0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0]) * 0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1]) * 0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2]) * 0.004431848411938341;\n}\n",{strength:{type:"1f",value:1},dirX:{type:"1f",value:t||0},dirY:{type:"1f",value:e||0}}),this.defaultFilter=new r.AbstractFilter,this.passes=1,this.dirX=t||0,this.dirY=e||0,this.strength=4}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n,i){var r=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)t.filterManager.applyFilter(r,e,n,i);else{var o=t.filterManager.getRenderTarget(!0);t.filterManager.applyFilter(r,e,o,i);for(var a=0;a<this.passes-2;a++)t.filterManager.applyFilter(r,o,o,i);t.filterManager.applyFilter(r,o,n,i),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(i.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*t,this.strength=t}},dirX:{get:function(){return this.dirX},set:function(t){this.uniforms.dirX.value=t}},dirY:{get:function(){return this.dirY},set:function(t){this.uniforms.dirY.value=t}}})},{"../../core":29}],90:[function(t,e,n){function i(){r.AbstractFilter.call(this),this.blurXFilter=new o,this.blurYFilter=new a}var r=t("../../core"),o=t("./BlurXFilter"),a=t("./BlurYFilter");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n){var i=t.filterManager.getRenderTarget(!0);this.blurXFilter.applyFilter(t,e,i),this.blurYFilter.applyFilter(t,i,n),t.filterManager.returnRenderTarget(i)},Object.defineProperties(i.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.padding=.5*Math.abs(t),this.blurXFilter.blur=this.blurYFilter.blur=t}},passes:{get:function(){return this.blurXFilter.passes},set:function(t){this.blurXFilter.passes=this.blurYFilter.passes=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":29,"./BlurXFilter":91,"./BlurYFilter":92}],91:[function(t,e,n){function i(){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n,i){var r=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)t.filterManager.applyFilter(r,e,n,i);else{for(var o=t.filterManager.getRenderTarget(!0),a=e,s=o,u=0;u<this.passes-1;u++){t.filterManager.applyFilter(r,a,s,!0);var c=s;s=a,a=c}t.filterManager.applyFilter(r,a,n,i),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(i.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*Math.abs(t),this.strength=t}}})},{"../../core":29}],92:[function(t,e,n){function i(){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n,i){var r=this.getShader(t);if(this.uniforms.strength.value=Math.abs(this.strength)/4/this.passes*(e.frame.height/e.size.height),1===this.passes)t.filterManager.applyFilter(r,e,n,i);else{for(var o=t.filterManager.getRenderTarget(!0),a=e,s=o,u=0;u<this.passes-1;u++){t.filterManager.applyFilter(r,a,s,!0);var c=s;s=a,a=c}t.filterManager.applyFilter(r,a,n,i),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(i.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*Math.abs(t),this.strength=t}}})},{"../../core":29}],93:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 delta;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{delta:{type:"v2",value:{x:.1,y:0}}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i},{"../../core":29}],94:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[25];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4];\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9];\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14];\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19];\n\n}\n",{m:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype._loadMatrix=function(t,e){e=!!e;var n=t;e&&(this._multiply(n,this.uniforms.m.value,t),n=this._colorMatrix(n)),this.uniforms.m.value=n},i.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19],t},i.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},i.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},i.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},i.prototype.grayscale=i.prototype.greyscale,i.prototype.blackAndWhite=function(t){var e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=.213,o=.715,a=.072,s=[r+n*(1-r)+i*-r,o+n*-o+i*-o,a+n*-a+i*(1-a),0,0,r+n*-r+.143*i,o+n*(1-o)+.14*i,a+n*-a+i*-.283,0,0,r+n*-r+i*-(1-r),o+n*-o+i*o,a+n*(1-a)+i*a,0,0,0,0,0,1,0];this._loadMatrix(s,e)},i.prototype.contrast=function(t,e){var n=(t||0)+1,i=-128*(n-1),r=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(r,e)},i.prototype.saturate=function(t,e){var n=2*(t||0)/3+1,i=(n-1)*-.5,r=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(r,e)},i.prototype.desaturate=function(t){this.saturate(-1)},i.prototype.negative=function(t){var e=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.sepia=function(t){var e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.technicolor=function(t){var e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.polaroid=function(t){var e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.toBGR=function(t){var e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.kodachrome=function(t){var e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.browni=function(t){var e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.vintage=function(t){var e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.colorTone=function(t,e,n,i,r){t=t||.2,e=e||.15,n=n||16770432,i=i||3375104;var o=(n>>16&255)/255,a=(n>>8&255)/255,s=(255&n)/255,u=(i>>16&255)/255,c=(i>>8&255)/255,h=(255&i)/255,l=[.3,.59,.11,0,0,o,a,s,t,0,u,c,h,e,0,o-u,a-c,s-h,0,0];this._loadMatrix(l,r)},i.prototype.night=function(t,e){t=t||.1;var n=[-2*t,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},i.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},i.prototype.lsd=function(t){var e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)},i.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},Object.defineProperties(i.prototype,{matrix:{get:function(){return this.uniforms.m.value},set:function(t){this.uniforms.m.value=t}}})},{"../../core":29}],95:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}})},{"../../core":29}],96:[function(t,e,n){function i(t,e,n){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(t)},texelSize:{type:"v2",value:{x:1/e,y:1/n}}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=new Float32Array(t)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(t){this.uniforms.texelSize.value.x=1/t}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(t){this.uniforms.texelSize.value.y=1/t}}})},{"../../core":29}],97:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i},{"../../core":29}],98:[function(t,e,n){function i(t,e){var n=new r.Matrix;t.renderable=!1,r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision mediump float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:t.texture},otherMatrix:{type:"mat3",value:n.toArray(!0)},scale:{type:"v2",value:{x:1,y:1}}}),this.maskSprite=t,this.maskMatrix=n,(null===e||void 0===e)&&(e=20),this.scale=new r.Point(e,e)}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n){var i=t.filterManager;i.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.scale.value.x=this.scale.x*(1/e.frame.width),this.uniforms.scale.value.y=this.scale.y*(1/e.frame.height);var r=this.getShader(t);i.applyFilter(r,e,n)},Object.defineProperties(i.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(t){this.uniforms.mapSampler.value=t}}})},{"../../core":29}],99:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":29}],100:[function(t,e,n){function i(){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    sum += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]},strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n,i){var r=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.height/e.size.height),1===this.passes)t.filterManager.applyFilter(r,e,n,i);else{for(var o=t.filterManager.getRenderTarget(!0),a=e,s=o,u=0;u<this.passes-1;u++){t.filterManager.applyFilter(r,a,s,i);var c=s;s=a,a=c}t.filterManager.applyFilter(r,a,n,i),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(i.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*t,this.strength=t}}})},{"../../core":29}],101:[function(t,e,n){function i(){r.AbstractFilter.call(this),this.blurXFilter=new o,this.blurYTintFilter=new a,this.defaultFilter=new r.AbstractFilter,this.padding=30,this._dirtyPosition=!0,this._angle=45*Math.PI/180,this._distance=10,this.alpha=.75,this.hideObject=!1,this.blendMode=r.BLEND_MODES.MULTIPLY}var r=t("../../core"),o=t("../blur/BlurXFilter"),a=t("./BlurYTintFilter");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n){var i=t.filterManager.getRenderTarget(!0);this._dirtyPosition&&(this._dirtyPosition=!1,this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance,this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance),this.blurXFilter.applyFilter(t,e,i),t.blendModeManager.setBlendMode(this.blendMode),this.blurYTintFilter.applyFilter(t,i,n),
t.blendModeManager.setBlendMode(r.BLEND_MODES.NORMAL),this.hideObject||this.defaultFilter.applyFilter(t,e,n),t.filterManager.returnRenderTarget(i)},Object.defineProperties(i.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYTintFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(t){this.blurYTintFilter.blur=t}},color:{get:function(){return r.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(t){this.blurYTintFilter.uniforms.color.value=r.utils.hex2rgb(t)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(t){this.blurYTintFilter.uniforms.alpha.value=t}},distance:{get:function(){return this._distance},set:function(t){this._dirtyPosition=!0,this._distance=t}},angle:{get:function(){return this._angle},set:function(t){this._dirtyPosition=!0,this._angle=t}}})},{"../../core":29,"../blur/BlurXFilter":91,"./BlurYTintFilter":100}],102:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}})},{"../../core":29}],103:[function(t,e,n){e.exports={AsciiFilter:t("./ascii/AsciiFilter"),BloomFilter:t("./bloom/BloomFilter"),BlurFilter:t("./blur/BlurFilter"),BlurXFilter:t("./blur/BlurXFilter"),BlurYFilter:t("./blur/BlurYFilter"),BlurDirFilter:t("./blur/BlurDirFilter"),ColorMatrixFilter:t("./color/ColorMatrixFilter"),ColorStepFilter:t("./color/ColorStepFilter"),ConvolutionFilter:t("./convolution/ConvolutionFilter"),CrossHatchFilter:t("./crosshatch/CrossHatchFilter"),DisplacementFilter:t("./displacement/DisplacementFilter"),DotScreenFilter:t("./dot/DotScreenFilter"),GrayFilter:t("./gray/GrayFilter"),DropShadowFilter:t("./dropshadow/DropShadowFilter"),InvertFilter:t("./invert/InvertFilter"),NoiseFilter:t("./noise/NoiseFilter"),PixelateFilter:t("./pixelate/PixelateFilter"),RGBSplitFilter:t("./rgb/RGBSplitFilter"),ShockwaveFilter:t("./shockwave/ShockwaveFilter"),SepiaFilter:t("./sepia/SepiaFilter"),SmartBlurFilter:t("./blur/SmartBlurFilter"),TiltShiftFilter:t("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:t("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:t("./tiltshift/TiltShiftYFilter"),TwistFilter:t("./twist/TwistFilter")}},{"./ascii/AsciiFilter":87,"./bloom/BloomFilter":88,"./blur/BlurDirFilter":89,"./blur/BlurFilter":90,"./blur/BlurXFilter":91,"./blur/BlurYFilter":92,"./blur/SmartBlurFilter":93,"./color/ColorMatrixFilter":94,"./color/ColorStepFilter":95,"./convolution/ConvolutionFilter":96,"./crosshatch/CrossHatchFilter":97,"./displacement/DisplacementFilter":98,"./dot/DotScreenFilter":99,"./dropshadow/DropShadowFilter":101,"./gray/GrayFilter":102,"./invert/InvertFilter":104,"./noise/NoiseFilter":105,"./pixelate/PixelateFilter":106,"./rgb/RGBSplitFilter":107,"./sepia/SepiaFilter":108,"./shockwave/ShockwaveFilter":109,"./tiltshift/TiltShiftFilter":111,"./tiltshift/TiltShiftXFilter":112,"./tiltshift/TiltShiftYFilter":113,"./twist/TwistFilter":114}],104:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}})},{"../../core":29}],105:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(t){this.uniforms.noise.value=t}}})},{"../../core":29}],106:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":29}],107:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(t){this.uniforms.red.value=t}},green:{get:function(){return this.uniforms.green.value},set:function(t){this.uniforms.green.value=t}},blue:{get:function(){return this.uniforms.blue.value},set:function(t){this.uniforms.blue.value=t}}})},{"../../core":29}],108:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}})},{"../../core":29}],109:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(t){this.uniforms.center.value=t}},params:{get:function(){return this.uniforms.params.value},set:function(t){this.uniforms.params.value=t}},time:{get:function(){return this.uniforms.time.value},set:function(t){this.uniforms.time.value=t}}})},{"../../core":29}],110:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}}),this.updateDelta()}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.updateDelta=function(){this.uniforms.delta.value.x=0,this.uniforms.delta.value.y=0},Object.defineProperties(i.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(t){this.uniforms.blur.value=t}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(t){this.uniforms.gradientBlur.value=t}},start:{get:function(){return this.uniforms.start.value},set:function(t){this.uniforms.start.value=t,this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(t){this.uniforms.end.value=t,this.updateDelta()}}})},{"../../core":29}],111:[function(t,e,n){function i(){r.AbstractFilter.call(this),this.tiltShiftXFilter=new o,this.tiltShiftYFilter=new a}var r=t("../../core"),o=t("./TiltShiftXFilter"),a=t("./TiltShiftYFilter");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,n){var i=t.filterManager.getRenderTarget(!0);this.tiltShiftXFilter.applyFilter(t,e,i),this.tiltShiftYFilter.applyFilter(t,i,n),t.filterManager.returnRenderTarget(i)},Object.defineProperties(i.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}}})},{"../../core":29,"./TiltShiftXFilter":112,"./TiltShiftYFilter":113}],112:[function(t,e,n){function i(){r.call(this)}var r=t("./TiltShiftAxisFilter");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,e=this.uniforms.end.value.y-this.uniforms.start.value.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=t/n,this.uniforms.delta.value.y=e/n}},{"./TiltShiftAxisFilter":110}],113:[function(t,e,n){function i(){r.call(this)}var r=t("./TiltShiftAxisFilter");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,e=this.uniforms.end.value.y-this.uniforms.start.value.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=-e/n,this.uniforms.delta.value.y=t/n}},{"./TiltShiftAxisFilter":110}],114:[function(t,e,n){function i(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}var r=t("../../core");i.prototype=Object.create(r.AbstractFilter.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}},radius:{get:function(){return this.uniforms.radius.value},set:function(t){this.uniforms.radius.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":29}],115:[function(t,e,n){(function(n){t("./polyfill");var i=e.exports=t("./core");i.extras=t("./extras"),i.filters=t("./filters"),i.interaction=t("./interaction"),i.loaders=t("./loaders"),i.mesh=t("./mesh"),i.accessibility=t("./accessibility"),i.loader=new i.loaders.Loader,Object.assign(i,t("./deprecation")),n.PIXI=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":21,"./core":29,"./deprecation":79,"./extras":86,"./filters":103,"./interaction":118,"./loaders":121,"./mesh":128,"./polyfill":133}],116:[function(t,e,n){function i(){this.global=new r.Point,this.target=null,this.originalEvent=null}var r=t("../core");i.prototype.constructor=i,e.exports=i,i.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)}},{"../core":29}],117:[function(t,e,n){function i(t,e){e=e||{},this.renderer=t,this.autoPreventDefault=void 0!==e.autoPreventDefault?e.autoPreventDefault:!0,this.interactionFrequency=e.interactionFrequency||10,this.mouse=new o,this.eventData={stopped:!1,target:null,type:null,data:this.mouse,stopPropagation:function(){this.stopped=!0}},this.interactiveDataPool=[],this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this._tempPoint=new r.Point,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}var r=t("../core"),o=t("./InteractionData");Object.assign(r.DisplayObject.prototype,t("./interactiveTarget")),i.prototype.constructor=i,e.exports=i,i.prototype.setTargetElement=function(t,e){this.removeEvents(),this.interactionDOMElement=t,this.resolution=e||1,this.addEvents()},i.prototype.addEvents=function(){this.interactionDOMElement&&(r.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},i.prototype.removeEvents=function(){this.interactionDOMElement&&(r.ticker.shared.remove(this.update),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},i.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)}},i.prototype.dispatchEvent=function(t,e,n){n.stopped||(n.target=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},i.prototype.mapPositionToPoint=function(t,e,n){var i=this.interactionDOMElement.getBoundingClientRect();t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)/this.resolution,t.y=(n-i.top)*(this.interactionDOMElement.height/i.height)/this.resolution},i.prototype.processInteractive=function(t,e,n,i,r){if(!e||!e.visible)return!1;var o=!1,a=r=e.interactive||r;if(e.hitArea&&(a=!1),e.interactiveChildren)for(var s=e.children,u=s.length-1;u>=0;u--){var c=s[u];if(this.processInteractive(t,c,n,i,a)){if(!c.parent)continue;o=!0,a=!1,c.interactive&&(i=!1)}}return r&&(i&&!o&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),o=e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):e.containsPoint&&(o=e.containsPoint(t))),e.interactive&&n(e,o)),o},i.prototype.onMouseDown=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},i.prototype.processMouseDown=function(t,e){var n=this.mouse.originalEvent,i=2===n.button||3===n.which;e&&(t[i?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(t,i?"rightdown":"mousedown",this.eventData))},i.prototype.onMouseUp=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},i.prototype.processMouseUp=function(t,e){var n=this.mouse.originalEvent,i=2===n.button||3===n.which,r=i?"_isRightDown":"_isLeftDown";e?(this.dispatchEvent(t,i?"rightup":"mouseup",this.eventData),t[r]&&(t[r]=!1,this.dispatchEvent(t,i?"rightclick":"click",this.eventData))):t[r]&&(t[r]=!1,this.dispatchEvent(t,i?"rightupoutside":"mouseupoutside",this.eventData))},i.prototype.onMouseMove=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.didMove=!0,this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)},i.prototype.processMouseMove=function(t,e){this.processMouseOverOut(t,e),(!this.moveWhenInside||e)&&this.dispatchEvent(t,"mousemove",this.eventData)},i.prototype.onMouseOut=function(t){this.mouse.originalEvent=t,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.interactionDOMElement.style.cursor="inherit",this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1)},i.prototype.processMouseOverOut=function(t,e){e?(t._over||(t._over=!0,this.dispatchEvent(t,"mouseover",this.eventData)),t.buttonMode&&(this.cursor=t.defaultCursor)):t._over&&(t._over=!1,this.dispatchEvent(t,"mouseout",this.eventData))},i.prototype.onTouchStart=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,n=e.length,i=0;n>i;i++){var r=e[i],o=this.getTouchData(r);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(o)}},i.prototype.processTouchStart=function(t,e){e&&(t._touchDown=!0,this.dispatchEvent(t,"touchstart",this.eventData))},i.prototype.onTouchEnd=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,n=e.length,i=0;n>i;i++){var r=e[i],o=this.getTouchData(r);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(o)}},i.prototype.processTouchEnd=function(t,e){e?(this.dispatchEvent(t,"touchend",this.eventData),t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"tap",this.eventData))):t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"touchendoutside",this.eventData))},i.prototype.onTouchMove=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,n=e.length,i=0;n>i;i++){var r=e[i],o=this.getTouchData(r);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchMove,this.moveWhenInside),this.returnTouchData(o)}},i.prototype.processTouchMove=function(t,e){(!this.moveWhenInside||e)&&this.dispatchEvent(t,"touchmove",this.eventData)},i.prototype.getTouchData=function(t){var e=this.interactiveDataPool.pop();return e||(e=new o),e.identifier=t.identifier,this.mapPositionToPoint(e.global,t.clientX,t.clientY),navigator.isCocoonJS&&(e.global.x=e.global.x/this.resolution,e.global.y=e.global.y/this.resolution),t.globalX=e.global.x,t.globalY=e.global.y,e},i.prototype.returnTouchData=function(t){this.interactiveDataPool.push(t)},i.prototype.destroy=function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null},r.WebGLRenderer.registerPlugin("interaction",i),r.CanvasRenderer.registerPlugin("interaction",i)},{"../core":29,"./InteractionData":116,"./interactiveTarget":119}],118:[function(t,e,n){e.exports={InteractionData:t("./InteractionData"),InteractionManager:t("./InteractionManager"),interactiveTarget:t("./interactiveTarget")}},{"./InteractionData":116,"./InteractionManager":117,"./interactiveTarget":119}],119:[function(t,e,n){var i={interactive:!1,buttonMode:!1,interactiveChildren:!0,defaultCursor:"pointer",_over:!1,_touchDown:!1};e.exports=i},{}],120:[function(t,e,n){function i(t,e){var n={},i=t.data.getElementsByTagName("info")[0],r=t.data.getElementsByTagName("common")[0];n.font=i.getAttribute("face"),n.size=parseInt(i.getAttribute("size"),10),n.lineHeight=parseInt(r.getAttribute("lineHeight"),10),n.chars={};for(var s=t.data.getElementsByTagName("char"),u=0;u<s.length;u++){var c=parseInt(s[u].getAttribute("id"),10),h=new o.Rectangle(parseInt(s[u].getAttribute("x"),10)+e.frame.x,parseInt(s[u].getAttribute("y"),10)+e.frame.y,parseInt(s[u].getAttribute("width"),10),parseInt(s[u].getAttribute("height"),10));n.chars[c]={xOffset:parseInt(s[u].getAttribute("xoffset"),10),yOffset:parseInt(s[u].getAttribute("yoffset"),10),xAdvance:parseInt(s[u].getAttribute("xadvance"),10),kerning:{},texture:new o.Texture(e.baseTexture,h)}}var l=t.data.getElementsByTagName("kerning");for(u=0;u<l.length;u++){var f=parseInt(l[u].getAttribute("first"),10),d=parseInt(l[u].getAttribute("second"),10),p=parseInt(l[u].getAttribute("amount"),10);n.chars[d]&&(n.chars[d].kerning[f]=p)}t.bitmapFont=n,a.BitmapText.fonts[n.font]=n}var r=t("resource-loader").Resource,o=t("../core"),a=t("../extras"),s=t("path");e.exports=function(){return function(t,e){if(!t.data||!t.isXml)return e();if(0===t.data.getElementsByTagName("page").length||0===t.data.getElementsByTagName("info").length||null===t.data.getElementsByTagName("info")[0].getAttribute("face"))return e();var n=s.dirname(t.url);"."===n&&(n=""),this.baseUrl&&n&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(n+="/"),n=n.replace(this.baseUrl,"")),n&&"/"!==n.charAt(n.length-1)&&(n+="/");var a=n+t.data.getElementsByTagName("page")[0].getAttribute("file");if(o.utils.TextureCache[a])i(t,o.utils.TextureCache[a]),e();else{var u={crossOrigin:t.crossOrigin,loadType:r.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata};this.add(t.name+"_image",a,u,function(n){i(t,n.texture),e()})}}}},{"../core":29,"../extras":86,path:2,"resource-loader":16}],121:[function(t,e,n){e.exports={Loader:t("./loader"),bitmapFontParser:t("./bitmapFontParser"),spritesheetParser:t("./spritesheetParser"),textureParser:t("./textureParser"),Resource:t("resource-loader").Resource}},{"./bitmapFontParser":120,"./loader":122,"./spritesheetParser":123,"./textureParser":124,"resource-loader":16}],122:[function(t,e,n){function i(t,e){r.call(this,t,e);for(var n=0;n<i._pixiMiddleware.length;++n)this.use(i._pixiMiddleware[n]())}var r=t("resource-loader"),o=t("./textureParser"),a=t("./spritesheetParser"),s=t("./bitmapFontParser");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i._pixiMiddleware=[r.middleware.parsing.blob,o,a,s],i.addPixiMiddleware=function(t){i._pixiMiddleware.push(t)};var u=r.Resource;u.setExtensionXhrType("fnt",u.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":120,"./spritesheetParser":123,"./textureParser":124,"resource-loader":16}],123:[function(t,e,n){var i=t("resource-loader").Resource,r=t("path"),o=t("../core");e.exports=function(){return function(t,e){if(!t.data||!t.isJson||!t.data.frames)return e();var n={crossOrigin:t.crossOrigin,loadType:i.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata},a=r.dirname(t.url.replace(this.baseUrl,"")),s=o.utils.getResolutionOfUrl(t.url);this.add(t.name+"_image",a+"/"+t.data.meta.image,n,function(n){t.textures={};var i=t.data.frames;for(var r in i){var a=i[r].frame;if(a){var u=null,c=null;if(u=i[r].rotated?new o.Rectangle(a.x,a.y,a.h,a.w):new o.Rectangle(a.x,a.y,a.w,a.h),i[r].trimmed&&(c=new o.Rectangle(i[r].spriteSourceSize.x/s,i[r].spriteSourceSize.y/s,i[r].sourceSize.w/s,i[r].sourceSize.h/s)),i[r].rotated){var h=u.width;u.width=u.height,u.height=h}u.x/=s,u.y/=s,u.width/=s,u.height/=s,t.textures[r]=new o.Texture(n.texture.baseTexture,u,u.clone(),c,i[r].rotated?2:0),o.utils.TextureCache[r]=t.textures[r]}}e()})}}},{"../core":29,path:2,"resource-loader":16}],124:[function(t,e,n){var i=t("../core");e.exports=function(){return function(t,e){if(t.data&&t.isImage){var n=new i.BaseTexture(t.data,null,i.utils.getResolutionOfUrl(t.url));n.imageUrl=t.url,t.texture=new i.Texture(n),i.utils.BaseTextureCache[t.url]=n,i.utils.TextureCache[t.url]=t.texture}e()}}},{"../core":29}],125:[function(t,e,n){function i(t,e,n,o,a){r.Container.call(this),this._texture=null,this.uvs=n||new Float32Array([0,0,1,0,1,1,0,1]),this.vertices=e||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=o||new Uint16Array([0,1,3,2]),this.dirty=!0,this.blendMode=r.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=a||i.DRAW_MODES.TRIANGLE_MESH,this.texture=t,this.shader=null}var r=t("../core"),o=new r.Point,a=new r.Polygon;i.prototype=Object.create(r.Container.prototype),i.prototype.constructor=i,e.exports=i,Object.defineProperties(i.prototype,{texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),i.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.mesh),t.plugins.mesh.render(this)},i.prototype._renderCanvas=function(t){var e=t.context,n=this.worldTransform;t.roundPixels?e.setTransform(n.a,n.b,n.c,n.d,0|n.tx,0|n.ty):e.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),this.drawMode===i.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(e):this._renderCanvasTriangles(e)},i.prototype._renderCanvasTriangleMesh=function(t){for(var e=this.vertices,n=this.uvs,i=e.length/2,r=0;i-2>r;r++){var o=2*r;this._renderCanvasDrawTriangle(t,e,n,o,o+2,o+4)}},i.prototype._renderCanvasTriangles=function(t){for(var e=this.vertices,n=this.uvs,i=this.indices,r=i.length,o=0;r>o;o+=3){var a=2*i[o],s=2*i[o+1],u=2*i[o+2];this._renderCanvasDrawTriangle(t,e,n,a,s,u)}},i.prototype._renderCanvasDrawTriangle=function(t,e,n,i,r,o){var a=this._texture.baseTexture.source,s=this._texture.baseTexture.width,u=this._texture.baseTexture.height,c=e[i],h=e[r],l=e[o],f=e[i+1],d=e[r+1],p=e[o+1],g=n[i]*s,m=n[r]*s,v=n[o]*s,b=n[i+1]*u,y=n[r+1]*u,x=n[o+1]*u;if(this.canvasPadding>0){var w=this.canvasPadding/this.worldTransform.a,_=this.canvasPadding/this.worldTransform.d,S=(c+h+l)/3,E=(f+d+p)/3,T=c-S,A=f-E,C=Math.sqrt(T*T+A*A);c=S+T/C*(C+w),f=E+A/C*(C+_),T=h-S,A=d-E,C=Math.sqrt(T*T+A*A),h=S+T/C*(C+w),d=E+A/C*(C+_),T=l-S,A=p-E,C=Math.sqrt(T*T+A*A),l=S+T/C*(C+w),p=E+A/C*(C+_)}t.save(),t.beginPath(),t.moveTo(c,f),t.lineTo(h,d),t.lineTo(l,p),t.closePath(),t.clip();var P=g*y+b*v+m*x-y*v-b*m-g*x,I=c*y+b*l+h*x-y*l-b*h-c*x,R=g*h+c*v+m*l-h*v-c*m-g*l,M=g*y*l+b*h*v+c*m*x-c*y*v-b*m*l-g*h*x,k=f*y+b*p+d*x-y*p-b*d-f*x,O=g*d+f*v+m*p-d*v-f*m-g*p,D=g*y*p+b*d*v+f*m*x-f*y*v-b*m*p-g*d*x;
t.transform(I/P,k/P,R/P,O/P,M/P,D/P),t.drawImage(a,0,0),t.restore()},i.prototype.renderMeshFlat=function(t){var e=this.context,n=t.vertices,i=n.length/2;e.beginPath();for(var r=1;i-2>r;r++){var o=2*r,a=n[o],s=n[o+2],u=n[o+4],c=n[o+1],h=n[o+3],l=n[o+5];e.moveTo(a,c),e.lineTo(s,h),e.lineTo(u,l)}e.fillStyle="#FF0000",e.fill(),e.closePath()},i.prototype._onTextureUpdate=function(){this.updateFrame=!0},i.prototype.getBounds=function(t){if(!this._currentBounds){for(var e=t||this.worldTransform,n=e.a,i=e.b,o=e.c,a=e.d,s=e.tx,u=e.ty,c=-(1/0),h=-(1/0),l=1/0,f=1/0,d=this.vertices,p=0,g=d.length;g>p;p+=2){var m=d[p],v=d[p+1],b=n*m+o*v+s,y=a*v+i*m+u;l=l>b?b:l,f=f>y?y:f,c=b>c?b:c,h=y>h?y:h}if(l===-(1/0)||h===1/0)return r.Rectangle.EMPTY;var x=this._bounds;x.x=l,x.width=c-l,x.y=f,x.height=h-f,this._currentBounds=x}return this._currentBounds},i.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,o);var e,n,r=this.vertices,s=a.points;if(this.drawMode===i.DRAW_MODES.TRIANGLES){var u=this.indices;for(n=this.indices.length,e=0;n>e;e+=3){var c=2*u[e],h=2*u[e+1],l=2*u[e+2];if(s[0]=r[c],s[1]=r[c+1],s[2]=r[h],s[3]=r[h+1],s[4]=r[l],s[5]=r[l+1],a.contains(o.x,o.y))return!0}}else for(n=r.length,e=0;n>e;e+=6)if(s[0]=r[e],s[1]=r[e+1],s[2]=r[e+2],s[3]=r[e+3],s[4]=r[e+4],s[5]=r[e+5],a.contains(o.x,o.y))return!0;return!1},i.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":29}],126:[function(t,e,n){function i(t,e,n){r.call(this,t),this._ready=!0,this.segmentsX=e||10,this.segmentsY=n||10,this.drawMode=r.DRAW_MODES.TRIANGLES,this.refresh()}var r=t("./Mesh");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.refresh=function(){var t=this.segmentsX*this.segmentsY,e=[],n=[],i=[],r=[],o=this.texture,a=this.segmentsX-1,s=this.segmentsY-1,u=0,c=o.width/a,h=o.height/s;for(u=0;t>u;u++){var l=u%this.segmentsX,f=u/this.segmentsX|0;e.push(l*c,f*h),i.push(o._uvs.x0+(o._uvs.x1-o._uvs.x0)*(l/(this.segmentsX-1)),o._uvs.y0+(o._uvs.y3-o._uvs.y0)*(f/(this.segmentsY-1)))}var d=a*s;for(u=0;d>u;u++){var p=u%a,g=u/a|0,m=g*this.segmentsX+p,v=g*this.segmentsX+p+1,b=(g+1)*this.segmentsX+p,y=(g+1)*this.segmentsX+p+1;r.push(m,v,b),r.push(v,y,b)}this.vertices=new Float32Array(e),this.uvs=new Float32Array(i),this.colors=new Float32Array(n),this.indices=new Uint16Array(r)},i.prototype._onTextureUpdate=function(){r.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()}},{"./Mesh":125}],127:[function(t,e,n){function i(t,e){r.call(this,t),this.points=e,this.vertices=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length),this._ready=!0,this.refresh()}var r=t("./Mesh"),o=t("../core");i.prototype=Object.create(r.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){var e=this.uvs,n=this.indices,i=this.colors,r=this._texture._uvs,a=new o.Point(r.x0,r.y0),s=new o.Point(r.x2-r.x0,r.y2-r.y0);e[0]=0+a.x,e[1]=0+a.y,e[2]=0+a.x,e[3]=1*s.y+a.y,i[0]=1,i[1]=1,n[0]=0,n[1]=1;for(var u,c,h,l=t.length,f=1;l>f;f++)u=t[f],c=4*f,h=f/(l-1),e[c]=h*s.x+a.x,e[c+1]=0+a.y,e[c+2]=h*s.x+a.x,e[c+3]=1*s.y+a.y,c=2*f,i[c]=1,i[c+1]=1,c=2*f,n[c]=c,n[c+1]=c+1;this.dirty=!0}},i.prototype._onTextureUpdate=function(){r.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},i.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){for(var e,n,i,r,o,a,s=t[0],u=0,c=0,h=this.vertices,l=t.length,f=0;l>f;f++)n=t[f],i=4*f,e=f<t.length-1?t[f+1]:n,c=-(e.x-s.x),u=e.y-s.y,r=10*(1-f/(l-1)),r>1&&(r=1),o=Math.sqrt(u*u+c*c),a=this._texture.height/2,u/=o,c/=o,u*=a,c*=a,h[i]=n.x+u,h[i+1]=n.y+c,h[i+2]=n.x-u,h[i+3]=n.y-c,s=n;this.containerUpdateTransform()}}},{"../core":29,"./Mesh":125}],128:[function(t,e,n){e.exports={Mesh:t("./Mesh"),Plane:t("./Plane"),Rope:t("./Rope"),MeshRenderer:t("./webgl/MeshRenderer"),MeshShader:t("./webgl/MeshShader")}},{"./Mesh":125,"./Plane":126,"./Rope":127,"./webgl/MeshRenderer":129,"./webgl/MeshShader":130}],129:[function(t,e,n){function i(t){r.ObjectRenderer.call(this,t),this.indices=new Uint16Array(15e3);for(var e=0,n=0;15e3>e;e+=6,n+=4)this.indices[e+0]=n+0,this.indices[e+1]=n+1,this.indices[e+2]=n+2,this.indices[e+3]=n+0,this.indices[e+4]=n+2,this.indices[e+5]=n+3;this.currentShader=null}var r=t("../../core"),o=t("../Mesh");i.prototype=Object.create(r.ObjectRenderer.prototype),i.prototype.constructor=i,e.exports=i,r.WebGLRenderer.registerPlugin("mesh",i),i.prototype.onContextChange=function(){},i.prototype.render=function(t){t._vertexBuffer||this._initWebGL(t);var e=this.renderer,n=e.gl,i=t._texture.baseTexture,r=t.shader,a=t.drawMode===o.DRAW_MODES.TRIANGLE_MESH?n.TRIANGLE_STRIP:n.TRIANGLES;e.blendModeManager.setBlendMode(t.blendMode),r=r?r.shaders[n.id]||r.getShader(e):e.shaderManager.plugins.meshShader,this.renderer.shaderManager.setShader(r),r.uniforms.translationMatrix.value=t.worldTransform.toArray(!0),r.uniforms.projectionMatrix.value=e.currentRenderTarget.projectionMatrix.toArray(!0),r.uniforms.alpha.value=t.worldAlpha,r.syncUniforms(),t.dirty?(t.dirty=!1,n.bindBuffer(n.ARRAY_BUFFER,t._vertexBuffer),n.bufferData(n.ARRAY_BUFFER,t.vertices,n.STATIC_DRAW),n.vertexAttribPointer(r.attributes.aVertexPosition,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,t._uvBuffer),n.bufferData(n.ARRAY_BUFFER,t.uvs,n.STATIC_DRAW),n.vertexAttribPointer(r.attributes.aTextureCoord,2,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),i._glTextures[n.id]?n.bindTexture(n.TEXTURE_2D,i._glTextures[n.id]):this.renderer.updateTexture(i),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t._indexBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.indices,n.STATIC_DRAW)):(n.bindBuffer(n.ARRAY_BUFFER,t._vertexBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,t.vertices),n.vertexAttribPointer(r.attributes.aVertexPosition,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,t._uvBuffer),n.vertexAttribPointer(r.attributes.aTextureCoord,2,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),i._glTextures[n.id]?n.bindTexture(n.TEXTURE_2D,i._glTextures[n.id]):this.renderer.updateTexture(i),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t._indexBuffer),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,t.indices)),n.drawElements(a,t.indices.length,n.UNSIGNED_SHORT,0)},i.prototype._initWebGL=function(t){var e=this.renderer.gl;t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW),t.colors&&(t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)},i.prototype.flush=function(){},i.prototype.start=function(){this.currentShader=null},i.prototype.destroy=function(){r.ObjectRenderer.prototype.destroy.call(this)}},{"../../core":29,"../Mesh":125}],130:[function(t,e,n){function i(t){r.Shader.call(this,t,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}var r=t("../../core");i.prototype=Object.create(r.Shader.prototype),i.prototype.constructor=i,e.exports=i,r.ShaderManager.registerPlugin("meshShader",i)},{"../../core":29}],131:[function(t,e,n){Math.sign||(Math.sign=function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1})},{}],132:[function(t,e,n){Object.assign||(Object.assign=t("object-assign"))},{"object-assign":11}],133:[function(t,e,n){t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign")},{"./Math.sign":131,"./Object.assign":132,"./requestAnimationFrame":134}],134:[function(t,e,n){(function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var n=Date.now(),i=["ms","moz","webkit","o"],r=0;r<i.length&&!t.requestAnimationFrame;++r)t.requestAnimationFrame=t[i[r]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[i[r]+"CancelAnimationFrame"]||t[i[r]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+n-e;return 0>i&&(i=0),n=e,setTimeout(function(){n=Date.now(),t(performance.now())},i)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[115])(115)}),function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){window.GlSprites={},GlSprites.SpriteRenderer=n(1),GlSprites.createTexture2D=n(13)},function(t,e,n){function i(t,e){return this instanceof i?(e=e||{},this._blendSrc=u(e.blendSrc,t.SRC_ALPHA),this._blendDst=u(e.blendDst,t.ONE_MINUS_SRC_ALPHA),this._blendEnabled=e.blend!==!1,this.gl=t,this.shader=e.shader||o(t,{color:!0,texcoord:!0}),this.batch=e.batch||a(t,c({dynamic:!0,premultiplied:!0},e)),this._bound=!1,this.projection=l.create(),this.view=l.create(),this.transform=l.create(),this.transformStack=[],void(this.color=[1,1,1,1])):new i(t,e)}var r=n(2),o=n(4),a=n(11),s=n(51).vec2,u=n(52),c=n(3),h=n(53),l=n(54),f=[0,0,1,1],d=[0,0],p=[0,0],g=[0,0,1,1];r(i,{transform:{get:function(){return this.batch.transform},set:function(t){this.batch.transform=t}},clear:function(){return this.batch.clear(),this},ortho:function(t,e){return l.ortho(this.projection,0,t,e,0,0,1),this.updateUniforms(),this},solid:function(){return this.batch.texture=null,this},image:function(t,e){return this.batch.texture=t,this.batch.texcoord=e||f,this},defaults:function(){return this.batch.defaults(),this.batch.color=this.color,this},flush:function(){return this.batch.flush(),this},fillRect:function(t,e,n,i){return this.solid().defaults(),this.rect(t,e,n,i),this},rect:function(t,e,n,i){this.batch.color=this.color,this.batch.position[0]=t||0,this.batch.position[1]=e||0,this.batch.shape[0]=n||0,this.batch.shape[1]=i||0,this.batch.push()},stroke:function(t,e,n,i,r){this.batch.color=this.color,r=u(r,1),this.rect(t+r,e,n-2*r,r),this.rect(t,e,r,i),this.rect(t+r,e+i-r,n-2*r,r),this.rect(t+n-r,e,r,i)},strokeRect:function(t,e,n,i,r){return this.solid().defaults(),this.stroke(t,e,n,i,r),this},fillText:function(t,e,n,i,r){var o=t.batch.transform,a=t.batch.color,s=this._bound;s&&(this.draw(),this.unbind(),this.clear()),t.batch.color=this.color,t.batch.transform=this.transform,t.draw(this.shader,e,n,i,r),t.batch.color=a,t.batch.transform=o,s&&this.bind()},drawImage:function(t,e,n,i,r){"use strict";i=u(i,t.shape?t.shape[0]:0),r=u(r,t.shape?t.shape[1]:0);var o=f;if(arguments.length>=9){var a=t.shape,c=s(d,arguments[1],arguments[2]),l=s(p,arguments[3],arguments[4]);o=h(c,l,a,g),e=arguments[5],n=arguments[6],i=arguments[7],r=arguments[8]}return this.defaults(),this.image(t,o),this.rect(e,n,i,r),this},sprite:function(t){return this.batch.push(t),this},updateUniforms:function(){this.shader.bind(),this.shader.uniforms.projection=this.projection,this.shader.uniforms.view=this.view},bind:function(){var t=this.gl;return this._blendEnabled&&(t.enable(t.BLEND),t.blendFuncSeparate(this._blendSrc,this._blendDst,t.ONE,t.ONE_MINUS_SRC_ALPHA)),this._bound=!0,this.batch.bind(this.shader),this.solid(),this},draw:function(){return this.batch.draw(),this},unbind:function(){return this.batch.unbind(),this._bound=!1,this},begin:function(){return this.bind(),this.clear(),this},end:function(){return this.draw(),this.unbind(),this}}),r(i,n(64)),t.exports=i},function(t,e,n){function i(t,e){for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if("function"==typeof i)t[n]=i;else if(i&&"object"==typeof i){var a=r(o,i);Object.defineProperty(t,n,a)}}}var r=n(3),o={enumerable:!0,configurable:!0};t.exports=function(t,e){i(t.prototype,e)},t.exports.mix=i},function(t,e){function n(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}t.exports=n},function(t,e,n){function i(t,e,n,i){n=n||0;var r="";r+="attribute vec4 "+s+";\n"+(t?"attribute vec3 "+u+";\n":"")+(e?"attribute vec4 "+c+";\n":"");var o;for(i=i.toFixed(5),o=0;n>o;o++)r+="attribute vec2 "+h+o+";\n";for(r+="uniform mat4 projection;\n",r+="uniform mat4 view;\n",r+="uniform mat4 model;\n",r+=e?"varying vec4 v_col;\n":"",o=0;n>o;o++)r+="varying vec2 v_tex"+o+";\n";for(r+="\nvoid main() {\n   gl_Position = projection * view * model * "+s+";\n"+(e?"   v_col = "+c+";\n":""),o=0;n>o;o++)r+="   v_tex"+o+" = "+h+o+";\n";return r+="   gl_PointSize = "+i+";\n",r+="}\n"}function r(t,e){e=e||0;var n="#ifdef GL_ES\nprecision mediump float;\n#endif\n\n";t&&(n+="varying vec4 v_col;\n");var i;for(i=0;e>i;i++)n+="varying vec2 v_tex"+i+";\n",n+="uniform sampler2D texture"+i+";\n";for(n+="uniform vec4 tint;\n",n+="\nvoid main() {\n   gl_FragColor = ",t&&(n+="v_col"),t&&e>0?n+=" * ":t||e||(n+="vec4(1.0)"),i=0;e>i;i++)n+=i==e-1?" texture2D(texture"+i+",  v_tex"+i+")":" texture2D(texture"+i+",  v_tex"+i+") *";return n+=" * tint",n+=";\n}"}var o=n(5),a=n(6),s="position",u="normal",c="color",h="texcoord";t.exports=function(e,n){n=n||{},n.texcoord="number"==typeof n.texcoord?n.texcoord:n.texcoord||0;var i=t.exports.generate(n),r=i.vertex,s=i.fragment,u=i.uniforms,c=i.attributes,h=a(e,r,s,u,c);h.bind();for(var l=0;l<n.texcoord;l++)h.uniforms["texture"+l]=l;var f=o(new Float32Array(16));return h.uniforms.projection=f,h.uniforms.model=f,h.uniforms.view=f,h.uniforms.tint=n.tint||[1,1,1,1],h},t.exports.generate=function(t){t=t||{},t.texcoord="number"==typeof t.texcoord?t.texcoord:t.texcoord||0;var e="number"==typeof t.pointSize?t.pointSize:1,n="string"==typeof t.vertex?t.vertex:i(t.normal,t.color,t.texcoord,e),o="string"==typeof t.fragment?t.fragment:r(t.color,t.texcoord),a=[{type:"mat4",name:"projection"},{type:"mat4",name:"view"},{type:"mat4",name:"model"},{type:"vec4",name:"tint"}],l=[{type:"vec4",name:s,location:0}];t.normal&&l.push({type:"vec3",name:u,location:1}),t.color&&l.push({type:"vec4",name:c,location:2});for(var f=3,d=0;d<t.texcoord;d++)a.push({type:"sampler2D",name:"texture"+d}),l.push({type:"vec2",name:h+d,location:f++});return{vertex:n,fragment:o,uniforms:a,attributes:l}}},function(t,e){function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}t.exports=n},function(t,e,n){"use strict";function i(t,e,n,i){this.gl=t,this.handle=e,this.attributes=null,this.uniforms=null,this.types=null,this.vertexShader=n,this.fragmentShader=i}function r(t,e,n,i){for(var r=0;r<i.length;++r)n[r]=t.getUniformLocation(e,i[r].name)}function o(t,e,n,r,o){var a=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(a,e),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(a);throw console.error("gl-shader: Error compling vertex shader:",s),new Error("gl-shader: Error compiling vertex shader:"+s)}var u=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(u,n),t.compileShader(u),!t.getShaderParameter(u,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(u);throw console.error("gl-shader: Error compiling fragment shader:",s),new Error("gl-shader: Error compiling fragment shader:"+s)}var c=t.createProgram();if(t.attachShader(c,u),t.attachShader(c,a),o.forEach(function(e){"number"==typeof e.location&&t.bindAttribLocation(c,e.location,e.name)}),t.linkProgram(c),!t.getProgramParameter(c,t.LINK_STATUS)){var s=t.getProgramInfoLog(c);throw console.error("gl-shader: Error linking shader program:",s),new Error("gl-shader: Error linking shader program:"+s)}var h=new i(t,c,a,u);return h.updateExports(r,o),h}var a=n(7),s=n(10),u=n(9);i.prototype.bind=function(){this.gl.useProgram(this.handle)},i.prototype.dispose=function(){var t=this.gl;t.deleteShader(this.vertexShader),t.deleteShader(this.fragmentShader),t.deleteProgram(this.handle)},i.prototype.updateExports=function(t,e){var n=new Array(t.length),i=this.handle,o=this.gl,c=r.bind(void 0,o,i,n,t);c(),this.types={uniforms:u(t),attributes:u(e)},this.attributes=s(o,i,e,c),Object.defineProperty(this,"uniforms",a(o,i,t,n))},t.exports=o},function(t,e,n){"use strict";function i(t){var e=new Function("y","return function(){return y}");return e(t)}function r(t,e,n,r){function s(n){var i=new Function("gl","prog","locations","return function(){return gl.getUniform(prog,locations["+n+"])}");return i(t,e,r)}function u(t,e,n){switch(n){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+e+"],obj"+t+")";case"float":return"gl.uniform1f(locations["+e+"],obj"+t+")";default:var i=n.indexOf("vec");if(!(i>=0&&1>=i&&n.length===4+i)){if(0===n.indexOf("mat")&&4===n.length){var r=n.charCodeAt(n.length-1)-48;if(2>r||r>4)throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+n);return"gl.uniformMatrix"+r+"fv(locations["+e+"],false,obj"+t+")"}throw new Error("gl-shader: Unknown uniform data type for "+name+": "+n)}var r=n.charCodeAt(n.length-1)-48;if(2>r||r>4)throw new Error("gl-shader: Invalid data type");switch(n.charAt(0)){case"b":case"i":return"gl.uniform"+r+"iv(locations["+e+"],obj"+t+")";case"v":return"gl.uniform"+r+"fv(locations["+e+"],obj"+t+")";default:throw new Error("gl-shader: Unrecognized data type for vector "+name+": "+n)}}}function c(t,e){if("object"!=typeof e)return[[t,e]];var n=[];for(var i in e){var r=e[i],o=t;o+=parseInt(i)+""===i?"["+i+"]":"."+i,"object"==typeof r?n.push.apply(n,c(o,r)):n.push([o,r])}return n}function h(i){for(var o=["return function updateProperty(obj){"],a=c("",i),s=0;s<a.length;++s){var h=a[s],l=h[0],f=h[1];r[f]&&o.push(u(l,f,n[f].type))}o.push("return obj}");var d=new Function("gl","prog","locations",o.join("\n"));return d(t,e,r)}function l(t){switch(t){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var e=t.indexOf("vec");if(e>=0&&1>=e&&t.length===4+e){var n=t.charCodeAt(t.length-1)-48;if(2>n||n>4)throw new Error("gl-shader: Invalid data type");return"b"===t.charAt(0)?o(n,!1):o(n)}if(0===t.indexOf("mat")&&4===t.length){var n=t.charCodeAt(t.length-1)-48;if(2>n||n>4)throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+t);return o([n,n])}throw new Error("gl-shader: Unknown uniform data type for "+name+": "+t)}}function f(t,e,o){if("object"==typeof o){var a=d(o);Object.defineProperty(t,e,{get:i(a),set:h(o),enumerable:!0,configurable:!1})}else r[o]?Object.defineProperty(t,e,{get:s(o),set:h(o),enumerable:!0,configurable:!1}):t[e]=l(n[o].type)}function d(t){var e;if(Array.isArray(t)){e=new Array(t.length);for(var n=0;n<t.length;++n)f(e,n,t[n])}else{e={};for(var i in t)f(e,i,t[i])}return e}var p=a(n,!0);return{get:i(d(p)),set:h(p),enumerable:!0,configurable:!0}}var o=n(8),a=n(9);t.exports=r},function(t,e){"use strict";function n(t,e,i){var r=0|t[i];if(0>=r)return[];var o,a=new Array(r);if(i===t.length-1)for(o=0;r>o;++o)a[o]=e;else for(o=0;r>o;++o)a[o]=n(t,e,i+1);return a}function i(t,e){var n,i;for(n=new Array(t),i=0;t>i;++i)n[i]=e;return n}function r(t,e){switch("undefined"==typeof e&&(e=0),typeof t){case"number":if(t>0)return i(0|t,e);break;case"object":if("number"==typeof t.length)return n(t,e,0)}return[]}t.exports=r},function(t,e){"use strict";function n(t,e){for(var n={},i=0;i<t.length;++i)for(var r=t[i].name,o=r.split("."),a=n,s=0;s<o.length;++s){var u=o[s].split("[");if(u.length>1){u[0]in a||(a[u[0]]=[]),a=a[u[0]];for(var c=1;c<u.length;++c){var h=parseInt(u[c]);c<u.length-1||s<o.length-1?(h in a||(c<u.length-1?a[h]=[]:a[h]={}),a=a[h]):e?a[h]=i:a[h]=t[i].type}}else s<o.length-1?(u[0]in a||(a[u[0]]={}),a=a[u[0]]):e?a[u[0]]=i:a[u[0]]=t[i].type}return n}t.exports=n},function(t,e){"use strict";function n(t,e,n,i,r,o,a){this._gl=t,this._program=e,this._location=n,this._dimension=i,this._name=r,this._constFunc=o,this._relink=a}function i(t,e,i,r,o,a,s){for(var u=["gl","v"],c=[],h=0;r>h;++h)u.push("x"+h),c.push("x"+h);u.push(["if(x0.length===void 0){return gl.vertexAttrib",r,"f(v,",c.join(),")}else{return gl.vertexAttrib",r,"fv(v,x0)}"].join(""));var l=Function.apply(void 0,u),f=new n(t,e,i,r,a,l,s);Object.defineProperty(o,a,{set:function(e){return t.disableVertexAttribArray(f._location),l(t,f._location,e),e},get:function(){return f},enumerable:!0})}function r(t,e,n,r){for(var o={},a=0,s=n.length;s>a;++a){var u=n[a],c=u.name,h=u.type,l=t.getAttribLocation(e,c);switch(h){case"bool":case"int":case"float":i(t,e,l,1,o,c,r);break;default:if(!(h.indexOf("vec")>=0))throw new Error("gl-shader: Unknown data type for attribute "+c+": "+h);var f=h.charCodeAt(h.length-1)-48;if(2>f||f>4)throw new Error("gl-shader: Invalid data type for attribute "+c+": "+h);i(t,e,l,f,o,c,r)}}return o}t.exports=r;var o=n.prototype;o.pointer=function(t,e,n,i){var r=this._gl;r.vertexAttribPointer(this._location,this._dimension,t||r.FLOAT,!!e,n||0,i||0),this._gl.enableVertexAttribArray(this._location)},Object.defineProperty(o,"location",{get:function(){return this._location},set:function(t){t!==this._location&&(this._location=t,this._gl.bindAttribLocation(this._program,t,this._name),this._gl.linkProgram(this._program),this._relink())}})},function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);if(!t)throw new Error("must specify gl context");this.gl=t,e=e||{},this._bound=!1,this.idx=0,this.transform=null,this._defaultTexture=e.defaultTexture||c(t),this._ownsDefault=!e.defaultTexture,this._lastTexture=this._defaultTexture,this._texture=this._defaultTexture,this.texture=null,this.mode="number"==typeof e.mode?e.mode:t.TRIANGLES,this.premultiplied=e.premultiplied||!1,this._dirty=!0,this.create(e),this.defaults()}function r(t,e,n){return t[0]=e,t[1]=n,t}function o(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}var a=n(32),s=n(2),u=n(34),c=n(12),h=n(35).floatsPerVertex,l=[0,0],f=[0,0],d=[0,0,0,0],p=[0,0,0,0],g=[0,0,0,0];s(i,n(35).mixins),s(i,{capacity:{get:function(){return this._capacity}},texture:{get:function(){return this._texture},set:function(t){this._texture=t||this._defaultTexture}},dispose:function(){this.vertexBuffer&&this.vertexBuffer.dispose(),this.indexBuffer&&this.indexBuffer.dispose(),this.vao&&this.vao.dispose(),this._ownsDefault&&this._defaultTexture.dispose()},clear:function(){return this.idx=0,this},bind:function(t){t.bind(),this.vao.bind(t),this._bound=!0},unbind:function(){this.vao.unbind(),this._bound=!1},defaults:function(){return this.position=r(l,0,0),this.texcoord=o(d,0,0,1,1),this.color=o(p,1,1,1,1),this.shape=r(f,0,0),this},push:function(t){if(t&&(this.texture=t.texture,this.position=t.position||r(l,0,0),this.texcoord=t.texcoord||o(d,0,0,1,1),this.color=t.color||o(p,1,1,1,1),this.shape=t.shape||r(f,0,0)),this.texture!==this._lastTexture)this._bound&&this.flush(),this._lastTexture=this.texture;else if(this.idx===this.vertices.length){if(!this._bound)return this;this.flush()}this._dirty=!0;var e=this.premultiplied?u(this.color,g):this.color,n=a(e),i=this.texcoord[0],s=this.texcoord[1],c=this.texcoord[2],h=this.texcoord[3],m=this.position[0],v=this.position[1],b=this.shape[0],y=this.shape[1];return this._vert(m,v,i,s,n),this._vert(m+b,v,c,s,n),this._vert(m+b,v+y,c,h,n),this._vert(m,v+y,i,h,n),this},_vert:function(t,e,n,i,r){var o=this.idx,a=this.vertices,s=this.transform;if(s){var u=t,c=e;t=s[0]*u+s[4]*c+s[12],e=s[1]*u+s[5]*c+s[13]}a[o++]=t,a[o++]=e,a[o++]=n,a[o++]=i,a[o++]=r,this.idx=o},flush:function(){return this.draw(),this.clear()},draw:function(){if(0===this.idx||!this._bound)return this;this.gl;if(this._dirty){var t=this.vertices.subarray(0,this.idx);this.vertexBuffer.update(t,0),this._dirty=!1}this._lastTexture&&this._lastTexture.bind(),this._lastTexture=this.texture;var e=this.idx/(4*h);return e>0&&this.vao.draw(this.mode,6*e,0),this}}),t.exports=i},function(t,e,n){var i=n(13),r=n(29);t.exports=function(t){var e=Array.apply(null,new Array(16)).map(Number.prototype.valueOf,255),n=r(new Uint8Array(e),[2,2,4]);return i(t,n)}},function(t,e,n){"use strict";function i(t){m=[t.LINEAR,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_NEAREST],v=[t.NEAREST,t.LINEAR,t.NEAREST_MIPMAP_NEAREST,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_LINEAR],b=[t.REPEAT,t.CLAMP_TO_EDGE,t.MIRRORED_REPEAT]}function r(t,e,n){var i=t.gl,r=i.getParameter(i.MAX_TEXTURE_SIZE);if(0>e||e>r||0>n||n>r)throw new Error("gl-texture2d: Invalid texture size");return t._shape=[e,n],t.bind(),i.texImage2D(i.TEXTURE_2D,0,t.format,e,n,0,t.format,t.type,null),t._mipLevels=[0],t}function o(t,e,n,i,r,o){this.gl=t,this.handle=e,this.format=r,this.type=o,this._shape=[n,i],this._mipLevels=[0],this._magFilter=t.NEAREST,this._minFilter=t.NEAREST,this._wrapS=t.CLAMP_TO_EDGE,this._wrapT=t.CLAMP_TO_EDGE,this._anisoSamples=1;var a=this,s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return a._wrapS},set:function(t){return a.wrapS=t}},{get:function(){return a._wrapT},set:function(t){return a.wrapT=t}}]),this._wrapVector=s;var u=[this._shape[0],this._shape[1]];Object.defineProperties(u,[{get:function(){return a._shape[0]},set:function(t){return a.width=t}},{get:function(){return a._shape[1]},set:function(t){return a.height=t}}]),this._shapeVector=u}function a(t,e){return 3===t.length?1===e[2]&&e[1]===t[0]*t[2]&&e[0]===t[2]:1===e[0]&&e[1]===t[0]}function s(t,e,n,i,r,o,s,u){var c=u.dtype,h=u.shape.slice();if(h.length<2||h.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var l=0,f=0,m=a(h,u.stride.slice());"float32"===c?l=t.FLOAT:"float64"===c?(l=t.FLOAT,m=!1,c="float32"):"uint8"===c?l=t.UNSIGNED_BYTE:(l=t.UNSIGNED_BYTE,m=!1,c="uint8");var v=1;if(2===h.length)f=t.LUMINANCE,h=[h[0],h[1],1],u=d(u.data,h,[u.stride[0],u.stride[1],1],u.offset);else{if(3!==h.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===h[2])f=t.ALPHA;else if(2===h[2])f=t.LUMINANCE_ALPHA;else if(3===h[2])f=t.RGB;else{if(4!==h[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");f=t.RGBA}v=h[2]}if(f!==t.LUMINANCE&&f!==t.ALPHA||r!==t.LUMINANCE&&r!==t.ALPHA||(f=r),f!==r)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var b=u.size,x=s.indexOf(i)<0;if(x&&s.push(i),l===o&&m)0===u.offset&&u.data.length===b?x?t.texImage2D(t.TEXTURE_2D,i,r,h[0],h[1],0,r,o,u.data):t.texSubImage2D(t.TEXTURE_2D,i,e,n,h[0],h[1],r,o,u.data):x?t.texImage2D(t.TEXTURE_2D,i,r,h[0],h[1],0,r,o,u.data.subarray(u.offset,u.offset+b)):t.texSubImage2D(t.TEXTURE_2D,i,e,n,h[0],h[1],r,o,u.data.subarray(u.offset,u.offset+b));else{var w;w=o===t.FLOAT?g.mallocFloat32(b):g.mallocUint8(b);var _=d(w,h,[h[2],h[2]*h[0],1]);l===t.FLOAT&&o===t.UNSIGNED_BYTE?y(_,u):p.assign(_,u),x?t.texImage2D(t.TEXTURE_2D,i,r,h[0],h[1],0,r,o,w.subarray(0,b)):t.texSubImage2D(t.TEXTURE_2D,i,e,n,h[0],h[1],r,o,w.subarray(0,b)),o===t.FLOAT?g.freeFloat32(w):g.freeUint8(w)}}function u(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e}function c(t,e,n,i,r){var a=t.getParameter(t.MAX_TEXTURE_SIZE);if(0>e||e>a||0>n||n>a)throw new Error("gl-texture2d: Invalid texture shape");if(r===t.FLOAT&&!t.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var s=u(t);return t.texImage2D(t.TEXTURE_2D,0,i,e,n,0,i,r,null),new o(t,s,e,n,i,r)}function h(t,e,n,i){var r=u(t);return t.texImage2D(t.TEXTURE_2D,0,n,n,i,e),new o(t,r,0|e.width,0|e.height,n,i)}function l(t,e){var n=e.dtype,i=e.shape.slice(),r=t.getParameter(t.MAX_TEXTURE_SIZE);if(i[0]<0||i[0]>r||i[1]<0||i[1]>r)throw new Error("gl-texture2d: Invalid texture size");var s=a(i,e.stride.slice()),c=0;"float32"===n?c=t.FLOAT:"float64"===n?(c=t.FLOAT,s=!1,n="float32"):"uint8"===n?c=t.UNSIGNED_BYTE:(c=t.UNSIGNED_BYTE,s=!1,n="uint8");var h=0;if(2===i.length)h=t.LUMINANCE,i=[i[0],i[1],1],e=d(e.data,i,[e.stride[0],e.stride[1],1],e.offset);else{if(3!==i.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===i[2])h=t.ALPHA;else if(2===i[2])h=t.LUMINANCE_ALPHA;else if(3===i[2])h=t.RGB;else{if(4!==i[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");h=t.RGBA}}c!==t.FLOAT||t.getExtension("OES_texture_float")||(c=t.UNSIGNED_BYTE,s=!1);var l,f,m=e.size;if(s)l=0===e.offset&&e.data.length===m?e.data:e.data.subarray(e.offset,e.offset+m);else{var v=[i[2],i[2]*i[0],1];f=g.malloc(m,n);var b=d(f,i,v,0);"float32"!==n&&"float64"!==n||c!==t.UNSIGNED_BYTE?p.assign(b,e):y(b,e),l=f.subarray(0,m)}var x=u(t);return t.texImage2D(t.TEXTURE_2D,0,h,i[0],i[1],0,h,c,l),s||g.free(f),new o(t,x,i[0],i[1],h,c)}function f(t){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(m||i(t),"number"==typeof arguments[1])return c(t,arguments[1],arguments[2],arguments[3]||t.RGBA,arguments[4]||t.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return c(t,0|arguments[1][0],0|arguments[1][1],arguments[2]||t.RGBA,arguments[3]||t.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var e=arguments[1];if(e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof HTMLVideoElement||e instanceof ImageData)return h(t,e,arguments[2]||t.RGBA,arguments[3]||t.UNSIGNED_BYTE);if(e.shape&&e.data&&e.stride)return l(t,e)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var d=n(14),p=n(17),g=n(22);t.exports=f;var m=null,v=null,b=null,y=function(t,e){p.muls(t,e,255)},x=o.prototype;Object.defineProperties(x,{minFilter:{get:function(){return this._minFilter},set:function(t){this.bind();var e=this.gl;if(this.type===e.FLOAT&&m.indexOf(t)>=0&&(e.getExtension("OES_texture_float_linear")||(t=e.NEAREST)),v.indexOf(t)<0)throw new Error("gl-texture2d: Unknown filter mode "+t);return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),this._minFilter=t}},magFilter:{get:function(){return this._magFilter},set:function(t){this.bind();var e=this.gl;if(this.type===e.FLOAT&&m.indexOf(t)>=0&&(e.getExtension("OES_texture_float_linear")||(t=e.NEAREST)),v.indexOf(t)<0)throw new Error("gl-texture2d: Unknown filter mode "+t);return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),this._magFilter=t}},mipSamples:{get:function(){return this._anisoSamples},set:function(t){var e=this._anisoSamples;if(this._anisoSamples=0|Math.max(t,1),e!==this._anisoSamples){var n=gl.getExtension("EXT_texture_filter_anisotropic");n&&this.gl.texParameterf(this.gl.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(t){if(this.bind(),b.indexOf(t)<0)throw new Error("gl-texture2d: Unknown wrap mode "+t);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,t),this._wrapS=t}},wrapT:{get:function(){return this._wrapT},set:function(t){if(this.bind(),b.indexOf(t)<0)throw new Error("gl-texture2d: Unknown wrap mode "+t);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,t),
this._wrapT=t}},wrap:{get:function(){return this._wrapVector},set:function(t){if(Array.isArray(t)||(t=[t,t]),2!==t.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var e=0;2>e;++e)if(b.indexOf(t[e])<0)throw new Error("gl-texture2d: Unknown wrap mode "+t);this._wrapS=t[0],this._wrapT=t[1];var n=this.gl;return this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,this._wrapS),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,this._wrapT),t}},shape:{get:function(){return this._shapeVector},set:function(t){if(Array.isArray(t)){if(2!==t.length)throw new Error("gl-texture2d: Invalid texture shape")}else t=[0|t,0|t];return r(this,0|t[0],0|t[1]),[0|t[0],0|t[1]]}},width:{get:function(){return this._shape[0]},set:function(t){return t=0|t,r(this,t,this._shape[1]),t}},height:{get:function(){return this._shape[1]},set:function(t){return t=0|t,r(this,this._shape[0],t),t}}}),x.bind=function(t){var e=this.gl;return void 0!==t&&e.activeTexture(e.TEXTURE0+(0|t)),e.bindTexture(e.TEXTURE_2D,this.handle),void 0!==t?0|t:e.getParameter(e.ACTIVE_TEXTURE)-e.TEXTURE0},x.dispose=function(){this.gl.deleteTexture(this.handle)},x.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var t=Math.min(this._shape[0],this._shape[1]),e=0;t>0;++e,t>>>=1)this._mipLevels.indexOf(e)<0&&this._mipLevels.push(e)},x.setPixels=function(t,e,n,i){var r=this.gl;if(this.bind(),Array.isArray(e)?(i=n,n=0|e[1],e=0|e[0]):(e=e||0,n=n||0),i=i||0,t instanceof HTMLCanvasElement||t instanceof ImageData||t instanceof HTMLImageElement||t instanceof HTMLVideoElement){var o=this._mipLevels.indexOf(i)<0;o?(r.texImage2D(r.TEXTURE_2D,0,this.format,this.format,this.type,t),this._mipLevels.push(i)):r.texSubImage2D(r.TEXTURE_2D,i,e,n,this.format,this.type,t)}else{if(!(t.shape&&t.stride&&t.data))throw new Error("gl-texture2d: Unsupported data type");if(t.shape.length<2||e+t.shape[1]>this._shape[1]>>>i||n+t.shape[0]>this._shape[0]>>>i||0>e||0>n)throw new Error("gl-texture2d: Texture dimensions are out of bounds");s(r,e,n,i,this.format,this.type,this._mipLevels,t)}}},function(t,e,n){function i(t,e){return t[0]-e[0]}function r(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(i);var r=new Array(n.length);for(t=0;t<r.length;++t)r[t]=n[t][1];return r}function o(t,e){var n=["View",e,"d",t].join("");0>e&&(n="View_Nil"+t);var i="generic"===t;if(-1===e){var o="function "+n+"(a){this.data=a;};	var proto="+n+".prototype;	proto.dtype='"+t+"';	proto.index=function(){return -1};	proto.size=0;	proto.dimension=-1;	proto.shape=proto.stride=proto.order=[];	proto.lo=proto.hi=proto.transpose=proto.step=	function(){return new "+n+"(this.data);};	proto.get=proto.set=function(){};	proto.pick=function(){return null};	return function construct_"+n+"(a){return new "+n+"(a);}",a=new Function(o);return a()}if(0===e){var o="function "+n+"(a,d) {	this.data = a;	this.offset = d	};	var proto="+n+".prototype;	proto.dtype='"+t+"';	proto.index=function(){return this.offset};	proto.dimension=0;	proto.size=1;	proto.shape=	proto.stride=	proto.order=[];	proto.lo=	proto.hi=	proto.transpose=	proto.step=function "+n+"_copy() {	return new "+n+"(this.data,this.offset)	};	proto.pick=function "+n+"_pick(){	return TrivialArray(this.data);	};	proto.valueOf=proto.get=function "+n+"_get(){	return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};	proto.set=function "+n+"_set(v){	return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"	};	return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",a=new Function("TrivialArray",o);return a(l[t][0])}var o=["'use strict'"],s=u(e),c=s.map(function(t){return"i"+t}),h="this.offset+"+s.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),f=s.map(function(t){return"b"+t}).join(","),d=s.map(function(t){return"c"+t}).join(",");o.push("function "+n+"(a,"+f+","+d+",d){this.data=a","this.shape=["+f+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){	return "+s.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),4>e?(o.push("function "+n+"_order(){"),2===e?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);	if(s0>s1){	if(s1>s2){	return [2,1,0];	}else if(s0>s2){	return [1,2,0];	}else{	return [1,0,2];	}	}else if(s0>s2){	return [2,0,1];	}else if(s2>s1){	return [0,1,2];	}else{	return [0,2,1];	}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i?o.push("return this.data.set("+h+",v)}"):o.push("return this.data["+h+"]=v}"),o.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i?o.push("return this.data.get("+h+")}"):o.push("return this.data["+h+"]}"),o.push("proto.index=function "+n+"_index(",c.join(),"){return "+h+"}"),o.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+s.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+s.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var p=s.map(function(t){return"a"+t+"=this.shape["+t+"]"}),g=s.map(function(t){return"c"+t+"=this.stride["+t+"]"});o.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+g.join(","));for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){	d=i"+m+"|0;	b+=c"+m+"*d;	a"+m+"-=d}");o.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"c"+t}).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+s.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+s.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'){	d=i"+m+"|0;	if(d<0){	c+=b"+m+"*(a"+m+"-1);	a"+m+"=ceil(-a"+m+"/d)	}else{	a"+m+"=ceil(a"+m+"/d)	}	b"+m+"*=d	}");o.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"b"+t}).join(",")+",c)}");for(var v=new Array(e),b=new Array(e),m=0;e>m;++m)v[m]="a[i"+m+"]",b[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+b.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map(function(t){return"shape["+t+"]"}).join(",")+","+s.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var a=new Function("CTOR_LIST","ORDER",o.join("\n"));return a(l[t],r)}function a(t){if(c(t))return"buffer";if(h)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function s(t,e,n,i){if(void 0===t){var r=l.array[0];return r([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===n){n=new Array(s);for(var u=s-1,c=1;u>=0;--u)n[u]=c,c*=e[u]}if(void 0===i){i=0;for(var u=0;s>u;++u)n[u]<0&&(i-=(e[u]-1)*n[u])}for(var h=a(t),f=l[h];f.length<=s+1;)f.push(o(h,f.length-1));var r=f[s+1];return r(t,e,n,i)}var u=n(15),c=n(16),h="undefined"!=typeof Float64Array,l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=s},function(t,e){"use strict";function n(t){for(var e=new Array(t),n=0;t>n;++n)e[n]=n;return e}t.exports=n},function(t,e){t.exports=function(t){return!(null==t||!t.constructor||"function"!=typeof t.constructor.isBuffer||!t.constructor.isBuffer(t))}},function(t,e,n){"use strict";function i(t){if(!t)return s;for(var e=0;e<t.args.length;++e){var n=t.args[e];0===e?t.args[e]={name:n,lvalue:!0,rvalue:!!t.rvalue,count:t.count||1}:t.args[e]={name:n,lvalue:!1,rvalue:!0,count:1}}return t.thisVars||(t.thisVars=[]),t.localVars||(t.localVars=[]),t}function r(t){return a({args:t.args,pre:i(t.pre),body:i(t.body),post:i(t.proc),funcName:t.funcName})}function o(t){for(var e=[],n=0;n<t.args.length;++n)e.push("a"+n);var i=new Function("P",["return function ",t.funcName,"_ndarrayops(",e.join(","),") {P(",e.join(","),");return a0}"].join(""));return i(r(t))}var a=n(18),s={body:"",args:[],thisVars:[],localVars:[]},u={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var t in u){var n=u[t];e[t]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:t+"eq"}),e[t+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:t+"seq"})}}();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var t in c){var n=c[t];e[t]=o({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:t}),e[t+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:t+"eq"})}}();var h={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var t in h){var n=h[t];e[t]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:t+"eq"}),e[t+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:t+"seq"})}}();var l=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var t=0;t<l.length;++t){var n=l[t];e[n]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),e[n+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var f=["max","min","atan2","pow"];!function(){for(var t=0;t<f.length;++t){var n=f[t];e[n]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),e[n+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),e[n+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),e[n+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var d=["atan2","pow"];!function(){for(var t=0;t<d.length;++t){var n=d[t];e[n+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),e[n+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),e[n+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),e[n+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),e.any=a({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),e.all=a({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),e.sum=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),e.prod=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),e.norm2squared=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),e.norm2=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),e.norminf=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),e.norm1=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),e.sup=a({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.inf=a({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.argmin=a({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.argmax=a({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),e.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),e.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),e.equals=a({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},function(t,e,n){"use strict";function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function r(t){var e=new i;e.pre=t.pre,e.body=t.body,e.post=t.post;var n=t.args.slice(0);e.argTypes=n;for(var r=0;r<n.length;++r){var a=n[r];if("array"===a||"object"==typeof a&&a.blockIndices){if(e.argTypes[r]="array",e.arrayArgs.push(r),e.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),e.shimArgs.push("array"+r),r<e.pre.args.length&&e.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array args");if(r<e.post.args.length&&e.post.args[r].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)e.scalarArgs.push(r),e.shimArgs.push("scalar"+r);else if("index"===a){if(e.indexArgs.push(r),r<e.pre.args.length&&e.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array index");if(r<e.body.args.length&&e.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array index");if(r<e.post.args.length&&e.post.args[r].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(e.shapeArgs.push(r),r<e.pre.args.length&&e.pre.args[r].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(r<e.body.args.length&&e.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array shape");if(r<e.post.args.length&&e.post.args[r].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+n[r]);e.argTypes[r]="offset",e.offsetArgs.push({array:a.array,offset:a.offset}),e.offsetArgIndex.push(r)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,o(e)}var o=n(19);t.exports=r},function(t,e,n){"use strict";function i(t){var e=["'use strict'","var CACHED={}"],n=[],i=t.funcName+"_cwise_thunk";e.push(["return function ",i,"(",t.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],u=[],c=[],h=0;h<t.arrayArgs.length;++h){var l=t.arrayArgs[h];n.push(["t",l,"=array",l,".dtype,","r",l,"=array",l,".order"].join("")),o.push("t"+l),o.push("r"+l),a.push("t"+l),a.push("r"+l+".join()"),s.push("array"+l+".data"),s.push("array"+l+".stride"),s.push("array"+l+".offset|0"),h>0&&(u.push("array"+t.arrayArgs[0]+".shape.length===array"+l+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[h]))),c.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+l+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[h])+"]"))}t.arrayArgs.length>1&&(e.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),e.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}"));for(var h=0;h<t.scalarArgs.length;++h)s.push("scalar"+t.scalarArgs[h]);n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),e.push("var "+n.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------");var f=new Function("compile",e.join("\n"));return f(r.bind(void 0,t))}var r=n(20);t.exports=i},function(t,e,n){"use strict";function i(t,e,n){var i,r,o=t.length,a=e.arrayArgs.length,s=e.indexArgs.length>0,u=[],c=[],h=0,l=0;for(i=0;o>i;++i)c.push(["i",i,"=0"].join(""));for(r=0;a>r;++r)for(i=0;o>i;++i)l=h,h=t[i],0===i?c.push(["d",r,"s",i,"=t",r,"p",h].join("")):c.push(["d",r,"s",i,"=(t",r,"p",h,"-s",l,"*t",r,"p",l,")"].join(""));for(u.push("var "+c.join(",")),i=o-1;i>=0;--i)h=t[i],u.push(["for(i",i,"=0;i",i,"<s",h,";++i",i,"){"].join(""));for(u.push(n),i=0;o>i;++i){for(l=h,h=t[i],r=0;a>r;++r)u.push(["p",r,"+=d",r,"s",i].join(""));s&&(i>0&&u.push(["index[",l,"]-=s",l].join("")),u.push(["++index[",h,"]"].join(""))),u.push("}")}return u.join("\n")}function r(t,e,n,r){for(var o=e.length,a=n.arrayArgs.length,s=n.blockSize,u=n.indexArgs.length>0,c=[],h=0;a>h;++h)c.push(["var offset",h,"=p",h].join(""));for(var h=t;o>h;++h)c.push(["for(var j"+h+"=SS[",e[h],"]|0;j",h,">0;){"].join("")),c.push(["if(j",h,"<",s,"){"].join("")),c.push(["s",e[h],"=j",h].join("")),c.push(["j",h,"=0"].join("")),c.push(["}else{s",e[h],"=",s].join("")),c.push(["j",h,"-=",s,"}"].join("")),u&&c.push(["index[",e[h],"]=j",h].join(""));for(var h=0;a>h;++h){for(var l=["offset"+h],f=t;o>f;++f)l.push(["j",f,"*t",h,"p",e[f]].join(""));c.push(["p",h,"=(",l.join("+"),")"].join(""))}c.push(i(e,n,r));for(var h=t;o>h;++h)c.push("}");return c.join("\n")}function o(t){for(var e=0,n=t[0].length;n>e;){for(var i=1;i<t.length;++i)if(t[i][e]!==t[0][e])return e;++e}return e}function a(t,e,n){for(var i=t.body,r=[],o=[],a=0;a<t.args.length;++a){var s=t.args[a];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),c="",h=e.arrayArgs.indexOf(a);switch(e.argTypes[a]){case"offset":var l=e.offsetArgIndex.indexOf(a),f=e.offsetArgs[l];h=f.array,c="+q"+l;case"array":c="p"+h+c;var d="l"+a,p="a"+h;if(0===e.arrayBlockIndices[h])1===s.count?"generic"===n[h]?s.lvalue?(r.push(["var ",d,"=",p,".get(",c,")"].join("")),i=i.replace(u,d),o.push([p,".set(",c,",",d,")"].join(""))):i=i.replace(u,[p,".get(",c,")"].join("")):i=i.replace(u,[p,"[",c,"]"].join("")):"generic"===n[h]?(r.push(["var ",d,"=",p,".get(",c,")"].join("")),i=i.replace(u,d),s.lvalue&&o.push([p,".set(",c,",",d,")"].join(""))):(r.push(["var ",d,"=",p,"[",c,"]"].join("")),i=i.replace(u,d),s.lvalue&&o.push([p,"[",c,"]=",d].join("")));else{for(var g=[s.name],m=[c],v=0;v<Math.abs(e.arrayBlockIndices[h]);v++)g.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(v+1)+"*t"+h+"b"+v);if(u=new RegExp(g.join(""),"g"),c=m.join("+"),"generic"===n[h])throw new Error("cwise: Generic arrays not supported in combination with blocks!");i=i.replace(u,[p,"[",c,"]"].join(""))}break;case"scalar":i=i.replace(u,"Y"+e.scalarArgs.indexOf(a));break;case"index":i=i.replace(u,"index");break;case"shape":i=i.replace(u,"shape")}}}return[r.join("\n"),i,o.join("\n")].join("\n").trim()}function s(t){for(var e=new Array(t.length),n=!0,i=0;i<t.length;++i){var r=t[i],o=r.match(/\d+/);o=o?o[0]:"",0===r.charAt(0)?e[i]="u"+r.charAt(1)+o:e[i]=r.charAt(0)+o,i>0&&(n=n&&e[i]===e[i-1])}return n?e[0]:e.join("")}function u(t,e){for(var n=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,u=new Array(t.arrayArgs.length),h=new Array(t.arrayArgs.length),l=0;l<t.arrayArgs.length;++l)h[l]=e[2*l],u[l]=e[2*l+1];for(var f=[],d=[],p=[],g=[],m=[],l=0;l<t.arrayArgs.length;++l){t.arrayBlockIndices[l]<0?(p.push(0),g.push(n),f.push(n),d.push(n+t.arrayBlockIndices[l])):(p.push(t.arrayBlockIndices[l]),g.push(t.arrayBlockIndices[l]+n),f.push(0),d.push(t.arrayBlockIndices[l]));for(var v=[],b=0;b<u[l].length;b++)p[l]<=u[l][b]&&u[l][b]<g[l]&&v.push(u[l][b]-p[l]);m.push(v)}for(var y=["SS"],x=["'use strict'"],w=[],b=0;n>b;++b)w.push(["s",b,"=SS[",b,"]"].join(""));for(var l=0;l<t.arrayArgs.length;++l){y.push("a"+l),y.push("t"+l),y.push("p"+l);for(var b=0;n>b;++b)w.push(["t",l,"p",b,"=t",l,"[",p[l]+b,"]"].join(""));for(var b=0;b<Math.abs(t.arrayBlockIndices[l]);++b)w.push(["t",l,"b",b,"=t",l,"[",f[l]+b,"]"].join(""))}for(var l=0;l<t.scalarArgs.length;++l)y.push("Y"+l);if(t.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),t.indexArgs.length>0){for(var _=new Array(n),l=0;n>l;++l)_[l]="0";w.push(["index=[",_.join(","),"]"].join(""))}for(var l=0;l<t.offsetArgs.length;++l){for(var S=t.offsetArgs[l],E=[],b=0;b<S.offset.length;++b)0!==S.offset[b]&&(1===S.offset[b]?E.push(["t",S.array,"p",b].join("")):E.push([S.offset[b],"*t",S.array,"p",b].join("")));0===E.length?w.push("q"+l+"=0"):w.push(["q",l,"=",E.join("+")].join(""))}var T=c([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));w=w.concat(T),x.push("var "+w.join(","));for(var l=0;l<t.arrayArgs.length;++l)x.push("p"+l+"|=0");t.pre.body.length>3&&x.push(a(t.pre,t,h));var A=a(t.body,t,h),C=o(m);n>C?x.push(r(C,m[0],t,A)):x.push(i(m[0],t,A)),t.post.body.length>3&&x.push(a(t.post,t,h)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+x.join("\n")+"\n----------");var P=[t.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",C,s(h)].join(""),I=new Function(["function ",P,"(",y.join(","),"){",x.join("\n"),"} return ",P].join(""));return I()}var c=n(21);t.exports=u},function(t,e){"use strict";function n(t,e){for(var n=1,i=t.length,r=t[0],o=t[0],a=1;i>a;++a)if(o=r,r=t[a],e(r,o)){if(a===n){n++;continue}t[n++]=r}return t.length=n,t}function i(t){for(var e=1,n=t.length,i=t[0],r=t[0],o=1;n>o;++o,r=i)if(r=i,i=t[o],i!==r){if(o===e){e++;continue}t[e++]=i}return t.length=e,t}function r(t,e,r){return 0===t.length?t:e?(r||t.sort(e),n(t,e)):(r||t.sort(),i(t))}t.exports=r},function(t,e,n){(function(t,i){"use strict";function r(t){if(t){var e=t.length||t.byteLength,n=b.log2(e);_[n].push(t)}}function o(t){r(t.buffer)}function a(t){var t=b.nextPow2(t),e=b.log2(t),n=_[e];return n.length>0?n.pop():new ArrayBuffer(t)}function s(t){return new Uint8Array(a(t),0,t)}function u(t){return new Uint16Array(a(2*t),0,t)}function c(t){return new Uint32Array(a(4*t),0,t)}function h(t){return new Int8Array(a(t),0,t)}function l(t){return new Int16Array(a(2*t),0,t)}function f(t){return new Int32Array(a(4*t),0,t)}function d(t){return new Float32Array(a(4*t),0,t)}function p(t){return new Float64Array(a(8*t),0,t)}function g(t){return x?new Uint8ClampedArray(a(t),0,t):s(t)}function m(t){return new DataView(a(t),0,t)}function v(t){t=b.nextPow2(t);var e=b.log2(t),n=S[e];return n.length>0?n.pop():new i(t)}var b=n(27),y=n(28);t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:y([32,0]),UINT16:y([32,0]),UINT32:y([32,0]),INT8:y([32,0]),INT16:y([32,0]),INT32:y([32,0]),FLOAT:y([32,0]),DOUBLE:y([32,0]),DATA:y([32,0]),UINT8C:y([32,0]),BUFFER:y([32,0])});var x="undefined"!=typeof Uint8ClampedArray,w=t.__TYPEDARRAY_POOL;w.UINT8C||(w.UINT8C=y([32,0])),w.BUFFER||(w.BUFFER=y([32,0]));var _=w.DATA,S=w.BUFFER;e.free=function(t){if(i.isBuffer(t))S[b.log2(t.length)].push(t);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(t)&&(t=t.buffer),!t)return;var e=t.length||t.byteLength,n=0|b.log2(e);_[n].push(t)}},e.freeUint8=e.freeUint16=e.freeUint32=e.freeInt8=e.freeInt16=e.freeInt32=e.freeFloat32=e.freeFloat=e.freeFloat64=e.freeDouble=e.freeUint8Clamped=e.freeDataView=o,e.freeArrayBuffer=r,e.freeBuffer=function(t){S[b.log2(t.length)].push(t)},e.malloc=function(t,e){if(void 0===e||"arraybuffer"===e)return a(t);switch(e){case"uint8":return s(t);case"uint16":return u(t);case"uint32":return c(t);case"int8":return h(t);case"int16":return l(t);case"int32":return f(t);case"float":case"float32":return d(t);case"double":case"float64":return p(t);case"uint8_clamped":return g(t);case"buffer":return v(t);case"data":case"dataview":return m(t);default:return null}return null},e.mallocArrayBuffer=a,e.mallocUint8=s,e.mallocUint16=u,e.mallocUint32=c,e.mallocInt8=h,e.mallocInt16=l,e.mallocInt32=f,e.mallocFloat32=e.mallocFloat=d,e.mallocFloat64=e.mallocDouble=p,e.mallocUint8Clamped=g,e.mallocDataView=m,e.mallocBuffer=v,e.clearCache=function(){for(var t=0;32>t;++t)w.UINT8[t].length=0,w.UINT16[t].length=0,w.UINT32[t].length=0,w.INT8[t].length=0,w.INT16[t].length=0,w.INT32[t].length=0,w.FLOAT[t].length=0,w.DOUBLE[t].length=0,w.UINT8C[t].length=0,_[t].length=0,S[t].length=0}}).call(e,function(){return this}(),n(23).Buffer)},function(t,e,n){(function(t){function i(){return t.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function t(e){return this instanceof t?(this.length=0,this.parent=void 0,"number"==typeof e?r(this,e):"string"==typeof e?o(this,e,arguments.length>1?arguments[1]:"utf8"):a(this,e)):arguments.length>1?new t(e,arguments[1]):new t(e)}function r(e,n){if(e=f(e,0>n?0:0|d(n)),!t.TYPED_ARRAY_SUPPORT)for(var i=0;n>i;i++)e[i]=0;return e}function o(t,e,n){("string"!=typeof n||""===n)&&(n="utf8");var i=0|g(e,n);return t=f(t,i),t.write(e,n),t}function a(e,n){if(t.isBuffer(n))return s(e,n);if(X(n))return u(e,n);if(null==n)throw new TypeError("must start with number, buffer, array or string");return"undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer?c(e,n):n.length?h(e,n):l(e,n)}function s(t,e){var n=0|d(e.length);return t=f(t,n),e.copy(t,0,0,n),t}function u(t,e){var n=0|d(e.length);t=f(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function c(t,e){var n=0|d(e.length);t=f(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function h(t,e){var n=0|d(e.length);t=f(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function l(t,e){var n,i=0;"Buffer"===e.type&&X(e.data)&&(n=e.data,i=0|d(n.length)),t=f(t,i);for(var r=0;i>r;r+=1)t[r]=255&n[r];return t}function f(e,n){t.TYPED_ARRAY_SUPPORT?e=t._augment(new Uint8Array(n)):(e.length=n,e._isBuffer=!0);var i=0!==n&&n<=t.poolSize>>>1;return i&&(e.parent=q),e}function d(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function p(e,n){if(!(this instanceof p))return new p(e,n);var i=new t(e,n);return delete i.parent,i}function g(t,e){"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(i)return j(t).length;e=(""+e).toLowerCase(),i=!0}}function m(t,e,n){var i=!1;if(e=0|e,n=void 0===n||n===1/0?this.length:0|n,
t||(t="utf8"),0>e&&(e=0),n>this.length&&(n=this.length),e>=n)return"";for(;;)switch(t){case"hex":return C(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return T(this,e,n);case"binary":return A(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function v(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i),i>r&&(i=r)):i=r;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;i>a;a++){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))throw new Error("Invalid hex string");t[n+a]=s}return a}function b(t,e,n,i){return H(j(e,t.length-n),t,n,i)}function y(t,e,n,i){return H(U(e),t,n,i)}function x(t,e,n,i){return y(t,e,n,i)}function w(t,e,n,i){return H(G(e),t,n,i)}function _(t,e,n,i){return H(z(e,t.length-n),t,n,i)}function S(t,e,n){return 0===e&&n===t.length?V.fromByteArray(t):V.fromByteArray(t.slice(e,n))}function E(t,e,n){var i="",r="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(i+=W(r)+String.fromCharCode(t[o]),r=""):r+="%"+t[o].toString(16);return i+W(r)}function T(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;n>r;r++)i+=String.fromCharCode(127&t[r]);return i}function A(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;n>r;r++)i+=String.fromCharCode(t[r]);return i}function C(t,e,n){var i=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>i)&&(n=i);for(var r="",o=e;n>o;o++)r+=F(t[o]);return r}function P(t,e,n){for(var i=t.slice(e,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function I(t,e,n){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,n,i,r,o,a){if(!t.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(n>o||a>n)throw new RangeError("value is out of bounds");if(i+r>e.length)throw new RangeError("index out of range")}function M(t,e,n,i){0>e&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-n,2);o>r;r++)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function k(t,e,n,i){0>e&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-n,4);o>r;r++)t[n+r]=e>>>8*(i?r:3-r)&255}function O(t,e,n,i,r,o){if(e>r||o>e)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range");if(0>n)throw new RangeError("index out of range")}function D(t,e,n,i,r){return r||O(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),Y.write(t,e,n,i,23,4),n+4}function L(t,e,n,i,r){return r||O(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),Y.write(t,e,n,i,52,8),n+8}function B(t){if(t=N(t).replace(Q,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function N(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function F(t){return 16>t?"0"+t.toString(16):t.toString(16)}function j(t,e){e=e||1/0;for(var n,i=t.length,r=null,o=[],a=0;i>a;a++){if(n=t.charCodeAt(a),n>55295&&57344>n){if(!r){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(e-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(56320>n){(e-=3)>-1&&o.push(239,191,189),r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&((e-=3)>-1&&o.push(239,191,189),r=null);if(128>n){if((e-=1)<0)break;o.push(n)}else if(2048>n){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(65536>n){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(2097152>n))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function z(t,e){for(var n,i,r,o=[],a=0;a<t.length&&!((e-=2)<0);a++)n=t.charCodeAt(a),i=n>>8,r=n%256,o.push(r),o.push(i);return o}function G(t){return V.toByteArray(B(t))}function H(t,e,n,i){for(var r=0;i>r&&!(r+n>=e.length||r>=t.length);r++)e[r+n]=t[r];return r}function W(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var V=n(24),Y=n(25),X=n(26);e.Buffer=t,e.SlowBuffer=p,e.INSPECT_MAX_BYTES=50,t.poolSize=8192;var q={};t.TYPED_ARRAY_SUPPORT=function(){function t(){}try{var e=new ArrayBuffer(0),n=new Uint8Array(e);return n.foo=function(){return 42},n.constructor=t,42===n.foo()&&n.constructor===t&&"function"==typeof n.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(i){return!1}}(),t.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.compare=function(e,n){if(!t.isBuffer(e)||!t.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(e===n)return 0;for(var i=e.length,r=n.length,o=0,a=Math.min(i,r);a>o&&e[o]===n[o];)++o;return o!==a&&(i=e[o],r=n[o]),r>i?-1:i>r?1:0},t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,n){if(!X(e))throw new TypeError("list argument must be an Array of Buffers.");if(0===e.length)return new t(0);if(1===e.length)return e[0];var i;if(void 0===n)for(n=0,i=0;i<e.length;i++)n+=e[i].length;var r=new t(n),o=0;for(i=0;i<e.length;i++){var a=e[i];a.copy(r,o),o+=a.length}return r},t.byteLength=g,t.prototype.length=void 0,t.prototype.parent=void 0,t.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):m.apply(this,arguments)},t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:0===t.compare(this,e)},t.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},t.prototype.compare=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?0:t.compare(this,e)},t.prototype.indexOf=function(e,n){function i(t,e,n){for(var i=-1,r=0;n+r<t.length;r++)if(t[n+r]===e[-1===i?0:r-i]){if(-1===i&&(i=r),r-i+1===e.length)return n+i}else i=-1;return-1}if(n>2147483647?n=2147483647:-2147483648>n&&(n=-2147483648),n>>=0,0===this.length)return-1;if(n>=this.length)return-1;if(0>n&&(n=Math.max(this.length+n,0)),"string"==typeof e)return 0===e.length?-1:String.prototype.indexOf.call(this,e,n);if(t.isBuffer(e))return i(this,e,n);if("number"==typeof e)return t.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,e,n):i(this,[e],n);throw new TypeError("val must be string, number or Buffer")},t.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},t.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},t.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else if(isFinite(e))e=0|e,isFinite(n)?(n=0|n,void 0===i&&(i="utf8")):(i=n,n=void 0);else{var r=i;i=e,e=0|n,n=r}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(0>n||0>e)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return y(this,t,e,n);case"binary":return x(this,t,e,n);case"base64":return w(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},t.prototype.slice=function(e,n){var i=this.length;e=~~e,n=void 0===n?i:~~n,0>e?(e+=i,0>e&&(e=0)):e>i&&(e=i),0>n?(n+=i,0>n&&(n=0)):n>i&&(n=i),e>n&&(n=e);var r;if(t.TYPED_ARRAY_SUPPORT)r=t._augment(this.subarray(e,n));else{var o=n-e;r=new t(o,void 0);for(var a=0;o>a;a++)r[a]=this[a+e]}return r.length&&(r.parent=this.parent||this),r},t.prototype.readUIntLE=function(t,e,n){t=0|t,e=0|e,n||I(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i},t.prototype.readUIntBE=function(t,e,n){t=0|t,e=0|e,n||I(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},t.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},t.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},t.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},t.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},t.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},t.prototype.readIntLE=function(t,e,n){t=0|t,e=0|e,n||I(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*e)),i},t.prototype.readIntBE=function(t,e,n){t=0|t,e=0|e,n||I(t,e,this.length);for(var i=e,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*e)),o},t.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},t.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},t.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},t.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),Y.read(this,t,!0,23,4)},t.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),Y.read(this,t,!1,23,4)},t.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),Y.read(this,t,!0,52,8)},t.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),Y.read(this,t,!1,52,8)},t.prototype.writeUIntLE=function(t,e,n,i){t=+t,e=0|e,n=0|n,i||R(this,t,e,n,Math.pow(2,8*n),0);var r=1,o=0;for(this[e]=255&t;++o<n&&(r*=256);)this[e+o]=t/r&255;return e+n},t.prototype.writeUIntBE=function(t,e,n,i){t=+t,e=0|e,n=0|n,i||R(this,t,e,n,Math.pow(2,8*n),0);var r=n-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+n},t.prototype.writeUInt8=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,1,255,0),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[n]=e,n+1},t.prototype.writeUInt16LE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8):M(this,e,n,!0),n+2},t.prototype.writeUInt16BE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=e):M(this,e,n,!1),n+2},t.prototype.writeUInt32LE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=e):k(this,e,n,!0),n+4},t.prototype.writeUInt32BE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e):k(this,e,n,!1),n+4},t.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=0|e,!i){var r=Math.pow(2,8*n-1);R(this,t,e,n,r-1,-r)}var o=0,a=1,s=0>t?1:0;for(this[e]=255&t;++o<n&&(a*=256);)this[e+o]=(t/a>>0)-s&255;return e+n},t.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=0|e,!i){var r=Math.pow(2,8*n-1);R(this,t,e,n,r-1,-r)}var o=n-1,a=1,s=0>t?1:0;for(this[e+o]=255&t;--o>=0&&(a*=256);)this[e+o]=(t/a>>0)-s&255;return e+n},t.prototype.writeInt8=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,1,127,-128),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[n]=e,n+1},t.prototype.writeInt16LE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8):M(this,e,n,!0),n+2},t.prototype.writeInt16BE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=e):M(this,e,n,!1),n+2},t.prototype.writeInt32LE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,4,2147483647,-2147483648),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24):k(this,e,n,!0),n+4},t.prototype.writeInt32BE=function(e,n,i){return e=+e,n=0|n,i||R(this,e,n,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e):k(this,e,n,!1),n+4},t.prototype.writeFloatLE=function(t,e,n){return D(this,t,e,!0,n)},t.prototype.writeFloatBE=function(t,e,n){return D(this,t,e,!1,n)},t.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},t.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},t.prototype.copy=function(e,n,i,r){if(i||(i=0),r||0===r||(r=this.length),n>=e.length&&(n=e.length),n||(n=0),r>0&&i>r&&(r=i),r===i)return 0;if(0===e.length||0===this.length)return 0;if(0>n)throw new RangeError("targetStart out of bounds");if(0>i||i>=this.length)throw new RangeError("sourceStart out of bounds");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-n<r-i&&(r=e.length-n+i);var o=r-i;if(1e3>o||!t.TYPED_ARRAY_SUPPORT)for(var a=0;o>a;a++)e[a+n]=this[a+i];else e._set(this.subarray(i,i+o),n);return o},t.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),e>n)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>n||n>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof t)for(i=e;n>i;i++)this[i]=t;else{var r=j(t.toString()),o=r.length;for(i=e;n>i;i++)this[i]=r[i%o]}return this}},t.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(t.TYPED_ARRAY_SUPPORT)return new t(this).buffer;for(var e=new Uint8Array(this.length),n=0,i=e.length;i>n;n+=1)e[n]=this[n];return e.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var K=t.prototype;t._augment=function(e){return e.constructor=t,e._isBuffer=!0,e._set=e.set,e.get=K.get,e.set=K.set,e.write=K.write,e.toString=K.toString,e.toLocaleString=K.toString,e.toJSON=K.toJSON,e.equals=K.equals,e.compare=K.compare,e.indexOf=K.indexOf,e.copy=K.copy,e.slice=K.slice,e.readUIntLE=K.readUIntLE,e.readUIntBE=K.readUIntBE,e.readUInt8=K.readUInt8,e.readUInt16LE=K.readUInt16LE,e.readUInt16BE=K.readUInt16BE,e.readUInt32LE=K.readUInt32LE,e.readUInt32BE=K.readUInt32BE,e.readIntLE=K.readIntLE,e.readIntBE=K.readIntBE,e.readInt8=K.readInt8,e.readInt16LE=K.readInt16LE,e.readInt16BE=K.readInt16BE,e.readInt32LE=K.readInt32LE,e.readInt32BE=K.readInt32BE,e.readFloatLE=K.readFloatLE,e.readFloatBE=K.readFloatBE,e.readDoubleLE=K.readDoubleLE,e.readDoubleBE=K.readDoubleBE,e.writeUInt8=K.writeUInt8,e.writeUIntLE=K.writeUIntLE,e.writeUIntBE=K.writeUIntBE,e.writeUInt16LE=K.writeUInt16LE,e.writeUInt16BE=K.writeUInt16BE,e.writeUInt32LE=K.writeUInt32LE,e.writeUInt32BE=K.writeUInt32BE,e.writeIntLE=K.writeIntLE,e.writeIntBE=K.writeIntBE,e.writeInt8=K.writeInt8,e.writeInt16LE=K.writeInt16LE,e.writeInt16BE=K.writeInt16BE,e.writeInt32LE=K.writeInt32LE,e.writeInt32BE=K.writeInt32BE,e.writeFloatLE=K.writeFloatLE,e.writeFloatBE=K.writeFloatBE,e.writeDoubleLE=K.writeDoubleLE,e.writeDoubleBE=K.writeDoubleBE,e.fill=K.fill,e.inspect=K.inspect,e.toArrayBuffer=K.toArrayBuffer,e};var Q=/[^+\/0-9A-z\-]/g}).call(e,n(23).Buffer)},function(t,e,n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===a||e===l?62:e===s||e===f?63:u>e?-1:u+10>e?e-u+26+26:h+26>e?e-h:c+26>e?e-c+26:void 0}function n(t){function n(t){c[l++]=t}var i,r,a,s,u,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=t.length;u="="===t.charAt(h-2)?2:"="===t.charAt(h-1)?1:0,c=new o(3*t.length/4-u),a=u>0?t.length-4:t.length;var l=0;for(i=0,r=0;a>i;i+=4,r+=3)s=e(t.charAt(i))<<18|e(t.charAt(i+1))<<12|e(t.charAt(i+2))<<6|e(t.charAt(i+3)),n((16711680&s)>>16),n((65280&s)>>8),n(255&s);return 2===u?(s=e(t.charAt(i))<<2|e(t.charAt(i+1))>>4,n(255&s)):1===u&&(s=e(t.charAt(i))<<10|e(t.charAt(i+1))<<4|e(t.charAt(i+2))>>2,n(s>>8&255),n(255&s)),c}function r(t){function e(t){return i.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var r,o,a,s=t.length%3,u="";for(r=0,a=t.length-s;a>r;r+=3)o=(t[r]<<16)+(t[r+1]<<8)+t[r+2],u+=n(o);switch(s){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),s="/".charCodeAt(0),u="0".charCodeAt(0),c="a".charCodeAt(0),h="A".charCodeAt(0),l="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=r}(e)},function(t,e){e.read=function(t,e,n,i,r){var o,a,s=8*r-i-1,u=(1<<s)-1,c=u>>1,h=-7,l=n?r-1:0,f=n?-1:1,d=t[e+l];for(l+=f,o=d&(1<<-h)-1,d>>=-h,h+=s;h>0;o=256*o+t[e+l],l+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=i;h>0;a=256*a+t[e+l],l+=f,h-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:(d?-1:1)*(1/0);a+=Math.pow(2,i),o-=c}return(d?-1:1)*a*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var a,s,u,c=8*o-r-1,h=(1<<c)-1,l=h>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,p=i?1:-1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+l>=1?f/u:f*Math.pow(2,1-l),e*u>=2&&(a++,u/=2),a+l>=h?(s=0,a=h):a+l>=1?(s=(e*u-1)*Math.pow(2,r),a+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,r),a=0));r>=8;t[n+d]=255&s,d+=p,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;t[n+d]=255&a,d+=p,a/=256,c-=8);t[n+d-p]|=128*g}},function(t,e){var n=Array.isArray,i=Object.prototype.toString;t.exports=n||function(t){return!!t&&"[object Array]"==i.call(t)}},function(t,e){"use strict";"use restrict";function n(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}var i=32;e.INT_BITS=i,e.INT_MAX=2147483647,e.INT_MIN=-1<<i-1,e.sign=function(t){return(t>0)-(0>t)},e.abs=function(t){var e=t>>i-1;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(e>t)},e.max=function(t,e){return t^(t^e)&-(e>t)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,t>>>=e,n=(t>255)<<3,t>>>=n,e|=n,n=(t>15)<<2,t>>>=n,e|=n,n=(t>3)<<1,t>>>=n,e|=n,e|t>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24},e.countTrailingZeros=n,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,t&=15,27030>>>t&1};var r=new Array(256);!function(t){for(var e=0;256>e;++e){var n=e,i=e,r=7;for(n>>>=1;n;n>>>=1)i<<=1,i|=1&n,--r;t[e]=i<<r&255}}(r),e.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},e.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},e.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),t=65535&(t|t>>>16),t<<16>>16},e.interleave3=function(t,e,n){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),t|n<<2},e.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),t=1023&(t|t>>>16),t<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},function(t,e){"use strict";function n(t,e,i){var r=0|t[i];if(0>=r)return[];var o,a=new Array(r);if(i===t.length-1)for(o=0;r>o;++o)a[o]=e;else for(o=0;r>o;++o)a[o]=n(t,e,i+1);return a}function i(t,e){var n,i;for(n=new Array(t),i=0;t>i;++i)n[i]=e;return n}function r(t,e){switch("undefined"==typeof e&&(e=0),typeof t){case"number":if(t>0)return i(0|t,e);break;case"object":if("number"==typeof t.length)return n(t,e,0)}return[]}t.exports=r},function(t,e,n){function i(t,e){return t[0]-e[0]}function r(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(i);var r=new Array(n.length);for(t=0;t<r.length;++t)r[t]=n[t][1];return r}function o(t,e){var n=["View",e,"d",t].join("");0>e&&(n="View_Nil"+t);var i="generic"===t;if(-1===e){var o="function "+n+"(a){this.data=a;};	var proto="+n+".prototype;	proto.dtype='"+t+"';	proto.index=function(){return -1};	proto.size=0;	proto.dimension=-1;	proto.shape=proto.stride=proto.order=[];	proto.lo=proto.hi=proto.transpose=proto.step=	function(){return new "+n+"(this.data);};	proto.get=proto.set=function(){};	proto.pick=function(){return null};	return function construct_"+n+"(a){return new "+n+"(a);}",a=new Function(o);return a()}if(0===e){var o="function "+n+"(a,d) {	this.data = a;	this.offset = d	};	var proto="+n+".prototype;	proto.dtype='"+t+"';	proto.index=function(){return this.offset};	proto.dimension=0;	proto.size=1;	proto.shape=	proto.stride=	proto.order=[];	proto.lo=	proto.hi=	proto.transpose=	proto.step=function "+n+"_copy() {	return new "+n+"(this.data,this.offset)	};	proto.pick=function "+n+"_pick(){	return TrivialArray(this.data);	};	proto.valueOf=proto.get=function "+n+"_get(){	return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};	proto.set=function "+n+"_set(v){	return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"	};	return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",a=new Function("TrivialArray",o);return a(l[t][0])}var o=["'use strict'"],s=u(e),c=s.map(function(t){return"i"+t}),h="this.offset+"+s.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),f=s.map(function(t){return"b"+t}).join(","),d=s.map(function(t){return"c"+t}).join(",");o.push("function "+n+"(a,"+f+","+d+",d){this.data=a","this.shape=["+f+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){	return "+s.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),4>e?(o.push("function "+n+"_order(){"),2===e?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);	if(s0>s1){	if(s1>s2){	return [2,1,0];	}else if(s0>s2){	return [1,2,0];	}else{	return [1,0,2];	}	}else if(s0>s2){	return [2,0,1];	}else if(s2>s1){	return [0,1,2];	}else{	return [0,2,1];	}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i?o.push("return this.data.set("+h+",v)}"):o.push("return this.data["+h+"]=v}"),o.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i?o.push("return this.data.get("+h+")}"):o.push("return this.data["+h+"]}"),o.push("proto.index=function "+n+"_index(",c.join(),"){return "+h+"}"),o.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+s.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+s.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var p=s.map(function(t){return"a"+t+"=this.shape["+t+"]"}),g=s.map(function(t){return"c"+t+"=this.stride["+t+"]"});o.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+g.join(","));for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){	d=i"+m+"|0;	b+=c"+m+"*d;	a"+m+"-=d}");o.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"c"+t}).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+s.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+s.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'){	d=i"+m+"|0;	if(d<0){	c+=b"+m+"*(a"+m+"-1);	a"+m+"=ceil(-a"+m+"/d)	}else{	a"+m+"=ceil(a"+m+"/d)	}	b"+m+"*=d	}");o.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"b"+t}).join(",")+",c)}");for(var v=new Array(e),b=new Array(e),m=0;e>m;++m)v[m]="a[i"+m+"]",b[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+b.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map(function(t){return"shape["+t+"]"}).join(",")+","+s.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var a=new Function("CTOR_LIST","ORDER",o.join("\n"));return a(l[t],r)}function a(t){if(c(t))return"buffer";if(h)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function s(t,e,n,i){if(void 0===t){var r=l.array[0];return r([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===n){n=new Array(s);for(var u=s-1,c=1;u>=0;--u)n[u]=c,c*=e[u]}if(void 0===i){i=0;for(var u=0;s>u;++u)n[u]<0&&(i-=(e[u]-1)*n[u])}for(var h=a(t),f=l[h];f.length<=s+1;)f.push(o(h,f.length-1));var r=f[s+1];return r(t,e,n,i)}var u=n(30),c=n(31),h="undefined"!=typeof Float64Array,l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=s},function(t,e){"use strict";function n(t){for(var e=new Array(t),n=0;t>n;++n)e[n]=n;return e}t.exports=n},function(t,e){t.exports=function(t){return!(null==t||!t.constructor||"function"!=typeof t.constructor.isBuffer||!t.constructor.isBuffer(t))}},function(t,e,n){var i=n(33).colorToFloat;t.exports=function(t){return i(~~(255*t[0]),~~(255*t[1]),~~(255*t[2]),~~(255*t[3]))}},function(t,e){var n=new Int8Array(4),i=new Int32Array(n.buffer,0,1),r=new Float32Array(n.buffer,0,1),o=function(){};o.intBitsToFloat=function(t){return i[0]=t,r[0]},o.floatToIntBits=function(t){return r[0]=t,i[0]},o.intToFloatColor=function(t){return o.intBitsToFloat(4278190079&t)},o.colorToFloat=function(t,e,n,i){var r=i<<24|n<<16|e<<8|t;return o.intToFloatColor(r)},o.isPowerOfTwo=function(t){return 0===(t&t-1)},o.nextPowerOfTwo=function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1},t.exports=o},function(t,e){function n(t,e){return e&&"number"!=typeof e||(e=[0,0,0,0]),e[0]=t[0]*t[3],e[1]=t[1]*t[3],e[2]=t[2]*t[3],e[3]=t[3],e}t.exports=n},function(t,e,n){function i(t){for(var e=6*t,n=new Uint16Array(e),i=0,r=0;e>i;i+=6,r+=4)n[i+0]=r+0,n[i+1]=r+1,n[i+2]=r+2,n[i+3]=r+0,n[i+4]=r+2,n[i+5]=r+3;return n}var r=n(36),o=n(39);t.exports.floatsPerVertex=5,t.exports.mixins={create:function(e){e=e||{},this.clear(),this.vao&&this.dispose();var n="number"==typeof e.capacity?e.capacity:100;if(n>10922)throw new Error("Can't have more than 10922 quads per batch: "+n);this._capacity=n;var a=4*n*t.exports.floatsPerVertex;this.vertices=new Float32Array(a),this.indices=i(n);var s=this.gl,u=e.dynamic?s.DYNAMIC_DRAW:s.STATIC_DRAW;this.vertexBuffer=o(s,this.vertices,s.ARRAY_BUFFER,u),this.indexBuffer=o(s,this.indices,s.ELEMENT_ARRAY_BUFFER,s.STATIC_DRAW);var c=20;return this.vao=r(s,[{name:"position",buffer:this.vertexBuffer,size:2,stride:c},{name:"texcoord0",buffer:this.vertexBuffer,size:2,offset:8,stride:c},{name:"color",buffer:this.vertexBuffer,size:4,stride:c,offset:16,type:s.UNSIGNED_BYTE,normalized:!0}],this.indexBuffer),this},ensureCapacity:function(t){return this.capacity<t&&this.create({capacity:t}),this}}},function(t,e,n){function i(t,e,n,i){var o=r(t);return o.update(e,n,i),o}var r=n(37);t.exports=i},function(t,e,n){function i(t){this.gl=t,this._elements=null,this._attributes=null,this._elementsType=t.UNSIGNED_SHORT}function r(t){return new i(t)}var o=n(38);i.prototype.bind=function(t){if(!t)throw new Error("must associate shader with vertex array");o(this.gl,this._elements,this._attributes,t)},i.prototype.update=function(t,e,n){this._elements=e,this._attributes=t,this._elementsType=n||this.gl.UNSIGNED_SHORT},i.prototype.dispose=function(){},i.prototype.unbind=function(){o(this.gl)},i.prototype.draw=function(t,e,n){n=n||0;var i=this.gl;this._elements?i.drawElements(t,e,this._elementsType,n):i.drawArrays(t,n,e)},t.exports=r},function(t,e){function n(t,e){if(!t)return null;var n=e.attributes;return n[t]?n[t].location:null}function i(t,e,i,a){if(e?e.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),null===r&&(r=0|t.getParameter(t.MAX_VERTEX_ATTRIBS),o=new Array(r)),i){if(i.length>r)throw new Error("gl-vao: Too many vertex attributes");var s=null;for(m=0;r>m;m++)o[m]=!1;for(m=0;m<i.length;m++){var u=i[m],c=n(u.name,a);if(null!==c)if(o[c]=!0,u.buffer){var h=u.buffer,l=u.size||4,f=u.type||t.FLOAT,d=!!u.normalized,p=u.stride||0,g=u.offset||0;s!==h&&(h.bind(),s=h),t.enableVertexAttribArray(c),t.vertexAttribPointer(c,l,f,d,p,g)}else{if("number"==typeof u)t.vertexAttrib1f(c,u);else if(1===u.length)t.vertexAttrib1f(c,u[0]);else if(2===u.length)t.vertexAttrib2f(c,u[0],u[1]);else if(3===u.length)t.vertexAttrib3f(c,u[0],u[1],u[2]);else{if(4!==u.length)throw new Error("gl-vao: Invalid vertex attribute");t.vertexAttrib4f(c,u[0],u[1],u[2],u[3])}t.disableVertexAttribArray(c)}}for(m=0;r>m;m++)o[m]||t.disableVertexAttribArray(m)}else{t.bindBuffer(t.ARRAY_BUFFER,null);for(var m=0;r>m;++m)t.disableVertexAttribArray(m)}}var r=null,o=null;t.exports=i},function(t,e,n){"use strict";function i(t,e,n,i,r){this.gl=t,this.type=e,this.handle=n,this.length=i,this.usage=r}function r(t,e,n,i,r,o){var a=r.length*r.BYTES_PER_ELEMENT;if(0>o)return t.bufferData(e,r,i),a;if(a+o>n)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return t.bufferSubData(e,o,r),n}function o(t,e){for(var n=u.malloc(t.length,e),i=t.length,r=0;i>r;++r)n[r]=t[r];return n}function a(t,e){for(var n=1,i=e.length-1;i>=0;--i){if(e[i]!==n)return!1;n*=t[i]}return!0}function s(t,e,n,r){if(n=n||t.ARRAY_BUFFER,r=r||t.DYNAMIC_DRAW,n!==t.ARRAY_BUFFER&&n!==t.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(r!==t.DYNAMIC_DRAW&&r!==t.STATIC_DRAW&&r!==t.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var o=t.createBuffer(),a=new i(t,n,o,0,r);return a.update(e),a}var u=n(40),c=n(43),h=n(48),l=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],f=i.prototype;f.bind=function(){this.gl.bindBuffer(this.type,this.handle)},f.unbind=function(){
this.gl.bindBuffer(this.type,null)},f.dispose=function(){this.gl.deleteBuffer(this.handle)},f.update=function(t,e){if("number"!=typeof e&&(e=-1),this.bind(),"object"==typeof t&&"undefined"!=typeof t.shape){var n=t.dtype;if(l.indexOf(n)<0&&(n="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var i=gl.getExtension("OES_element_index_uint");n=i&&"uint16"!==n?"uint32":"uint16"}if(n===t.dtype&&a(t.shape,t.stride))0===t.offset&&t.data.length===t.shape[0]?this.length=r(this.gl,this.type,this.length,this.usage,t.data,e):this.length=r(this.gl,this.type,this.length,this.usage,t.data.subarray(t.offset,t.shape[0]),e);else{var s=u.malloc(t.size,n),f=h(s,t.shape);c.assign(f,t),0>e?this.length=r(this.gl,this.type,this.length,this.usage,s,e):this.length=r(this.gl,this.type,this.length,this.usage,s.subarray(0,t.size),e),u.free(s)}}else if(Array.isArray(t)){var d;d=this.type===this.gl.ELEMENT_ARRAY_BUFFER?o(t,"uint16"):o(t,"float32"),0>e?this.length=r(this.gl,this.type,this.length,this.usage,d,e):this.length=r(this.gl,this.type,this.length,this.usage,d.subarray(0,t.length),e),u.free(d)}else if("object"==typeof t&&"number"==typeof t.length)this.length=r(this.gl,this.type,this.length,this.usage,t,e);else{if("number"!=typeof t&&void 0!==t)throw new Error("gl-buffer: Invalid data type");if(e>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");t=0|t,0>=t&&(t=1),this.gl.bufferData(this.type,0|t,this.usage),this.length=t}},t.exports=s},function(t,e,n){(function(t,i){"use strict";function r(t){if(t){var e=t.length||t.byteLength,n=b.log2(e);_[n].push(t)}}function o(t){r(t.buffer)}function a(t){var t=b.nextPow2(t),e=b.log2(t),n=_[e];return n.length>0?n.pop():new ArrayBuffer(t)}function s(t){return new Uint8Array(a(t),0,t)}function u(t){return new Uint16Array(a(2*t),0,t)}function c(t){return new Uint32Array(a(4*t),0,t)}function h(t){return new Int8Array(a(t),0,t)}function l(t){return new Int16Array(a(2*t),0,t)}function f(t){return new Int32Array(a(4*t),0,t)}function d(t){return new Float32Array(a(4*t),0,t)}function p(t){return new Float64Array(a(8*t),0,t)}function g(t){return x?new Uint8ClampedArray(a(t),0,t):s(t)}function m(t){return new DataView(a(t),0,t)}function v(t){t=b.nextPow2(t);var e=b.log2(t),n=S[e];return n.length>0?n.pop():new i(t)}var b=n(41),y=n(42);t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:y([32,0]),UINT16:y([32,0]),UINT32:y([32,0]),INT8:y([32,0]),INT16:y([32,0]),INT32:y([32,0]),FLOAT:y([32,0]),DOUBLE:y([32,0]),DATA:y([32,0]),UINT8C:y([32,0]),BUFFER:y([32,0])});var x="undefined"!=typeof Uint8ClampedArray,w=t.__TYPEDARRAY_POOL;w.UINT8C||(w.UINT8C=y([32,0])),w.BUFFER||(w.BUFFER=y([32,0]));var _=w.DATA,S=w.BUFFER;e.free=function(t){if(i.isBuffer(t))S[b.log2(t.length)].push(t);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(t)&&(t=t.buffer),!t)return;var e=t.length||t.byteLength,n=0|b.log2(e);_[n].push(t)}},e.freeUint8=e.freeUint16=e.freeUint32=e.freeInt8=e.freeInt16=e.freeInt32=e.freeFloat32=e.freeFloat=e.freeFloat64=e.freeDouble=e.freeUint8Clamped=e.freeDataView=o,e.freeArrayBuffer=r,e.freeBuffer=function(t){S[b.log2(t.length)].push(t)},e.malloc=function(t,e){if(void 0===e||"arraybuffer"===e)return a(t);switch(e){case"uint8":return s(t);case"uint16":return u(t);case"uint32":return c(t);case"int8":return h(t);case"int16":return l(t);case"int32":return f(t);case"float":case"float32":return d(t);case"double":case"float64":return p(t);case"uint8_clamped":return g(t);case"buffer":return v(t);case"data":case"dataview":return m(t);default:return null}return null},e.mallocArrayBuffer=a,e.mallocUint8=s,e.mallocUint16=u,e.mallocUint32=c,e.mallocInt8=h,e.mallocInt16=l,e.mallocInt32=f,e.mallocFloat32=e.mallocFloat=d,e.mallocFloat64=e.mallocDouble=p,e.mallocUint8Clamped=g,e.mallocDataView=m,e.mallocBuffer=v,e.clearCache=function(){for(var t=0;32>t;++t)w.UINT8[t].length=0,w.UINT16[t].length=0,w.UINT32[t].length=0,w.INT8[t].length=0,w.INT16[t].length=0,w.INT32[t].length=0,w.FLOAT[t].length=0,w.DOUBLE[t].length=0,w.UINT8C[t].length=0,_[t].length=0,S[t].length=0}}).call(e,function(){return this}(),n(23).Buffer)},function(t,e){"use strict";"use restrict";function n(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}var i=32;e.INT_BITS=i,e.INT_MAX=2147483647,e.INT_MIN=-1<<i-1,e.sign=function(t){return(t>0)-(0>t)},e.abs=function(t){var e=t>>i-1;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(e>t)},e.max=function(t,e){return t^(t^e)&-(e>t)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,t>>>=e,n=(t>255)<<3,t>>>=n,e|=n,n=(t>15)<<2,t>>>=n,e|=n,n=(t>3)<<1,t>>>=n,e|=n,e|t>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24},e.countTrailingZeros=n,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,t&=15,27030>>>t&1};var r=new Array(256);!function(t){for(var e=0;256>e;++e){var n=e,i=e,r=7;for(n>>>=1;n;n>>>=1)i<<=1,i|=1&n,--r;t[e]=i<<r&255}}(r),e.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},e.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},e.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),t=65535&(t|t>>>16),t<<16>>16},e.interleave3=function(t,e,n){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),t|n<<2},e.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),t=1023&(t|t>>>16),t<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},function(t,e){"use strict";function n(t,e,i){var r=0|t[i];if(0>=r)return[];var o,a=new Array(r);if(i===t.length-1)for(o=0;r>o;++o)a[o]=e;else for(o=0;r>o;++o)a[o]=n(t,e,i+1);return a}function i(t,e){var n,i;for(n=new Array(t),i=0;t>i;++i)n[i]=e;return n}function r(t,e){switch("undefined"==typeof e&&(e=0),typeof t){case"number":if(t>0)return i(0|t,e);break;case"object":if("number"==typeof t.length)return n(t,e,0)}return[]}t.exports=r},function(t,e,n){"use strict";function i(t){if(!t)return s;for(var e=0;e<t.args.length;++e){var n=t.args[e];0===e?t.args[e]={name:n,lvalue:!0,rvalue:!!t.rvalue,count:t.count||1}:t.args[e]={name:n,lvalue:!1,rvalue:!0,count:1}}return t.thisVars||(t.thisVars=[]),t.localVars||(t.localVars=[]),t}function r(t){return a({args:t.args,pre:i(t.pre),body:i(t.body),post:i(t.proc),funcName:t.funcName})}function o(t){for(var e=[],n=0;n<t.args.length;++n)e.push("a"+n);var i=new Function("P",["return function ",t.funcName,"_ndarrayops(",e.join(","),") {P(",e.join(","),");return a0}"].join(""));return i(r(t))}var a=n(44),s={body:"",args:[],thisVars:[],localVars:[]},u={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var t in u){var n=u[t];e[t]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:t+"eq"}),e[t+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:t+"seq"})}}();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var t in c){var n=c[t];e[t]=o({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:t}),e[t+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:t+"eq"})}}();var h={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var t in h){var n=h[t];e[t]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:t+"eq"}),e[t+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:t+"seq"})}}();var l=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var t=0;t<l.length;++t){var n=l[t];e[n]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),e[n+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var f=["max","min","atan2","pow"];!function(){for(var t=0;t<f.length;++t){var n=f[t];e[n]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),e[n+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),e[n+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),e[n+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var d=["atan2","pow"];!function(){for(var t=0;t<d.length;++t){var n=d[t];e[n+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),e[n+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),e[n+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),e[n+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),e.any=a({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),e.all=a({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),e.sum=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),e.prod=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),e.norm2squared=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),e.norm2=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),e.norminf=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),e.norm1=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),e.sup=a({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.inf=a({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.argmin=a({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.argmax=a({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),e.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),e.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),e.equals=a({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},function(t,e,n){"use strict";function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function r(t){var e=new i;e.pre=t.pre,e.body=t.body,e.post=t.post;var n=t.args.slice(0);e.argTypes=n;for(var r=0;r<n.length;++r){var a=n[r];if("array"===a||"object"==typeof a&&a.blockIndices){if(e.argTypes[r]="array",e.arrayArgs.push(r),e.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),e.shimArgs.push("array"+r),r<e.pre.args.length&&e.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array args");if(r<e.post.args.length&&e.post.args[r].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)e.scalarArgs.push(r),e.shimArgs.push("scalar"+r);else if("index"===a){if(e.indexArgs.push(r),r<e.pre.args.length&&e.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array index");if(r<e.body.args.length&&e.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array index");if(r<e.post.args.length&&e.post.args[r].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(e.shapeArgs.push(r),r<e.pre.args.length&&e.pre.args[r].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(r<e.body.args.length&&e.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array shape");if(r<e.post.args.length&&e.post.args[r].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+n[r]);e.argTypes[r]="offset",e.offsetArgs.push({array:a.array,offset:a.offset}),e.offsetArgIndex.push(r)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,o(e)}var o=n(45);t.exports=r},function(t,e,n){"use strict";function i(t){var e=["'use strict'","var CACHED={}"],n=[],i=t.funcName+"_cwise_thunk";e.push(["return function ",i,"(",t.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],u=[],c=[],h=0;h<t.arrayArgs.length;++h){var l=t.arrayArgs[h];n.push(["t",l,"=array",l,".dtype,","r",l,"=array",l,".order"].join("")),o.push("t"+l),o.push("r"+l),a.push("t"+l),a.push("r"+l+".join()"),s.push("array"+l+".data"),s.push("array"+l+".stride"),s.push("array"+l+".offset|0"),h>0&&(u.push("array"+t.arrayArgs[0]+".shape.length===array"+l+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[h]))),c.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+l+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[h])+"]"))}t.arrayArgs.length>1&&(e.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),e.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}"));for(var h=0;h<t.scalarArgs.length;++h)s.push("scalar"+t.scalarArgs[h]);n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),e.push("var "+n.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------");var f=new Function("compile",e.join("\n"));return f(r.bind(void 0,t))}var r=n(46);t.exports=i},function(t,e,n){"use strict";function i(t,e,n){var i,r,o=t.length,a=e.arrayArgs.length,s=e.indexArgs.length>0,u=[],c=[],h=0,l=0;for(i=0;o>i;++i)c.push(["i",i,"=0"].join(""));for(r=0;a>r;++r)for(i=0;o>i;++i)l=h,h=t[i],0===i?c.push(["d",r,"s",i,"=t",r,"p",h].join("")):c.push(["d",r,"s",i,"=(t",r,"p",h,"-s",l,"*t",r,"p",l,")"].join(""));for(u.push("var "+c.join(",")),i=o-1;i>=0;--i)h=t[i],u.push(["for(i",i,"=0;i",i,"<s",h,";++i",i,"){"].join(""));for(u.push(n),i=0;o>i;++i){for(l=h,h=t[i],r=0;a>r;++r)u.push(["p",r,"+=d",r,"s",i].join(""));s&&(i>0&&u.push(["index[",l,"]-=s",l].join("")),u.push(["++index[",h,"]"].join(""))),u.push("}")}return u.join("\n")}function r(t,e,n,r){for(var o=e.length,a=n.arrayArgs.length,s=n.blockSize,u=n.indexArgs.length>0,c=[],h=0;a>h;++h)c.push(["var offset",h,"=p",h].join(""));for(var h=t;o>h;++h)c.push(["for(var j"+h+"=SS[",e[h],"]|0;j",h,">0;){"].join("")),c.push(["if(j",h,"<",s,"){"].join("")),c.push(["s",e[h],"=j",h].join("")),c.push(["j",h,"=0"].join("")),c.push(["}else{s",e[h],"=",s].join("")),c.push(["j",h,"-=",s,"}"].join("")),u&&c.push(["index[",e[h],"]=j",h].join(""));for(var h=0;a>h;++h){for(var l=["offset"+h],f=t;o>f;++f)l.push(["j",f,"*t",h,"p",e[f]].join(""));c.push(["p",h,"=(",l.join("+"),")"].join(""))}c.push(i(e,n,r));for(var h=t;o>h;++h)c.push("}");return c.join("\n")}function o(t){for(var e=0,n=t[0].length;n>e;){for(var i=1;i<t.length;++i)if(t[i][e]!==t[0][e])return e;++e}return e}function a(t,e,n){for(var i=t.body,r=[],o=[],a=0;a<t.args.length;++a){var s=t.args[a];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),c="",h=e.arrayArgs.indexOf(a);switch(e.argTypes[a]){case"offset":var l=e.offsetArgIndex.indexOf(a),f=e.offsetArgs[l];h=f.array,c="+q"+l;case"array":c="p"+h+c;var d="l"+a,p="a"+h;if(0===e.arrayBlockIndices[h])1===s.count?"generic"===n[h]?s.lvalue?(r.push(["var ",d,"=",p,".get(",c,")"].join("")),i=i.replace(u,d),o.push([p,".set(",c,",",d,")"].join(""))):i=i.replace(u,[p,".get(",c,")"].join("")):i=i.replace(u,[p,"[",c,"]"].join("")):"generic"===n[h]?(r.push(["var ",d,"=",p,".get(",c,")"].join("")),i=i.replace(u,d),s.lvalue&&o.push([p,".set(",c,",",d,")"].join(""))):(r.push(["var ",d,"=",p,"[",c,"]"].join("")),i=i.replace(u,d),s.lvalue&&o.push([p,"[",c,"]=",d].join("")));else{for(var g=[s.name],m=[c],v=0;v<Math.abs(e.arrayBlockIndices[h]);v++)g.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(v+1)+"*t"+h+"b"+v);if(u=new RegExp(g.join(""),"g"),c=m.join("+"),"generic"===n[h])throw new Error("cwise: Generic arrays not supported in combination with blocks!");i=i.replace(u,[p,"[",c,"]"].join(""))}break;case"scalar":i=i.replace(u,"Y"+e.scalarArgs.indexOf(a));break;case"index":i=i.replace(u,"index");break;case"shape":i=i.replace(u,"shape")}}}return[r.join("\n"),i,o.join("\n")].join("\n").trim()}function s(t){for(var e=new Array(t.length),n=!0,i=0;i<t.length;++i){var r=t[i],o=r.match(/\d+/);o=o?o[0]:"",0===r.charAt(0)?e[i]="u"+r.charAt(1)+o:e[i]=r.charAt(0)+o,i>0&&(n=n&&e[i]===e[i-1])}return n?e[0]:e.join("")}function u(t,e){for(var n=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,u=new Array(t.arrayArgs.length),h=new Array(t.arrayArgs.length),l=0;l<t.arrayArgs.length;++l)h[l]=e[2*l],u[l]=e[2*l+1];for(var f=[],d=[],p=[],g=[],m=[],l=0;l<t.arrayArgs.length;++l){t.arrayBlockIndices[l]<0?(p.push(0),g.push(n),f.push(n),d.push(n+t.arrayBlockIndices[l])):(p.push(t.arrayBlockIndices[l]),g.push(t.arrayBlockIndices[l]+n),f.push(0),d.push(t.arrayBlockIndices[l]));for(var v=[],b=0;b<u[l].length;b++)p[l]<=u[l][b]&&u[l][b]<g[l]&&v.push(u[l][b]-p[l]);m.push(v)}for(var y=["SS"],x=["'use strict'"],w=[],b=0;n>b;++b)w.push(["s",b,"=SS[",b,"]"].join(""));for(var l=0;l<t.arrayArgs.length;++l){y.push("a"+l),y.push("t"+l),y.push("p"+l);for(var b=0;n>b;++b)w.push(["t",l,"p",b,"=t",l,"[",p[l]+b,"]"].join(""));for(var b=0;b<Math.abs(t.arrayBlockIndices[l]);++b)w.push(["t",l,"b",b,"=t",l,"[",f[l]+b,"]"].join(""))}for(var l=0;l<t.scalarArgs.length;++l)y.push("Y"+l);if(t.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),t.indexArgs.length>0){for(var _=new Array(n),l=0;n>l;++l)_[l]="0";w.push(["index=[",_.join(","),"]"].join(""))}for(var l=0;l<t.offsetArgs.length;++l){for(var S=t.offsetArgs[l],E=[],b=0;b<S.offset.length;++b)0!==S.offset[b]&&(1===S.offset[b]?E.push(["t",S.array,"p",b].join("")):E.push([S.offset[b],"*t",S.array,"p",b].join("")));0===E.length?w.push("q"+l+"=0"):w.push(["q",l,"=",E.join("+")].join(""))}var T=c([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));w=w.concat(T),x.push("var "+w.join(","));for(var l=0;l<t.arrayArgs.length;++l)x.push("p"+l+"|=0");t.pre.body.length>3&&x.push(a(t.pre,t,h));var A=a(t.body,t,h),C=o(m);n>C?x.push(r(C,m[0],t,A)):x.push(i(m[0],t,A)),t.post.body.length>3&&x.push(a(t.post,t,h)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+x.join("\n")+"\n----------");var P=[t.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",C,s(h)].join(""),I=new Function(["function ",P,"(",y.join(","),"){",x.join("\n"),"} return ",P].join(""));return I()}var c=n(47);t.exports=u},function(t,e){"use strict";function n(t,e){for(var n=1,i=t.length,r=t[0],o=t[0],a=1;i>a;++a)if(o=r,r=t[a],e(r,o)){if(a===n){n++;continue}t[n++]=r}return t.length=n,t}function i(t){for(var e=1,n=t.length,i=t[0],r=t[0],o=1;n>o;++o,r=i)if(r=i,i=t[o],i!==r){if(o===e){e++;continue}t[e++]=i}return t.length=e,t}function r(t,e,r){return 0===t.length?t:e?(r||t.sort(e),n(t,e)):(r||t.sort(),i(t))}t.exports=r},function(t,e,n){function i(t,e){return t[0]-e[0]}function r(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(i);var r=new Array(n.length);for(t=0;t<r.length;++t)r[t]=n[t][1];return r}function o(t,e){var n=["View",e,"d",t].join("");0>e&&(n="View_Nil"+t);var i="generic"===t;if(-1===e){var o="function "+n+"(a){this.data=a;};	var proto="+n+".prototype;	proto.dtype='"+t+"';	proto.index=function(){return -1};	proto.size=0;	proto.dimension=-1;	proto.shape=proto.stride=proto.order=[];	proto.lo=proto.hi=proto.transpose=proto.step=	function(){return new "+n+"(this.data);};	proto.get=proto.set=function(){};	proto.pick=function(){return null};	return function construct_"+n+"(a){return new "+n+"(a);}",a=new Function(o);return a()}if(0===e){var o="function "+n+"(a,d) {	this.data = a;	this.offset = d	};	var proto="+n+".prototype;	proto.dtype='"+t+"';	proto.index=function(){return this.offset};	proto.dimension=0;	proto.size=1;	proto.shape=	proto.stride=	proto.order=[];	proto.lo=	proto.hi=	proto.transpose=	proto.step=function "+n+"_copy() {	return new "+n+"(this.data,this.offset)	};	proto.pick=function "+n+"_pick(){	return TrivialArray(this.data);	};	proto.valueOf=proto.get=function "+n+"_get(){	return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};	proto.set=function "+n+"_set(v){	return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"	};	return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",a=new Function("TrivialArray",o);return a(l[t][0])}var o=["'use strict'"],s=u(e),c=s.map(function(t){return"i"+t}),h="this.offset+"+s.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),f=s.map(function(t){return"b"+t}).join(","),d=s.map(function(t){return"c"+t}).join(",");o.push("function "+n+"(a,"+f+","+d+",d){this.data=a","this.shape=["+f+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){	return "+s.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),4>e?(o.push("function "+n+"_order(){"),2===e?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);	if(s0>s1){	if(s1>s2){	return [2,1,0];	}else if(s0>s2){	return [1,2,0];	}else{	return [1,0,2];	}	}else if(s0>s2){	return [2,0,1];	}else if(s2>s1){	return [0,1,2];	}else{	return [0,2,1];	}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i?o.push("return this.data.set("+h+",v)}"):o.push("return this.data["+h+"]=v}"),o.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i?o.push("return this.data.get("+h+")}"):o.push("return this.data["+h+"]}"),o.push("proto.index=function "+n+"_index(",c.join(),"){return "+h+"}"),o.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+s.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+s.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var p=s.map(function(t){return"a"+t+"=this.shape["+t+"]"}),g=s.map(function(t){return"c"+t+"=this.stride["+t+"]"});o.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+g.join(","));for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){	d=i"+m+"|0;	b+=c"+m+"*d;	a"+m+"-=d}");o.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"c"+t}).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+s.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+s.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'){	d=i"+m+"|0;	if(d<0){	c+=b"+m+"*(a"+m+"-1);	a"+m+"=ceil(-a"+m+"/d)	}else{	a"+m+"=ceil(a"+m+"/d)	}	b"+m+"*=d	}");o.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"b"+t}).join(",")+",c)}");for(var v=new Array(e),b=new Array(e),m=0;e>m;++m)v[m]="a[i"+m+"]",b[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+b.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(var m=0;e>m;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map(function(t){return"shape["+t+"]"}).join(",")+","+s.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var a=new Function("CTOR_LIST","ORDER",o.join("\n"));return a(l[t],r)}function a(t){if(c(t))return"buffer";if(h)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function s(t,e,n,i){if(void 0===t){var r=l.array[0];return r([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===n){n=new Array(s);for(var u=s-1,c=1;u>=0;--u)n[u]=c,c*=e[u]}if(void 0===i){i=0;for(var u=0;s>u;++u)n[u]<0&&(i-=(e[u]-1)*n[u])}for(var h=a(t),f=l[h];f.length<=s+1;)f.push(o(h,f.length-1));var r=f[s+1];return r(t,e,n,i)}var u=n(49),c=n(50),h="undefined"!=typeof Float64Array,l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=s},function(t,e){"use strict";function n(t){for(var e=new Array(t),n=0;t>n;++n)e[n]=n;return e}t.exports=n},function(t,e){t.exports=function(t){return!(null==t||!t.constructor||"function"!=typeof t.constructor.isBuffer||!t.constructor.isBuffer(t))}},function(t,e){t.exports.vec2=function(t,e,n){
return t[0]=e,t[1]=n,t},t.exports.vec3=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}},function(t,e){t.exports=function(t,e){return"number"==typeof t?t:"number"==typeof e?e:0}},function(t,e){t.exports=function(t,e,n,i){i||(i=[0,0,1,1]),t=t||[0,0],e=e||[1,1],n=n||e;var r=1/n[0],o=1/n[1],a=t[0],s=t[1],u=e[0],c=e[1];return i[0]=a*r,i[1]=s*o,i[2]=(a+u)*r,i[3]=(s+c)*o,i}},function(t,e,n){t.exports={ortho:n(56),identity:n(5),create:n(57),scale:n(58),rotateZ:n(59),rotateY:n(55),rotateX:n(60),translate:n(61),clone:n(62),multiply:n(63)}},function(t,e){function n(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-c*i,t[1]=a*r-h*i,t[2]=s*r-l*i,t[3]=u*r-f*i,t[8]=o*i+c*r,t[9]=a*i+h*r,t[10]=s*i+l*r,t[11]=u*i+f*r,t}t.exports=n},function(t,e){function n(t,e,n,i,r,o,a){var s=1/(e-n),u=1/(i-r),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*u,t[14]=(a+o)*c,t[15]=1,t}t.exports=n},function(t,e){function n(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}t.exports=n},function(t,e){function n(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}t.exports=n},function(t,e){function n(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],h=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=a*r+h*i,t[2]=s*r+l*i,t[3]=u*r+f*i,t[4]=c*r-o*i,t[5]=h*r-a*i,t[6]=l*r-s*i,t[7]=f*r-u*i,t}t.exports=n},function(t,e){function n(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=a*r+h*i,t[6]=s*r+l*i,t[7]=u*r+f*i,t[8]=c*r-o*i,t[9]=h*r-a*i,t[10]=l*r-s*i,t[11]=f*r-u*i,t}t.exports=n},function(t,e){function n(t,e,n){var i,r,o,a,s,u,c,h,l,f,d,p,g=n[0],m=n[1],v=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*v+e[12],t[13]=e[1]*g+e[5]*m+e[9]*v+e[13],t[14]=e[2]*g+e[6]*m+e[10]*v+e[14],t[15]=e[3]*g+e[7]*m+e[11]*v+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],d=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=l,t[9]=f,t[10]=d,t[11]=p,t[12]=i*g+s*m+l*v+e[12],t[13]=r*g+u*m+f*v+e[13],t[14]=o*g+c*m+d*v+e[14],t[15]=a*g+h*m+p*v+e[15]),t}t.exports=n},function(t,e){function n(t){var e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=n},function(t,e){function n(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],v=e[14],b=e[15],y=n[0],x=n[1],w=n[2],_=n[3];return t[0]=y*i+x*s+w*l+_*g,t[1]=y*r+x*u+w*f+_*m,t[2]=y*o+x*c+w*d+_*v,t[3]=y*a+x*h+w*p+_*b,y=n[4],x=n[5],w=n[6],_=n[7],t[4]=y*i+x*s+w*l+_*g,t[5]=y*r+x*u+w*f+_*m,t[6]=y*o+x*c+w*d+_*v,t[7]=y*a+x*h+w*p+_*b,y=n[8],x=n[9],w=n[10],_=n[11],t[8]=y*i+x*s+w*l+_*g,t[9]=y*r+x*u+w*f+_*m,t[10]=y*o+x*c+w*d+_*v,t[11]=y*a+x*h+w*p+_*b,y=n[12],x=n[13],w=n[14],_=n[15],t[12]=y*i+x*s+w*l+_*g,t[13]=y*r+x*u+w*f+_*m,t[14]=y*o+x*c+w*d+_*v,t[15]=y*a+x*h+w*p+_*b,t}t.exports=n},function(t,e,n){var i=n(54),r=n(51).vec3,o=n(52),a=[0,0,0];t.exports={save:function(){return this.transformStack.push(i.clone(this.transform)),this},restore:function(){if(this.transformStack.length>0){var t=this.transformStack.pop();this.transform=t}return this},scale:function(t,e){return t=o(t,1),e=o(e,1),i.scale(this.transform,this.transform,r(a,t,e,1)),this},translate:function(t,e){return t=t||0,e=e||0,i.translate(this.transform,this.transform,r(a,t,e,0)),this},rotateZ:function(t){return t=t||0,i.rotateZ(this.transform,this.transform,t),this},rotateY:function(t){return t=t||0,i.rotateY(this.transform,this.transform,t),this},rotateX:function(t){return t=t||0,i.rotateX(this.transform,this.transform,t),this},transformMat4:function(t){return i.multiply(this.transform,this.transform,t),this},rotate:function(t){return this.rotateZ(t),this},identity:function(){return i.identity(this.transform),this}}}]);var requirejs,require,define;!function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var n;for(n=0;n<t.length&&(!t[n]||!e(t[n],n,t));n+=1);}}function eachReverse(t,e){if(t){var n;for(n=t.length-1;n>-1&&(!t[n]||!e(t[n],n,t));n-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var n;for(n in t)if(hasProp(t,n)&&e(t[n],n))break}function mixin(t,e,n,i){return e&&eachProp(e,function(e,r){(n||!hasProp(t,r))&&(i&&"string"!=typeof e?(t[r]||(t[r]={}),mixin(t[r],e,n,i)):t[r]=e)}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,n,i){var r=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return r.requireType=t,r.requireModules=i,n&&(r.originalError=n),r}function newContext(t){function e(t){var e,n;for(e=0;t[e];e+=1)if(n=t[e],"."===n)t.splice(e,1),e-=1;else if(".."===n){if(1===e&&(".."===t[2]||".."===t[0]))break;e>0&&(t.splice(e-1,2),e-=2)}}function n(t,n,i){var r,o,a,s,u,c,h,l,f,d,p,g=n&&n.split("/"),m=g,v=S.map,b=v&&v["*"];if(t&&"."===t.charAt(0)&&(n?(m=getOwn(S.pkgs,n)?g=[n]:g.slice(0,g.length-1),t=m.concat(t.split("/")),e(t),o=getOwn(S.pkgs,r=t[0]),t=t.join("/"),o&&t===r+"/"+o.main&&(t=r)):0===t.indexOf("./")&&(t=t.substring(2))),i&&v&&(g||b)){for(s=t.split("/"),u=s.length;u>0;u-=1){if(h=s.slice(0,u).join("/"),g)for(c=g.length;c>0;c-=1)if(a=getOwn(v,g.slice(0,c).join("/")),a&&(a=getOwn(a,h))){l=a,f=u;break}if(l)break;!d&&b&&getOwn(b,h)&&(d=getOwn(b,h),p=u)}!l&&d&&(l=d,f=p),l&&(s.splice(0,f,l),t=s.join("/"))}return t}function i(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===x.contextName?(e.parentNode.removeChild(e),!0):void 0})}function r(t){var e=getOwn(S.paths,t);return e&&isArray(e)&&e.length>1?(e.shift(),x.require.undef(t),x.require([t]),!0):void 0}function o(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function a(t,e,i,r){var a,s,u,c,h=null,l=e?e.name:null,f=t,d=!0,p="";return t||(d=!1,t="_@r"+(R+=1)),c=o(t),h=c[0],t=c[1],h&&(h=n(h,l,r),s=getOwn(P,h)),t&&(h?p=s&&s.normalize?s.normalize(t,function(t){return n(t,l,r)}):n(t,l,r):(p=n(t,l,r),c=o(p),h=c[0],p=c[1],i=!0,a=x.nameToUrl(p))),u=!h||s||i?"":"_unnormalized"+(M+=1),{prefix:h,name:p,parentMap:e,unnormalized:!!u,url:a,originalName:f,isDefine:d,id:(h?h+"!"+p:p)+u}}function s(t){var e=t.id,n=getOwn(E,e);return n||(n=E[e]=new x.Module(t)),n}function u(t,e,n){var i=t.id,r=getOwn(E,i);!hasProp(P,i)||r&&!r.defineEmitComplete?(r=s(t),r.error&&"error"===e?n(r.error):r.on(e,n)):"defined"===e&&n(P[i])}function c(t,e){var n=t.requireModules,i=!1;e?e(t):(each(n,function(e){var n=getOwn(E,e);n&&(n.error=t,n.events.error&&(i=!0,n.emit("error",t)))}),i||req.onError(t))}function h(){globalDefQueue.length&&(apsp.apply(C,[C.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function l(t){delete E[t],delete T[t]}function f(t,e,n){var i=t.map.id;t.error?t.emit("error",t.error):(e[i]=!0,each(t.depMaps,function(i,r){var o=i.id,a=getOwn(E,o);!a||t.depMatched[r]||n[o]||(getOwn(e,o)?(t.defineDep(r,P[o]),t.check()):f(a,e,n))}),n[i]=!0)}function d(){var t,e,n,o,a=1e3*S.waitSeconds,s=a&&x.startTime+a<(new Date).getTime(),u=[],h=[],l=!1,p=!0;if(!b){if(b=!0,eachProp(T,function(n){if(t=n.map,e=t.id,n.enabled&&(t.isDefine||h.push(n),!n.error))if(!n.inited&&s)r(e)?(o=!0,l=!0):(u.push(e),i(e));else if(!n.inited&&n.fetched&&t.isDefine&&(l=!0,!t.prefix))return p=!1}),s&&u.length)return n=makeError("timeout","Load timeout for modules: "+u,null,u),n.contextName=x.contextName,c(n);p&&each(h,function(t){f(t,{},{})}),s&&!o||!l||!isBrowser&&!isWebWorker||_||(_=setTimeout(function(){_=0,d()},50)),b=!1}}function p(t){hasProp(P,t[0])||s(a(t[0],null,!0)).init(t[1],t[2])}function g(t,e,n,i){t.detachEvent&&!isOpera?i&&t.detachEvent(i,e):t.removeEventListener(n,e,!1)}function m(t){var e=t.currentTarget||t.srcElement;return g(e,x.onScriptLoad,"load","onreadystatechange"),g(e,x.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function v(){var t;for(h();C.length;){if(t=C.shift(),null===t[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));p(t)}}var b,y,x,w,_,S={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},E={},T={},A={},C=[],P={},I={},R=1,M=1;return w={require:function(t){return t.require?t.require:t.require=x.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?t.exports:t.exports=P[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){var e,n=getOwn(S.pkgs,t.map.id);return e=n?getOwn(S.config,t.map.id+"/"+n.main):getOwn(S.config,t.map.id),e||{}},exports:P[t.map.id]}}},y=function(t){this.events=getOwn(A,t.id)||{},this.map=t,this.shim=getOwn(S.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(t,e,n,i){i=i||{},this.inited||(this.factory=e,n?this.on("error",n):this.events.error&&(n=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,x.startTime=(new Date).getTime();var t=this.map;return this.shim?void x.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;I[t]||(I[t]=!0,x.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,n=this.map.id,i=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=x.execCb(n,o,i,r)}catch(a){t=a}else r=x.execCb(n,o,i,r);if(this.map.isDefine&&(e=this.module,e&&void 0!==e.exports&&e.exports!==this.exports?r=e.exports:void 0===r&&this.usingExports&&(r=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",c(this.error=t)}else r=o;this.exports=r,this.map.isDefine&&!this.ignore&&(P[n]=r,req.onResourceLoad&&req.onResourceLoad(x,this.map,this.depMaps)),l(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,i=a(t.prefix);this.depMaps.push(i),u(i,"defined",bind(this,function(i){var r,o,h,f=this.map.name,d=this.map.parentMap?this.map.parentMap.name:null,p=x.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(f=i.normalize(f,function(t){return n(t,d,!0)})||""),o=a(t.prefix+"!"+f,this.map.parentMap),u(o,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),h=getOwn(E,o.id),void(h&&(this.depMaps.push(o),this.events.error&&h.on("error",bind(this,function(t){this.emit("error",t)})),h.enable()))):(r=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),r.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(E,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&l(t.map.id)}),c(t)}),r.fromText=bind(this,function(n,i){var o=t.name,u=a(o),h=useInteractive;i&&(n=i),h&&(useInteractive=!1),s(u),hasProp(S.config,e)&&(S.config[o]=S.config[e]);try{req.exec(n)}catch(l){return c(makeError("fromtexteval","fromText eval for "+e+" failed: "+l,l,[e]))}h&&(useInteractive=!0),this.depMaps.push(u),x.completeLoad(o),p([o],r)}),void i.load(t.name,p,r,S))})),x.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){T[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var n,i,r;if("string"==typeof t){if(t=a(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,r=getOwn(w,t.id))return void(this.depExports[e]=r(this));this.depCount+=1,u(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback&&u(t,"error",bind(this,this.errback))}n=t.id,i=E[n],hasProp(w,n)||!i||i.enabled||x.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(E,t.id);e&&!e.enabled&&x.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var n=this.events[t];n||(n=this.events[t]=[]),n.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},x={config:S,contextName:t,registry:E,defined:P,urlFetched:I,defQueue:C,Module:y,makeModuleMap:a,nextTick:req.nextTick,onError:c,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=S.pkgs,n=S.shim,i={paths:!0,config:!0,map:!0};eachProp(t,function(t,e){i[e]?"map"===e?(S.map||(S.map={}),mixin(S[e],t,!0,!0)):mixin(S[e],t,!0):S[e]=t}),t.shim&&(eachProp(t.shim,function(t,e){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=x.makeShimExports(t)),n[e]=t}),S.shim=n),t.packages&&(each(t.packages,function(t){var n;t="string"==typeof t?{name:t}:t,n=t.location,e[t.name]={name:t.name,location:n||t.name,main:(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),S.pkgs=e),eachProp(E,function(t,e){t.inited||t.map.unnormalized||(t.map=a(e))}),(t.deps||t.callback)&&x.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,r){function o(n,i,u){var h,l,f;return r.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?c(makeError("requireargs","Invalid require call"),u):e&&hasProp(w,n)?w[n](E[e.id]):req.get?req.get(x,n,e,o):(l=a(n,e,!1,!0),h=l.id,hasProp(P,h)?P[h]:c(makeError("notloaded",'Module name "'+h+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(v(),x.nextTick(function(){v(),f=s(a(null,e)),f.skipMap=r.skipMap,f.init(n,i,u,{enabled:!0}),d()}),o)}return r=r||{},mixin(o,{isBrowser:isBrowser,toUrl:function(t){var i,r=t.lastIndexOf("."),o=t.split("/")[0],a="."===o||".."===o;return-1!==r&&(!a||r>1)&&(i=t.substring(r,t.length),t=t.substring(0,r)),x.nameToUrl(n(t,e&&e.id,!0),i,!0)},defined:function(t){return hasProp(P,a(t,e,!1,!0).id)},specified:function(t){return t=a(t,e,!1,!0).id,hasProp(P,t)||hasProp(E,t)}}),e||(o.undef=function(t){h();var n=a(t,e,!0),r=getOwn(E,t);i(t),delete P[t],delete I[n.url],delete A[t],r&&(r.events.defined&&(A[t]=r.events),l(t))}),o},enable:function(t){var e=getOwn(E,t.id);e&&s(t).enable()},completeLoad:function(t){var e,n,i,o=getOwn(S.shim,t)||{},a=o.exports;for(h();C.length;){if(n=C.shift(),null===n[0]){if(n[0]=t,e)break;e=!0}else n[0]===t&&(e=!0);p(n)}if(i=getOwn(E,t),!e&&!hasProp(P,t)&&i&&!i.inited){if(!(!S.enforceDefine||a&&getGlobal(a)))return r(t)?void 0:c(makeError("nodefine","No define call for "+t,null,[t]));p([t,o.deps||[],o.exportsFn])}d()},nameToUrl:function(t,e,n){var i,r,o,a,s,u,c,h,l;if(req.jsExtRegExp.test(t))h=t+(e||"");else{for(i=S.paths,r=S.pkgs,s=t.split("/"),u=s.length;u>0;u-=1){if(c=s.slice(0,u).join("/"),o=getOwn(r,c),l=getOwn(i,c)){isArray(l)&&(l=l[0]),s.splice(0,u,l);break}if(o){a=t===o.name?o.location+"/"+o.main:o.location,s.splice(0,u,a);break}}h=s.join("/"),h+=e||(/^data\:|\?/.test(h)||n?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+h}return S.urlArgs?h+((-1===h.indexOf("?")?"?":"&")+S.urlArgs):h},load:function(t,e){req.load(x,t,e)},execCb:function(t,e,n,i){return e.apply(i,n)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=m(t);x.completeLoad(e.id)}},onScriptError:function(t){var e=m(t);return r(e.id)?void 0:c(makeError("scripterror","Script error for: "+e.id,t,[e.id]))}},x.require=x.makeRequire(),x}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,n,i){var r,o,a=defContextName;return isArray(t)||"string"==typeof t||(o=t,isArray(e)?(t=e,e=n,n=i):t=[]),o&&o.context&&(a=o.context),r=getOwn(contexts,a),r||(r=contexts[a]=req.s.newContext(a)),o&&r.configure(o),r.require(t,e,n)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t,e,n){var i=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return i.type=t.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i},req.load=function(t,e,n){var i,r=t&&t.config||{};if(isBrowser)return i=req.createNode(r,e,n),i.setAttribute("data-requirecontext",t.contextName),i.setAttribute("data-requiremodule",e),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",t.onScriptLoad,!1),i.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",t.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),t.completeLoad(e)}catch(o){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+n,o,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(t,e,n){var i,r;"string"!=typeof t&&(n=e,e=t,t=null),isArray(e)||(n=e,e=null),!e&&isFunction(n)&&(e=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,n){e.push(n)}),e=(1===n.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(t||(t=i.getAttribute("data-requiremodule")),r=contexts[i.getAttribute("data-requirecontext")])),(r?r.defQueue:globalDefQueue).push([t,e,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(t,e){"use strict";function n(t){return document.createElement(t)}function i(t,e){for(var n in e)try{t.style[n]=e[n]}catch(i){}return t}function r(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function o(t,e){if("array"!==r(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1}function a(){var t=arguments;for(var e in t[1])if(t[1].hasOwnProperty(e))switch(r(t[1][e])){case"object":t[0][e]=a({},t[0][e],t[1][e]);break;case"array":t[0][e]=t[1][e].slice(0);break;default:t[0][e]=t[1][e]}return t.length>2?a.apply(null,[t[0]].concat(Array.prototype.slice.call(t,2))):t[0]}function s(t,e,n){var i,r,o,a,s,c,h,l,f;return a=.5>=n?n*(1+e):n+e-n*e,0===a?"#000":(s=2*n-a,c=(a-s)/a,t=6*t,h=Math.floor(t),l=t-h,f=a*c*l,0===h||6===h?(i=a,r=s+f,o=s):1===h?(i=a-f,r=a,o=s):2===h?(i=s,r=a,o=s+f):3===h?(i=s,r=a-f,o=a):4===h?(i=s+f,r=s,o=a):(i=a,r=s,o=a-f),"#"+u(i)+u(r)+u(o))}function u(t){return t=Math.round(255*t).toString(16),1===t.length?"0"+t:t}function c(t,e,n,i){t.addEventListener?t[i?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[i?"detachEvent":"attachEvent"]("on"+e,n)}function h(t,u){function v(){for(D=N.history;D--;)Y[D]=0===D?B.fps:Y[D-1],X[D]=0===D?B.duration:X[D-1]}function b(t,e,n,i){return P[0|t][Math.round(Math.min((e-n)/(i-n)*U,U))]}function y(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[p]=q?"FPS":"ms"),O=q?B.fps:B.duration,F.count[p]=O>999?"999+":O.toFixed(O>99?0:N.decimals)}function x(){if(I=l(),V<I-N.threshold&&(B.fps-=B.fps/Math.max(1,60*N.smoothing/N.interval),B.duration=1e3/B.fps),v(),y(),N.heat){if(z.length)for(D=z.length;D--;)z[D].el.style[C[z[D].name].heatOn]=q?b(C[z[D].name].heatmap,B.fps,0,N.maxFps):b(C[z[D].name].heatmap,B.duration,N.threshold,0);if(F.graph&&C.column.heatOn)for(D=j.length;D--;)j[D].style[C.column.heatOn]=q?b(C.column.heatmap,Y[D],0,N.maxFps):b(C.column.heatmap,X[D],N.threshold,0)}if(F.graph)for(L=0;L<N.history;L++)j[L].style.height=(q?Y[L]?Math.round(k/N.maxFps*Math.min(Y[L],N.maxFps)):0:X[L]?Math.round(k/N.threshold*Math.min(X[L],N.threshold)):0)+"px"}function w(){N.interval<20?(R=d(w),x()):(R=setTimeout(w,N.interval),M=d(x))}function _(t){t=t||window.event,t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),B.toggle()}function S(){N.toggleOn&&c(F.container,N.toggleOn,_,1),t.removeChild(F.container)}function E(){if(C=h.theme[N.theme],P=C.compiledHeatmaps||[],!P.length&&C.heatmaps.length){for(L=0;L<C.heatmaps.length;L++)for(P[L]=[],D=0;U>=D;D++)P[L][D]=s(.33/U*D,C.heatmaps[L].saturation,C.heatmaps[L].lightness);C.compiledHeatmaps=P}}function T(){F.container&&S(),E(),F.container=i(n("div"),C.container),F.count=F.container.appendChild(i(n("div"),C.count)),F.legend=F.container.appendChild(i(n("div"),C.legend)),F.graph=N.graph?F.container.appendChild(i(n("div"),C.graph)):0,z.length=0;for(var e in F)F[e]&&C[e].heatOn&&z.push({name:e,el:F[e]});if(j.length=0,F.graph)for(F.graph.style.width=N.history*C.column.width+(N.history-1)*C.column.spacing+"px",D=0;D<N.history;D++)j[D]=F.graph.appendChild(i(n("div"),C.column)),j[D].style.position="absolute",j[D].style.bottom=0,j[D].style.right=D*C.column.width+D*C.column.spacing+"px",j[D].style.width=C.column.width+"px",j[D].style.height="0px";A(),y(),t.appendChild(F.container),F.graph&&(k=F.graph.clientHeight),N.toggleOn&&("click"===N.toggleOn&&(F.container.style.cursor="pointer"),c(F.container,N.toggleOn,_))}function A(){i(F.container,N)}"object"===r(t)&&t.nodeType===e&&(u=t,t=document.body),t||(t=document.body);var C,P,I,R,M,k,O,D,L,B=this,N=a({},h.defaults,u||{}),F={},j=[],U=100,z=[],G=0,H=N.threshold,W=0,V=l()-H,Y=[],X=[],q="fps"===N.show;B.options=N,B.fps=0,B.duration=0,B.isPaused=0,B.tickStart=function(){W=l()},B.tick=function(){I=l(),G=I-V,H+=(G-H)/N.smoothing,B.fps=1e3/H,B.duration=V>W?H:I-W,V=I},B.pause=function(){return R&&(B.isPaused=1,clearTimeout(R),f(R),f(M),R=M=0),B},B.resume=function(){return R||(B.isPaused=0,w()),B},B.set=function(t,e){return N[t]=e,q="fps"===N.show,-1!==o(t,g)&&T(),-1!==o(t,m)&&A(),B},B.showDuration=function(){return B.set("show","ms"),B},B.showFps=function(){return B.set("show","fps"),B},B.toggle=function(){return B.set("show",q?"ms":"fps"),B},B.hide=function(){return B.pause(),F.container.style.display="none",B},B.show=function(){return B.resume(),F.container.style.display="block",B},B.destroy=function(){B.pause(),S(),B.tick=B.tickStart=function(){}},function(){T(),w()}()}var l;!function(){var e=t.performance;if(e&&(e.now||e.webkitNow)){var n=e.now?"now":"webkitNow";l=e[n].bind(e)}else l=function(){return+new Date}}();var f=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,d=t.requestAnimationFrame;!function(){for(var e=["moz","webkit","o"],n=0,i=0,r=e.length;r>i&&!f;++i)f=t[e[i]+"CancelAnimationFrame"]||t[e[i]+"CancelRequestAnimationFrame"],d=f&&t[e[i]+"RequestAnimationFrame"];f||(d=function(e){var i=l(),r=Math.max(0,16-(i-n));return n=i+r,t.setTimeout(function(){e(i+r)},r)},f=function(t){clearTimeout(t)})}();var p="string"===r(document.createElement("div").textContent)?"textContent":"innerText";h.extend=a,window.FPSMeter=h,h.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var g=["toggleOn","theme","heat","graph","history"],m=["position","zIndex","left","top","right","bottom","margin"]}(window),function(t,e,n){"use strict";e.theme={};var i=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter),function(){"use strict";var t=!1,e=[],n=window.requirejs,i=window.require,r=window.define,o={require:i,define:function(){var n=arguments[0];t&&e.push(n),r.apply(this,arguments)},refresh:function(){var t=0;for(t=0;t<e.length;++t)n.undef(e[t])},watch:function(){t=!0}};window.bento=window.bento||o}(),bento.define("audia",[],function(){var t=null;"function"==typeof AudioContext?t=new AudioContext:window.webkitAudioContext&&(t=new webkitAudioContext);var e,n=Boolean(t),i=0,r={},o=function(t){var e=++i;return r[e]=t,e},a=function(t,e,n){return Math.min(Math.max(Number(t),e),n)};if(n){var s={},u=function(e,n){var i=function(t){t.duration!==e._duration&&(e._duration=t.duration,e.dispatchEvent("durationchange")),e.dispatchEvent("canplay"),e.dispatchEvent("canplaythrough"),e.dispatchEvent("load"),e._autoplay&&e.play(),e._onload&&e.onload()};if(n in s)i(s[n]);else{var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.onload=function(){t.decodeAudioData(r.response,function(t){s[n]=t,i(t)})},r.send()}},c=function(e){e.bufferSource=t.createBufferSource(),e.bufferSource.buffer=s[e.src],e.bufferSource.connect(e.gainNode),e.bufferSource.loop=e._loop,e.bufferSource.onended=e._onended},h=t.createGain();h.gain.value=1,h.connect(t.destination),e=function(e){this.id=o(this),this._listenerId=0,this._listeners={},this._autoplay=!1,this._buffered=[],this._currentSrc="",this._currentTime=0,this._defaultPlaybackRate=1,this._duration=NaN,this._loop=!1,this._muted=!1,this._paused=!0,this._playbackRate=1,this._played=[],this._preload="auto",this._seekable=[],this._seeking=!1,this._src="",this._volume=1,this._onended=null,this._onload=null,this.gainNode=t.createGain(),this.gainNode.gain.value=this._volume,this.gainNode.connect(h),void 0!==e&&(this.src=e)},e.prototype.load=function(){this._src&&u(this,this._src)},e.prototype.play=function(){this._paused=!1,c(this),this.bufferSource.start?this.bufferSource.start(0):this.bufferSource.noteOn(0)},e.prototype.pause=function(){this._paused||(this._paused=!0,this.bufferSource.stop?this.bufferSource.stop(0):this.bufferSource.noteOff(0))},e.prototype.stop=function(){this._paused||(this.pause(),this.currentTime=0)},e.prototype.addEventListener=function(t,e){this._listeners[++this._listenerKey]={eventName:t,callback:e}},e.prototype.dispatchEvent=function(t,e){for(var n in this._listeners){var i=this._listeners[n];i.eventName==t&&i.callback&&i.callback.apply(i.callback,e)}},e.prototype.removeEventListener=function(t,e){var n=null;for(var i in this._listeners){var r=this._listeners[i];if(r.eventName===t&&r.callback===e){n=i;break}}null!==n&&delete this._listeners[n]},Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._autoplay},set:function(t){this._autoplay=t}}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._buffered}}),Object.defineProperty(e.prototype,"currentSrc",{get:function(){return this._currentSrc}}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},set:function(t){this._currentTime=t}}),Object.defineProperty(e.prototype,"defaultPlaybackRate",{get:function(){return Number(this._defaultPlaybackRate)},set:function(t){this._defaultPlaybackRate=t}}),Object.defineProperty(e.prototype,"duration",{
get:function(){return this._duration}}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop!==t&&(this._loop=t,this.bufferSource&&(this._paused?(c(this),this.bufferSource.loop=t):(this.pause(),c(this),this.bufferSource.loop=t,this.play())))}}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.gainNode.gain.value=t?0:this._volume}}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t}}),Object.defineProperty(e.prototype,"played",{get:function(){return this._played}}),Object.defineProperty(e.prototype,"preload",{get:function(){return this._preload},set:function(t){this._preload=t}}),Object.defineProperty(e.prototype,"seekable",{get:function(){return this._seekable}}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this._seeking}}),Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(t){this._src=t,u(this,t)}}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){e.preventErrors||a(t,0,1)!==t,0>t&&(t=0),this._volume=t,this._muted||(this.gainNode.gain.value=t,this.dispatchEvent("volumechange"))}}),Object.defineProperty(e.prototype,"onended",{get:function(){return this._onended},set:function(t){this._onended=t}}),Object.defineProperty(e.prototype,"onload",{get:function(){return this._onload},set:function(t){this._onload=t}})}else e=function(t){this.id=o(this),this._audioNode=new Audio,void 0!==t&&(this.src=t)},e.prototype.load=function(t){this._audioNode.load()},e.prototype.play=function(t){void 0!==t&&(this._audioNode.currentTime=t),this._audioNode.play()},e.prototype.pause=function(){this._audioNode.pause()},e.prototype.stop=function(){this._audioNode.pause(),this._audioNode.currentTime=0},e.prototype.addEventListener=function(t,e,n){this._audioNode.addEventListener(t,e,n)},e.prototype.removeEventListener=function(t,e,n){this._audioNode.removeEventListener(t,e,n)},Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._audioNode.autoplay},set:function(t){this._audioNode.autoplay=t}}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._audioNode.buffered}}),Object.defineProperty(e.prototype,"currentSrc",{get:function(){return this._audioNode.src}}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._audioNode.currentTime},set:function(t){this._audioNode.currentTime=t}}),Object.defineProperty(e.prototype,"defaultPlaybackRate",{get:function(){return this._audioNode.defaultPlaybackRate},set:function(t){this._audioNode.defaultPlaybackRate=t}}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._audioNode.duration}}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._audioNode.loop},set:function(t){this._audioNode.currentTime>=this._audioNode.duration&&(this._audioNode.currentTime=0),this._audioNode.loop=t}}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._audioNode.muted},set:function(t){this._audioNode.muted=t}}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._audioNode.paused}}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._audioNode.playbackRate},set:function(t){this._audioNode.playbackRate=t}}),Object.defineProperty(e.prototype,"played",{get:function(){return this._audioNode.played}}),Object.defineProperty(e.prototype,"preload",{get:function(){return this._audioNode.preload},set:function(t){this._audioNode.preload=t}}),Object.defineProperty(e.prototype,"seekable",{get:function(){return this._audioNode.seekable}}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this._audioNode.seeking}}),Object.defineProperty(e.prototype,"src",{get:function(){return this._audioNode.src},set:function(t){var e=this,n=function(){e.onload&&e.onload(),e._audioNode.removeEventListener("canplaythrough",n,!1)};this._audioNode.src=t,this._audioNode.preload="auto",this._audioNode.addEventListener("canplaythrough",n,!1),this._audioNode.addEventListener("error",function(t){console.log("audio load error",e._audioNode.error)},!1),this._audioNode.load()}}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._audioNode.volume},set:function(t){if(e.preventErrors)var t=a(t,0,1);this._audioNode.volume=t}}),Object.defineProperty(e.prototype,"onended",{get:function(){return this._audioNode.onended},set:function(t){this._audioNode.onended=t}}),Object.defineProperty(e.prototype,"onload",{get:function(){return this._audioNode.onload},set:function(t){this._audioNode.onload=t}});e.preventErrors=!0,Object.defineProperty(e,"hasWebAudio",{get:function(){return n}}),Object.defineProperty(e,"audioContext",{get:function(){return t}}),Object.defineProperty(e,"gainNode",{get:function(){return h}}),Object.defineProperty(e,"version",{get:function(){return"0.3.0"}});var l;e.canPlayType=function(t){void 0===l&&(l=new Audio);var t=(null===t.match("/")?"audio/":"")+t;return l.canPlayType(t)},e.prototype.canPlayType=function(t){return e.canPlayType(t)};for(var f=["abort","canplay","canplaythrough","durationchange","emptied","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange"],d=0,p=f.length;p>d;++d)!function(t){var n="_on"+t;e.prototype[n]=null,Object.defineProperty(e.prototype,"on"+t,{get:function(){return this[n]},set:function(e){this[n]&&this.removeEventListener(t,this[n],!1),"function"==typeof e?(this[n]=e,this.addEventListener(t,e,!1)):this[n]=null}})}(f[d]);return e}),bento.define("bento",["bento/utils","bento/lib/domready","bento/managers/asset","bento/managers/input","bento/managers/object","bento/managers/audio","bento/managers/screen","bento/managers/savestate","bento/math/vector2","bento/math/rectangle","bento/renderer"],function(t,e,n,i,r,o,a,s,u,c,h){"use strict";var l,f,d,p=((new Date).getTime(),!0),g=0,m=!1,v={x:1,y:1},b={},y=c(0,0,640,480),x=function(e,n){var i;l=document.getElementById(e.canvasId),l||(i=document.getElementById("wrapper"),i||(i=document.body),l=document.createElement(t.isCocoonJS()?"screencanvas":"canvas"),l.id=e.canvasId,i.appendChild(l)),l.width=y.width,l.height=y.height,g=y.height/y.width,e.renderer=e.renderer||"auto","auto"===e.renderer&&(e.renderer="webgl",(t.isCocoonJS()||t.isAndroid())&&(e.renderer="canvas2d")),h(e.renderer,l,e,function(t){f=t,b={canvas:l,renderer:t,canvasScale:v,viewport:y,entity:null},n()})},w=function(){var t,e,n=window.innerWidth,i=window.innerHeight;m||(d=i/n,g>d?(t=i/g,e=i):(t=n,e=n*g),p?(l.style.width=t+"px",l.style.height=e+"px"):(l.width=t,l.height=e),v.x=t/y.width,v.y=e/y.height)},_={setup:function(s,u){e(function(){var e=function(){_.objects.run(),u&&u()};if(s.canvasDimension){if(!s.canvasDimension.isRectangle)throw"settings.canvasDimension must be a rectangle";y=s.canvasDimension||y}x(s,function(){m=s.manualResize,window.addEventListener("resize",w,!1),window.addEventListener("orientationchange",w,!1),w(),_.input=i(b),_.objects=r(b,s),_.assets=n(),_.audio=o(_),_.screens=a(),t.extend(_,_.objects),s.assetGroups?_.assets.loadAssetGroups(s.assetGroups,e):e()})})},getViewport:function(){return y},getCanvas:function(){return l},getRenderer:function(){return f},getGameData:function(){return{canvas:l,renderer:f,canvasScale:v,viewport:y,entity:null}},assets:null,objects:null,input:null,audio:null,screens:null,saveState:s,utils:t};return _}),bento.define("bento/color",["bento/utils"],function(t){return function(e,n,i,r){return e/=255,e=n/255,e=i/255,t.isDefined(r)||(r=1),[e,n,i,r]}}),bento.define("bento/entity",["bento","bento/utils","bento/math/vector2","bento/math/rectangle"],function(t,e,n,i){"use strict";var r=0;return function(o){var a,s,u=!0,c=n(0,0),h=(n(0,0),n(0,0)),l=i(0,0,0,0),f=[],d=[],p=null,g=++r,m=function(){var t;for(t=f.length-1;t>=0;--t)f[t]||f.splice(t,1)},v={z:0,timer:0,global:!1,"float":!1,updateWhenPaused:!1,name:"",isAdded:!1,useHshg:!1,start:function(t){var e,n,i;for(t&&(t.entity=this),e=0,n=f.length;n>e;++e)i=f[e],i&&i.start&&i.start(t)},destroy:function(t){var e,n,i;for(t&&(t.entity=this),e=0,n=f.length;n>e;++e)i=f[e],i&&i.destroy&&i.destroy(t)},update:function(t){var e,n,i;for(t&&(t.entity=this),e=0,n=f.length;n>e;++e)i=f[e],i&&i.update&&i.update(t);++v.timer,m()},draw:function(t){var e,n,i;if(u){for(t&&(t.entity=this),e=0,n=f.length;n>e;++e)i=f[e],i&&i.draw&&i.draw(t);for(e=f.length-1;e>=0;e--)i=f[e],i&&i.postDraw&&i.postDraw(t)}},addToFamily:function(t){d.push(t)},getFamily:function(){return d},extend:function(t){return e.extend(v,t)},getPosition:function(){return c},setPosition:function(t){c.x=t.x,c.y=t.y},setPositionX:function(t){c.x=t},setPositionY:function(t){c.y=t},getDimension:function(){return l},setDimension:function(t){l=t},getBoundingBox:function(){var t,e,r,o,a,u;return s?(u=s.clone(),t=v.scale?v.scale.getScale():n(1,1),u.x*=Math.abs(t.x),u.y*=Math.abs(t.y),u.width*=Math.abs(t.x),u.height*=Math.abs(t.y),u.x+=c.x,u.y+=c.y,u):(t=v.scale?v.scale.getScale():n(1,1),e=c.x-h.x*t.x,o=c.y-h.y*t.y,r=c.x+(l.width-h.x)*t.x,a=c.y+(l.height-h.y)*t.y,t.x<0&&(r=[e,e=r][0]),t.y<0&&(a=[o,o=a][0]),i(e,o,r-e,a-o))},setBoundingBox:function(t){s=t},getRectangle:function(){return s},setOrigin:function(t){h.x=t.x,h.y=t.y},setOriginRelative:function(t){h.x=t.x*l.width,h.y=t.y*l.height},getOrigin:function(){return h},isVisible:function(){return u},setVisible:function(t){u=t},attached:function(t){var e,n,i;for(t?t.entity=this:t={entity:v},e=0,n=f.length;n>e;++e)if(i=f[e]){if(i.getParent)continue;i.attached&&i.attached(t)}},attach:function(t,n){var i={},r=v;if(f.push(t),t.setParent&&t.setParent(v),t.init&&t.init(),t.attached&&t.attached({entity:v}),v.isAdded)t.start&&t.start();else for(r.getParent&&(r=r.getParent());r;)r.isAdded&&t.start&&t.start(),r=r.getParent();return n&&(i[n]=t,e.extend(v,i)),v},remove:function(t){var e;if(t)return e=f.indexOf(t),e>=0&&(t.destroy&&t.destroy(),f[e]=null),v},getComponents:function(){return f},getComponentByName:function(t){var e,n,i;for(e=0,n=f.length;n>e;++e)if(i=f[e],i.name===t)return i},getComponentIndex:function(t){return f.indexOf(t)},moveComponentTo:function(t,e){var n;t&&(n=f.indexOf(t),n>=0&&(f.splice(n,1),f.splice(e,0,t)))},setParent:function(t){p=t},getParent:function(){return p},getId:function(){return g},collidesWith:function(t,i,r){var o;return e.isDefined(i)||(i=n(0,0)),o=v.getBoundingBox().offset(i).intersect(t.getBoundingBox()),o&&r&&r(t),o},collidesWithGroup:function(t,i,r){var o,a,s;if(e.isDefined(i)||(i=n(0,0)),!e.isArray(t))return void console.log("Collision check must be with an Array of object");if(!t.length)return null;for(s=v.getBoundingBox().offset(i),o=0;o<t.length;++o)if(a=t[o],a!==v&&a.getBoundingBox&&s.intersect(a.getBoundingBox()))return r&&r(a),a;return null},getAABB:function(){var t=v.getBoundingBox();return{min:[t.x,t.y],max:[t.x+t.width,t.y+t.height]}}};if(o){if(o.components)for(e.isArray(o.components)||(o.components=[o.components]),a=0;a<o.components.length;++a)o.components[a](v,o);if(o.position&&v.setPosition(o.position),o.origin&&v.setOrigin(o.origin),o.originRelative&&v.setOriginRelative(o.originRelative),o.name&&(v.name=o.name),o.family)for(e.isArray(o.family)||(o.family=[o.family]),a=0;a<o.family.length;++a)v.addToFamily(o.family[a]);o.init&&o.init.apply(v),v.z=o.z||0,v.updateWhenPaused=o.updateWhenPaused||!1,v.global=o.global||!1,v["float"]=o["float"]||!1,v.useHshg=o.useHshg||!1,v.staticHshg=o.staticHshg||!1,v.onCollide=o.onCollide,o.addNow&&t.objects.add(v)}return v}}),bento.define("bento/eventsystem",["bento/utils"],function(t){var e={},n=[],i=function(){var i,r,o,a,s;for(r=0;r<n.length;r+=1)if(a=n[r].eventName,s=n[r].callback,!t.isUndefined(e[a]))for(o=e[a],i=o.length-1;i>=0;i-=1)if(o[i]===s){o.splice(i,1);break}n=[]},r=function(n,i){t.isUndefined(e[n])&&(e[n]=[]),e[n].push(i)},o=function(t,e){n.push({eventName:t,callback:e})};return{fire:function(n,r){var o,a,s,u;if(i(),t.isString(n)||(n=n.toString()),!t.isUndefined(e[n]))for(s=e[n],o=0,a=s.length;a>o;++o)u=s[o],u?u(r):console.log("Warning: listener is not a function:",u,o)},addEventListener:r,removeEventListener:o,on:r,off:o}}),bento.define("bento/packedimage",["bento/math/rectangle"],function(t){return function(e,n){var i=n?t(n.x,n.y,n.w,n.h):t(0,0,e.width,e.height);return i.image=e,i}}),bento.define("bento/renderer",["bento/utils"],function(t){return function(e,n,i,r){var o={save:function(){},restore:function(){},translate:function(){},scale:function(t,e){},rotate:function(t){},fillRect:function(t,e,n,i,r){},fillCircle:function(t,e,n,i){},strokeRect:function(t,e,n,i,r){},drawImage:function(t,e,n,i,r,o,a,s,u){},begin:function(){},flush:function(){},setColor:function(){},getOpacity:function(){},setOpacity:function(){},createSurface:function(){},setContext:function(){},restoreContext:function(){}};require(["bento/renderers/"+e],function(e){t.extend(o,e(n,i)),r(o)})}}),bento.define("bento/utils",[],function(){"use strict";var t,e=function(t){return"string"==typeof t||t instanceof String},n=Array.prototype.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=function(t){return"[object Object]"===Object.prototype.toString.call(t)},r=function(t){return"[object Function]"===Object.prototype.toString.call(t)},o=function(t){return"[object Number]"===Object.prototype.toString.call(t)},a=function(t){return t===!0||t===!1||"[object Boolean]"===Object.prototype.toString.call(t)},s=function(t){return parseFloat(t)===parseInt(t,10)&&!isNaN(t)},u=function(t){return void 0===t},c=function(t){return void 0!==t},h=function(t,e){var n,i;for(n=0,i=t.length;i>n;n+=1)if(t[n]===e){t.splice(n,1);break}},l=function(t,e,n){var r,o;for(r in e)e.hasOwnProperty(r)&&(t.hasOwnProperty(r)&&!n&&(t.base=t.base||{},o={},o[r]=t[r],l(t.base,o)),i(e[r])?t[r]=l({},e[r]):t[r]=e[r]);return t},f=function(t){return Object.keys(t).length},d=function(){var t=function(t,n){return e(t.slice(),n)},e=function(t,e){"function"!=typeof e&&(e=function(t,e){return String(t).localeCompare(e)});var i=t.length;if(1>=i)return t;for(var r=new Array(i),o=1;i>o;o*=2){n(t,e,o,r);var a=t;t=r,r=a}return t},n=function(t,e,n,i){var r,o,a,s,u,c=t.length,h=0,l=2*n;for(r=0;c>r;r+=l)for(o=r+n,a=o+n,o>c&&(o=c),a>c&&(a=c),s=r,u=o;;)if(o>s&&a>u)e(t[s],t[u])<=0?i[h++]=t[s++]:i[h++]=t[u++];else if(o>s)i[h++]=t[s++];else{if(!(a>u))break;i[h++]=t[u++]}};return t.inplace=function(t,i){var r=e(t,i);return r!==t&&n(r,null,t.length,t),t},t}(),p=function(){var t,e={3:["cancel"],8:["backspace"],9:["tab"],12:["clear"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt","menu"],19:["pause","break"],20:["capslock"],27:["escape","esc"],32:["space","spacebar"],33:["pageup"],34:["pagedown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],41:["select"],42:["printscreen"],43:["execute"],44:["snapshot"],45:["insert","ins"],46:["delete","del"],47:["help"],91:["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"],92:["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"],145:["scrolllock","scroll"],186:["semicolon",";"],187:["equal","equalsign","="],188:["comma",","],189:["dash","-"],190:["period","."],191:["slash","forwardslash","/"],192:["graveaccent","`"],219:["openbracket","["],220:["backslash","\\"],221:["closebracket","]"],222:["apostrophe","'"],48:["zero","0"],49:["one","1"],50:["two","2"],51:["three","3"],52:["four","4"],53:["five","5"],54:["six","6"],55:["seven","7"],56:["eight","8"],57:["nine","9"],96:["numzero","num0"],97:["numone","num1"],98:["numtwo","num2"],99:["numthree","num3"],100:["numfour","num4"],101:["numfive","num5"],102:["numsix","num6"],103:["numseven","num7"],104:["numeight","num8"],105:["numnine","num9"],106:["nummultiply","num*"],107:["numadd","num+"],108:["numenter"],109:["numsubtract","num-"],110:["numdecimal","num."],111:["numdivide","num/"],144:["numlock","num"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"]};for(t=65;90>=t;t+=1)e[t]=String.fromCharCode(t+32);return e}();return t={isString:e,isArray:n,isObject:i,isFunction:r,isNumber:o,isBoolean:a,isInt:s,isUndefined:u,isDefined:c,removeObject:h,extend:l,getKeyLength:f,stableSort:d,keyboardMapping:p,getRandom:function(t){return Math.floor(Math.random()*t)},toRadian:function(t){return t*Math.PI/180},sign:function(t){return t>0?1:0>t?-1:0},approach:function(t,e,n){return e>t?Math.min(t+n,e):Math.max(t-n,e)},isApple:function(){var t=navigator.userAgent.match(/iPhone|iPad|iPod/i);return/iPhone/i.test(t)||/iPad/i.test(t)||/iPod/i.test(t)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isCocoonJS:function(){return navigator.isCocoonJS}}}),bento.define("bento/components/animation",["bento","bento/utils"],function(t,e){"use strict";return function(n,i){var r,o,a,s,u={},c={},h=0,l=1,f=1,d=0,p=0,g=n.getOrigin(),m={name:"animation",setup:function(e){if(o=e?e:{frameCountX:1,frameCountY:1},o.animations||(o.animations={}),o.animations["default"]||(o.animations["default"]={frames:[0]}),e.image)r=e.image;else{if(!e.imageName)return;if(!t.assets)throw"Bento asset manager not loaded";r=t.assets.getImage(e.imageName)}o.frameWidth?(d=o.frameWidth,l=Math.floor(r.width/d)):(l=o.frameCountX||1,d=r.width/l),o.frameHeight?(p=o.frameHeight,f=Math.floor(r.height/p)):(f=o.frameCountY||1,p=r.height/f),n.getDimension().width=d,n.getDimension().height=p,u=o.animations,a=u["default"]},setAnimation:function(t,n,i){var r=u[t];return r?void(r&&a!==r&&(e.isDefined(r.loop)||(r.loop=!0),e.isDefined(r.backTo)||(r.backTo=0),s=n,a=r,a.name=t,i||(h=0))):void console.log("Warning: animation "+t+" does not exist.")},getAnimation:function(){return a?a.name:null},setFrame:function(t){h=t},setCurrentSpeed:function(t){a.speed=t},getCurrentFrame:function(){return h},getFrameWidth:function(){return d},update:function(){var t;if(a){if(t=!1,h+=a.speed||1,a.loop)for(;h>=a.frames.length;)h-=a.frames.length-a.backTo,t=!0;else h>=a.frames.length&&(t=!0);t&&s&&s()}},draw:function(t){var e,n,i;a&&(e=Math.min(Math.floor(h),a.frames.length-1),n=a.frames[e]%l*d,i=Math.floor(a.frames[e]/l)*p,t.renderer.translate(Math.round(-g.x),Math.round(-g.y)),t.renderer.drawImage(r,n,i,d,p,0,0,d,p),t.renderer.translate(Math.round(g.x),Math.round(g.y)))}};return i&&i[m.name]&&m.setup(i[m.name]),n.attach(m),c[m.name]=m,e.extend(n,c),n}}),bento.define("bento/components/clickable",["bento","bento/utils","bento/math/vector2","bento/math/matrix","bento/eventsystem"],function(t,e,n,i,r){"use strict";return function(n,o){var a={},s=!1,u=!1,c={name:"clickable",isHovering:!1,hasTouched:!1,holdId:null,pointerDown:function(t){},pointerUp:function(t){},pointerMove:function(t){},onClick:function(){},onClickUp:function(){},onClickMiss:function(){},onHold:function(){},onHoldLeave:function(){},onHoldEnter:function(){},onHoldEnd:function(){},onHoverLeave:function(){},onHoverEnter:function(){},destroy:function(){r.removeEventListener("pointerDown",l),r.removeEventListener("pointerUp",f),r.removeEventListener("pointerMove",d),u=!1},start:function(){u||(r.addEventListener("pointerDown",l),r.addEventListener("pointerUp",f),r.addEventListener("pointerMove",d),u=!0)},update:function(){this.isHovering&&s&&this.onHold&&this.onHold()}},h=function(t){return{id:t.id,position:t.position.clone(),eventType:t.eventType,localPosition:t.localPosition.clone(),worldPosition:t.worldPosition.clone()}},l=function(e){var i=g(e);t.objects&&t.objects.isPaused()&&!n.updateWhenPaused||(s=!0,c.pointerDown&&c.pointerDown(i),n.getBoundingBox&&p(i,!0))},f=function(e){var i,r=g(e);t.objects&&t.objects.isPaused()&&!n.updateWhenPaused||(i=r.localPosition,s=!1,c.pointerUp&&c.pointerUp(r),n.getBoundingBox().hasPosition(i)&&(c.onClickUp(r),c.hasTouched&&c.holdId===r.id&&(c.holdId=null,c.onHoldEnd(r))),c.hasTouched=!1)},d=function(e){var i=g(e);t.objects&&t.objects.isPaused()&&!n.updateWhenPaused||(c.pointerMove&&c.pointerMove(i),n.getBoundingBox&&p(i))},p=function(t,e){var i=t.localPosition;n.getBoundingBox().hasPosition(i)?(c.hasTouched&&!c.isHovering&&c.holdId===t.id&&c.onHoldEnter(t),c.isHovering||c.onHoverEnter(t),c.isHovering=!0,e&&(c.hasTouched=!0,c.holdId=t.id,c.onClick(t))):(c.hasTouched&&c.isHovering&&c.holdId===t.id&&c.onHoldLeave(t),c.isHovering&&c.onHoverLeave(t),c.isHovering=!1,e&&c.onClickMiss(t))},g=function(t){var e,r,o,a,s,u,c=i(3,3),l=i(3,3),f=i(3,3),d=[];if(!n.getParent||!n.getParent())return n["float"]?t.localPosition=t.position.clone():t.localPosition=t.worldPosition.clone(),t;for(t=h(t),e=n["float"]?t.localPosition.toMatrix():t.worldPosition.toMatrix(),s=n;s.getParent&&s.getParent();)s=s.getParent(),d.unshift(s);for(u=0;u<d.length;++u)s=d[u],s.getPosition&&(a=s.getPosition(),c.set(2,0,-a.x),c.set(2,1,-a.y),e.multiplyWith(c)),s.rotation&&(r=Math.sin(-s.rotation.getAngleRadian()),o=Math.cos(-s.rotation.getAngleRadian()),f.set(0,0,o),f.set(1,0,-r),f.set(0,1,r),f.set(1,1,o),e.multiplyWith(f)),s.scale&&(l.set(0,0,1/s.scale.getScale().x),l.set(1,1,1/s.scale.getScale().y),e.multiplyWith(l));return t.localPosition.x=e.get(0,0),t.localPosition.y=e.get(0,1),t};return o&&o[c.name]&&(o=o[c.name],e.extend(c,o)),n.attach(c),a[c.name]=c,e.extend(n,a),n}}),bento.define("bento/components/fill",["bento/utils","bento"],function(t,e){"use strict";return function(n,i){var r=e.getViewport(),o={},a=[0,0,0,1],s={name:"fill",draw:function(t){t.renderer.fillRect(a,0,0,r.width,r.height)},setup:function(t){a=t.color}};return i&&i[s.name]&&s.setup(i[s.name]),n.attach(s),o[s.name]=s,t.extend(n,o),n}}),bento.define("bento/components/opacity",["bento/utils","bento/math/vector2"],function(t,e){"use strict";return function(e){var n=1,i=!1,r=1,o={},a={name:"opacity",draw:function(t){i&&(r=t.renderer.getOpacity(),t.renderer.setOpacity(n))},postDraw:function(t){t.renderer.setOpacity(r)},setOpacity:function(t){i=!0,n=t},getOpacity:function(){return n}};return e.attach(a),o[a.name]=a,t.extend(e,o),e}}),bento.define("bento/components/pixi",["bento","bento/utils"],function(t,e){"use strict";return window.PIXI?function(n,i){var r,o,a,s,u,c,h,l={},f={},d=0,p=1,g=1,m=0,v=0,b=t.getViewport(),y={name:"pixi",setup:function(e){var i;if(s=e?e:{frameCountX:1,frameCountY:1},s.animations||(s.animations={}),s.animations["default"]||(s.animations["default"]={frames:[0]}),e.image)c=e.image;else{if(!e.imageName)return;if(!t.assets)throw"Bento asset manager not loaded";c=t.assets.getImage(e.imageName)}s.frameWidth?(m=s.frameWidth,p=Math.floor(c.width/m)):(p=s.frameCountX||1,m=c.width/p),s.frameHeight?(v=s.frameHeight,g=Math.floor(c.height/v)):(g=s.frameCountY||1,v=c.height/g),n.getDimension().width=m,n.getDimension().height=v,l=s.animations,u=l["default"],r=new PIXI.BaseTexture(c.image,PIXI.SCALE_MODES.NEAREST),i=new PIXI.Rectangle(c.x,c.y,m,v),o=new PIXI.Texture(r,i),a=new PIXI.Sprite(o)},update:function(){var t;if(u){if(t=!1,d+=u.speed||1,u.loop)for(;d>=u.frames.length;)d-=u.frames.length-u.backTo,t=!0;else d>=u.frames.length&&(t=!0);t&&h&&h(),a.visible=n.isVisible()}},draw:function(t){var e,i,r,s,h,l,f=n.getOrigin(),g=n.getPosition();u&&(s=Math.min(Math.floor(d),u.frames.length-1),h=u.frames[s]%p*m,l=Math.floor(u.frames[s]/p)*v,r=new PIXI.Rectangle(c.x+h,c.y+l,m,v),o.frame=r,a.x=g.x,a.y=g.y,a.anchor.x=f.x/m,a.anchor.y=f.y/v,n["float"]&&(a.x-=b.x,a.y-=b.y),n.scale&&(i=n.scale.getScale(),a.scale.x=i.x,a.scale.y=i.y),n.rotation&&(e=n.rotation.getAngleRadian(),a.rotation=e),n.opacity&&(a.alpha=n.opacity.getOpacity()))},destroy:function(t){a&&a.parent&&a.parent.removeChild(a)},start:function(t){return a?void 0:void console.log("call setup first")},attached:function(t){var e,n;t.renderer?t.renderer.addChild(a):t.entity&&(e=t.entity.getParent(),e&&(n=e.getComponentByName("pixi"),n&&n.getPixiSprite().addChild(a)))},getPixiSprite:function(){return a},setAnimation:function(t,n,i){var r=l[t];return r?void(r&&u!==r&&(e.isDefined(r.loop)||(r.loop=!0),e.isDefined(r.backTo)||(r.backTo=0),h=n,u=r,u.name=t,i||(d=0))):void console.log("Warning: animation "+t+" does not exist.")},getAnimation:function(){return u?u.name:null},setFrame:function(t){d=t},setCurrentSpeed:function(t){u.speed=t},getCurrentFrame:function(){return d},getFrameWidth:function(){return m}};return i&&i[y.name]&&y.setup(i[y.name]),n.attach(y),f[y.name]=y,e.extend(n,f),n}:(console.log("Warning: PIXI is not available"),function(){})}),bento.define("bento/components/rotation",["bento/utils"],function(t){"use strict";return function(e){var n,i={},r={name:"rotation",draw:function(t){n&&t.renderer.rotate(n)},postDraw:function(t){},addAngleDegree:function(t){n||(n=0),n+=t*Math.PI/180},addAngleRadian:function(t){n||(n=0),n+=t},setAngleDegree:function(t){n=t*Math.PI/180},setAngleRadian:function(t){n=t},getAngleDegree:function(){return n?180*n/Math.PI:0},getAngleRadian:function(){return n?n:0}};return e.attach(r),i[r.name]=r,t.extend(e,i),e}}),bento.define("bento/components/scale",["bento/utils","bento/math/vector2"],function(t,e){"use strict";return function(n){var i=!1,r=e(1,1),o={},a={name:"scale",draw:function(t){i&&t.renderer.scale(r.x,r.y)},setScale:function(t){i=!0,r=t},getScale:function(){return r},setScaleX:function(t){i=!0,r.x=t},setScaleY:function(t){i=!0,r.y=t}};return n.attach(a),o[a.name]=a,t.extend(n,o),n}}),bento.define("bento/components/sprite",["bento","bento/utils","bento/components/translation","bento/components/rotation","bento/components/scale","bento/components/opacity","bento/components/animation","bento/components/pixi"],function(t,e,n,i,r,o,a,s){"use strict";var u;return function(s,c){return u||(u=t.getRenderer()),n(s,c),r(s,c),i(s,c),o(s,c),c.sprite&&(c.animation=c.sprite),a(s,c),s.sprite=s.animation,e.extend(s.sprite,s.scale),e.extend(s.sprite,s.rotation),e.extend(s.sprite,s.opacity),s}}),bento.define("bento/components/translation",["bento/utils","bento/math/vector2"],function(t,e){"use strict";return function(e){var n={},i=!1,r={name:"translation",setSubPixel:function(t){i=t},draw:function(t){var n=e.getParent(),r=e.getPosition(),o=(e.getOrigin(),t.viewport);t.renderer.save(e),i?t.renderer.translate(r.x,r.y):t.renderer.translate(Math.round(r.x),Math.round(r.y)),null!==n||e["float"]||t.renderer.translate(Math.round(-o.x),Math.round(-o.y))},postDraw:function(t){t.renderer.restore()}};return e.attach(r),n[r.name]=r,t.extend(e,n),e}}),bento.define("bento/autoresize",["bento/utils"],function(t){return function(t,e,n,i){var r=t.clone(),o=window.innerWidth,a=window.innerHeight,s=i?o:a,u=i?a:o,c=function(){temp=t.width,t.width=t.height,t.height=temp},h=function(){var o,a=2,h=t.height,l=s/u,f=t.height/t.width;for(1>l?(f=l,o=s):(f=u/s,o=u),h=o,o*=window.devicePixelRatio||1,console.log(o);h>n;)if(h=Math.floor(o/a),a+=1,e>h){h=i?r.height:r.width;break}return t.width=h/f,t.height=h,i||c(),t},l=function(){window.scrollTo(0,0)};return window.addEventListener("orientationchange",l,!1),i||c(),h()}}),bento.define("bento/screen",["bento/utils","bento","bento/math/rectangle","bento/tiled"],function(t,e,n,i){"use strict";return function(n){var r,o=e.getViewport(),a=n&&n.dimension?n.dimension:o.clone(),s={name:null,setDimension:function(t){a.width=t.width,a.height=t.height},getDimension:function(){return a},extend:function(e){return t.extend(this,e)},loadTiled:function(t){r=i({name:t,spawn:!0}),this.setDimension(r.dimension)},onShow:function(t){n&&(n.tiled&&this.loadTiled(n.tiled),n.onShow&&n.onShow(t))},onHide:function(t){e.removeAll(),o.x=0,o.y=0,n.onHide&&n.onHide(t)}};return s}}),define("bento/tiled",["bento","bento/entity","bento/math/vector2","bento/math/rectangle","bento/math/polygon","bento/packedimage","bento/utils"],function(t,e,n,i,r,o,a){"use strict";return function(n,s){var u,c,h,l,f,d,p=t.assets.getJson(n.name),g=p.width,m=p.height,v=p.layers.length,b=p.tilewidth,y=p.tileheight,x=document.createElement("canvas"),w=x.getContext("2d"),_=[],S=[],E=t.getViewport(),T=e().extend({z:0,draw:function(t){var e=Math.max(Math.min(x.width-E.x,E.width),0),n=Math.max(Math.min(x.height-E.y,E.height),0),i=o(x);0!==e&&0!==n&&t.renderer.drawImage(i,~~Math.max(Math.min(E.x,x.width),0),~~Math.max(Math.min(E.y,x.height),0),~~e,~~n,0,0,~~e,~~n)}}),A=function(t){var e,n,i=null;for(e=0;e<p.tilesets.length;++e)n=p.tilesets[e],n.firstgid<=t&&(i=n);return i},C=function(e,n){var i,r,o;return null===e?null:(i=n-e.firstgid,r=Math.floor(e.imagewidth/e.tilewidth),o=Math.floor(e.imageheight/e.tileheight),{subimage:t.assets.getImage(e.name),x:i%r*e.tilewidth,y:Math.floor(i/r)*e.tileheight,width:e.tilewidth,height:e.tileheight})},P=function(t,e){var n=l.data[e*g+t],i=A(n),r=C(i,n);r&&w.drawImage(r.subimage.image,r.subimage.x+r.x,r.subimage.y+r.y,r.width,r.height,t*b,e*y,b,y)},I=function(e,i,r){var o=i.x,s=i.y,u={};a.extend(u,r),a.extend(u,i.properties),require([e],function(e){var i=e.apply(this,[u]),r=i.getOrigin(),a=i.getDimension();i.setPosition({x:o+r.x,y:s+(r.y-a.height)}),n.spawn&&t.objects.add(i),_.push(i)})},R=function(t){var e,n,i=t.gid,r=A(i),o=i-r.firstgid;r.tileproperties&&(e=r.tileproperties[o.toString()],e&&(n=e.module)),n&&I(n,t,e)},M=function(i,r){var o;n.spawn&&(o=e({z:0,name:r,family:[r],useHshg:!0,staticHshg:!0}).extend({update:function(){},draw:function(){}}),o.setBoundingBox(i),t.objects.add(o)),i.type=r,S.push(i)};for(x.width=g*b,x.height=m*y,h=0;v>h;++h)if(l=p.layers[h],"tilelayer"===l.type)for(c=0;c<l.height;++c)for(u=0;u<l.width;++u)P(u,c);else if("objectgroup"===l.type)for(u=0;u<l.objects.length;++u)if(f=l.objects[u],""===f.type&&(f.type="solid"),f.gid)R(f);else if(f.polygon){for(d=[],c=0;c<f.polygon.length;++c)d.push({x:f.polygon[c].x+f.x,y:f.polygon[c].y+f.y+1});M(r(d),f.type)}else M(i(f.x,f.y,f.width,f.height),f.type);return n.spawn&&t.objects.add(T),{tileLayer:T,objects:_,shapes:S,dimension:i(0,0,b*g,y*m)}}}),bento.define("bento/tween",["bento","bento/utils","bento/entity"],function(t,e,n){"use strict";var i={easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return 0===t?e:n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return t===i?e+n:n*(-Math.pow(2,-10*t/i)+1)+e},easeInOutExpo:function(t,e,n,i){return 0===t?e:t===i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(-Math.pow(2,-10*--t)+2)+e},easeInCirc:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,i){var r=1.70158,o=0,a=n;return 0===t?e:1===(t/=i)?e+n:(o||(o=.3*i),a<Math.abs(n)?(a=n,r=o/4):r=o/(2*Math.PI)*Math.asin(n/a),-(a*Math.pow(2,10*(t-=1))*Math.sin((t*i-r)*(2*Math.PI)/o))+e)},easeOutElastic:function(t,e,n,i){var r=1.70158,o=0,a=n;return 0===t?e:1===(t/=i)?e+n:(o||(o=.3*i),a<Math.abs(n)?(a=n,r=o/4):r=o/(2*Math.PI)*Math.asin(n/a),
a*Math.pow(2,-10*t)*Math.sin((t*i-r)*(2*Math.PI)/o)+n+e)},easeInOutElastic:function(t,e,n,i){var r=1.70158,o=0,a=n;return 0===t?e:2===(t/=i/2)?e+n:(o||(o=i*(.3*1.5)),a<Math.abs(n)?(a=n,r=o/4):r=o/(2*Math.PI)*Math.asin(n/a),1>t?-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*i-r)*(2*Math.PI)/o))+e:a*Math.pow(2,-10*(t-=1))*Math.sin((t*i-r)*(2*Math.PI)/o)*.5+n+e)},easeInBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*(t/=i)*t*((r+1)*t-r)+e},easeOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},easeInOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),(t/=i/2)<1?n/2*(t*t*(((r*=1.525)+1)*t-r))+e:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e},easeInBounce:function(t,e,n,i){return n-this.easeOutBounce(i-t,0,n,i)+e},easeOutBounce:function(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,i){return i/2>t?.5*this.easeInBounce(2*t,0,n,i)+e:.5*this.easeOutBounce(2*t-i,0,n,i)+.5*n+e}},r={linear:function(t,e,n,i,r){return(e-t)*n+t},quadratic:function(t,e,n,i,r){return(e-t)*n*n+t},squareroot:function(t,e,n,i,r){return(e-t)*Math.pow(n,.5)+t},cubic:function(t,e,n,i,r){return(e-t)*n*n*n+t},cuberoot:function(t,e,n,i,r){return(e-t)*Math.pow(n,1/3)+t},exponential:function(t,e,n,i,r){return(e-t)/(Math.exp(i)-1)*Math.exp(i*n)+t-(e-t)/(Math.exp(i)-1)},elastic:function(t,e,n,i,r){return(e-t)/(Math.exp(i)-1)*Math.cos(r*n*2*Math.PI)*Math.exp(i*n)+t-(e-t)/(Math.exp(i)-1)},sin:function(t,e,n,i,r){return t+e*Math.sin(i*n*2*Math.PI)},cos:function(t,e,n,i,r){return t+e*Math.cos(i*n*2*Math.PI)}},o=function(t,e,n,o,a,s){var u=r[t];return u?u(e,n,o,a,s):i[t](o,e,n-e,1)};return function(i){var r=0,a=!1,s=!0,u=n(i).extend({id:i.id,update:function(n){s&&(++r,i["do"]&&i["do"].apply(this,[o(i.ease||"linear",i.from||0,e.isDefined(i.to)?i.to:1,r/i["in"],e.isDefined(i.alpha)?i.alpha:1,e.isDefined(i.beta)?i.beta:1),r]),!i.stay&&r>=i["in"]&&(i.onComplete&&i.onComplete.apply(this),t.objects.remove(u),a=!1))},begin:function(){return r=0,a||(t.objects.add(u),a=!0),s=!0,u},stop:function(){return r=0,s=!1,u}});return 0===i["in"]&&(i["in"]=1),u.begin(),u}}),bento.define("bento/math/array2d",function(){"use strict";return function(t,e){var n,i,r=[];for(n=0;t>n;++n)for(r[n]=[],i=0;e>i;++i)r[n][i]=null;return{isArray2d:function(){return!0},iterate:function(n){var i,o;for(o=0;e>o;++o)for(i=0;t>i;++i)n(i,o,r[i][o])},get:function(t,e){return r[t][e]},set:function(t,e,n){r[t][e]=n}}}}),bento.define("bento/math/matrix",["bento/utils"],function(t){"use strict";var e=function(t){var e=this.clone();return e.addTo(t),e},n=function(t,e){var n=this.clone();return n.multiplyWith(other),n},i=function(r,o){var a,s,u=[],c=r||0,h=o||0,l=function(t,e,n){u[e*c+t]=n},f=function(t,e){return u[e*c+t]};for(s=0;h>s;++s)for(a=0;c>a;++a)a===s?l(a,s,1):l(a,s,0);return{isMatrix:function(){return!0},stringify:function(){var t,e,n="",i="";for(e=0;h>e;++e){for(t=0;c>t;++t)i+=f(t,e)+"	";n+=i+"\n",i=""}return n},get:function(t,e){return f(t,e)},set:function(t,e,n){l(t,e,n)},setValues:function(t){var e,n=Math.min(u.length,t.length);for(e=0;n>e;++e)u[e]=t[e];return this},getWidth:function(){return c},getHeight:function(){return h},iterate:function(e){var n,i;for(i=0;h>i;++i)for(n=0;c>n;++n){if(!t.isFunction(e))throw"Please supply a callback function";e(n,i,f(n,i))}},transpose:function(){var t,e,n=[];for(t=0;c>t;++t)for(e=0;h>e;++e)n[t*h+e]=f(t,e);return u=n,h=[c,c=h][0],this},addTo:function(t){var e,n;if(h!=t.getHeight()||c!=t.getWidth())throw"Matrix sizes incorrect";for(n=0;h>n;++n)for(e=0;c>e;++e)l(e,n,f(e,n)+t.get(e,n));return this},add:e,multiplyWith:function(t){var e,n,i,r=[],o=c,a=h,s=t.getHeight(),l=t.getWidth(),d=0;if(a!=l)throw"Matrix sizes incorrect";for(n=0;s>n;++n)for(e=0;o>e;++e){for(d=0,i=0;l>i;++i)d+=t.get(i,n)*f(e,i);r[n*o+e]=d}return u=r,c=o,h=s,this},multiply:n,clone:function(){var t=i(c,h);return t.setValues(u),t}}};return i}),bento.define("bento/math/polygon",["bento/utils","bento/math/rectangle"],function(t,e){"use strict";var n=function(){return!0},i=function(){for(var t=[],e=this.points,n=e.length;n--;)t[n]=e[n];return u(t)},r=function(t){for(var e=[],n=this.points,i=n.length;i--;)e[i]=n[i],e[i].x+=t.x,e[i].y+=t.y;return u(e)},o=function(t,e,n,i){var r,o,a=function(t,e){return t.x*e.y-t.y*e.x},s=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},u=s(e,t),c=s(i,n),h=a(s(n,t),u),l=a(u,c);return 0===h&&0===l?n.x-t.x<0!=n.x-e.x<0!=i.x-t.x<0!=i.x-e.x<0||n.y-t.y<0!=n.y-e.y<0!=i.y-t.y<0!=i.y-e.y<0:0===l?!1:(r=h/l,o=a(s(n,t),c)/l,o>=0&&1>=o&&r>=0&&1>=r)},a=function(t){var e,n,i,r,a,s,c=[],h=this.points;if(t.isRectangle){if(!this.getBoundingBox().intersect(t))return!1;c.push({x:t.x,y:t.y}),c.push({x:t.getX2(),y:t.y}),c.push({x:t.getX2(),y:t.getY2()}),c.push({x:t.x,y:t.getY2()}),t=u(c)}else{if(!this.getBoundingBox().intersect(t.getBoundingBox()))return!1;c=t.points}for(a=0;a<h.length;++a)for(s=0;s<c.length;++s)if(e=h[a],n=h[(a+1)%h.length],i=c[s],r=c[(s+1)%c.length],o(e,n,i,r))return!0;return this.hasPosition(c[0])||t.hasPosition(h[0])?!0:!1},s=function(t){var e=this.points,n=!1,i=0,r=e.length-1,o=this.getBoundingBox();if(t.x<o.x||t.x>o.x+o.width||t.y<o.y||t.y>o.y+o.height)return!1;for(r;i<e.length;r=i++)e[i].y>t.y!=e[r].y>t.y&&t.x<(e[r].x-e[i].x)*(t.y-e[i].y)/(e[r].y-e[i].y)+e[i].x&&(n=!n);return n},u=function(t){var o,u=t[0].x,c=t[0].x,h=t[0].y,l=t[0].y,f=1;for(f=1;f<t.length;++f)o=t[f],u=Math.min(o.x,u),c=Math.max(o.x,c),h=Math.min(o.y,h),l=Math.max(o.y,l);return{x:u,y:h,width:c-u,height:l-h,points:t,isPolygon:n,getBoundingBox:function(){return e(u,h,c-u,l-h)},hasPosition:s,intersect:a,offset:r,clone:i}};return u}),bento.define("bento/math/rectangle",["bento/utils"],function(t){"use strict";var e=function(){return!0},n=function(){return this.x+this.width},i=function(){return this.y+this.height},r=function(t){var e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.getX2(),t.getX2()),r=Math.max(this.getY2(),t.getY2());return l(e,n,i-e,r-n)},o=function(t){return t.isPolygon?t.intersect(this):!(this.x+this.width<=t.x||this.y+this.height<=t.y||this.x>=t.x+t.width||this.y>=t.y+t.height)},a=function(t){var e=l(0,0,0,0);return this.intersect(t)&&(e.x=Math.max(this.x,t.x),e.y=Math.max(this.y,t.y),e.width=Math.min(this.x+this.width,t.x+t.width)-e.x,e.height=Math.min(this.y+this.height,t.y+t.height)-e.y),e},s=function(t){return l(this.x+t.x,this.y+t.y,this.width,this.height)},u=function(){return l(this.x,this.y,this.width,this.height)},c=function(t){return!(t.x<this.x||t.y<this.y||t.x>=this.x+this.width||t.y>=this.y+this.height)},h=function(t){this.x-=t/2,this.y-=t/2,this.width+=t,this.height+=t},l=function(t,l,f,d){return{x:t,y:l,width:f,height:d,isRectangle:e,getX2:n,getY2:i,union:r,intersect:o,intersection:a,offset:s,clone:u,hasPosition:c,grow:h}};return l}),bento.define("bento/math/vector2",["bento/math/matrix"],function(t){"use strict";var e=function(){return!0},n=function(t){var e=this.clone();return e.addTo(t),e},i=function(t){return this.x+=t.x,this.y+=t.y,this},r=function(t){var e=this.clone();return e.substractFrom(t),e},o=function(t){return this.x-=t.x,this.y-=t.y,this},a=function(){return Math.atan2(this.y,this.x)},s=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},u=function(t){return this.x*t.x+this.y*t.y},c=function(t){var e=this.clone();return e.multiplyWith(t),e},h=function(t){return this.x*=t.x,this.y*=t.y,this},l=function(t){var e=this.clone();return e.divideBy(t),e},f=function(t){return this.x/=t.x,this.y/=t.y,this},d=function(t){var e=this.clone();return e.scalarMultiplyWith(t),e},p=function(t){return this.x*=t,this.y*=t,this},g=function(t){return this.x*=t,this.y*=t,this},m=function(){return Math.sqrt(this.dotProduct(this))},v=function(){var t=this.length();return this.x/=t,this.y/=t,this},b=function(t){return t.substract(this).length()},y=function(t){var e=this.x*Math.cos(t)-this.y*Math.sin(t),n=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=e,this.y=n,this},x=function(t){return this.rotateRadian(t*Math.PI/180)},w=function(){return S(this.x,this.y)},_=function(){var e=t(1,3);return e.set(0,0,this.x),e.set(0,1,this.y),e.set(0,2,1),e},S=function(t,S){return{x:t,y:S,isVector2:e,add:n,addTo:i,substract:r,substractFrom:o,angle:a,angleBetween:s,dotProduct:u,multiply:c,multiplyWith:h,divide:l,divideBy:f,scalarMultiply:d,scalarMultiplyWith:p,scale:g,length:m,normalize:v,distance:b,rotateRadian:y,rotateDegree:x,clone:w,toMatrix:_}};return S}),bento.define("bento/managers/asset",["bento/packedimage","bento/utils","audia"],function(t,e,n){"use strict";return function(){var i={},r="",o={audio:{},json:{},images:{},binary:{}},a={},s=[],u=function(t,i,o){var a,s,u,c=!0;if(e.isArray(i))for(s=0;s<i.length;s+=1)i[s]=r+"audio/"+i[s];else i=[r+"audio/"+i];for(s=0;s<i.length;++s)if(a=new n,u=a.canPlayType("audio/"+i[s].slice(-3))){a.onload=function(){o(null,t,a)},a.src=i[s],c=!1;break}c&&o("This audio type is not supported:",t,i)},c=function(t,e,n){var i=new XMLHttpRequest;i.overrideMimeType&&i.overrideMimeType("application/json"),i.open("GET",e,!0),i.onerror=function(){n("Error "+e)},i.ontimeout=function(){n("Timeout"+e)},i.onreadystatechange=function(){4===i.readyState&&(304===i.status||200===i.status||0===i.status&&i.responseText?n(null,t,JSON.parse(i.responseText)):n("Error: State "+i.readyState+" "+e))},i.send(null)},h=function(t,e,n){var i=new Image;i.src=e,i.addEventListener("load",function(){n(null,t,i)},!1)},l=function(t,n,r){var o,a=e.getKeyLength(t),s=0,u=function(t,o,u){return t?void console.log(t):(i[o]=u,s+=1,e.isDefined(r)&&r(s,a),void(a===s&&e.isDefined(n)&&n(null)))};for(o in t)t.hasOwnProperty(o)&&c(o,t[o],u)},f=function(t,n,a){var l,f=i[t],d=0,p=0,g=[],m=function(){d===p&&e.isDefined(n)&&(y(),n(null))},v=function(t,n,i){return t?void console.log(t):(o.images[n]=i,d+=1,e.isDefined(a)&&a(d,p),void m())},b=function(t,n,i){return t?void console.log(t):(o.json[n]=i,s.push(n),d+=1,e.isDefined(a)&&a(d,p),void m())},x=function(t,n,i){return t?void console.log(t):(o.json[n]=i,d+=1,e.isDefined(a)&&a(d,p),void m())},w=function(t,n,i){return t?void console.log(t):(o.audio[n]=i,d+=1,e.isDefined(a)&&a(d,p),void m())},_=function(t,e,n,i){g.push({fn:t,asset:e,path:n,callback:i})},S=function(){var t,e=0;for(e=0;e<g.length;++e)t=g[e],t.fn(t.asset,t.path,t.callback)};if(!e.isDefined(f))return void n("Could not find asset group "+t);if(e.isDefined(f.path)&&(r=f.path),e.isDefined(f.images)){p+=e.getKeyLength(f.images);for(l in f.images)f.images.hasOwnProperty(l)&&_(h,l,r+"images/"+f.images[l],v)}if(e.isDefined(f.texturePacker)){p+=e.getKeyLength(f.texturePacker);for(l in f.texturePacker)f.texturePacker.hasOwnProperty(l)&&_(c,l,r+"json/"+f.texturePacker[l],b)}if(e.isDefined(f.audio)){p+=e.getKeyLength(f.audio);for(l in f.audio)f.audio.hasOwnProperty(l)&&_(u,l,f.audio[l],w)}if(e.isDefined(f.json)){p+=e.getKeyLength(f.json);for(l in f.json)f.json.hasOwnProperty(l)&&_(c,l,r+"json/"+f.json[l],x)}S()},d=function(t){},p=function(e){var n,i=a[e];if(!i){if(n=g(e),!n)throw"Can not find "+e;i=t(n),a[e]=i}return i},g=function(t){var n=o.images[t];if(!e.isDefined(n))throw"Asset "+t+" could not be found";return n},m=function(t){var n=o.json[t];if(!e.isDefined(n))throw"Asset "+t+" could not be found";return n},v=function(t){var n=o.audio[t];if(!e.isDefined(n))throw"Asset "+t+" could not be found";return n},b=function(){return o},y=function(){for(var e,n,i,r,o;s.length;)for(n=s.pop(),r=g(n),o=m(n),i=0;i<o.frames.length;++i)name=o.frames[i].filename,name=name.substring(0,name.length-4),e=o.frames[i].frame,a[name]=t(r,e)};return{loadAssetGroups:l,load:f,unload:d,getImage:p,getImageElement:g,getJson:m,getAudio:v,getAssets:b}}}),define("bento/managers/audio",["bento/utils"],function(t){return function(e){var n,i,r=!1,o=!1,a=!1,s=!1,u="",c=0,h=e.assets,l=(e.getCanvas(),function(t){t?(n=r,i=o,f.muteMusic(!0),f.muteSound(!0)):(r=n,o=i,f.playMusic(u,s))}),f={setVolume:function(t,e){h.getAudio(e).volume=t},playSound:function(e,n,i){var o=h.getAudio(e);r||a||(t.isDefined(n)&&(o.loop=n),t.isDefined(i)&&(o.onended=i),o.play())},stopSound:function(t){h.getAudio(t).stop()},playMusic:function(e,n,i,r){var a;u=e,s=t.isDefined(n)?n:!0,o||""===u||(a=h.getAudio(e),i&&(a.onended=i),a.loop=s,a.play(r||0))},stopMusic:function(t){h.getAudio(t).stop()},muteSound:function(t){r=t,r&&this.stopAllSound()},muteMusic:function(e,n){var i=u;o=e,t.isDefined(n)||(n=!1),o?(f.stopAllMusic(),u=i):n&&""!==u&&f.playMusic(u,s)},stopAllSound:function(){var t,e=h.getAssets().audio;for(t in e)e.hasOwnProperty(t)&&"sfx"===t.substring(0,3)&&e[t].stop()},stopAllMusic:function(){var t,e=h.getAssets().audio;for(t in e)e.hasOwnProperty(t)&&"bgm"===t.substring(0,3)&&e[t].stop(t===u?c:void 0);u=""},preventSounds:function(t){a=t}};return"hidden"in document?document.addEventListener("visibilitychange",function(){l(document.hidden)},!1):"mozHidden"in document?document.addEventListener("mozvisibilitychange",function(){l(document.mozHidden)},!1):"webkitHidden"in document?document.addEventListener("webkitvisibilitychange",function(){l(document.webkitHidden)},!1):"msHidden"in document?document.addEventListener("msvisibilitychange",function(){l(document.msHidden)},!1):"onpagehide"in window?(window.addEventListener("pagehide",function(){l(!0)},!1),window.addEventListener("pageshow",function(){l(!1)},!1)):"onblur"in document?(window.addEventListener("blur",function(){l(!0)},!1),window.addEventListener("focus",function(){l(!1)},!1),visHandled=!0):"onfocusout"in document&&(window.addEventListener("focusout",function(){l(!0)},!1),window.addEventListener("focusin",function(){l(!1)},!1)),f}}),bento.define("bento/managers/input",["bento/utils","bento/math/vector2","bento/eventsystem"],function(t,e,n){"use strict";return function(i){var r,o,a,s=!1,u=[],c={},h=0,l=0,f=function(t){u.push({id:t.id,position:t.position,eventType:t.eventType,localPosition:t.localPosition,worldPosition:t.worldPosition}),n.fire("pointerDown",t)},d=function(t){n.fire("pointerMove",t),S(t)},p=function(t){n.fire("pointerUp",t),E(t)},g=function(t){var e;for(t.preventDefault(),e=0;e<t.changedTouches.length;e+=1)w(t,e,"start"),f(t)},m=function(t){var e;for(t.preventDefault(),e=0;e<t.changedTouches.length;e+=1)w(t,e,"move"),d(t)},v=function(t){var e;for(t.preventDefault(),e=0;e<t.changedTouches.length;e+=1)w(t,e,"end"),p(t)},b=function(t){t.preventDefault(),_(t),f(t)},y=function(t){t.preventDefault(),_(t),d(t)},x=function(t){t.preventDefault(),_(t),p(t)},w=function(t,n,i){var r=t.changedTouches[n],s=(r.pageX-h)/o.x,u=(r.pageY-l)/o.y;t.preventDefault(),t.id=0,t.eventType="touch",t.changedTouches[n].position=e(s,u),t.changedTouches[n].worldPosition=t.changedTouches[n].position.clone(),t.changedTouches[n].worldPosition.x+=a.x,t.changedTouches[n].worldPosition.y+=a.y,t.changedTouches[n].localPosition=t.changedTouches[n].position.clone(),t.position=t.changedTouches[n].position.clone(),t.worldPosition=t.changedTouches[n].worldPosition.clone(),t.localPosition=t.changedTouches[n].position.clone(),t.id=t.changedTouches[n].identifier+1},_=function(t){var n=(t.pageX-h)/o.x,i=(t.pageY-l)/o.y;t.id=0,t.eventType="mouse",t.position=e(n,i),t.worldPosition=t.position.clone(),t.worldPosition.x+=a.x,t.worldPosition.y+=a.y,t.localPosition=t.position.clone(),t.id=-1},S=function(t){var e=0;for(e=0;e<u.length;e+=1)if(u[e].id===t.id)return u[e].position=t.position,u[e].worldPosition=t.worldPosition,void(u[e].localPosition=t.position)},E=function(t){var e=0;for(e=0;e<u.length;e+=1)if(u[e].id===t.id)return void u.splice(e,1)},T=function(){r.addEventListener("touchstart",g),document.body.addEventListener("touchmove",m),document.body.addEventListener("touchend",v),r.addEventListener("mousedown",b),document.body.addEventListener("mousemove",y),document.body.addEventListener("mouseup",x),s=!0,document.body.addEventListener("touchstart",function(t){return t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),!1}),document.body.addEventListener("touchmove",function(t){return t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),!1})},A=function(){var t=i.canvas||window,e=function(e){t.focus&&t.focus()};t.tabIndex=0,t.focus&&t.focus(),t.addEventListener("keydown",C,!1),t.addEventListener("keyup",P,!1),t.addEventListener("mousedown",e,!1)},C=function(e){var i,r;for(e.preventDefault(),n.fire("keyDown",e),r=t.keyboardMapping[e.keyCode],i=0;i<r.length;++i)c[r[i]]=!0,n.fire("buttonDown",r[i])},P=function(e){var i,r;for(e.preventDefault(),n.fire("keyUp",e),r=t.keyboardMapping[e.keyCode],i=0;i<r.length;++i)c[r[i]]=!1,n.fire("buttonUp",r[i])},I=function(){h=r.offsetLeft,l=r.offsetTop};if(window.addEventListener("resize",I,!1),window.addEventListener("orientationchange",I,!1),!i)throw"Supply a settings object";return o=i.canvasScale,r=i.canvas,a=i.viewport,r&&!t.isCocoonJS()&&(h=r.offsetLeft,l=r.offsetTop),T(),A(),{getPointers:function(){return u},resetPointers:function(){u.length=0},isKeyDown:function(t){return c[t]||!1},stop:function(){s&&(r.removeEventListener("touchstart",g),document.body.removeEventListener("touchmove",m),document.body.removeEventListener("touchend",v),r.removeEventListener("mousedown",b),document.body.removeEventListener("mousemove",y),document.body.removeEventListener("mouseup",x),s=!1)},resume:function(){s||(r.addEventListener("touchstart",g),document.body.addEventListener("touchmove",m),document.body.addEventListener("touchend",v),r.addEventListener("mousedown",b),document.body.addEventListener("mousemove",y),document.body.addEventListener("mouseup",x),s=!0)}}}}),bento.define("bento/managers/object",["hshg","bento/utils"],function(t,e){"use strict";return function(n,i){var r,o,a=[],s=(new Date).getTime(),u=0,c=30,h=(new Date).getTime(),l={},f=!1,d=!0,p=!1,g=new t,m=function(){i.defaultSort?a.sort(function(t,e){return t.z-e.z}):e.stableSort.inplace(a,function(t,e){return t.z-e.z})},v=function(){var t;for(t=a.length-1;t>=0;--t)null===a[t]&&a.splice(t,1)},b=function(t){var e=(new Date).getTime(),n=e-s;if(f){for(i.debug&&o&&o.tickStart(),s=e,u+=n,r.deltaT=n,i.useDeltaT&&(u=1e3/60);u>=1e3/60;){if(u-=1e3/60,u>1e3/c)for(;u>=1e3/60;)u-=1e3/60;i.useDeltaT&&(u=0),y()}v(),d&&m(),x(),h=t,i.debug&&o&&o.tick(),requestAnimationFrame(b)}},y=function(){var t,e;for(p||(g.update(),g.queryForCollisionPairs()),e=0;e<a.length;++e)t=a[e],t&&t.update&&(p&&t.updateWhenPaused||!p)&&t.update(r)},x=function(){var t,e;for(r.renderer.begin(),e=0;e<a.length;++e)t=a[e],t&&t.draw&&t.draw(r);r.renderer.flush()},w=function(t){var e,n,i;if(t.z=t.z||0,a.push(t),t.init&&t.init(),t.start&&t.start(r),t.attached&&t.attached(r),t.isAdded=!0,t.useHshg&&t.getAABB&&g.addObject(t),t.getFamily)for(i=t.getFamily(),e=0;e<i.length;++e)n=i[e],l[n]||(l[n]=[]),l[n].push(t)},_={attach:w,add:w,remove:function(t){var n,i,o,s;if(t&&(o=a.indexOf(t),o>=0&&(a[o]=null,t.destroy&&t.destroy(r),t.isAdded=!1),t.useHshg&&t.getAABB&&g.removeObject(t),t.getFamily))for(s=t.getFamily(),n=0;n<s.length;++n)i=s[n],e.removeObject(l[i],t)},removeAll:function(t){var e,n;for(e=0;e<a.length;++e)n=a[e],n&&(!n.global||t)&&_.remove(n)},get:function(t,e){var n,i;for(n=0;n<a.length;++n)if(i=a[n],i&&i.name&&i.name===t)return e&&e(i),i;return null},getByName:function(t,e){var n,i,r=[];for(n=0;n<a.length;++n)i=a[n],i&&i.name&&i.name===t&&r.push(i);return e&&r.length&&e(r),r},getByFamily:function(t,e){var n=l[t];return n||(l[t]=[],n=l[t],console.log("Warning: family called "+t+" does not exist")),e&&n.length&&e(n),n},stop:function(){f=!1},run:function(){f||(f=!0,b())},count:function(){return a.length},pause:function(){p=!0},resume:function(){p=!1},isPaused:function(){return p},draw:function(){x()}};return window.performance||(window.performance={now:Date.now}),r=n,i.debug&&e.isDefined(window.FPSMeter)&&(FPSMeter.defaults.graph=1,o=new FPSMeter),_}}),bento.define("bento/managers/savestate",["bento/utils"],function(t){"use strict";var e,n=document.URL,i={setItem:function(t,e){var n,r=0;i[t]=e;for(n in i)i.hasOwnProperty(n)&&++r;this.length=r},getItem:function(e){var n=i[e];return t.isDefined(n)?n:null},removeItem:function(t){delete i[t]},clear:function(){this.length=0},length:0};try{if(e=window.localStorage,!window.localStorage)throw"No local storage available";window.localStorage.setItem(n+"save","0")}catch(r){console.log("Warning: you have disabled cookies on your browser. You cannot save progress in your game."),e=i}return{save:function(t,i){"string"!=typeof t&&(t=JSON.stringify(t)),e.setItem(n+t,JSON.stringify(i))},load:function(t,i){var r;return r=e.getItem(n+t),null===r?i:JSON.parse(r)},remove:function(t){e.removeItem(n+t)},clear:function(){e.clear()},debug:function(){console.log(localStorage)},isEmpty:function(){return 0===e.length},setId:function(t){n=t}}}),bento.define("bento/managers/screen",["bento/utils"],function(t){"use strict";return function(){var t={},e=null,n={add:function(e){if(!e.name)throw"Add name property to screen";t[e.name]=e},show:function(i,r,o){null!==e&&n.hide(),e=t[i],e?(e.onShow&&e.onShow(r),o&&o()):bento.require([i],function(t){t.name||(t.name=i),n.add(t),n.show(i,r,o)})},hide:function(t){e&&(e.onHide(t),e=null)},getCurrentScreen:function(){return e},reset:function(){t={}}};return n}}),bento.define("bento/lib/domready",[],function(){"use strict";function t(t){var e;for(e=0;e<t.length;e+=1)t[e](c)}function e(){var e=h;u&&e.length&&(h=[],t(e))}function n(){u||(u=!0,a&&clearInterval(a),e())}function i(t){return u?t(c):h.push(t),i}var r,o,a,s="undefined"!=typeof window&&window.document,u=!s,c=s?document:null,h=[];if(s){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),o=document.createElement("div");try{r=null===window.frameElement}catch(l){}o.doScroll&&r&&window.external&&(a=setInterval(function(){try{o.doScroll(),n()}catch(t){}},30))}"complete"===document.readyState&&n()}return i.version="2.0.1",i.load=function(t,e,n,r){r.isBuild?n(null):i(n)},i}),bento.define("hshg",[],function(){function t(){var t,e,n,i,r,o;for(t=0;t<this._globalObjects.length;t++)e=this._globalObjects[t],i=e.HSHG,n=i.grid,r=e.getAABB(),o=n.toHash(r.min[0],r.min[1]),o!==i.hash&&(n.removeObject(e),n.addObject(e,o))}function e(){}function n(t,e){var n=t.getAABB(),i=e.getAABB();return n.min[0]>i.max[0]||n.min[1]>i.max[1]||n.max[0]<i.min[0]||n.max[1]<i.min[1]?!1:!0}function i(t,e){return Math.max(Math.abs(e[0]-t[0]),Math.abs(e[1]-t[1]))}function r(){this.MAX_OBJECT_CELL_DENSITY=1/8,this.INITIAL_GRID_LENGTH=256,this.HIERARCHY_FACTOR=2,this.HIERARCHY_FACTOR_SQRT=Math.SQRT2,this.UPDATE_METHOD=t,this._grids=[],this._globalObjects=[]}function o(t,e,n){this.cellSize=t,this.inverseCellSize=1/t,this.rowColumnCount=~~Math.sqrt(e),this.xyHashMask=this.rowColumnCount-1,this.occupiedCells=[],this.allCells=Array(this.rowColumnCount*this.rowColumnCount),this.allObjects=[],this.sharedInnerOffsets=[],this._parentHierarchy=n||null}function a(){this.objectContainer=[],this.neighborOffsetArray,this.occupiedCellsIndex=null,this.allCellsIndex=null}return r.prototype.addObject=function(t){var e,n,r,a,s,u=t.getAABB(),c=i(u.min,u.max);if(t.HSHG={globalObjectsIndex:this._globalObjects.length},this._globalObjects.push(t),0==this._grids.length)r=c*this.HIERARCHY_FACTOR_SQRT,s=new o(r,this.INITIAL_GRID_LENGTH,this),s.initCells(),s.addObject(t),this._grids.push(s);else{for(e=0,n=0;n<this._grids.length;n++)if(a=this._grids[n],e=a.cellSize,e>c){if(e/=this.HIERARCHY_FACTOR,e>c){for(;e>c;)e/=this.HIERARCHY_FACTOR;s=new o(e*this.HIERARCHY_FACTOR,this.INITIAL_GRID_LENGTH,this),s.initCells(),s.addObject(t),this._grids.splice(n,0,s)}else a.addObject(t);return}for(;c>=e;)e*=this.HIERARCHY_FACTOR;s=new o(e,this.INITIAL_GRID_LENGTH,this),s.initCells(),s.addObject(t),this._grids.push(s)}},r.prototype.removeObject=function(t){var e,n,i=t.HSHG;void 0!==i&&(e=i.globalObjectsIndex,e===this._globalObjects.length-1?this._globalObjects.pop():(n=this._globalObjects.pop(),n.HSHG.globalObjectsIndex=e,this._globalObjects[e]=n),i.grid.removeObject(t),delete t.HSHG)},r.prototype.update=function(){this.UPDATE_METHOD.call(this)},r.prototype.queryForCollisionPairs=function(t){var e,i,r,o,a,s,u,c,h,l,f,d,p,g,m=[];for(broadOverlapTest=t||n,e=0;e<this._grids.length;e++){for(s=this._grids[e],i=0;i<s.occupiedCells.length;i++){for(u=s.occupiedCells[i],r=0;r<u.objectContainer.length;r++)if(c=u.objectContainer[r],!c.staticHshg)for(o=r+1;o<u.objectContainer.length;o++)h=u.objectContainer[o],broadOverlapTest(c,h)===!0&&m.push([c,h]);for(a=0;4>a;a++)for(l=u.neighborOffsetArray[a],f=s.allCells[u.allCellsIndex+l],r=0;r<u.objectContainer.length;r++)if(c=u.objectContainer[r],!c.staticHshg)for(o=0;o<f.objectContainer.length;o++)h=f.objectContainer[o],broadOverlapTest(c,h)===!0&&m.push([c,h])}for(i=0;i<s.allObjects.length;i++)if(c=s.allObjects[i],!c.staticHshg)for(p=c.getAABB(),r=e+1;r<this._grids.length;r++)for(d=this._grids[r],g=d.toHash(p.min[0],p.min[1]),u=d.allCells[g],a=0;a<u.neighborOffsetArray.length;a++)for(l=u.neighborOffsetArray[a],f=d.allCells[u.allCellsIndex+l],o=0;o<f.objectContainer.length;o++)h=f.objectContainer[o],broadOverlapTest(c,h)===!0&&m.push([c,h])}for(e=0;e<m.length;++e)m[e][0].onCollide&&m[e][0].onCollide(m[e][1]),m[e][1].onCollide&&m[e][1].onCollide(m[e][0]);return m},r.update_RECOMPUTE=t,r.update_REMOVEALL=e,o.prototype.initCells=function(){var t,e,n,i,r,o,s,u,c,h,l,f,d=this.allCells.length,p=this.rowColumnCount,g=[p-1,p,p+1,-1,0,1,-1+-p,-p,-p+1],m=[];for(this.sharedInnerOffsets=g,t=0;d>t;t++)f=new a,n=~~(t/this.rowColumnCount),e=~~(t-n*this.rowColumnCount),i=!1,r=!1,o=!1,s=!1,(e+1)%this.rowColumnCount==0?i=!0:e%this.rowColumnCount==0&&(r=!0),(n+1)%this.rowColumnCount==0?o=!0:n%this.rowColumnCount==0&&(s=!0),i||r||o||s?(c=i===!0?-p+1:1,u=r===!0?p-1:-1,h=o===!0?-d+p:p,l=s===!0?d-p:-p,m=[u+h,h,c+h,u,0,c,u+l,l,c+l],f.neighborOffsetArray=m):f.neighborOffsetArray=this.sharedInnerOffsets,f.allCellsIndex=t,this.allCells[t]=f},o.prototype.toHash=function(t,e,n){var i,r,o;return 0>t?(i=-t*this.inverseCellSize,r=this.rowColumnCount-1-(~~i&this.xyHashMask)):(i=t*this.inverseCellSize,r=~~i&this.xyHashMask),0>e?(i=-e*this.inverseCellSize,o=this.rowColumnCount-1-(~~i&this.xyHashMask)):(i=e*this.inverseCellSize,o=~~i&this.xyHashMask),r+o*this.rowColumnCount},o.prototype.addObject=function(t,e){var n,i,r;void 0!==e?i=e:(n=t.getAABB(),i=this.toHash(n.min[0],n.min[1])),r=this.allCells[i],0===r.objectContainer.length&&(r.occupiedCellsIndex=this.occupiedCells.length,this.occupiedCells.push(r)),t.HSHG.objectContainerIndex=r.objectContainer.length,t.HSHG.hash=i,t.HSHG.grid=this,t.HSHG.allGridObjectsIndex=this.allObjects.length,r.objectContainer.push(t),this.allObjects.push(t),this.allObjects.length/this.allCells.length>this._parentHierarchy.MAX_OBJECT_CELL_DENSITY&&this.expandGrid()},o.prototype.removeObject=function(t){var e,n,i,r,o,a,s=t.HSHG;e=s.hash,n=s.objectContainerIndex,i=s.allGridObjectsIndex,r=this.allCells[e],1===r.objectContainer.length?(r.objectContainer.length=0,r.occupiedCellsIndex===this.occupiedCells.length-1?this.occupiedCells.pop():(o=this.occupiedCells.pop(),o.occupiedCellsIndex=r.occupiedCellsIndex,this.occupiedCells[r.occupiedCellsIndex]=o),r.occupiedCellsIndex=null):n===r.objectContainer.length-1?r.objectContainer.pop():(a=r.objectContainer.pop(),a.HSHG.objectContainerIndex=n,r.objectContainer[n]=a),i===this.allObjects.length-1?this.allObjects.pop():(a=this.allObjects.pop(),a.HSHG.allGridObjectsIndex=i,this.allObjects[i]=a)},o.prototype.expandGrid=function(){var t,e=this.allCells.length,n=(this.rowColumnCount,this.xyHashMask,4*e),i=~~Math.sqrt(n),r=i-1,o=this.allObjects.slice(0);Array.prototype.push;for(t=0;t<o.length;t++)this.removeObject(o[t]);for(this.rowColumnCount=i,this.allCells=Array(this.rowColumnCount*this.rowColumnCount),this.xyHashMask=r,this.initCells(),t=0;t<o.length;t++)this.addObject(o[t])},r._private={Grid:o,Cell:a,testAABBOverlap:n,getLongestAABBEdge:i},r}),bento.define("bento/lib/requestanimationframe",[],function(){"use strict";for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var i=(new Date).getTime(),r=Math.max(0,16-(i-t)),o=window.setTimeout(function(){e(i+r)},r);return t=i+r,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.requestAnimationFrame}),bento.define("bento/math/transformmatrix",["bento/utils","bento/math/vector2"],function(t,e){"use strict";function n(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}return n.prototype.multiplyWithVector=function(t){var n=new e,i=t.x,r=t.y;return n.x=this.a*i+this.c*r+this.tx,n.y=this.b*i+this.d*r+this.ty,n},n.prototype.inverseMultiplyWithVector=function(t){var n=new e,i=t.x,r=t.y,o=1/(this.a*this.d-this.c*this.b);return n.x=this.d*i*o+-this.c*r*o+(this.ty*this.c-this.tx*this.d)*o,n.y=this.a*r*o+-this.b*i*o+(-this.ty*this.a+this.tx*this.b)*o,n},n.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},n.prototype.scale=function(t,e){return this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.tx*=t,this.ty*=e,this},n.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.b,o=this.c,a=this.d,s=this.tx,u=this.ty;return this.a=i*e-r*n,this.b=i*n+r*e,this.c=o*e-a*n,this.d=o*n+a*e,this.tx=s*e-u*n,this.ty=s*n+u*e,this},n.prototype.multiplyWith=function(t){var e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this},n.prototype.multiply=function(t){return this.clone().multiplyWith(t)},n.prototype.clone=function(){var t=new n;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n}),bento.define("bento/renderers/pixi",["bento","bento/utils","bento/math/transformmatrix","bento/renderers/canvas2d"],function(t,e,n,i){return function(t,r){var o,a,s,u,c=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),h=[],l=1,f=1,d=r.pixelSize||1,p=function(){var t=new PIXI.Matrix;return t.a=o.a,t.b=o.b,t.c=o.c,t.d=o.d,t.tx=o.tx,t.ty=o.ty,t},g=function(t){var e=new PIXI.Graphics,n=255*t[2]+(255*t[1]<<8)+(255*t[0]<<16),i=t[3];return e.beginFill(n,i),e.worldTransform=p(),e.worldAlpha=i,e},m={name:"pixi",init:function(){},destroy:function(){},save:function(){h.push(o.clone())},restore:function(){o=h.pop()},translate:function(t,e){var i=new n;o.multiplyWith(i.translate(t,e))},scale:function(t,e){var i=new n;o.multiplyWith(i.scale(t,e))},rotate:function(t){var e=new n;o.multiplyWith(e.rotate(t))},fillRect:function(t,e,n,i,r){var o=g(t);o.drawRect(e,n,i,r),a.setObjectRenderer(u),u.render(o)},fillCircle:function(t,e,n,i){var r=g(t);r.drawCircle(e,n,i),a.setObjectRenderer(u),u.render(r)},drawImage:function(t,e,n,i,r,u,c,h,f){var d,p,g,m=t.image;return e+i>m.width||n+r>m.height?void console.log("Warning: image and frame size do not correspond.",m):(m.texture||(m.texture=new PIXI.BaseTexture(m,PIXI.SCALE_MODES.NEAREST)),d=new PIXI.Rectangle(e,n,i,r),g=new PIXI.Texture(m.texture,d),g._updateUvs(),p=new PIXI.Sprite(g),p.worldTransform=o,p.worldAlpha=l,a.setObjectRenderer(s),void s.render(p))},begin:function(){s.start(),(1!==d||navigator.isCocoonJS)&&(this.save(),this.scale(d*f,d*f))},flush:function(){s.flush(),(1!==d||navigator.isCocoonJS)&&this.restore()},getOpacity:function(){return l},setOpacity:function(t){l=t},drawParticleContainer:function(){}};return c&&e.isDefined(window.PIXI)?(o=new n,navigator.isCocoonJS&&(f=window.innerWidth/t.width,console.log("Cocoon-Pixi scale",f)),
t.width*=d*f,t.height*=d*f,a=new PIXI.WebGLRenderer(t.width,t.height,{view:t,backgroundColor:0}),s=a.plugins.sprite,u=a.plugins.graphics,console.log("Init pixi as renderer"),m):(window.PIXI?c||console.log("WARNING: WebGL not available, reverting to Canvas2D renderer"):console.log("WARNING: PIXI library is missing, reverting to Canvas2D renderer"),i(t,r))}}),bento.define("bento/renderers/canvas2d",["bento/utils"],function(t){return function(t,e){var n=t.getContext("2d"),i=n,r={name:"canvas2d",save:function(){n.save()},restore:function(){n.restore()},translate:function(t,e){n.translate(t,e)},scale:function(t,e){n.scale(t,e)},rotate:function(t){n.rotate(t)},fillRect:function(t,e,i,r,a){var s=o(t),u=n.globalAlpha;1!==t[3]&&(n.globalAlpha=t[3]),n.fillStyle=s,n.fillRect(e,i,r,a),1!==t[3]&&(n.globalAlpha=u)},fillCircle:function(t,e,i,r){var a=o(t);n.globalAlpha;1!==t[3]&&(n.globalAlpha=t[3]),n.fillStyle=a,n.beginPath(),n.arc(e,i,r,0,2*Math.PI),n.fill(),n.closePath()},strokeRect:function(t,e,i,r,a){var s=o(t),u=n.globalAlpha;1!==t[3]&&(n.globalAlpha=t[3]),n.strokeStyle=s,n.strokeRect(e,i,r,a),1!==t[3]&&(n.globalAlpha=u)},drawImage:function(t,e,i,r,o,a,s,u,c){n.drawImage(t.image,t.x+e,t.y+i,r,o,a,s,u,c)},getOpacity:function(){return n.globalAlpha},setOpacity:function(t){n.globalAlpha=t},createSurface:function(e,n){var i,r=document.createElement("canvas");return r.width=e,r.height=n,i=t.getContext("2d")},setContext:function(t){n=t},restoreContext:function(){n=i}},o=function(t){var e="#";return e+=("00"+Math.floor(255*t[0]).toString(16)).slice(-2),e+=("00"+Math.floor(255*t[1]).toString(16)).slice(-2),e+=("00"+Math.floor(255*t[2]).toString(16)).slice(-2)};return console.log("Init canvas2d as renderer"),e.smoothing||(n.imageSmoothingEnabled&&(n.imageSmoothingEnabled=!1),n.webkitImageSmoothingEnabled&&(n.webkitImageSmoothingEnabled=!1),n.mozImageSmoothingEnabled&&(n.mozImageSmoothingEnabled=!1)),r}}),bento.define("bento/renderers/webgl",["bento/utils","bento/renderers/canvas2d"],function(t,e){return function(n,i){var r,o,a,s=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),u=1,c=(window.devicePixelRatio,window.innerWidth*window.devicePixelRatio),h=window.innerHeight*window.devicePixelRatio,l={name:"webgl",save:function(){o.save()},restore:function(){o.restore()},translate:function(t,e){o.translate(t,e)},scale:function(t,e){o.scale(t,e)},rotate:function(t){o.rotate(t)},fillRect:function(t,e,n,i,r){var a=o.color;l.setColor(t),o.fillRect(e,n,i,r),o.color=a},fillCircle:function(t,e,n,i){},strokeRect:function(t,e,n,i,r){var a=o.color;l.setColor(t),o.strokeRect(e,n,i,r),o.color=a},drawImage:function(t,e,n,i,a,s,u,c,h){var l=t.image;l.texture||(l.texture=window.GlSprites.createTexture2D(r,l)),o.drawImage(l.texture,t.x+e,t.y+n,i,a,s,u,i,a)},begin:function(){o.begin()},flush:function(){o.end()},setColor:function(t){o.color=t},getOpacity:function(){return o.color[3]},setOpacity:function(t){o.color[3]=t},createSurface:function(t,e){var i,r,o=document.createElement("canvas");return o.width=t,o.height=e,i=n.getContext("webgl")||n.getContext("experimental-webgl"),r=window.GlSprites.SpriteRenderer(i),r.ortho(n.width,n.height),r},setContext:function(t){o=t},restoreContext:function(){o=a}};return console.log("Init webgl as renderer"),i.smoothing||(u=c>h?Math.round(Math.max(window.innerHeight/n.height,1)):Math.round(Math.max(c/n.width,1))),s&&t.isDefined(window.GlSprites)?(n.width*=u,n.height*=u,r=n.getContext("webgl")||n.getContext("experimental-webgl"),o=window.GlSprites.SpriteRenderer(r),o.ortho(n.width/u,n.height/u),a=o,l):(console.log("webgl failed, revert to canvas"),e(n,i))}}),bento.define("bento/gui/clickbutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/eventsystem"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(n){var s=(t.getViewport(),!0),c=a.extend({z:0,name:"",originRelative:e(.5,.5),position:e(0,0),components:[i,r],family:["buttons"],sprite:{image:n.image,frameWidth:n.frameWidth||32,frameHeight:n.frameHeight||32,animations:n.animations||{up:{speed:0,frames:[0]},down:{speed:0,frames:[1]}}},clickable:{onClick:function(){h.sprite.setAnimation("down")},onHoldEnter:function(){h.sprite.setAnimation("down")},onHoldLeave:function(){h.sprite.setAnimation("up")},pointerUp:function(){h.sprite.setAnimation("up")},onHoldEnd:function(){s&&n.onClick&&(n.onClick.apply(h),n.sfx&&(t.audio.stopSound(n.sfx),t.audio.playSound(n.sfx)),u.fire("clickButton",h))}},init:function(){this.sprite.setAnimation("up")}},n),h=o(c).extend({setActive:function(t){s=t},doCallback:function(){n.onClick.apply(h)}});return a.isDefined(n.active)&&(s=n.active),h}}),bento.define("bento/gui/counter",["bento","bento/entity","bento/math/vector2","bento/components/sprite","bento/components/translation","bento/components/rotation","bento/components/scale","bento/utils"],function(t,e,n,i,r,o,a,s){"use strict";return function(t){var u,c=t.value||0,h=t.spacing||n(0,0),l=t.align||t.alignment||"right",f=0,d=[],p=function(){return Math.floor(c).toString().length},g=function(){return e({components:[i],sprite:{image:t.image,frameWidth:t.frameWidth,frameHeight:t.frameHeight,animations:{0:{frames:[0]},1:{frames:[1]},2:{frames:[2]},3:{frames:[3]},4:{frames:[4]},5:{frames:[5]},6:{frames:[6]},7:{frames:[7]},8:{frames:[8]},9:{frames:[9]}}},init:function(){f=t.frameWidth}})},m=function(){var t,e,i,r=c.toString(),o=p(),a=d.length-o;if(0>a)for(t=0;t<Math.abs(a);++t)i=g(),d.push(i),u.attach(i);else if(a>0)for(t=0;t<Math.abs(a);++t)i=d.pop(),u.remove(i);for(t=0;t<d.length;++t)i=d[t],i.setPosition(n((f+h.x)*t,0)),i.sprite.setAnimation(r.substr(t,1));if("right"===l)for(t=0;t<d.length;++t)i=d[t],e=i.getPosition().clone(),e.substract(n((f+h.x)*o-h.x,0)),i.setPosition(e);else if("center"===l)for(t=0;t<d.length;++t)i=d[t],e=i.getPosition(),e.addTo(n(((f+h.x)*o-h.x)/-2,0))},v={z:t.z,name:t.name,position:t.position,components:[r,o,a]};return s.extend(v,t),u=e(v).extend({init:function(){m()},setValue:function(t){c=t,m()},getValue:function(){return c},addValue:function(t){c+=t,m()},getDigits:function(){return p()}})}}),bento.define("bento/gui/togglebutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s){"use strict";return function(n){var s=(t.getViewport(),!0),u=!1,c=a.extend({z:0,name:"",originRelative:e(.5,.5),position:e(0,0),components:[i,r],family:["buttons"],sprite:{image:n.image,frameWidth:n.frameWidth||32,frameHeight:n.frameHeight||32,animations:n.animations||{up:{speed:0,frames:[0]},down:{speed:0,frames:[1]}}},clickable:{onClick:function(){h.sprite.setAnimation("down")},onHoldEnter:function(){h.sprite.setAnimation("down")},onHoldLeave:function(){h.sprite.setAnimation(u?"down":"up")},pointerUp:function(){h.sprite.setAnimation(u?"down":"up")},onHoldEnd:function(){s&&(u=u?!1:!0,n.onToggle&&(n.onToggle.apply(h),n.sfx&&(t.audio.stopSound(n.sfx),t.audio.playSound(n.sfx))),h.sprite.setAnimation(u?"down":"up"))}},init:function(){}},n),h=o(c).extend({isToggled:function(){return u},toggle:function(e,i){u=a.isDefined(e)?e:!u,i&&n.onToggle&&(n.onToggle.apply(h),n.sfx&&(t.audio.stopSound(n.sfx),t.audio.playSound(n.sfx))),h.sprite.setAnimation(u?"down":"up")}});return a.isDefined(n.active)&&(s=n.active),n.toggled&&(u=!0),h.sprite.setAnimation(u?"down":"up"),h}}),bento.define("autoresize",["bento/utils"],function(t){return function(t,e,n,i){var r=t.clone(),o=window.innerWidth,a=window.innerHeight,s=i?o:a,u=i?a:o,c=function(){temp=t.width,t.width=t.height,t.height=temp},h=function(){var o,a=2,h=t.height,l=s/u,f=t.height/t.width;for(1>l?(f=l,o=s):(f=u/s,o=u),h=o,o*=window.devicePixelRatio||1,console.log(o);h>n;)if(h=Math.floor(o/a),a+=1,console.log(h,a),e>h){console.log("cannot fit pixels"),h=i?r.height:r.width;break}return t.width=h/f,t.height=h,i||c(),console.log(t.width,t.height),t},l=function(){window.scrollTo(0,0)};return window.addEventListener("orientationchange",l,!1),i||c(),h()}}),bento.define("break",["bento","bento/math/vector2","bento/math/rectangle","bento/eventsystem","utils","ads/adsmogo","ads/mopub","ads/applovin","ads/chartboost"],function(t,e,n,i,r,o,a,s,u){"use strict";var c={adsmogo:o,mopub:a,applovin:s,chartboost:u},h=["mopub","applovin","chartboost","adsmogo"],l={adsmogo:0,mopub:1,applovin:1,charboost:1},f={},d=!0,p=function(t,e){var n;for(n=0;n<h.length;++n)if(c[h[n]].canShow())return c[h[n]].show(t,e),void m(h[n])},g=function(e){var n=t.saveState.load("adFrequency",{date:"1-1-1980",networks:{mopub:0}}),i=new Date,r=i.getDate()+"-"+i.getMonth()+"-"+i.getFullYear();return n.date!==r&&(n.date=r,n.networks={}),console.log("showntoday",JSON.stringify(n.networks)),n.networks[e]||0},m=function(e){var n=t.saveState.load("adFrequency",{date:"1-1-1980",networks:{mopub:0}}),i=new Date,r=i.getDate()+"-"+i.getMonth()+"-"+i.getFullYear();n.date!==r&&(n.date=r,n.networks={}),n.networks[e]=n.networks[e]||0,n.networks[e]+=1,console.log(JSON.stringify(n)),t.saveState.save("adFrequency",n)};return{init:function(t){var e;if(t.order)for(h=[],e=0;e<t.order.length;++e)c[t.order[e]]&&h.push(t.order[e]);if(t.odds){l=t.odds;for(e in l)l.hasOwnProperty(e)&&(c[e]||delete l[e])}t.frequencyCap&&(f=t.frequencyCap),d=t.showByOrder},setOrder:function(){},canShow:function(){var t,e=!1;for(t=0;t<h.length;++t)f[h[t]]&&g(h[t])>=f[h[t]]&&(c[h[t]].block(),console.log("block",h[t])),console.log("canShow",h[t],c[h[t]].canShow()),e=e||c[h[t]].canShow();return e},show:function(t,e){var n,i,o,a=[];if(d)return void p(t,e);for(n=0;n<h.length;++n)for(i=0;i<l[h[n]];++i)a.push(c[h[n]]);o=r.getRandom(a.length),a[o].canShow()?(a[o].show(t,e),m(o)):p(t,e)},load:function(){var t;for(t=0;t<h.length;++t)c[h[t]].load()},cancel:function(){}}}),bento.define("debug",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s){"use strict";return function(){var n=(t.getViewport(),!1),i=0,r=function(t){var e=document.createElement("a");e.href=t;var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!0,!1,!1,0,null),e.dispatchEvent(n)},a=o({z:1e12,name:"debug",global:!0,position:e(0,0),originRelative:e(0,0),init:function(){}}).attach({update:function(e){t.input.isKeyDown("q")?i+=1:i=0,1===i&&(n=!0)},draw:function(t){n&&(n=!1,r(t.canvas.toDataURL()))}});return a}}),bento.define("filter",["bento/packedimage"],function(t){"use strict";return{getPixels:function(t,e){var n=this.getCanvas(t.width,t.height),i=n.getContext("2d");i.drawImage(t.image,t.x,t.y,t.width,t.height,0,0,t.width,t.height),e(i.getImageData(0,0,n.width,n.height),i,n)},getCanvas:function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n},filterImage:function(e,n,i){var r,o=[];return this.getPixels(n,function(n,i,a){var s;o.push(n);for(var u=2;u<arguments.length;u++)o.push(arguments[u]);s=e.apply(null,o),i.putImageData(s,0,0),r=t(a)}),r},grayscale:function(t,e){for(var n=t.data,i=0;i<n.length;i+=4){var r=n[i],o=n[i+1],a=n[i+2],s=.2126*r+.7152*o+.0722*a;n[i]=s/2,n[i+1]=s/2,n[i+2]=s/2}return t},black:function(t,e){for(var n=t.data,i=0;i<n.length;i+=4){var r=n[i],o=n[i+1],a=n[i+2];n[i]=r/20,n[i+1]=o/20,n[i+2]=a/10}return t}}}),bento.require.config({baseUrl:"js",waitSeconds:0}),window.startGame=function(){bento.require(["bento","bento/math/vector2","bento/math/rectangle","bento/entity","bento/components/sprite","bento/components/animation","bento/components/translation","bento/components/rotation","bento/components/scale","bento/components/fill","bento/components/clickable","bento/tween","bento/eventsystem","utils","autoresize","debug","store","break","bento/packedimage"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v,b){var y=p(n(0,0,160,240),144,192,!1),x=function(t,e,n){var i=new XMLHttpRequest;i.overrideMimeType&&i.overrideMimeType("application/json"),i.open("GET",e,!0),i.onerror=function(){n("Error "+e)},i.ontimeout=function(){n("Timeout"+e)},i.onreadystatechange=function(){4===i.readyState&&(304===i.status||200===i.status||0===i.status&&i.responseText?n(null,t,JSON.parse(i.responseText)):n("Error: State "+i.readyState+" "+e))},i.send(null)};d.isCocoonJS()||d.isMobile()||(y=n(0,0,192,320)),t.saveState.setId("game"),t.setup({canvasId:"canvas",canvasDimension:y,assetGroups:{assets:"assets/assets.json",preloader:"assets/preloader.json",cats:"assets/cats.json",catsbw:"assets/catsbw.json"},renderer:"canvas2d",pixelSize:2},function(){var n=t.saveState.load("bootup",0);n+=1,d.isCocoonJS()&&Cocoon&&d.Cocoon.setAntiAlias(!1),t.assets.load("preloader",function(n){var o;d.Localization.initLanguage(),d.Localization.setLanguage("EN"),o=d.Localization.getLang(),("ZTW"===o||"ZHK"===o)&&(o="ZH"),x("adSettings","http://www.heigames.com/nomcat/settings.json",function(n,a,s){return n?(console.log("error retrieving data",n),void(d.skipNews=!0)):(d.extend(d.settings,s),d.settings.language&&d.settings.language[o]?v.init(d.settings.language[o]):v.init(d.settings),void function(){var n,o,a,s=!1,u=d.Localization.getLang();("ZTW"===u||"ZHK"===u)&&(u="ZH"),d.settings.crossPromotion[u]||(u="EN"),o=d.settings.crossPromotion[u].showCrossPromo,d.settings.news=d.settings.crossPromotion[u].news,console.log("promo",u,o),n=new Image,d.settings.news>t.saveState.load("news",0)?(console.log(d.settings.news,t.saveState.load("news",0)),n.src="http://www.heigames.com/nomcat/"+u+"/news.png",s=!0):"off"===o?d.skipNews=!0:"randomize"===o?(a=d.getRandom(d.settings.crossPromotion[u].numberOfCrossPromo),n.src="http://www.heigames.com/nomcat/"+u+"/promo"+a+".png"):n.src="http://www.heigames.com/nomcat/"+u+"/"+o,n.addEventListener("load",function(){var t=b(n);d.newsEntity=i({z:100,name:"news",originRelative:e(.5,.5),components:[r,h],clickable:{onClick:function(){s||"randomize"!==o||(d.isNativeIos()?Cocoon.App.openURL(d.settings.crossPromotion[u]["iosLink"+a]):Cocoon.App.openURL(d.settings.crossPromotion[u]["androidLink"+a]))}},sprite:{image:t},init:function(){this.loadedNews=s}})},!1),n.addEventListener("error",function(){console.log("error loading image"),d.skipNews=!0})}())});for(var a=t.assets.getJson("cat"),s=0;s<a.cats.length;++s)d.cats.push(a.cats[s]),"Infinity"===a.cats[s].price&&(d.cats[s].price=1/0);t.screens.show("screens/preloader")},function(t,e){console.log(t,e)}),d.isCocoonJS()&&(d.isNativeIos()?d.GameCenter.login():d.isNativeAndroid()&&!d.isAmazon()&&(d.GooglePlay.init(function(){}),d.GooglePlay.login())),d.debugMode&&t.objects.add(g());for(var o=0,a=0;a<d.cats.length;++a)d.cats[a].price!==1/0&&(o+=d.cats[a].price);console.log("Total goldfish:",o),t.audio.muteSound(d.SaveState.load("muteSound",!1)),t.audio.muteMusic(d.SaveState.load("muteMusic",!1)),d.SaveState.save("sessionTime",Date.now()),d.Analytics.init(),function(){var t;window.Cocoon&&(t=window.Cocoon.Device.getDeviceInfo()),t?d.Analytics.event("UI","bootup",void 0,t.model):d.Analytics.event("UI","bootup"),d.Analytics.event("UI","totalBootup",n)}(),t.saveState.save("bootup",n)})})},document.addEventListener("deviceready",function(){navigator.splashscreen?(navigator.splashscreen.hide(),startGame()):startGame()},!1),function(){var t;navigator.isCocoonJS||(document.createEvent?(t=document.createEvent("HTMLEvents"),t.initEvent("deviceready",!0,!0)):(t=document.createEventObject(),t.eventType="deviceready"),t.eventName="deviceready",document.createEvent?document.dispatchEvent(t):document.fireEvent(t.eventType,t),setTimeout(function(){var t=document.createElement("script");t.src="lib/cocoon.js",document.body.appendChild(t)},0),console.log("Starting web version"))}(),bento.define("store",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/eventsystem","bento/entity","bento/tween","utils"],function(t,e,n,i,r,o,a,s,u){"use strict";var c,h=[],l=!1,f={},d={init:function(){return window.Cocoon&&window.Cocoon.InApp?window.Cocoon.InApp.canPurchase()?(window.Cocoon.InApp.on("purchase",{start:function(t){console.log("Product purchase started: "+t)},complete:function(t){console.log("Product purchase completed: "),console.log(JSON.stringify(arguments)),o.fire("purchase_success",t)},error:function(t,e){return console.log("Product purchase failed: "+e),u.isCocoonJS()?void o.fire("purchase_error",e.message):void o.fire("purchase_error","Only available in the app version!")}}),void window.Cocoon.InApp.initialize({autofinish:!0},function(){for(console.log("init store"),u.isNativeAndroid()?window.Cocoon.InApp.setValidationHandler(function(t,e,n){n(!0)}):window.Cocoon.InApp.setLudeiServerValidationHandler(),c=0;c<u.cats.length;++c)"catrandom"===u.cats[c].resource||"cat"===u.cats[c].resource||u.cats[c].unlockOnly||h.push(u.cats[c].resource);for(c=0;c<u.backgrounds.length;++c)"background0"===u.backgrounds[c].resource||u.backgrounds[c].unlockOnly||h.push(u.backgrounds[c].resource);console.log("products to fetch:",h.length),window.Cocoon.InApp.fetchProducts(h,function(t,e){if(e)return console.log("onProductsFetchFailed",JSON.stringify(e)),void console.log("closing");for(var n=t.length-1;n>=0;n--);console.log("products fetched:",t.length),l=!0})})):(console.log("Warning: Store not available"),d):void console.log("InApp plugin not available")},setCallback:function(t,e){f[t]=e},purchase:function(t){return l?(Cocoon.InApp.purchase(t,1,function(t){return t?void console.log(t):void 0}),!0):(console.log("Cannot purchase",t),console.log("isLoaded",l),console.log("canPurchase",Cocoon.InApp.canPurchase()),!1)},restore:function(){return l?(Cocoon.InApp.restorePurchases(function(t){return t?(console.log("error restore purchases"),void console.log(t)):void o.fire("restore_success")}),!0):(console.log("Cannot restore"),!1)},getProducts:function(){return l?Cocoon.InApp.getProducts():null},isLoaded:function(){return l},canPurchase:function(){return window.Cocoon.InApp.canPurchase()}};return d}),bento.define("utils",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/eventsystem","singletons/gamecenter","singletons/googleplay","singletons/localization","singletons/notification","singletons/analytics","singletons/cocoon","singletons/everyplay","singletons/currency","singletons/crittercism"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v){"use strict";var b={version:"2.0.4",debugMode:!0,lives:1,Fonts:{getFontLang:function(){return"ZH"===l.getLang()||"ZHK"===l.getLang()||"ZTW"===l.getLang()||"KO"===l.getLang()||"RU"===l.getLang()||"JA"===l.getLang()?l.getLang():"EN"},"font-EN":{font:"font",fontColor:"#fff",fontSize:16},"fontLarge-EN":{font:"font",fontColor:"#fff",fontSize:32},"fontTight-EN":{font:"font",fontColor:"#fff",fontSize:16,ySpacing:-4},"fontStroked-EN":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"font",fontSize:16},"fontStrokedLarge-EN":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"font",fontSize:32},"font-JA":{font:"yasashisa",fontColor:"#fff",fontSize:12,ySpacing:8},"fontLarge-JA":{font:"yasashisa",fontColor:"#fff",fontSize:20},"fontTight-JA":{font:"yasashisa",fontColor:"#fff",fontSize:12,ySpacing:0},"fontStroked-JA":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"yasashisa",fontSize:12},"fontStrokedLarge-JA":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"yasashisa",fontSize:16},"font-ZH":{font:"haibao",fontColor:"#fff",fontSize:12,ySpacing:8},"fontLarge-ZH":{font:"haibao",fontColor:"#fff",fontSize:20},"fontTight-ZH":{font:"haibao",fontColor:"#fff",fontSize:12,ySpacing:0},"fontStroked-ZH":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"haibao",fontSize:12},"fontStrokedLarge-ZH":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"haibao",fontSize:16},"font-ZTW":{font:"hanwanhei",fontColor:"#fff",fontSize:12,ySpacing:8},"fontLarge-ZTW":{font:"hanwanhei",fontColor:"#fff",fontSize:20},"fontTight-ZTW":{font:"hanwanhei",fontColor:"#fff",fontSize:12,ySpacing:0},"fontStroked-ZTW":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"hanwanhei",fontSize:12},"fontStrokedLarge-ZTW":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"hanwanhei",fontSize:16},"font-ZHK":{font:"hanwanhei",fontColor:"#fff",fontSize:12,ySpacing:8},"fontLarge-ZHK":{font:"hanwanhei",fontColor:"#fff",fontSize:20},"fontTight-ZHK":{font:"hanwanhei",fontColor:"#fff",fontSize:12,ySpacing:0},"fontStroked-ZHK":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"hanwanhei",fontSize:12},"fontStrokedLarge-ZHK":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"hanwanhei",fontSize:16},"font-KO":{font:"bmhanna",fontColor:"#fff",fontSize:12,ySpacing:8},"fontLarge-KO":{font:"bmhanna",fontColor:"#fff",fontSize:20},"fontTight-KO":{font:"bmhanna",fontColor:"#fff",fontSize:12,ySpacing:0},"fontStroked-KO":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"bmhanna",fontSize:12},"fontStrokedLarge-KO":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"bmhanna",fontSize:16},"font-RU":{font:"pressstart",fontColor:"#fff",fontSize:6,ySpacing:8},"fontLarge-RU":{font:"pressstart",fontColor:"#fff",fontSize:12},"fontTight-RU":{font:"pressstart",fontColor:"#fff",fontSize:6,ySpacing:0},"fontStroked-RU":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"pressstart",fontSize:6},"fontStrokedLarge-RU":{fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,font:"pressstart",fontSize:12}},SaveState:t.saveState,GameCenter:c,GooglePlay:h,Localization:l,Notification:f,Analytics:d,Cocoon:p,EveryPlay:g,Currency:m,Constants:{Layer:{CAT:2,FOOD:3,EXPLOSION:4,PHOTO:5,GUI:10,PAUSE:30,FADEOUT:100}},BuyFish:{Tier1:{Price:"10",Amount:"500"},Tier2:{Price:"18",Amount:"1000"},Tier3:{Price:"30",Amount:"2000"}},isApple:function(){var t=navigator.userAgent.match(/iPhone|iPad|iPod/i);return/iPhone/i.test(t)||/iPad/i.test(t)||/iPod/i.test(t)},isMobile:function(){var t=!1;return function(e){(/(android|bb\d+|meego|android|ipad|playbook|silk).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t},isNativeIos:function(){return navigator.isCocoonJS&&"ios"===window.Cocoon.getPlatform()?!0:!1},isNativeAndroid:function(){var t;return navigator.isCocoonJS&&(t=window.Cocoon.getPlatform(),"android"===t||"amazon"===t)?!0:!1},getStoreLink:function(){return this.isNativeIos()?"apple.co/1FA8fcf":this.isAmazon()?"http://www.amazon.com/gp/mas/dl/android?p=com.heigames.nomcat":"https://play.google.com/store/apps/details?id=com.heigames.nomcat"},isChinese:function(){var t=l.getLang();return"ZH"===t||"ZHK"===t||"ZTW"===t},isAmazon:function(){return navigator.isCocoonJS&&"amazon"===window.Cocoon.getPlatform()?!0:!1},timeout:function(t,e,n){var i=s({from:0,to:1,"in":t,ease:"linear",updateWhenPaused:n,onComplete:e});return i},cats:[],backgrounds:[{name:"Kitchen",resource:"background0",preview:"background0",price:0,music:"bgm_cat-ingame"},{name:"City",resource:"background2",preview:"background2full",price:50,music:"bgm_french"},{name:"Docks",resource:"background5",preview:"background5full",price:50,music:"bgm_harbor"},{name:"Japan",resource:"background1",preview:"background1",price:50,music:"bgm_asian"}],screenShake:function(e,n){s({addNow:!0,from:e,to:0,"in":n,ease:"linear","do":function(e,n){var i=t.getViewport();i.x=Math.random()*e,i.y=Math.random()*e},onComplete:function(){var e=t.getViewport();e.x=0,e.y=0}})},gachaPrice:50,nomSlotsRecursion:10,canShowNews:!1,skipNews:!1,newsEntity:null,settings:{adSettings:{ratio:1,useMopubOnly:!1},order:["mopub"],odds:{adsmogo:0,mopub:1,applovin:1,chartboost:1},frequencyCap:{},showByOrder:!0,language:{ZH:{order:["chartboost","mopub","applovin","adsmogo"],odds:{adsmogo:1,mopub:1,applovin:1,chartboost:1},showByOrder:!1}},news:0,crossPromotion:{EN:{news:1,showCrossPromo:"off",numberOfCrossPromo:1,iosLink0:"https://itunes.apple.com/us/app/super-bunny-world/id921240026?ls=1&mt=8",androidLink0:"http://play.google.com/store/apps/details?id=com.heigames.superbunnyworld",iosLink1:"",androidLink1:""}}},initDevReload:function(){bento.watch(),window.reloadAssets=function(e){t.assets.load("game",function(t){console.log("Loaded assets"),e&&e()},function(t,e){text.setText("Loading... "+t+"/"+e)})},window.devReload=function(e){var n=t.screens.getCurrentScreen();return n?(t.screens.reset(),t.objects.resume(),t.objects.stop(),bento.refresh(),t.screens.show(e||n.name),void setTimeout(t.objects.run,120)):void console.log("WARNING: No screen has been loaded.")},document&&document.addEventListener&&(document.addEventListener("contextmenu",function(t){window.devReload(),t.preventDefault()},!1),document.addEventListener("keydown",function(t){49===t.keyCode&&window.devReload(),50===t.keyCode&&window.reloadAssets(window.devReload),51===t.keyCode&&window.devReload("screens/title")}))}},y=function(e){var n=e.productId,i=t.saveState.load("unlocked",["cat"]),r=t.saveState.load("unlockedBackgrounds",["background0"]);"cat"===n.substr(0,3)?i.indexOf(n)<0&&(i.push(n),t.saveState.save("unlocked",i)):r.indexOf(n)<0&&(r.push(n),t.saveState.save("unlockedBackgrounds",r))};return a.extend(a,b),u.addEventListener("purchase_success",y),a}),bento.define("ads/adsmogo",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/tween","utils"],function(t,e,n,i,r,o,a,s,u){"use strict";var c=!1,h=!1,l=function(){h||(h=!0)},f=function(){};return window.adsmogo?(window.adsmogo.interstitialLoaded(function(){console.log("loaded adsmogo"),c=!0}),window.adsmogo.interstitialClosed(function(){console.log("closed adsmogo")}),l(),{canShow:function(){return u.isChinese()?!0:!1},show:function(t,e){window.adsmogo.showInterstitial(),window.adsmogo.interstitialClosed(e)},load:l,block:function(){c=!1,this.isBlocking=!0}}):{canShow:function(){return!1},show:f,load:f,block:f}}),bento.define("ads/applovin",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/tween","utils"],function(t,e,n,i,r,o,a,s,u){"use strict";var c=!1,h=!1,l=function(){h||(h=!0,window.applovin.incentivLoad())},f=function(){};return window.applovin?(window.applovin.onInitializeSdk=function(){var t;window.Cocoon&&(t=window.Cocoon.Device.getDeviceInfo(),window.applovin.setUserId(t.openudid)),console.log("applovin init"),l()},window.applovin.onIncentivLoaded=function(){console.log("applovin ready to show"),c=!0,h=!1},window.applovin.onIncentivLoadFail=function(t){h=!1,l()},window.applovin.onVideoPlaybackWasHidden=function(){},window.applovin.onRewardFail=function(){},window.applovin.initializeSdk(),{canShow:function(){return c},show:function(t,e){var n=function(){e&&e(),l()};window.applovin.incentivShow(),window.applovin.onVideoPlaybackWasHidden=n,console.log("show applovin")},load:l,block:function(){c=!1,this.isBlocking=!0}}):(console.log("applovin not available!!"),{canShow:function(){return!1},show:f,load:f,block:f})}),bento.define("ads/chartboost",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/tween","utils"],function(t,e,n,i,r,o,a,s,u){"use strict";var c=!1,h=!1,l=!1,f=!1,d=function(){f||(f=!0,c||(console.log("load chartboost ads"),u.isChinese()&&window.chartboost.preloadFullScreenAd("Default"),window.chartboost.preloadRewardedVideoAd("Default")))},p=function(){},g="55914bea0d602531c4605ee4",m="6779a3bd89a688c591340bf009923abcefe782ac";return u.isNativeIos()&&(g="55914bea0d602531c4605ee3",m="1a6425852e3bca7d64d4de44cb9313cfdd322f67"),window.chartboost?(window.chartboost.setUp(g,m),window.chartboost.onFullScreenAdPreloaded=function(){h=!0},window.chartboost.onFullScreenAdLoaded=function(){h=!0},window.chartboost.onFullScreenAdShown=function(){},window.chartboost.onFullScreenAdHidden=function(){},window.chartboost.onMoreAppsAdPreloaded=function(){l=!0},window.chartboost.onMoreAppsAdLoaded=function(){l=!0},window.chartboost.onMoreAppsAdShown=function(){},window.chartboost.onMoreAppsAdHidden=function(){},window.chartboost.onRewardedVideoAdPreloaded=function(){c=!0},window.chartboost.onRewardedVideoAdLoaded=function(){c=!0},window.chartboost.onRewardedVideoAdShown=function(){},window.chartboost.onRewardedVideoAdHidden=function(){},window.chartboost.onRewardedVideoAdCompleted=function(){},d(),{canShow:function(){return c||h||l},show:function(t,e){c?(console.log("show rewarded"),window.chartboost.onRewardedVideoAdHidden=e,window.chartboost.showRewardedVideoAd("Default"),c=!1):h?(console.log("show fullscreen"),window.chartboost.onFullScreenAdHidden=e,window.chartboost.showFullScreenAd("Default"),h=!1):l&&(console.log("show more apps"),window.chartboost.onMoreAppsAdHidden=e,window.chartboost.showMoreAppsAd("Default"),l=!1),console.log("show chartboost")},load:d,block:function(){c=!1,this.isBlocking=!0}}):{canShow:function(){return!1},show:p,load:p,block:p}}),bento.define("ads/domob",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/tween","utils"],function(t,e,n,i,r,o,a,s,u){"use strict";var c=!1,h=!1,l=function(){h||(h=!0)},f=function(){};return window.domob?(l(),{canShow:function(){return window.domob?(window.domob.checkVideoAvailable(function(t){c=t,console.log("domob canshow",c)}),c):!1},show:function(t,e){domob.showVideoWall(function(t){console.log("domob",t),e&&e()})},load:l,block:function(){c=!1,this.isBlocking=!0}}):{canShow:function(){return!1},show:f,load:f,block:f}}),bento.define("ads/leadbolt",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/tween","utils"],function(t,e,n,i,r,o,a,s,u){
"use strict";var c=!1,h=!1,l=function(){h||(h=!0)};return l(),{canShow:function(){return c},show:function(t,e){},load:l,block:function(){c=!1,this.isBlocking=!0}}}),bento.define("ads/mopub",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";var c,h,l=!1,f=navigator.isCocoonJS?Cocoon.Ad.MoPub:null,d=function(){},p=function(){l=!1,h.load(),t.saveState.save("adsWatched",t.saveState.load("adsWatched",0)+1),c&&c()},g=function(){console.log("ready to show ad"),l=!0};return navigator.isCocoonJS&&f&&(f.configure({ios:{interstitial:"f407c503645f43a3a545a3e24bcf5a5a"},android:{interstitial:"edd471ad49bf4d79a47b9b500d303565"}}),h=f.createInterstitial(),h.on("load",g),h.on("show",d),h.on("dismiss",p),h.on("fail",function(t){console.log("Interstitial failed to load: "+JSON.stringify(t)),setTimeout(function(){h.load()},1e4)}),h.on("click",function(){console.log("Interstitial clicked")}),h.load()),{canShow:function(){return l},show:function(t,e){var n=function(){c=e,h.show(),t(!0)},i=function(){h.load()},r=function(){t(!1)};l?n():(i(),r()),console.log("show mopub")},load:function(){f&&h.load()},block:function(){l=!1,this.isBlocking=!0}}}),bento.define("ads/unityads",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/tween","utils"],function(t,e,n,i,r,o,a,s,u){"use strict";var c=!1,h=!1,l=function(){h||(h=!0)},f="49955";u.isNativeAndroid()&&(f="49958");var d="defaultZone",p="rewardedVideoZone",g=!0;return window.unityads.setUp(f,d,p,g),window.unityads.onRewardedVideoAdLoaded=function(){c=!0},window.unityads.onRewardedVideoAdShown=function(){},window.unityads.onRewardedVideoAdCompleted=function(){},l(),{canShow:function(){return c},show:function(t,e){var n=function(){e&&e(),l(),c=!1};window.unityads.showRewardedVideoAd(),window.unityads.onRewardedVideoAdHidden=n,console.log("show unityads")},load:l,block:function(){c=!1}}}),bento.define("components/fill",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(n,r){var a=t.getViewport(),u={},c=e(1/8,1/8),h=o({z:0,name:"fill",position:n.getPosition().multiply(e(-1,-1)),originRelative:e(0,0),components:[i],family:[""],sprite:{image:t.assets.getImage("black")},init:function(){}});return h.setup=function(){},c.x*=a.width,c.y*=a.height,h.scale.setScale(c),r&&r[h.name]&&h.setup(r[h.name]),n.attach(h),u[h.name]=h,s.extend(n,u),n}}),bento.define("entities/backgroundpreview",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(){var e;t.getViewport();return e}}),bento.define("entities/backgroundselector",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/entity","bento/utils","bento/tween","bento/screen","gui/clickbutton","bento/gui/togglebutton","gui/text","bento/packedimage","filter","entities/backscroller","entities/confetti","gui/counter"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v){"use strict";var b=function(t){return t.grayScale||(t.grayScale=p.filterImage(p.grayscale,t)),t.grayScale};return function(n,o){var c,l,f=t.getViewport(),d=[],p=t.saveState.load("unlockedBackgrounds",["background0"]),g=s.backgrounds,y=!1,x=192,w=0,_=0,S=0,E=!1,T=0,A=0,C=0,P=0,I=!1,R=(h({z:s.Constants.Layer.GUI,image:t.assets.getImage("buttonleft"),position:e(f.width/2-24,f.height/2+80),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){M()}}),h({z:s.Constants.Layer.GUI,image:t.assets.getImage("buttonright"),position:e(f.width/2+24,f.height/2+80),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){k()}}),a({z:0,name:"cats",position:e(f.width/2,f.height/2),originRelative:e(0,0),components:[i,r],sprite:{image:t.assets.getImage("nothing")},family:[""],addNow:!0,updateWhenPaused:!0,init:function(){},clickable:{pointerDown:function(t){R.getPosition().y;_=t.worldPosition.x,t.worldPosition.y>48&&t.worldPosition.y<f.height-64&&(E=!0)},pointerMove:function(t){E&&!y&&(T=t.worldPosition.x-_,Math.abs(T)>Math.abs(A)&&(A=T),S=t.worldPosition.x-_,R.getPosition().x+=S,_=t.worldPosition.x)},pointerUp:function(t){E=!1,C=A}}}).attach({update:function(){var e=f.width/2-R.getPosition().x,i=Math.min(Math.max(Math.round(e/x),0),d.length-1),r=i*x;!I&&t.input.isKeyDown("left")?(M(),I=!0):!I&&t.input.isKeyDown("right")?(k(),I=!0):t.input.isKeyDown("left")||t.input.isKeyDown("right")||(I=!1),P!==i&&(P=i,n(i),w=i,t.saveState.save("currentCatChoice",w),t.audio.stopSound("sfx_char-scroll"),t.audio.playSound("sfx_char-scroll")),A=.8*A,y&&(E=!1),E||(Math.abs(C)<1?R.getPosition().x-=.1*(r-e):R.getPosition().x+=C,(Math.round(e/x)<0||Math.round(e/x)>d.length-1)&&(R.getPosition().x-=.1*(r-e),C/=2)),C*=Math.abs(C)<2?.9:.95}}).extend({getAvailable:function(){return g},unlock:function(t){return d[w].unlock?d[w].unlock(t):!1},getCurrentCat:function(){return d[w]},getCurrentCatChoice:function(){return w}})),M=function(){--w<0&&(w=0),O()},k=function(){var t=d.length-1;++w>=t&&(w=t),O()},O=function(){u({from:R.getPosition().x,to:f.width/2-w*x,"in":20,ease:"exponential",alpha:-5,beta:0,"do":function(t,e){R.getPosition().x=t}})},D=function(n,r,o,c){var h,l=t.assets.getImage(c||n),w=b(l),_=!1,S=(v({image:t.assets.getImage("numberstiny"),frameWidth:8,frameHeight:8,spacing:e(0,0),position:e(-16,24),align:"center",value:o.buyOnly?0:g[r].price}).extend({setText:function(t){this.setValue(+t)},getText:function(){return this.getValue().toString()}}).attach(a({z:0,name:"fishIcon",position:e(32,0),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("goldfishicon")}})),a({z:0,name:"",position:e(0,0),originRelative:e(.5,.5),components:[i],family:[""],updateWhenPaused:!0,sprite:{image:t.assets.getImage("lock")},init:function(){}}).extend({drop:!1,speedY:0}).attach({update:function(){S.drop&&(S.rotation.addAngleDegree(5),S.speedY+=.2,S.getPosition().y+=S.speedY,S.getPosition().x-=2,S.getPosition().y>500&&h.remove(S))}}));return p.indexOf(n)>=0&&(_=!0),h=a({z:0,name:"",position:e(d.length*x,0),originRelative:e(.5,.5),components:[i],updateWhenPaused:!0,family:[""],sprite:{image:l},init:function(){}}).attach({update:function(){var t=(f.width/2-R.getPosition().x,1);y||h.scale.setScale(e(t,t))}}).extend({unlock:function(i){return _?(i&&i(),!1):(y=!0,_=!0,p=t.saveState.load("unlockedBackgrounds",p),p.indexOf(n)<0&&(p.push(n),t.saveState.save("unlockedBackgrounds",p)),"background4"===n&&(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQDA",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQDA",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQDA",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQDA",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQDA",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQDA",!0)})),t.audio.stopSound("sfx_elastic-slower"),t.audio.playSound("sfx_elastic-slower"),u({from:1,to:.75,"in":30,ease:"exponential",alpha:-4,beta:0,updateWhenPaused:!0,"do":function(t,n){h.scale.setScale(e(t,t))},onComplete:function(){u({from:0,to:1,"in":30,ease:"linear",updateWhenPaused:!0,"do":function(t,n){var i=.75+Math.floor(n/2)%2*.02;h.scale.setScale(e(i,i))},onComplete:function(){h.dropLock(),h.sprite.setup({image:l}),m(),u({from:.75,to:1,"in":window.duration||20,ease:"elastic",alpha:window.alpha||-6,beta:window.beta||2,updateWhenPaused:!0,"do":function(t,n){h.scale.setScale(e(t,t))},onComplete:function(){y=!1,i&&i()}})}})}}),!0)},dropLock:function(){S.drop=!0,S.speedY=-6}}),_||(h.sprite.setup({image:w}),h.attach(S)),h};for(function(){p.indexOf("catkeyboard")>=0&&(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQDA",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQDA",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQDA",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQDA",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQDA",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQDA",!0)}))}(),n(0),c=0;c<g.length;++c)l=D(g[c].resource,c,g[c],g[c].preview),d.push(l),R.attach(l),g[c].resource===t.saveState.load("currentBackground",{resource:"background0"}).resource&&(o?(w=t.saveState.load("currentBackgroundChoice",w),R.getPosition().x=f.width/2-w*x):(w=c,t.saveState.save("currentBackgroundChoice",w),u({from:1e3,to:f.width/2-w*x,"in":30,ease:"exponential",alpha:-5,beta:0,"do":function(t,e){R.getPosition().x=t},onComplete:function(){}})));return R}}),bento.define("entities/backscroller",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/opacity","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(n,r,s,u,c,h,l){var f=t.getViewport(),d=a({z:h||-1,name:"backscroller",position:e(f.width/2,f.height/2),originRelative:e(.5,.5),components:[o,i],sprite:{image:t.assets.getImage(n)},family:[""],addNow:!0,updateWhenPaused:!0,init:function(){}});return d}}),bento.define("entities/cat",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","entities/explosion","bento/eventsystem"],function(t,e,n,i,r,o,a,s,u,c){"use strict";var h=0,l=0;return function(r,f){var d=t.getViewport(),p=!1,g=!1,m=!1,v=null,b=e(1,1),y=t.objects.get("gameState"),x=o({z:a.Constants.Layer.CAT,name:"cat",position:e(d.width/2+40*-r,d.height/2+110),originRelative:e(.5,1),components:[i],family:["cat"],clickable:{pointerDown:function(t){g||x.getBoundingBox().hasPosition(t.position)&&!p&&(p=!0,v=t.id)},pointerUp:function(t){p&&v===t.id&&(p=!1)}},sprite:{image:t.assets.getImage(f),frameCountX:2,frameCountY:2,animations:{closed:{speed:0,frames:[0]},open:{speed:.5,backTo:0,frames:[1]},swallow:{speed:1,frames:[2]},dead:{speed:0,frames:[2]},sad:{speed:0,frames:[3]}}},init:function(){var t=this.getDimension();t.x-=t.width/2,t.y-=d.height,t.height=d.height+t.height,this.setBoundingBox(t)}}).extend({getResourceName:function(){return f},isMouthOpen:function(){return p},eat:function(e,n){var i;if("bomb"===e.getType())return g=!0,t.saveState.save("stats_bombs",t.saveState.load("stats_bombs",0)+1),void(y&&y.gameOver(n));if("fish"===e.getType())t.audio.stopSound("sfx_fish-eat"),t.audio.playSound("sfx_fish-eat"),t.saveState.save("stats_fish",t.saveState.load("stats_fish",0)+1),i||(i=t.objects.getByName("counter")),i&&i.length&&(i[0].addValue(1),s({from:1.2,to:1,"in":20,ease:"elastic",alpha:-3,beta:1,"do":function(t,e){x.scale.setScaleX(t*-r),x.scale.setScaleY(1/t)},onComplete:function(){var e=t.objects.get("photo");!e||i[0].getValue()%50!==0&&10!==i[0].getValue()||e.snap()}}),h+=1,50===h&&(t.saveState.load("expert",!1)?(a.isNativeAndroid()&&a.GooglePlay.isLoggedIn()&&a.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQDQ",function(){}),a.isNativeIos()&&a.GameCenter.isLoggedIn()&&a.GameCenter.postAchievement("CgkI3NDPhKAbEAIQDQ",function(){})):(a.isNativeAndroid()&&a.GooglePlay.isLoggedIn()&&a.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQAg",function(){}),a.isNativeIos()&&a.GameCenter.isLoggedIn()&&a.GameCenter.postAchievement("CgkI3NDPhKAbEAIQAg",function(){}))),100===h&&(t.saveState.load("expert",!1)?(a.isNativeAndroid()&&a.GooglePlay.isLoggedIn()&&a.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQDg",function(){}),a.isNativeIos()&&a.GameCenter.isLoggedIn()&&a.GameCenter.postAchievement("CgkI3NDPhKAbEAIQDg",function(){})):(a.isNativeAndroid()&&a.GooglePlay.isLoggedIn()&&a.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQAw",function(){}),a.isNativeIos()&&a.GameCenter.isLoggedIn()&&a.GameCenter.postAchievement("CgkI3NDPhKAbEAIQAw",function(){}))));else if("goldfish"===e.getType()){var o,u=t.saveState.load("goldfish",0);u+=1,t.saveState.save("stats_goldfish",t.saveState.load("stats_goldfish",0)+1),t.saveState.save("goldfish",u),o=t.objects.getByName("goldfishtext"),o&&o[0].setText(u.toString()),t.audio.stopSound("sfx_meow"),t.audio.stopSound("sfx_extra-meow"),t.audio.playSound("sfx_extra-meow"),i||(i=t.objects.getByName("counter")),i&&(i[0].addValue(1),s({from:1.2,to:1,"in":20,ease:"elastic",alpha:-3,beta:1,"do":function(t,e){x.scale.setScaleX(t*-r),x.scale.setScaleY(1/t)},onComplete:function(){}}),l+=1,20===l&&(a.isNativeAndroid()&&a.GooglePlay.isLoggedIn()&&a.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQBA",function(){}),a.isNativeIos()&&a.GameCenter.isLoggedIn()&&a.GameCenter.postAchievement("CgkI3NDPhKAbEAIQBA",function(){})))}e.onEaten&&e.onEaten()}}).attach({update:function(){var n,r=!1,h=t.input.getPointers(),l=x.getPosition().x>d.width/2?"right":"left";if(!y)return void(y=t.objects.get("gameState"));for(n=0;n<h.length;n+=1)x.getBoundingBox().hasPosition(h[n].worldPosition)&&(r=!0,p=!0);return t.input.isKeyDown(l)&&(p=!0),r||t.input.isKeyDown(l)||(p=!1),y&&y.isGameOver()&&(p=!1),g?(p=!1,void(m||(m=!0,x.sprite.setAnimation("swallow",function(){for(x.sprite.setAnimation("dead"),t.audio.stopSound("sfx_explode"),t.audio.playSound("sfx_explode"),a.Analytics.event("Game","exploded"),n=0;1>n;++n)s({from:0,to:1,"in":2*n,ease:"linear",id:n,onComplete:function(){var n=x.getPosition().clone(),r=t.saveState.load("currentCat",{resource:"cat"}).resource;"catlilbub"===r?t.objects.add(u(n,"watersplash",.25)):"catgrumpy"===f?(t.objects.add(u(n)),o({z:a.Constants.Layer.CAT+1,name:"no",addNow:!0,position:n,originRelative:e(.5,1.2),components:[i],sprite:{image:t.assets.getImage("no")},init:function(){console.log("no")}})):t.objects.add(u(n)),a.getRandom(2)&&a.timeout(a.getRandom(60),function(){var e=t.objects.get("photo");e&&e.snap()})}})})))):(b.x=1+.05*Math.cos(x.timer/10+Math.PI),b.y=1+.05*Math.cos(x.timer/10),void(p?x.sprite.setAnimation("open"):y&&y.isGameOver()?(x.sprite.setAnimation("sad"),"catgrumpy"===f||("catkeyboard"===f?x.missFish||x.isPlaying||(x.isPlaying=!0,console.log("setup keyboard"),x.sprite.setup({image:t.assets.getImage("playthemoff"),frameCountX:2,frameCountY:1,animations:{sad:{speed:.1,frames:[0,1]}}}),x.sprite.setAnimation("sad"),c.on("musicStopped",w)):_.setVisible(!0))):x.sprite.setAnimation("closed")))}}),w=function(){x.isPlaying&&(t.audio.stopAllMusic(),t.audio.playMusic("bgm_keyboard",!1)),c.off("musicStopped",w)},_=(o({z:a.Constants.Layer.CAT-1,name:"shadow",position:x.getPosition(),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("shadow")},addNow:!0,init:function(){}}),o({z:0,name:"",position:e(0,0),originRelative:e(.5,1),components:[i],family:[""],sprite:{image:t.assets.getImage("cattears"),frameCountX:3,frameCountY:1,animations:{crying:{speed:.15,frames:[2,1,0]}}},init:function(){this.translation.setSubPixel(!0),this.sprite.setAnimation("crying"),this.setVisible(!1)}}));if(("catvenus2"===f||"catsocial"===f||"catpokey"===f)&&(r=-1),"catglitch"===f){x.sprite.setup({image:t.assets.getImage("catglitchanimation"),frameCountX:4,frameCountY:4,animations:{closed:{speed:.2,frames:[1,0,0,0,0,1,2,3]},open:{speed:.2,frames:[4,5,6,7,4,4,4]},swallow:{speed:1,frames:[2]},dead:{speed:.2,frames:[12,12,13,14,15]},sad:{speed:.2,frames:[8,9,10,10,11]}}});var S=n(0,0,80,80);S.x-=S.width/2,S.y-=d.height,S.height=d.height+S.height,x.setBoundingBox(S)}return x.scale.setScaleX(-r),x.attach(_),h=0,l=0,x}}),bento.define("entities/catselector",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/entity","bento/utils","bento/tween","bento/screen","gui/clickbutton","bento/gui/togglebutton","gui/text","bento/packedimage","entities/backscroller","entities/confetti","gui/counter","gui/camerabutton","bento/eventsystem"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v,b){"use strict";return function(n,o){var c,l,f=t.getViewport(),d=[],p=t.saveState.load("unlocked",["cat"]),v=s.cats,b=!1,y=64,x=0,w=0,_=0,S=!1,E=0,T=0,A=0,C=0,P=!1,I=(h({z:s.Constants.Layer.GUI,image:t.assets.getImage("buttonleft"),position:e(f.width/2-24,f.height/2+48),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){R()}}),h({z:s.Constants.Layer.GUI,image:t.assets.getImage("buttonright"),position:e(f.width/2+24,f.height/2+48),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){M()}}),a({z:0,name:"cats",position:e(f.width/2,f.height/2),originRelative:e(0,0),components:[i,r],sprite:{image:t.assets.getImage("nothing")},family:[""],addNow:!0,updateWhenPaused:!0,init:function(){},clickable:{pointerDown:function(t){I.getPosition().y;w=t.worldPosition.x,t.worldPosition.y>48&&t.worldPosition.y<f.height-64&&(S=!0)},pointerMove:function(t){S&&!b&&(E=t.worldPosition.x-w,Math.abs(E)>Math.abs(T)&&(T=E),_=t.worldPosition.x-w,I.getPosition().x+=_,w=t.worldPosition.x)},pointerUp:function(t){S=!1,A=T}}}).attach({update:function(){var e=B()?d.length-1:d.length-2,i=f.width/2-I.getPosition().x,r=Math.min(Math.max(Math.round(i/y),0),e),o=r*y;!P&&t.input.isKeyDown("left")?(R(),P=!0):!P&&t.input.isKeyDown("right")?(M(),P=!0):t.input.isKeyDown("left")||t.input.isKeyDown("right")||(P=!1),C!==r&&(C=r,n(r),x=r,t.saveState.save("currentCatChoice",x),t.audio.stopSound("sfx_char-scroll"),t.audio.playSound("sfx_char-scroll")),!t.saveState.load("sawGlitchCat",!1)&&Math.floor((i-f.width/2)/y)>e&&(console.log("hello"),t.audio.stopSound("sfx_meow"),t.audio.playSound("sfx_meow"),t.saveState.save("sawGlitchCat",!0)),T=.6*T,b&&(S=!1),S||(Math.abs(A)<1?I.getPosition().x-=.3*(o-i):I.getPosition().x+=A,(Math.round(i/y)<=0||Math.round(i/y)>=e)&&(I.getPosition().x-=.1*(o-i),A/=2)),A*=Math.abs(A)<2?.9:.95}}).extend({getAvailable:function(){return v},unlock:function(t){return d[x].unlock?d[x].unlock(t):!1},getCurrentCat:function(){return d[x]},getCurrentCatChoice:function(){return x}})),R=function(){--x<0&&(x=0),k()},M=function(){var t=d.length-1;B()||(t-=1),++x>=t&&(x=t),k()},k=function(){u({from:I.getPosition().x,to:f.width/2-x*y,"in":20,ease:"exponential",alpha:-5,beta:0,"do":function(t,e){I.getPosition().x=t}})},O=function(n,o,c,h){var l,x=p.indexOf(n)>=0||"catrandom"===n?!0:!1,w=x?h||n:(h||n)+"bw",_=t.assets.getImage(w),S=(m({image:t.assets.getImage("numberstiny"),frameWidth:8,frameHeight:8,spacing:e(0,0),position:e(0,0),align:"center",value:c.buyOnly?0:v[o].price}).extend({setText:function(t){this.setValue(+t)},getText:function(){return this.getValue().toString()}}),"catglitch"===n&&!B()),E=a({z:0,name:"",position:e(0,-24),originRelative:e(.5,.5),components:[i],family:[""],updateWhenPaused:!0,sprite:{image:t.assets.getImage("lock")},init:function(){}}).extend({drop:!1,speedY:0}).attach({update:function(){E.drop&&(E.rotation.addAngleDegree(5),E.speedY+=.2,E.getPosition().y+=E.speedY,E.getPosition().x-=2,E.getPosition().y>500&&l.remove(E))}});if(l=a({z:0,name:n,position:e(d.length*y+(S?f.width-32:0),0),originRelative:e(.5,1),components:[i,r],updateWhenPaused:!0,family:[""],sprite:{image:_,frameCountX:h?1:2,frameCountY:h?1:2},clickable:{onClick:function(){!B()}},init:function(){}}).attach({update:function(){var t=f.width/2-I.getPosition().x,n=Math.max(.5,1-Math.abs(t-l.getPosition().x)/160);b||l.scale.setScale(e(n,n))}}).extend({draw:function(t){var e=this.getPosition().x+I.getPosition().x;e>-40&&e<f.width+40&&this.base.draw(t)},unlock:function(i){return x?(i&&i(),!1):(b=!0,x=!0,p=t.saveState.load("unlocked",["cat"]),p.indexOf(n)<0&&(p.push(n),t.saveState.save("unlocked",p)),p.length>=20&&(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQBg",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQBg",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQBg",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQBg",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQBg",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQBg",!0)})),"catgrumpy"===n?(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQCQ",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQCQ",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQCQ",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQCQ",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQCQ",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQCQ",!0)})):"catnyan"===n?(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQCg",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQCg",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQCg",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQCg",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQCg",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQCg",!0)})):"catkeyboard"===n&&(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQCw",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQCw",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQCw",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQCw",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQCw",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQCw",!0)})),t.audio.stopSound("sfx_elastic-slower"),t.audio.playSound("sfx_elastic-slower"),u({from:1,to:.75,"in":30,ease:"exponential",alpha:-4,beta:0,updateWhenPaused:!0,"do":function(t,n){l.scale.setScale(e(t,t))},onComplete:function(){u({from:0,to:1,"in":30,ease:"linear",updateWhenPaused:!0,"do":function(t,n){var i=.75+Math.floor(n/2)%2*.02;l.scale.setScale(e(i,i))},onComplete:function(){var n=c.name;"ZH"===s.Localization.getLang()&&c.name_ZH&&(n=c.name_ZH),"ZHK"!==s.Localization.getLang()&&"ZTW"!==s.Localization.getLang()||!c.name_ZT||(n=c.name_ZT),l.attach(E),l.dropLock(),"catglitch"===l.name?(l.sprite.setup({image:t.assets.getImage("catglitchanimation"),frameCountX:4,frameCountY:4,animations:{closed:{speed:.2,frames:[0,0,0,0,0,0,1,2,3]}}}),l.sprite.setAnimation("closed")):l.sprite.setup({image:t.assets.getImage(l.name),frameCountX:h?1:2,frameCountY:h?1:2}),g(),u({from:.75,to:1,"in":window.duration||20,ease:"elastic",alpha:window.alpha||-6,beta:window.beta||2,updateWhenPaused:!0,"do":function(t,n){l.scale.setScale(e(t,t))},onComplete:function(){b=!1,i&&i()}})}})}}),!0)},dropLock:function(){E.drop=!0,E.speedY=-6}}),"catglitch"===n){var T=x?"catglitchanimation":"catglitchanimationbw";l.sprite.setup({image:t.assets.getImage(T),frameCountX:4,frameCountY:4,animations:{closed:{speed:.2,frames:[0,0,0,0,0,0,1,2,3]}}}),l.sprite.setAnimation("closed")}return l},D=function(){p.indexOf("catklaus")>=0&&(p.indexOf("catklaus2")<0&&p.push("catklaus2"),p.indexOf("catoskar")<0&&p.push("catoskar"),t.saveState.save("unlocked",p)),p.indexOf("catvenus")>=0&&(p.indexOf("catvenus2")<0&&p.push("catvenus2"),p.indexOf("catroo")<0&&p.push("catroo"),t.saveState.save("unlocked",p)),p.indexOf("catgrumpy")>=0&&(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQCQ",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQCQ",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQCQ",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQCQ",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQCQ",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQCQ",!0)})),p.indexOf("catnyan")>=0&&(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQCg",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQCg",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQCg",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQCg",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQCg",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQCg",!0)})),p.indexOf("catkeyboard")>=0&&(s.isNativeAndroid()&&s.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQCw",!1)&&s.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQCw",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQCw",!0)}),s.isNativeIos()&&s.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQCw",!1)&&s.GameCenter.postAchievement("CgkI3NDPhKAbEAIQCw",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQCw",!0)}))},L=t.saveState.load("sawGlitchCat",!1),B=function(){return L};for(D(),n(0),c=0;c<v.length;++c)l=O(v[c].resource,c,v[c],v[c].selectImage),d.push(l),I.attach(l),v[c].resource===t.saveState.load("currentCat",{resource:"cat"}).resource&&(2===t.saveState.load("playCount",1)&&t.saveState.load("highlightNext",!0)&&(x+=1,t.saveState.save("highlightNext",!1)),o?(x=t.saveState.load("currentCatChoice",x),I.getPosition().x=f.width/2-x*y):(x=c,t.saveState.save("currentCatChoice",x),u({from:1e3,to:f.width/2-x*y,"in":30,ease:"exponential",alpha:-5,beta:0,"do":function(t,e){I.getPosition().x=t},onComplete:function(){}})));return I}}),bento.define("entities/cherryblossom",["bento","bento/math/vector2","bento/math/rectangle","bento/components/translation","bento/components/rotation","bento/components/scale","bento/components/animation","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u,c,h,l){"use strict";return function(){var n=t.getViewport(),s=0,c=h.getRandom(15),l=h.getRandom(5)/5,f=function(t){var e={draw:function(t){t.renderer.rotate(Math.PI/4)},postDraw:function(t){}};return t.attach(e),t},d=function(t){var e={draw:function(t){t.renderer.rotate(-Math.PI/4)},postDraw:function(t){}};return t.attach(e),t},p=u({z:-8,name:"",addNow:!1,useHshg:!1,position:e(h.getRandom(n.width),h.getRandom(n.height)),originRelative:e(.5,.5),components:[i,r,f,o,d,a],family:[""],animation:{image:t.assets.getImage("background1cherryblossom")},init:function(){s+=(h.getRandom(10)-h.getRandom(10))/50,this.rotation.setAngleDegree(h.getRandom(360)),this.translation.setSubPixel(!0)}}).attach({update:function(){var t=p.getPosition();t.y+=.5,s+=(h.getRandom(10)-h.getRandom(10))/50,s=Math.min(Math.max(s,-1.3),.5),t.x+=s,t.y>n.height&&(t.y-=n.height),t.x<0&&(t.x+=n.width),p.scale.setScaleX(Math.sin(p.timer/(c+5))),p.rotation.addAngleDegree(l)}});return p}}),bento.define("entities/confetti",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/opacity","bento/entity","bento/utils","bento/tween","gui/camerabutton"],function(t,e,n,i,r,o,a,s,u,c){"use strict";return function(n){var r,c=t.getViewport(),h=n?n.lifeTime||180:180,l=a({z:n?n.z||0:0,name:"confetti",position:e(0,0),originRelative:e(0,0),components:[o],family:[""],addNow:!0,updateWhenPaused:!0,init:function(){var e=this;u({from:0,to:1,"in":10,ease:"linear","do":function(t,n){e.opacity.setOpacity(t)},onComplete:function(){s.timeout(h,function(){u({from:1,to:0,"in":30,ease:"linear","do":function(t,n){e.opacity.setOpacity(t)},onComplete:function(){t.objects.remove(e)}})})}})}}),f=function(){var n=a({position:e(s.getRandom(c.width),s.getRandom(c.height)),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("confetti"),frameWidth:16,frameHeight:16,animations:{"default":{speed:0,frames:[s.getRandom(3)]}}},init:function(){this.timer=s.getRandom(100)}}).attach({speedX:0,rotationSpeed:s.getRandom(5),update:function(){var t=n.getDimension(),e=n.getPosition();e.x<-t.width?e.x=c.width+t.width:e.x>c.width+t.width&&(e.x=-t.width),e.y<-t.height?e.y=c.height+t.height:e.y>c.height+t.height&&(e.y=-t.height),this.speedX+=(s.getRandom(10)-s.getRandom(10))/10,this.speedX=Math.min(Math.max(this.speedX,-2),2),e.x+=this.speedX,e.y+=1,n.scale.setScaleX(Math.sin(n.timer/(this.rotationSpeed+5)))}});l.attach(n)};for(r=0;25>r;++r)f();return t.audio.stopSound("sfx_winning-sound2-crowd8"),t.audio.playSound("sfx_winning-sound2-crowd8"),l}}),bento.define("entities/explosion",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s){"use strict";return function(n,r,s){var u=(t.getViewport(),o({z:a.Constants.Layer.EXPLOSION,name:"explosion",position:n,originRelative:e(.5,1),components:[i],family:["explosion"],sprite:{image:t.assets.getImage(r||"explosion"),frameCountX:3,frameCountY:3,animations:{explosion:{speed:s||.2,frames:[0,1,2,3,4,5,6,7,8]}}},init:function(){this.sprite.setAnimation("explosion",function(){t.objects.remove(u)})}}));return u}}),bento.define("entities/fade",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween","bento/packedimage"],function(t,e,n,i,r,o,a,s,u,c){"use strict";var h=document.createElement("canvas"),l=h.getContext("2d");return function(n,r,a){var f,d,p,g,m=t.getViewport(),v=a||e(m.width/2,m.height/2);return h.width=m.width,h.height=m.height+10,f=c(h),d=o({z:s.Constants.Layer.FADEOUT,name:"fadeout",addNow:!0,useHshg:!1,position:e(0,-2),components:[i],updateWhenPaused:!0,sprite:{image:f},init:function(){}}),r?(g=Math.sqrt(m.width*m.width+m.height*m.height),p=.01):(p=Math.sqrt(m.width*m.width+m.height*m.height),g=.01),u({from:p,to:g,"in":30,ease:"exponential",alpha:-1,beta:0,updateWhenPaused:!0,"do":function(t,e){l.globalCompositeOperation="source-over",l.fillStyle="#000000",l.fillRect(0,0,h.width,h.height),l.globalCompositeOperation="destination-out",l.beginPath(),l.arc(v.x,v.y,t,0,2*Math.PI),l.fill(),l.closePath(),h.texture&&(h.texture=null)},onComplete:function(){s.timeout(30,function(){t.objects.remove(d),n&&n()},!0)}}),d}}),bento.define("entities/food",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","entities/smoke","gui/text"],function(t,e,n,i,r,o,a,s,u,c){"use strict";return function(n){var r=t.getViewport(),u=!0,h=t.objects.get("gameState"),l=function(){var e=t.saveState.load("currentCat",{resource:"cat"}).resource;return"catlilbub"===e?"goldfish"===n?{image:t.assets.getImage(n),animations:{idle:{speed:0,frames:[0]}}}:"fish"===n?{image:t.assets.getImage("yogurt"),animations:{idle:{speed:0,frames:[0]}}}:{image:t.assets.getImage("waterballoon"),animations:{idle:{speed:0,frames:[0]}}}:"fish"===n||"goldfish"===n?{image:t.assets.getImage(n),animations:{idle:{speed:0,frames:[0]}}}:{image:t.assets.getImage("bomb"),frameWidth:32,frameHeight:32,animations:{idle:{speed:.2,frames:[0,1,2]}}}},f=o({z:a.Constants.Layer.FOOD+("goldfish"===n?1:0),name:"food",originRelative:e(.5,.5),components:[i],family:["food","bomb"===n?"bomb":"fish"],sprite:l(),init:function(){this.sprite.setAnimation("idle")}}).extend({gravity:.15,vspeed:0,hspeed:0,angle:0,angleSpeed:a.getRandom(100)/10,paused:!1,dropped:!1,forceEat:0,getType:function(){return n}}).attach({update:function(e){var i,o=f.getPosition(),l=1,p=!1;f.paused||(f.vspeed+=f.gravity,o.y+=f.vspeed,o.x+=f.hspeed),i="goldfish"===n?f.angleSpeed/4:f.angleSpeed,f.paused?(f.angle+=i/10,f.rotation.setAngleDegree(f.angle)):(f.angle+=i,f.rotation.setAngleDegree(f.angle)),"bomb"===n&&f.timer%4===0,u&&(f.hspeed>0&&o.x>f.targetPos.x&&(p=!0),f.hspeed<0&&o.x<f.targetPos.x&&(p=!0),p&&(u=!1,f.target.isMouthOpen()||1===f.forceEat?(f.target.eat(f,e),t.objects.remove(f),"goldfish"===n&&d(f.getPosition())):f.target.isMouthOpen()&&2!==f.forceEat||(l=f.getPosition().x>=r.width/2?1:-1,f.hspeed=l*(1+a.getRandom(20)/10),f.vspeed*=-1/(1+a.getRandom(20)/10),f.dropped=!0,"fish"===n?(t.saveState.save("stats_miss",t.saveState.load("stats_miss",0)+1),f.target.missFish=!0,h.dropped=h.dropped||0,h.dropped+=1,h.drop(),t.audio.stopSound("sfx_fish-hit-head"),t.audio.playSound("sfx_fish-hit-head"),h.dropped>=a.lives&&(h.isGameOver()||(a.Analytics.event("Game","missFish"),h.gameOver(e),t.objects.add(c({
z:a.Constants.Layer.FOOD+1,text:a.Localization.getText("miss"),fontSettings:a.Fonts["fontStroked-"+a.Fonts.getFontLang()],font:"font",align:"center",textBaseline:"middle",fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,fontSize:16,position:o}).attach({moved:!1,oldPos:o,update:function(e){var n=e.entity;this.moved||(this.moved=!0,s({from:o.y-64,to:o.y-32,"in":60,ease:"easeOutBounce","do":function(t,e){n.getPosition().y=t},onComplete:function(){n.dropped=!0,a.timeout(30,function(){t.objects.remove(n)})}})),n.dropped&&n.setVisible(Math.floor(n.timer/2)%2)}}))))):(t.audio.stopSound("sfx_bomb-hit-head"),t.audio.playSound("sfx_bomb-hit-head")),f.onDropped&&f.onDropped()))),o.y>r.height+32&&t.objects.remove(f)}}),d=function(n){o({z:a.Constants.Layer.FOOD+1,name:"goldFishEffect",position:n,originRelative:e(.5,.5),components:[i],family:["effects"],sprite:{image:t.assets.getImage("halo")},init:function(){var n=this,i=40;s({from:1,to:0,"in":i,ease:"squareroot","do":function(t,e){n.opacity.setOpacity(t)}}),s({from:0,to:1.5,"in":i,ease:"exponential",alpha:-5,"do":function(t,i){n.scale.setScale(e(t,t))},onComplete:function(){t.objects.remove(n)}})}}),o({z:a.Constants.Layer.FOOD+1,name:"goldFishEffect",position:n,originRelative:e(.5,.5),components:[i],family:["effects"],addNow:!0,sprite:{image:t.assets.getImage("goldfisheffect"),frameCountX:5,frameCountY:1,animations:{idle:{speed:.2,frames:[0,1,2,3,4]}}},init:function(){var e=this;this.sprite.setAnimation("idle",function(){t.objects.remove(e)})}})};return f}}),bento.define("entities/foodmanager",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","entities/food","bento/packedimage","gui/text","gui/countdown"],function(t,e,n,i,r,o,a,s,u,c,h,l){"use strict";return function(){var n,r,s,f,d,p,g,m,v=t.objects.getByFamily("cat"),b=t.getViewport(),y=0,x=60,w=t.saveState.load("tutorial",1),_="",S=t.objects.get("gameState"),E=[],T=1,A=t.saveState.load("expert",!1),C=function(n,i,r){var o,s,c,h,l=i.getPosition().add(e(0,-48)),f=i.getPosition().x>=b.width/2?1:-1,d=e(b.width/2-b.width/2*f,b.height/2-40),p=u(n),g=0,m=!1,v=1e5,x=t.objects.getByFamily("fish"===n||"goldfish"===n?"bomb":"fish"),w=function(){for(a.isDefined(r)?p.vspeed=r:(p.vspeed=-1-a.getRandom(40)/10,T>=2&&(p.vspeed-=Math.min(a.getRandom(10*T)/40,1)),p.vspeed*=Math.sqrt(T)),p.gravity*=T,o=p.vspeed*p.vspeed+2*p.gravity*(l.y-d.y),s=Math.sqrt(Math.abs(o)),p.hspeed=p.gravity*(l.x-d.x)/(-p.vspeed+s),p.setPosition(d),p.travelTime=Math.abs((l.x-d.x)/p.hspeed),p.arrivalTime=i.timer+p.travelTime,c=0;c<x.length;c+=1)a.sign(x[c].hspeed)===a.sign(p.hspeed)&&(h=Math.abs(x[c].arrivalTime-p.arrivalTime),v=Math.min(h,v));if(v<10+Math.max(0,10-y)){if(g>10)return void(m=!0);g+=1,w()}};return p.target=i,p.targetPos=l,w(),m?void 0:(t.add(p),"fish"===n||"goldfish"===n?(t.audio.stopSound("sfx_fish-throw"),t.audio.playSound("sfx_fish-throw")):(t.audio.stopSound("sfx_bomb-throw"),t.audio.playSound("sfx_bomb-throw")),p)},P=function(){var t="bomb",e=2+Math.max(0,2-y),i=0;n&&n.length&&(i=n[0].getValue()),x-=1,y=Math.floor(i/20),i>50&&(T=Math.min(1+(i-50)/200,2)),A&&(T=i>50?Math.min(2+(i-50)/200,4):2,y=Math.floor(i/2)),0!==x||S.isGameOver()||(x=a.getRandom(20+10*Math.max(0,3-y))+1,t=a.getRandom(e)?"fish":"bomb",a.getRandom(100)<15&&(t="goldfish"),C(t,v[a.getRandom(v.length)]))},I=function(){1===w&&(p=o({z:a.Constants.Layer.GUI+1,addNow:!0,init:function(){this.highlights=[],this.setVisible(!1),r=document.createElement("canvas"),r.width=b.width,r.height=b.height,s=r.getContext("2d"),f=c(r),d=o({z:0,name:"",position:e(0,0),originRelative:e(0,0),components:[i],family:[""],sprite:{image:f},init:function(){this.opacity.setOpacity(.75)}}).attach({highlights:-1,update:function(){var t,e;if(this.highlights!==p.highlights.length){for(this.highlights=p.highlights.length,s.globalCompositeOperation="source-over",s.fillStyle="#000000",s.fillRect(0,0,r.width,r.height),s.globalCompositeOperation="destination-out",t=0;t<p.highlights.length;++t)e=p.highlights[t],s.beginPath(),s.arc(e.getPosition().x,e.getPosition().y,e.getBoundingBox().width,0,2*Math.PI),s.fill(),s.closePath();r.texture&&(r.texture=null)}}}),this.attach(d)}}),w=2,a.timeout(60,function(){g=C("fish",v[0],-2),g.forceEat=1,a.timeout(25,function(){m=C("fish",v[0],-2),m.forceEat=1}),a.timeout(30,function(){var n=!1;g.paused=!0,m.paused=!0,p.highlights.push(g),p.highlights.push(m),p.highlights.push({getPosition:function(){return v[0].getPosition().add(e(0,-40))},getBoundingBox:function(){return{width:40}}}),p.attach(h({position:e(b.width/2,b.height/2),name:"explanationtext",align:"center",text:a.Localization.getText("tutorial1"+_),font:"font",fontSize:16,ySpacing:-4,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:b.width}),"text"),p.attach(o({position:v[0].getPosition().add(e(0,-16)),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("tutorialhand"),frameWidth:48,frameHeight:48,animations:{point:{speed:.05,frames:[0,1]},stop:{frames:[2]}}},init:function(){this.sprite.setAnimation("point")}}),"finger"),p.setVisible(!0),a.timeout(30,function(){g.attach({update:function(t){t.entity.paused=!0,v[0].isMouthOpen()?(t.entity.paused=!1,n=!0):n&&p.text.setText(a.Localization.getText("tutorial2"+_)),p.setVisible(t.entity.paused),t.entity.dropped&&(t.entity.paused=!0)}}),m.attach({update:function(t){t.entity.paused=!0,v[0].isMouthOpen()&&(t.entity.paused=!1),p.setVisible(t.entity.paused),t.entity.dropped&&(t.entity.paused=!0)}}),m.onEaten=function(){w=3}})})})),3===w&&(w=4,a.timeout(60,function(){g=C("fish",v[0],-2),m=C("fish",v[1],-2),g.forceEat=1,m.forceEat=1,a.timeout(30,function(){g.paused=!0,m.paused=!0,p.highlights=[],p.highlights.push(g),p.highlights.push(m),p.highlights.push({getPosition:function(){return v[0].getPosition().add(e(0,-40))},getBoundingBox:function(){return{width:40}}}),p.highlights.push({getPosition:function(){return v[1].getPosition().add(e(0,-40))},getBoundingBox:function(){return{width:40}}}),p.text.setText(a.Localization.getText("tutorial3"+_)),p.attach(o({position:v[1].getPosition().add(e(0,-16)),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("tutorialhand"),frameWidth:48,frameHeight:48,animations:{point:{speed:.05,frames:[0,1]},stop:{frames:[2]}}},init:function(){this.sprite.setAnimation("point")}}),"finger2"),p.setVisible(!0),a.timeout(30,function(){g.attach({update:function(t){t.entity.paused=!0,v[0].isMouthOpen()&&v[1].isMouthOpen()&&(t.entity.paused=!1),m.paused=t.entity.paused,p.setVisible(t.entity.paused),t.entity.dropped&&(t.entity.paused=!0)}}),g.onEaten=function(){w=5}})})})),5===w&&(w=6,a.timeout(60,function(){g=C("bomb",v[0],-2),g.forceEat=2,a.timeout(30,function(){g.paused=!0,p.highlights=[],p.highlights.push(g),p.highlights.push({getPosition:function(){return v[0].getPosition().add(e(0,-40))},getBoundingBox:function(){return{width:40}}}),p.text.setText(a.Localization.getText("tutorial4"+_)),p.finger.sprite.setAnimation("stop"),p.finger2.setVisible(!1),p.setVisible(!0),a.timeout(60,function(){g.attach({update:function(t){t.entity.paused=v[0].isMouthOpen(),w>=7&&(t.entity.paused=!1),p.setVisible(t.entity.paused)}}),g.onDropped=function(){w=7}})})})),7===w&&(w=8,a.timeout(60,function(){g=C("goldfish",v[1],-2),g.forceEat=1,a.timeout(30,function(){g.paused=!0,p.highlights=[],p.highlights.push(g),p.highlights.push({getPosition:function(){return v[1].getPosition().add(e(0,-40))},getBoundingBox:function(){return{width:40}}}),p.highlights.push({getPosition:function(){return e(b.width-24,16)},getBoundingBox:function(){return{width:16}}}),p.text.setText(a.Localization.getText("tutorial5"+_)),p.finger.setVisible(!1),p.finger2.setVisible(!0),p.setVisible(!0),a.timeout(60,function(){g.attach({update:function(t){t.entity.paused=!0,v[1].isMouthOpen()&&(t.entity.paused=!1),p.setVisible(t.entity.paused),t.entity.dropped&&(t.entity.paused=!0)}}),g.onEaten=function(){w=9}})})})),9===w&&(w=10,a.timeout(60,function(){w=0,t.saveState.save("tutorial",0),l()}))},R=o({z:0,name:"foodmanager",init:function(){}}).attach({timer:0,update:function(){return n?void(w>0?I():P()):void(n=t.objects.getByName("counter"))}});return E.push({60:{type:"fish",target:0,vspeed:-2},90:{type:"bomb",target:0,vspeed:-2},120:{type:"fish",target:0,vspeed:-2},180:{type:"fish",target:1,vspeed:-2},210:{type:"bomb",target:1,vspeed:-2},240:{type:"fish",target:1,vspeed:-2,end:!0}}),a.isMobile()||(_="desktop"),R}}),bento.define("entities/gamestate",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/components/scale","bento/components/rotation","bento/entity","bento/utils","bento/tween","bento/gui/clickbutton","gui/bestscore","gui/text","entities/minigame","break","entities/prize","bento/packedimage","entities/fade","entities/socialcat","entities/polaroid","bento/eventsystem","entities/nomslotstimer"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v,b,y,x,w,_){"use strict";return function(){var o,a=t.getViewport(),s=c.lives,p=0,x=[],_=!1,S=t.saveState.load("usedContinue",!1),E=t.saveState.load("playCount",1),T=!1,A=function(e,n){var i,r,o=t.saveState.load("goldfish",0),a=t.saveState.load("unlocked",["cat"]);t.pause(),i=m(),t.audio.stopSound("sfx_winning-sound2-crowd8"),t.audio.playSound("sfx_winning-sound2-crowd8"),i.updateWhenPaused=!0,t.objects.add(i),n?(i.unlockedCat(n),a.push(n),t.saveState.save("unlocked",a),a.length>=20&&(c.isNativeAndroid()&&c.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQBg",!1)&&c.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQBg",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQBg",!0)}),c.isNativeIos()&&c.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQBg",!1)&&c.GameCenter.postAchievement("CgkI3NDPhKAbEAIQBg",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQBg",!0)}))):(i.setText("+"+e),o+=e,t.saveState.save("goldfish",o)),c.timeout(120,function(){h({from:1,to:0,"in":60,ease:"linear",updateWhenPaused:!0,alpha:0,beta:0,"do":function(t,e){i.opacity.setOpacity(t)},onComplete:function(){t.resume(),t.objects.remove(i),r=t.objects.getByName("goldfishtext"),r&&r[0].setText(o.toString())}})},!0)},C=function(n){var r,o=4,a=16+o,s=e(8+a/2*n,16);r=u({z:c.Constants.Layer.GUI,name:"icon",position:s.clone(),originRelative:e(.5,.5),components:[i],family:["icon"],sprite:{image:t.assets.getImage("fishicon"),frameWidth:18,frameHeight:18,animations:{"default":{speed:0,frames:[0]},miss:{speed:0,frames:[1]}}},init:function(){}}).extend({position:s.clone(),shake:function(){var t=this;h({from:1,to:0,"in":30,ease:"linear",alpha:0,beta:0,"do":function(n,i){var o=e(0,0);o.x=t.position.x+(c.getRandom(4)-c.getRandom(4))*n,o.y=t.position.y+(c.getRandom(4)-c.getRandom(4))*n,r.setPosition(o)},onComplete:function(){r.setPosition(t.position)}})}}),x.push(r),t.objects.add(r)},P=60+c.getRandom(600),I=u({z:0,name:"gameState",init:function(){var t;if(s>1)for(t=0;s>t;++t)C(t)}}).extend({dropped:0,isGameOver:function(){return _},gameOver:function(e){var n,r=60,o=[],a=t.objects.getByName("pauseButton"),s=t.objects.get("counter");this.isGameOver()||(n=g.canShow(),_=!0,a&&a.length&&t.objects.remove(a[0]),s&&(s.z=c.Constants.Layer.GUI+2),c.timeout(5,function(){o=t.objects.getByName("cat"),2===o.length&&("catkeyboard"===o[0].getResourceName()&&o[0].isPlaying||"catkeyboard"===o[1].getResourceName()&&o[1].isPlaying)&&(r=1,console.log("found keyboard")),c.timeout(r,function(){h({from:1,to:0,"in":r,ease:"linear",alpha:0,beta:0,"do":function(e,n){t.audio.setVolume(e,"bgm_cat-ingame"),t.audio.setVolume(e,"bgm_asian"),t.audio.setVolume(e,"bgm_french"),t.audio.setVolume(e,"bgm_harbor")},onComplete:function(){t.audio.stopAllMusic(),w.fire("musicStopped")}})})}),c.timeout(60,function(){var e=u({z:c.Constants.Layer.GUI+1,name:"fadeout",components:[i],sprite:{image:t.assets.getImage("black333")},addNow:!0,init:function(){this.opacity.setOpacity(0)}});c.timeout(30,function(){h({from:0,to:1,"in":60,ease:"linear",alpha:0,beta:0,"do":function(t,n){e.opacity.setOpacity(t)},onComplete:function(){var e=t.objects.get("counter").getValue();c.EveryPlay.stop(),!S&&g.canShow()&&e>0?t.saveState.load("noOnContinue",0)>=10?R():M():k()}})})}))},drop:function(){this.isGameOver()||(p<x.length&&(x[p].sprite.setAnimation("miss"),x[p].shake()),p+=1)}}).attach({update:function(){P-=1,0!==P||I.isGameOver()||(P=120+c.getRandom(600),t.audio.stopSound("sfx_extra-meow"),t.audio.stopSound("sfx_meow"),t.audio.playSound("sfx_meow"))}}),R=function(){d({z:c.Constants.Layer.GUI+3,text:c.Localization.getText("forcead"),align:"center",textBaseline:"middle",font:"font",fontColor:"#fff",fontSize:16,fontSettings:c.Fonts["font-"+c.Fonts.getFontLang()],addNow:!0,maxWidth:a.width-32,position:e(a.width/2,a.height/2-16)});t.saveState.save("noOnContinue",0),c.timeout(180,function(){t.audio.stopAllMusic(),c.Analytics.event("UI","forcedAd"),g.show(function(t){console.log("Trying to show ad:",t)},function(){t.saveState.save("continueState",t.objects.get("counter").getValue()),t.saveState.save("background",t.saveState.load("previousBackground","background0")),t.screens.show("screens/main")})})},M=function(){var n=d({z:c.Constants.Layer.GUI+3,text:c.Localization.getText("continue2"),align:"center",textBaseline:"middle",font:"font",fontColor:"#fff",fontSize:16,fontSettings:c.Fonts["font-"+c.Fonts.getFontLang()],addNow:!0,maxWidth:a.width-32,position:e(a.width/2,a.height/2-16)}),i=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttonresume"),position:e(a.width/2+32,a.height/2+48),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){t.objects.remove(i),n.setText(c.Localization.getText("loading")),c.Analytics.event("UI","yesOnContinue"),t.audio.stopAllMusic(),t.saveState.save("noOnContinue",0),g.show(function(t){console.log("Trying to show ad:",t)},function(){t.saveState.save("continueState",t.objects.get("counter").getValue()),t.saveState.save("background",t.saveState.load("previousBackground","background0")),t.screens.show("screens/main")})}}),r=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttonno"),position:e(a.width/2-32,a.height/2+48),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){t.objects.remove(n),t.objects.remove(i),t.objects.remove(r),c.Analytics.event("UI","noOnContinue"),t.saveState.save("noOnContinue",t.saveState.load("noOnContinue",0)+1),k()}})},k=function(){O()},O=function(){var s,p=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttonresume"),position:e(-a.width/2,a.height/2),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){t.objects.pause(),b(function(){t.objects.resume(),t.screens.show("screens/main")},!1,this.getPosition()),c.Analytics.event("UI","resume")},init:function(){this.setBoundingBox(n(-24,-18,48,36))}}),m=l({z:c.Constants.Layer.GUI+5,name:"buttonSelect",image:t.assets.getImage("buttoncat"),position:e(-a.width/2-44,a.height/2),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){t.objects.pause(),b(function(){t.objects.resume(),t.screens.show("screens/select")},!1,this.getPosition())},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}).extend({bounce:function(){h({from:1.3,to:1,"in":60,ease:"elastic",alpha:-5,beta:2,"do":function(t,e){m.scale.setScaleX(t),m.scale.setScaleY(1/t)},onComplete:function(){}})}}),x=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttoncatlarge"),position:e(-a.width/2+44,a.height/2),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){F>=c.gachaPrice?(t.objects.pause(),b(function(){t.objects.resume(),t.screens.show("screens/gacha")},!1,this.getPosition())):(t.audio.stopSound("sfx_error"),t.audio.playSound("sfx_error"))},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}),w=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttonbackground"),position:e(-a.width/2+44,a.height/2),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){t.objects.pause(),b(function(){t.objects.resume(),t.screens.show("screens/background")},!1,this.getPosition())},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}),_=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttoncat"),position:e(a.width/2+20+40,a.height+24),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){t.objects.pause(),b(function(){t.objects.resume(),t.screens.show("screens/select")},!1,this.getPosition()),c.Analytics.event("UI","selectButton")},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}),S=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttonpaw"),position:e(a.width/2-20,a.height+24),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){j.z=c.Constants.Layer.GUI,t.saveState.save("expert",!t.saveState.load("expert",0)),t.saveState.load("expert",!1)?t.objects.add(j):t.objects.remove(j)},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}),C=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttonnomslots"),position:e(a.width/2-20-40,a.height+24),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){z.isActive&&(t.objects.pause(),b(function(){t.objects.resume(),t.screens.show("screens/nomslots")},!1,C.getPosition()))},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}),P=l({z:c.Constants.Layer.GUI+2,image:t.assets.getImage("buttoncatlarge"),position:e(-a.width/2,a.height/2),frameWidth:128,frameHeight:48,sfx:"sfx_button",onClick:function(){t.screens.show("screens/select")}}),I=u({z:c.Constants.Layer.GUI+1e3,init:function(){var t,e;this.highlights=[],t=document.createElement("canvas"),t.width=a.width,t.height=a.height,e=t.getContext("2d"),this.tutorialOverlayImage=v(t),this.tutorialOverlay=u({components:[i],sprite:{image:this.tutorialOverlayImage},init:function(){this.opacity.setOpacity(.75)}}).attach({update:function(n){var i,r;for(e.globalCompositeOperation="source-over",e.fillStyle="#000000",e.fillRect(0,0,t.width,t.height),e.globalCompositeOperation="destination-out",i=0;i<I.highlights.length;++i)r=I.highlights[i],e.beginPath(),e.arc(r.getPosition().x,r.getPosition().y,r.getBoundingBox().width/2,0,2*Math.PI),e.fill(),e.closePath()}}),this.attach(this.tutorialOverlay)}}),R=function(n,r,o,s){var f=u({z:c.Constants.Layer.GUI+2,name:"buttonFish",components:[i],sprite:{image:t.assets.getImage("nothing48")},position:e(a.width/2+48,a.height/2+48),originRelative:e(0,0),family:[""],init:function(){}}).attach({height:0,init:function(){h({from:0,to:36,"in":10,ease:"exponential",alpha:-6,onComplete:function(){var a=u({z:c.Constants.Layer.GUI+2,components:[i],sprite:{image:t.assets.getImage("black40")},position:e(0,2),originRelative:e(.5,.5)}),p=d({z:c.Constants.Layer.GUI+3,name:"actionText",text:r,align:"center",textBaseline:"middle",maxWidth:112,font:"font",fontColor:"#fff",fontSize:16,ySpacing:-4,fontSettings:c.Fonts["fontTight-"+c.Fonts.getFontLang()],position:e(-72,-4)}),g=l({z:c.Constants.Layer.GUI+2,name:o,image:t.assets.getImage(o),frameWidth:48,frameHeight:48,animations:s,sfx:"sfx_button",onClick:function(){n&&n(),t.objects.remove(f)}});h({from:-200,to:-76,"in":20,ease:"elastic",alpha:-6,beta:1,"do":function(t,e){p.getPosition().x=t}}),h({from:-200,to:-48,"in":20,ease:"elastic",alpha:-6,beta:1,"do":function(t,e){a.getPosition().x=t}}),h({from:100,to:-4,"in":20,ease:"elastic",alpha:-6,beta:1,"do":function(t,e){g.getPosition().x=t}}),f.attach(a),f.attach(p),f.attach(g),g.start()}})}});t.objects.add(f)},M=function(){var e,n,i=t.saveState.load("seenCats",["cat"]),r=t.saveState.load("goldfish",0),o=!1;for(e=0;e<c.cats.length;++e)r>=c.cats[e].price&&(n=c.cats[e],-1===i.indexOf(n.resource)&&(i.push(n.resource),o=!0));return o},k=u({position:e(0,-21),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("newcat"),frameCountX:6,frameCountY:1,animations:{"new":{speed:.2,frames:[0,1,2,3,4,5]}}},init:function(){this.sprite.setAnimation("new")}}),O=(u({position:e(0,-21),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("share"),frameCountX:5,frameCountY:1,animations:{share:{speed:.2,frames:[0,1,2,3,4]}}},init:function(){this.sprite.setAnimation("share")}}),t.objects.get("counter").getValue()),D=t.saveState.load("expert",!1),L=D?"highscoreTurbo":"highscore",B=Math.max(O,c.SaveState.load(L,0)),N=f(B),F=t.saveState.load("goldfish",0),j=u({z:c.Constants.Layer.GUI+2,name:"turbo",addNow:!1,useHshg:!1,position:e(a.width/2,2),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("expert")}}),U=l({z:c.Constants.Layer.GUI+1,image:t.assets.getImage("buttonhome"),position:e(-44,24),frameWidth:48,frameHeight:48,onClick:function(){b(function(){t.screens.show("screens/main",!0)},!1,this.getPosition())}}),z=u({z:c.Constants.Layer.GUI+2,name:"nomSlotsIcon",position:e(48,a.height-16),originRelative:e(.5,1),components:[i,r],sprite:{image:t.assets.getImage("nomslotssmall"),frameCountX:1,frameCountY:3,animations:{inactive:{frames:[2]},active:{speed:.025,frames:[0,1]}}},clickable:{onClick:function(){z.isActive&&(t.objects.pause(),b(function(){t.objects.resume(),t.screens.show("screens/nomslots")},!1,z.getPosition()))}},init:function(){this.sprite.setAnimation("inactive")}}),G=d({z:c.Constants.Layer.GUI+3,text:"next Nom Slots in:",font:"font",align:"center",textBaseline:"middle",fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,fontSize:16,maxWidth:120,position:e(0,-20)}).attach({update:function(){}}),H=function(){var e=t.saveState.load("lastTimeWatched",0),n=Date.now()-e,i=n/1e3/60,r=!1,o=[],a=function(){R(function(){t.screens.show("screens/gacha")},c.Localization.getText("gacha"),"buttongachagoldanim",{up:{speed:.2,frames:[0,0,0,0,0,0,0,0,0,1,2,3,5,6]},"default":{speed:.15,frames:[0,0,1,2,3,5,6]},down:{speed:0,frames:[7]}})},s=function(){R(function(){A(c.gachaPrice+c.getRandom(16)),t.saveState.save("lastTimeWatched",Date.now()),a()},c.Localization.getText("gift"),"buttongift",{up:{speed:.2,frames:[0,0,0,0,0,0,0,0,0,1,2,3,5,6]},"default":{speed:.15,frames:[0,0,1,2,3,5,6]},down:{speed:0,frames:[7]}})},u=function(){var e,n=t.saveState.load("lastTimeWatched",0),i=0,r=0,o=0,a=c.Localization.getText("nextgift");R(function(){Date.now()-t.saveState.load("lastTimeWatched",0)>18e4&&s()},a,"nothing48"),c.timeout(11,function(){t.objects.attach({start:function(){e=t.objects.get("buttonFish").getComponentByName("actionText")},update:function(){i=Date.now()-n,r=2-Math.floor(i/1e3/60),0>r&&(r=0),r=r.toString(),o=59-Math.floor(i/1e3%60),o=0>o||Math.floor(i/1e3/60)>=3?"00":10>o?"0"+o.toString():o.toString(),e.setText(a+r+":"+o)}})})};console.log("Last time watched (minutes)",i),(E>=5||t.saveState.load("unlocked",["cat"]).length>2)&&(O>50||t.saveState.load("justWonNomSlots",!1)||T)&&(r=!0),i>=3?s():(console.log("no ad available"),g.load(),t.saveState.load("goldfish",0)>=c.gachaPrice?o.push(a):o.push(u),o.length&&o[c.getRandom(o.length)]())};t.saveState.save("usedContinue",!1),s=t.objects.getByName("goldfishtext"),s&&s[0].setText(F.toString()),c.SaveState.save(L,B),c.isNativeIos()?D?c.GameCenter.post(O,"nomcatturbo",function(t){t&&console.log("error: error"),console.log("GC score sent (expert mode)")}):c.GameCenter.post(O,"nomcathighscore",function(t){t&&console.log("error: error"),console.log("GC score sent")}):c.isNativeAndroid()&&(t.saveState.load("expert",!1)?c.GooglePlay.post(O,"CgkI3NDPhKAbEAIQCA",function(){console.log("GP score sent (expert mode)")}):c.GooglePlay.post(O,"CgkI3NDPhKAbEAIQAQ",function(){console.log("GP score sent")})),t.objects.add(m),t.objects.add(p),t.objects.add(U),t.saveState.load("expert",!1)&&t.objects.add(j),t.objects.add(w),C.attach(G),a.width<=160&&(C.scale.setScale(e(.75,.75)),S.scale.setScale(e(.75,.75)),w.scale.setScale(e(.75,.75)),_.scale.setScale(e(.75,.75))),H(),t.objects.add(N),h({from:-a.width/2,to:a.width/2+24-7*N.getDigits(),"in":30,ease:"exponential",alpha:-5,beta:0,"do":function(t,e){N.getPosition().x=t}}),function(){var t=function(t,e,n){c.timeout(n,function(){h({"in":20,onComplete:function(){h({from:-a.width/2,to:a.width/2,"in":20,ease:"exponential",alpha:-6,beta:1,"do":function(n,i){t.getPosition().x=n+e}})}})})},e=function(t,e,n){c.timeout(n,function(){h({"in":20,onComplete:function(){h({from:a.height+24,to:a.height-24,"in":20,ease:"exponential",alpha:-6,beta:1,"do":function(n,i){t.getPosition().y=n+e}})}})})};t(m,-44,20),t(p,0,10),t(w,44,0),t(U,24-a.width/2,0),e(_,0,30),e(S,0,50),e(C,0,60)}(),M()&&(_.attach(k),P.attach(k)),c.Analytics.event("Game","score",O),E+=1,t.saveState.save("playCount",E),t.saveState.save("playCount"+c.version,t.saveState.load("playCount"+c.version,0)+1),o=y(),x.attach(o),o.scale.setScaleX(-1)};return I}}),bento.define("entities/luckykatlogo",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(n){var r,o,c,h,l=t.getViewport(),f=[],d=[],p=[],g=a({z:1,name:"keyboard",position:e(l.width/2,l.height+100),originRelative:e(0,0),components:[i],sprite:{image:t.assets.getImage("nothing")},family:[""],addNow:!0,init:function(){}}).attach(a({position:e(0,-90),originRelative:e(.5,0),components:[i],sprite:{image:t.assets.getImage("keyboardbackground")}})),m=function(n,r){var o=a({z:0,name:"",position:r,originRelative:e(.5,1),components:[i],family:[""],sprite:{image:t.assets.getImage("keyboardletters"),frameCountX:10,frameCountY:3,animations:{letter:{speed:0,frames:[n]}}},init:function(){this.sprite.setAnimation("letter")}});return f.push(o),o},v=function(n,r){var o,s=f[r],u=0;o=a({z:0,name:"",position:e(0,0),originRelative:e(.5,1),components:[i],family:[""],sprite:{image:t.assets.getImage("keyboardletterspressed"),frameCountX:8,frameCountY:1,animations:{letter:{speed:0,frames:[n>=0?n:0]}}},init:function(){this.sprite.setAnimation("letter")}}).extend({show:function(){0>n||(u=5,this.setVisible(!0))}}).attach({update:function(){u>0?(o.setVisible(!0),u-=1):o.setVisible(!1)}}),o.setVisible(!1),s.attach(o),d.push(o)},b=a({z:10,name:"lucky",position:e(l.width/2,l.height/2),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("luckykatlogo")},addNow:!0,init:function(){}});for(r=0;9>r;++r)p.push(a({z:0,name:"",position:e(-56+14*r,64),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("luckykatletters"),frameWidth:14,frameHeight:12,animations:{letter:{speed:0,frames:[r]}}},init:function(){this.setVisible(!1),this.sprite.setAnimation("letter")}})),b.attach(p[r]);for(c=-68,h=l.width,r=0;10>r;++r)o=m(r,e(-h/2+h/10*(r+.5),c)),g.attach(o);for(h=l.width-16,c+=20,r=0;9>r;++r)o=m(10+r,e(-h/2+h/9*(r+.5),c)),g.attach(o);for(h=l.width-40,c+=20,r=0;7>r;++r)o=m(20+r,e(-h/2+h/7*(r+.5),c)),g.attach(o);return g.attach(a({position:e(-0.875*l.width/2,c),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("keyboardextra"),frameCountX:4,frameCountY:1,animations:{letter:{speed:0,frames:[3]}}},init:function(){this.sprite.setAnimation("letter")}})),g.attach(a({position:e(.875*l.width/2,c),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("keyboardextra"),frameCountX:4,frameCountY:1,animations:{letter:{speed:0,frames:[2]}}},init:function(){this.sprite.setAnimation("letter")}})),c+=20,g.attach(a({position:e(0,c),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("keyboardspace")}})),g.attach(a({position:e(-0.625*l.width/2,c),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("keyboardextra"),frameCountX:4,frameCountY:1,animations:{letter:{speed:0,frames:[1]}}},init:function(){this.sprite.setAnimation("letter")}})),g.attach(a({position:e(-0.875*l.width/2,c),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("keyboardextra"),frameCountX:4,frameCountY:1,animations:{letter:{speed:0,frames:[0]}}},init:function(){this.sprite.setAnimation("letter")}})),g.attach(a({position:e(.75*l.width/2,c),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("keyboardsearch")},init:function(){this.sprite.setAnimation("letter")}})),v(0,18),v(1,6),v(2,22),v(3,17),v(4,5),v(-1,0),v(5,17),v(6,20),v(7,4),s.timeout(60,function(){u({from:l.height/2,to:l.height/2-60,"in":20,ease:"exponential",alpha:-4,beta:0,"do":function(t,e){b.getPosition().y=t},onComplete:function(){}}),u({from:l.height+100,to:l.height,"in":20,ease:"exponential",alpha:-4,beta:0,"do":function(t,e){g.getPosition().y=t},onComplete:function(){s.timeout(30,function(){var e=0;for(e=0;9>e;++e)u({"in":10*e,id:e,onComplete:function(){d[this.id].show(),p[this.id].setVisible(!0),t.audio.stopSound("sfx_keybaordsound"),t.audio.playSound("sfx_keybaordsound")}})}),s.timeout(160,function(){t.audio.stopSound("sfx_meow"),t.audio.playSound("sfx_meow")}),s.timeout(150,function(){u({from:l.height,to:l.height+100,"in":20,ease:"exponential",alpha:-4,beta:0,"do":function(t,e){g.getPosition().y=t},onComplete:function(){s.timeout(30,n)}}),u({from:l.height/2-60,to:l.height/2,"in":20,ease:"exponential",alpha:-4,beta:0,"do":function(t,e){b.getPosition().y=t},onComplete:function(){}})})}})}),b}}),bento.define("entities/minigame",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/components/fill","bento/components/opacity","bento/entity","bento/utils","bento/tween","bento/packedimage","bento/gui/clickbutton","entities/backscroller","entities/confetti","gui/text","entities/prize","entities/nomslotstimer"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v){"use strict";return function(r){var a=t.getViewport(),s=27,l=a.height/3,b={part1:null,part2:null,part3:null},y={pos:0,attached:0,running:!0,speed:6,stop:function(){var t=this;this.running=!1,h({from:this.pos,to:this.pos+80*this.attached,"in":80*this.attached/this.speed/.5,ease:"easeOutQuad",alpha:-1,"do":function(e,n){t.pos=e},onComplete:function(){var e=80*Math.floor(t.pos/80)+40,n=Math.floor(t.pos/80)%t.attached;n+=t.attached-1,n%=t.attached,h({from:t.pos,to:e,"in":60,ease:"elastic",alpha:-5,beta:5,"do":function(e,n){t.pos=e},onComplete:function(){var e,n,i,r=1e5;for(e=0;e<t.slices.length;++e)n=t.slices[e],n.update({}),Math.abs(n.getPosition().x)<r&&(r=Math.abs(n.getPosition().x),i=n);b[t.name]=i.getName(),b.part1&&b.part2&&b.part3&&D()}})}})}},x={update:function(t){var e=t.entity;e.running&&(e.pos+=e.speed)}},w=u({z:c.Constants.Layer.GUI+11,name:"part1",position:e(0,-s),originRelative:e(0,0),components:[o],init:function(){}}).extend(y).attach(x).extend({slices:[]}),_=u({z:c.Constants.Layer.GUI+11,name:"part2",position:e(0,0),originRelative:e(0,0),components:[o],init:function(){}}).extend(y).attach(x).extend({slices:[],reversed:!0}),S=u({z:c.Constants.Layer.GUI+11,name:"part3",position:e(0,s),originRelative:e(0,0),components:[o],init:function(){}}).extend(y).attach(x).extend({slices:[]}),E=u({z:c.Constants.Layer.GUI+12,name:"border",position:e(a.width/2,l),origin:e(96,81),components:[i],family:[""],sprite:{image:t.assets.getImage("minigameborder")},init:function(){var n=0,r=u({position:e(-a.width/2,0),origin:e(0,81),components:[i],sprite:{image:t.assets.getImage("minigameborder"),frameWidth:96,frameHeight:167,animations:{"default":{speed:0,frames:[0]}}}}),o=u({position:e(a.width/2,0),origin:e(96,81),components:[i],sprite:{image:t.assets.getImage("minigameborder"),frameWidth:96,frameHeight:167,animations:{"default":{speed:0,frames:[1]}}},init:function(){}}),s=function(){var r=u({position:e((n%5-2)*a.width/5,-64+124*Math.floor(n/5)),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("minigamelamp"),frameCountX:2,frameCountY:1,animations:{flicker:{speed:.1,frames:[n%2,(n+1)%2]}}},init:function(){this.sprite.setAnimation("flicker")}});return r};for(this.attach(r),this.attach(o),n=0;10>n;++n)this.attach(s())}}),T=!0,A=u({init:function(){var n=u({position:e(0,8),originRelative:e(.5,1),components:[i],
sprite:{image:t.assets.getImage("minigametitle")},init:function(){}}),r=g({position:e(0,8),name:"explanationtext",font:"font",text:c.Localization.getText("nomslots"),fontSize:16,ySpacing:-4,fontSettings:c.Fonts["fontTight-"+c.Fonts.getFontLang()],margin:e(8,8),align:"center",textBaseline:"top",fontColor:"#ffffff",maxWidth:a.width-16}),o=82;this.attach(u({position:e(-a.width/2-32,-o/2),components:[i],sprite:{image:t.assets.getImage("minigamegray")}})),this.attach(n),n.scale.setScale(e(0,0)),c.timeout(60,function(){h({from:0,to:1,"in":60,ease:"elastic",alpha:-6,beta:4,"do":function(t,i){n.scale.setScale(e(t,t))},onComplete:function(){A.attach(r),c.timeout(120,function(){h({from:1,to:0,"in":10,ease:"linear","do":function(t,e){n.opacity.setOpacity(t)}}),h({from:82,to:1,"in":10,ease:"linear",alpha:-5,"do":function(t,e){o=t},onComplete:function(){T=!1,E.remove(A),R.setActive(!0)}})})}})})}}),C=[],P=d("backgroundtilered",3,4,0,0,c.Constants.Layer.GUI+10,[208/255,39/255,56/255,1]),I=m(),R=f({z:c.Constants.Layer.GUI+13,image:t.assets.getImage("minigamebutton"),frameWidth:90,frameHeight:93,originRelative:e(.3,.5),position:e(a.width/2,a.height-46),sfx:"sfx_button",active:!1,onClick:function(t){w.running?w.stop():_.running?_.stop():S.running&&S.stop()}}),M=u({z:0,name:"",position:e(0,0),originRelative:e(0,0),components:[],family:[""],init:function(){}}),k=function(r,o){var a,c,h,l="cat"===r.substring(0,3),f=t.assets.getImage(r),d=f.width,p=f.height;l&&(d/=2,p/=2),C[o].attached=C[o].attached||0,h=C[o].attached,a=n(f.x,f.y+p-(3-o)*s,d,s),a.image=f.image,c=u({position:e(80*h-80,0),originRelative:e(.5,.5),components:[i],sprite:{image:a}}).attach({update:function(){var t=C[o],e=(t.pos+80*h)%(80*C[o].attached),n=c.getPosition();n.x=e-200,1===o&&(n.x=-n.x)}}).extend({getName:function(){return r}}),C[o].attach(c),C[o].slices.push(c),C[o].attached+=1},O=function(e){var n=t.saveState.load("goldfish",0),i=t.saveState.load("unlocked",["cat"]);"minigamebomb"===e?(I.setText("+10"),n+=10,c.Analytics.event("MiniGame","winBomb")):"minigamefish"===e?(I.setText("+25"),n+=25,c.Analytics.event("MiniGame","winFish")):"minigamegoldfish"===e?(I.setText("+50"),n+=50,c.Analytics.event("MiniGame","winGoldFish")):i.indexOf(e)<0?(I.unlockedCat(e),i.push(e),t.saveState.save("unlocked",i),c.Analytics.event("MiniGame","unlocked_"+e),i.length>=20&&(c.isNativeAndroid()&&c.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQBg",!1)&&c.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQBg",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQBg",!0)}),c.isNativeIos()&&c.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQBg",!1)&&c.GameCenter.postAchievement("CgkI3NDPhKAbEAIQBg",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQBg",!0)}))):(I.setText("+50"),n+=50),t.saveState.save("goldfish",n),c.Analytics.event("MiniGame","winCat"),c.isNativeAndroid()&&c.GooglePlay.isLoggedIn()&&!t.saveState.load("GP-CgkI3NDPhKAbEAIQBQ",!1)&&c.GooglePlay.postAchievement("CgkI3NDPhKAbEAIQBQ",function(){t.saveState.save("GP-CgkI3NDPhKAbEAIQBQ",!0)}),c.isNativeIos()&&c.GameCenter.isLoggedIn()&&!t.saveState.load("GC-CgkI3NDPhKAbEAIQBQ",!1)&&c.GameCenter.postAchievement("CgkI3NDPhKAbEAIQBQ",function(){t.saveState.save("GC-CgkI3NDPhKAbEAIQBQ",!0)})},D=function(){b.part1===b.part2&&b.part2===b.part3?(t.saveState.save("justWonNomSlots",!0),c.timeout(30,function(){p({z:c.Constants.Layer.GUI+14}),c.timeout(10,function(){t.objects.add(I),O(b.part1)}),c.timeout(240,L)})):(t.audio.stopSound("sfx_crowd_aw"),t.audio.playSound("sfx_crowd_aw"),c.Analytics.event("MiniGame","lose"),c.timeout(120,L))},L=function(){h({from:1,to:0,"in":60,ease:"linear",alpha:0,beta:0,"do":function(e,n){t.audio.setVolume(e,"bgm_cat-minigame")},onComplete:function(){t.audio.stopAllMusic(),t.saveState.save("lastMiniGame",Date.now()),v().reset(),r()}})};return C.push(w),C.push(_),C.push(S),E.attach(w),E.attach(_),E.attach(S),E.attach(A),c.Analytics.event("MiniGame","startNomSlots"),h({from:0,to:1,"in":10,ease:"linear","do":function(t,e){P.opacity.setOpacity(t)}}),c.timeout(30,function(){var e,n=c.cats,i="cat",r=!1;for(e=0;e<n.length/2;++e)if(n[e].price!==1/0&&"catgrumpy"!==n[e].resource&&"catnyan"!==n[e].resource&&"catkeyboard"!==n[e].resource)if("cat"!==n[e].resource){if(r&&0===c.getRandom(2)){i=n[e].resource;break}}else r=!0;t.audio.playMusic("bgm_cat-minigame",!0),t.audio.setVolume(1,"bgm_cat-minigame"),k(i,0),k("minigamefish",0),k("minigamebomb",0),k("minigamefish",0),k("minigamegoldfish",0),k("minigamebomb",1),k("minigamefish",1),k("minigamegoldfish",1),k(i,1),k("minigamefish",1),k("minigamegoldfish",2),k("minigamefish",2),k("minigamebomb",2),k(i,2),k("minigamefish",2),t.objects.add(E),h({from:1.5*a.height,to:l,"in":20,ease:"exponential",alpha:-6,beta:0,"do":function(t,e){E.getPosition().y=t},onComplete:function(){}}),c.timeout(10,function(){t.objects.add(R),h({from:1.5*a.height,to:R.getPosition().y,"in":20,ease:"exponential",alpha:-6,beta:0,"do":function(t,e){R.getPosition().y=t},onComplete:function(){}})})}),M}}),bento.define("entities/nomslotstimer",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";var c;return function(){return t.objects.get("nomslotsTimer")||(c=o({z:0,name:"nomslotsTimer",addNow:!0,global:!0,init:function(){this.nomslotstimer=t.saveState.load("nomslotsTimer",36e3)}}).attach({update:function(e){e.entity.nomslotstimer>0&&(e.entity.nomslotstimer-=1),e.entity.nomslotstimer%600===1&&t.saveState.save("nomslotsTimer",e.entity.nomslotstimer)}}).extend({getTime:function(){var t=Math.floor(this.nomslotstimer/60),e=t%60,n=Math.floor(t/60),i=""+n+":"+("00"+e).slice(-2);return i},reset:function(){this.nomslotstimer=36e3,t.saveState.save("nomslotsTimer",36e3)},canPlay:function(){return this.nomslotstimer<=0}})),c}}),bento.define("entities/photo",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/components/rotation","bento/components/scale","bento/entity","bento/eventsystem","bento/utils","bento/tween","bento/packedimage","entities/title"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d){"use strict";var p,g=document.createElement("canvas"),m=g.getContext("2d"),v=4,b=160,y=160;return g.width=b*v,g.height=y*v,m.imageSmoothingEnabled&&(m.imageSmoothingEnabled=!1),m.webkitImageSmoothingEnabled&&(m.webkitImageSmoothingEnabled=!1),m.mozImageSmoothingEnabled&&(m.mozImageSmoothingEnabled=!1),window.takepic=function(){var t=p();t.snap(),console.log(t.getBase64())},p=function(){var n,r=(t.getViewport(),t.getRenderer(),d(),u({z:0,name:"turbo",position:e(0,0),originRelative:e(.5,0),components:[i],sprite:{image:t.assets.getImage("expert")}}),u({z:h.Constants.Layer.PHOTO,name:"photo",addNow:!1,useHshg:!1,position:e(0,0),originRelative:e(0,0),components:[o,s,a],family:[""],init:function(){}}).extend({getBase64:function(){return g.toDataURL()},drawScore:function(){return},snap:function(t){return},share:function(t,e){Cocoon.Share.share({message:t,image:r.getBase64()},e)},getImage:function(){return n},getScale:function(){return v}}));return r.setVisible(!1),r}}),bento.define("entities/polaroid",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/translation","bento/components/scale","bento/components/rotation","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u,c,h,l){"use strict";return function(n){var s=t.getViewport(),c=t.objects.get("photo"),f=.46,d=(u({z:h.Constants.Layer.GUI+3,name:"sharebutton",addNow:!1,useHshg:!1,position:e(s.width/2,s.height/2),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("buttonshare"),frameCountX:1,frameCountY:2},init:function(){}}),u({z:h.Constants.Layer.GUI+3,name:"polaroid",addNow:!1,useHshg:!1,position:e(s.width/2,s.height/2),components:[r,o,a],originRelative:e(0,0),init:function(){this.scale.setScale(e(f/c.getScale(),f/c.getScale()))}}).attach({draw:function(t){t.renderer.fillRect([1,1,1,1],-100*c.getScale(),-100*c.getScale(),200*c.getScale(),220*c.getScale())}}));c?(c.drawScore(),d.attach(u({z:0,name:"photo",position:e(0,0),originRelative:e(.5,.5),components:[i],sprite:{image:c.getImage()},init:function(){}})),t.objects.add(d),l({from:0,to:h.getRandom(10)-h.getRandom(10),"in":25,ease:"exponential",alpha:-5,beta:0,"do":function(t,e){d.rotation.setAngleDegree(t)},onComplete:function(){}}),l({from:-s.height/2,to:s.height/4,"in":25,ease:"exponential",alpha:-5,beta:0,"do":function(t,e){d.getPosition().y=t},onComplete:function(){n(),h.timeout(60,function(){var n=t.objects.get("buttonShare"),i=30;console.log(n.getPosition().x),l({from:d.getPosition().x,to:n.getPosition().x,"in":i,ease:"linear","do":function(t,e){d.setPositionX(t)}}),l({from:d.getPosition().y,to:n.getPosition().y,"in":i,ease:"quadratic","do":function(t,e){d.setPositionY(t)}}),l({from:f/c.getScale(),to:0,"in":i,ease:"linear",alpha:-4,beta:0,"do":function(t,n){d.scale.setScale(e(t,t))},onComplete:function(){n.bounce(),t.objects.remove(d)}})})}})):n()}}),bento.define("entities/prize",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/components/fill","bento/components/opacity","bento/entity","bento/utils","bento/tween","bento/packedimage","bento/gui/clickbutton","entities/backscroller","entities/confetti","gui/text","gui/camerabutton"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m){"use strict";return function(n){var r=t.getViewport(),a=n?n.lighten||!1:!1,h=u({z:c.Constants.Layer.GUI+15,name:"winMessage",position:e(r.width/2,r.height/2),originRelative:e(0,0),components:[o,s],family:[""],init:function(){var n=u({originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("minigamerays")}}).attach({update:function(){n.rotation.addAngleDegree(1)}}),o=u({originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("minigameblob")}}),s=u({name:"fishIcon",position:e(15,0),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("goldfishicon")},init:function(){this.scale.setScale(e(2,2))}}),h=g({position:e(-10,-10),name:"goldfishtext",font:"font",text:"+5",fontSize:32,align:"right",textBaseline:"middle",lineWidth:2,strokeStyle:"#084040",innerStroke:!1,fontColor:"#ffffff",fontSettings:c.Fonts["fontStrokedLarge-"+c.Fonts.getFontLang()],maxWidth:120});a||this.attach({draw:function(t){t.renderer.fillRect([0,0,0,.5],-r.width/2,-r.height/2,r.width,r.height)}}),this.attach(n),this.attach(o),this.attach(s,"fishIcon"),this.attach(h,"fishText")}}).extend({setText:function(t){this.fishText.setText(t)},unlockedCat:function(n){var r,o=u({position:e(0,32),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage(n),frameCountX:2,frameCountY:2,animations:{"default":{speed:0,frames:[0]}}},init:function(){}}),a="Nom Cat";for(r=0;r<c.cats.length;++r)if(c.cats[r].resource===n){a=c.cats[r].name;break}this.remove(this.fishIcon),this.fishIcon.setVisible(!1),this.fishText.setPosition(e(0,32)),this.fishText.setText("Unlocked "+a+"!",{align:"center",textBaseline:"top",fontSize:16,lineWidth:1}),this.attach(o)},raysAndText:function(t){this.remove(this.fishIcon),this.fishIcon.setVisible(!1),this.fishText.setPosition(e(0,32)),this.fishText.setText(t,{align:"center",textBaseline:"top",fontSize:16,lineWidth:1})}});return h}}),bento.define("entities/smoke",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s){"use strict";return function(n){var r=(t.getViewport(),o({z:a.Constants.Layer.FOOD-1,name:"smoke",position:n.add(e(a.getRandom(3)-2,a.getRandom(3)-2)),originRelative:e(.5,.5),components:[i],family:["particles"],sprite:{image:t.assets.getImage("smoke"),frameWidth:16,frameHeight:16,animations:{smoke:{speed:.2,frames:[0,1,2,3]}}},init:function(){var e=this;this.sprite.setAnimation("smoke",function(){t.objects.remove(e)})}}));return r}}),bento.define("entities/socialcat",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(n){var r=(t.getViewport(),o({z:0,name:"socialcat",position:e(0,0),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("buttonsocialcat"),frameWidth:64,frameHeight:64,animations:{"default":{speed:0,frames:[0]},appear:{speed:.2,frames:[0,1,2,3,4,5,6,7,8,9,10,11,11,11,11,12,13,14,15,15,15,14,13,12,11,11,11]},disappear:{speed:.2,frames:[11,11,11,11,10,9,8,7,6,5,4,2]}}},init:function(){var t=this,e=function(){s.timeout(60,function(){t.sprite.setAnimation("appear",function(){t.sprite.setAnimation("disappear",function(){t.sprite.setAnimation("default"),s.timeout(120,e)})})})};s.timeout(60,e)}}));return r}}),bento.define("entities/title",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(){var n,a=t.getViewport(),u=s.Localization.getLang(),c="title-EN",h=0;return c="JA"===u?"title-JA":"KO"===u?"title-KO":"ZH"===u?"title-ZH":"ZHK"===u||"ZTW"===u?"title-ZT":"title-EN",n=o({z:s.Constants.Layer.GUI,name:"logo",position:e(a.width/2,a.height/8),originRelative:e(.5,.5),components:[i,r],family:[""],sprite:{image:t.assets.getImage(c)},init:function(){this.getPosition().y+=8},clickable:{onClick:function(){h+=1,window.Cocoon&&h,window.Cocoon&&20===h&&s.Cocoon.prompt({title:"Meow",message:"What would you like, meow?"},{success:function(e){var n,i;if(h=0,"reset"===e)t.saveState.clear(),t.audio.playSound("sfx_extra-meow");else if("nomorenomslots"===e)t.saveState.save("nomorenomslots",!0);else if("gimmenomslots"===e)t.saveState.save("nomorenomslots",!1);else if("gimme100fish"===e)t.saveState.save("goldfish",t.saveState.load("goldfish",0)+100),t.audio.playSound("sfx_extra-meow");else if("gimme1000fish"===e)t.saveState.save("goldfish",t.saveState.load("goldfish",0)+1e3),t.audio.playSound("sfx_extra-meow");else if("gimme10000fish"===e)t.saveState.save("goldfish",t.saveState.load("goldfish",0)+1e4),t.audio.playSound("sfx_extra-meow");else if("gimmeallcats"===e){var n,i=t.saveState.load("unlocked",["cat"]),r=s.cats;for(n=0;n<r.length;++n)i.indexOf(r[n].resource)<0&&i.push(r[n].resource);t.saveState.save("unlocked",i),t.audio.playSound("sfx_extra-meow")}else if("unlock_benlashescats"===e){var n,i=t.saveState.load("unlocked",["cat"]),o=s.backgrounds,r=s.cats;for(n=0;n<r.length;++n)("catgrumpy"===r[n].resource||"catnyan"===r[n].resource||"catkeyboard"===r[n].resource)&&i.indexOf(r[n].resource)<0&&i.push(r[n].resource);for(i=t.saveState.load("unlockedBackgrounds",["background0"]),n=0;n<o.length;++n)i.indexOf(o[n].resource)<0&&i.push(o[n].resource);t.saveState.save("unlockedBackgrounds",i),t.saveState.save("unlocked",i),t.audio.playSound("sfx_extra-meow")}else if("gimmeallbackgrounds"===e){var n,i=t.saveState.load("unlockedBackgrounds",["background0"]),o=s.backgrounds;for(n=0;n<o.length;++n)i.indexOf(o[n].resource)<0&&i.push(o[n].resource);t.saveState.save("unlockedBackgrounds",i),t.audio.playSound("sfx_extra-meow")}else if(2===e.length)s.Localization.setLanguage(e),t.audio.playSound("sfx_extra-meow");else for(n=0;n<s.cats.length;++n)if(s.cats[n].resource===e)return t.audio.playSound("sfx_extra-meow"),i=t.saveState.load("unlocked",["cat"]),i.push(s.cats[n].resource),void t.saveState.save("unlocked",i)},cancel:function(){}})}}})}}),bento.define("entities/titlescreen",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","entities/backscroller","entities/catselector","entities/photo","entities/fade","entities/title"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m){"use strict";return function(u){var h,f=t.getViewport(),d=!0,v=t.saveState.load("expert",!1),b=70,y=o({z:11,name:"expert",addNow:!1,useHshg:!1,position:e(12,b/2),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("expert")},init:function(){}}),x=(a.cats,c({z:a.Constants.Layer.GUI,image:t.assets.getImage("buttonpaw"),position:e(f.width/2-40,f.height/2-20),frameWidth:48,frameHeight:48,addNow:!1,sfx:"sfx_button",onClick:function(){v=!v,C(v)},init:function(){this.setBoundingBox(n(-18,-18,36,36))}})),h=m(),w=c({z:a.Constants.Layer.GUI,image:t.assets.getImage("buttonbackground"),position:e(f.width/2,f.height/2-20),frameWidth:48,frameHeight:48,addNow:!0,sfx:"sfx_button",onClick:function(){t.objects.pause(),g(function(){t.objects.resume(),t.screens.show("screens/background")},!1,this.getPosition())},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}),_=c({z:a.Constants.Layer.GUI,image:t.assets.getImage("buttoncat"),position:e(f.width/2+40,f.height/2-20),addNow:!0,frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){t.objects.pause(),g(function(){t.objects.resume(),t.screens.show("screens/select")},!1,this.getPosition())},init:function(){this.setBoundingBox(n(-18,-18,36,36))}}),S=l({font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontStroked-"+a.Fonts.getFontLang()],text:a.Localization.getText("start"),align:"center",textBaseline:"middle",addNow:!1,z:1,position:e(f.width/2,f.height/2)}).attach({update:function(){}}),E=o({z:0,name:"touchToStart",addNow:!1,useHshg:!1,components:[r],clickable:{pointerUp:function(e){e.position.y<80||(u&&u(),t.objects.remove(x),t.objects.remove(E),t.objects.remove(S),t.objects.remove(h),t.objects.remove(T))}},init:function(){}}),T=l({z:a.Constants.Layer.GUI+3,text:"v"+a.version,align:"right",textBaseline:"bottom",font:"font",fontColor:"#fff",fontSize:16,addNow:!0,position:e(f.width,f.height-2)}),A=c({z:a.Constants.Layer.GUI,image:t.assets.getImage("buttonplay"),position:e(f.width/2,f.height/2+17),frameWidth:128,frameHeight:48,addNow:!0,sfx:"sfx_button",onClick:function(){u&&u(),t.objects.remove(x),t.objects.remove(w),t.objects.remove(_),t.objects.remove(A),t.objects.remove(h),t.objects.remove(T)},init:function(){this.setBoundingBox(n(-64,-18,128,36))}}),C=function(n){t.saveState.save("expert",n),n?(y.setVisible(!0),s({from:0,to:1,"in":30,ease:"linear","do":function(t,e){y.opacity.setOpacity(t)}}),s({from:2,to:1,"in":30,ease:"quadratic",alpha:0,beta:0,"do":function(t,n){y.scale.setScale(e(t,t))},onComplete:function(){t.audio.stopSound("sfx_fish-hit-head"),t.audio.playSound("sfx_fish-hit-head"),s({from:1,to:0,"in":30,ease:"linear",alpha:0,beta:0,"do":function(t,n){var i=a.getRandom(150*t)/100,r=a.getRandom(150*t)/100;y.setPosition(e(12+i,b/2+r))},onComplete:function(){y.setPosition(e(12,b/2))}})}})):y.setVisible(!1)};C(v),t.audio.stopAllMusic(),t.objects.add(h),h.attach(y),d&&0===t.saveState.load("tutorial",1)?t.objects.add(x):x=o({z:a.Constants.Layer.GUI,name:"buttonExpert",addNow:!0,useHshg:!1,position:e(f.width/2-40,f.height/2-20),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("buttonpawinactive")},init:function(){}}),d||t.saveState.save("expert",!1),a.timeout(100,function(){p().snap()})}}),bento.define("entities/tutorial",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/fill","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";return function(){var n=t.getViewport(),u=a({z:s.Constants.Layer.GUI+3,name:"",components:[o],family:[""],fill:{color:[0,0,0,.5]},addNow:!0,init:function(){}}),c=a({z:s.Constants.Layer.GUI+3,name:"text",position:e(n.width/2,n.height/2+88),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("tutorialtext")},addNow:!0,init:function(){}}),h=a({z:s.Constants.Layer.GUI+3,name:"tutorial",position:e(n.width/2,n.height/2),originRelative:e(.5,.5),components:[i,r],family:[""],sprite:{image:t.assets.getImage("tutorial")},clickable:{pointerUp:function(){h.timer>10&&(t.objects.remove(h),t.objects.remove(u),t.objects.remove(c),t.resume())}},addNow:!0,updateWhenPaused:!0,init:function(){}});return t.pause(),h}}),bento.define("gui/bestscore",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/entity","bento/utils","bento/tween","gui/counter"],function(t,e,n,i,r,o,a,s,u,c){"use strict";return function(n){var r=t.getViewport(),u=c({image:t.assets.getImage("numberssmall"),frameWidth:24,frameHeight:24,alignment:"left",spacing:e(-10,0),position:e(4,0),value:n}),h=a({z:0,name:"best",position:e(-32,8),origin:e(48,16),components:[i],family:[""],sprite:{image:t.assets.getImage("best")},init:function(){}}),l=a({z:s.Constants.Layer.GUI+1,name:"bestScore",position:e(-r.width/2,72),originRelative:e(0,0),components:[o],family:[""],init:function(){}}).attach(h).attach(u).extend({getDigits:u.getDigits});return l}}),bento.define("gui/camerabutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween","bento/gui/clickbutton","gui/photosnap","entities/photo"],function(t,e,n,i,r,o,a,s,u,c,h,l){"use strict";return function(n){var i,r=t.getViewport(),o=!1,a=n||"a new cat",f=c({z:s.Constants.Layer.GUI+10,name:"buttoncamera",image:t.assets.getImage("buttoncamera"),position:e(r.width-24,-24),frameWidth:48,frameHeight:48,addNow:!1,sfx:"sfx_button",onClick:function(){var e=s.Localization.getText("shareimage").replace("{0}",a).replace("{1}",s.getStoreLink());o||(f.setVisible(!1),t.objects.remove(f),h(),window.Cocoon&&window.Cocoon.Share&&s.timeout(30,function(){Cocoon.Share.share(e,i.getBase64(),function(t,e,n){})}),o=!0)}});return t.objects.add(f),u({from:-24,to:24,"in":30,ease:"elastic",alpha:-4,beta:1,"do":function(t,e){f.getPosition().y=t},onComplete:function(){i=l(),i.snap(!0)}}),s.timeout(210,function(){u({from:24,to:-24,"in":30,ease:"linear",alpha:0,beta:0,"do":function(t,e){f.getPosition().y=t},onComplete:function(){t.objects.remove(f)}})}),f}}),bento.define("gui/clickbutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","gui/text","bento/eventsystem"],function(t,e,n,i,r,o,a,s,u,c){"use strict";return function(n){var s,c=(t.getViewport(),!1),h=!0,l=a.extend({z:a.Constants.Layer.GUI,name:"",originRelative:e(.5,.5),position:e(0,0),components:[i,r],family:["buttons"],sprite:{image:n.image,frameWidth:n.frameWidth||32,frameHeight:n.frameHeight||32,animations:n.animations||{"default":{speed:0,frames:[0]},down:{speed:0,frames:[1]},inactive:{speed:0,frames:[2]}}},clickable:{onClick:function(){h&&(f.sprite.setAnimation("down"),n.onDown&&n.onDown.apply(f))},onHoldEnter:function(){h&&(n.onHoldEnter&&n.onHoldEnter(),f.sprite.setAnimation("down"),n.onDown&&n.onDown.apply(f))},onHoldLeave:function(){h&&(f.sprite.setAnimation("default"),n.onUp&&n.onUp.apply(f))},pointerUp:function(){h&&(f.sprite.setAnimation("default"),n.onUp&&n.onUp.apply(f))},onHoldEnd:function(){h&&(n.onClick&&n.onClick(),n.onUp&&n.onUp.apply(f))}},init:function(){}},n),f=o(l).extend({setActive:function(t){h=t,h?f.sprite.setAnimation("default"):f.sprite.setAnimation("inactive")},setLabel:function(t){c||d(),s.setText(t)},getText:function(){return s}}),d=function(){c||(s=u({font:n.font||"font",text:n.label,fontSize:n.fontSize||16,fontColor:n.fontColor||"#ffffff",fontSettings:n.fontSettings,position:n.labelOffset||e(0,0),maxWidth:n.labelMaxWidth||f.getBoundingBox().width,maxHeight:n.labelMaxHeight,margin:e(0,0),align:"center",textBaseline:"middle"}),f.attach(s),c=!0)};return n.label&&d(),f}}),bento.define("gui/countdown",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/fill","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween","gui/counter"],function(t,e,n,i,r,o,a,s,u,c,h){"use strict";return function(){var n=t.getViewport(),i=function(){t.audio.stopSound("sfx_char-scroll"),t.audio.playSound("sfx_char-scroll"),o.addValue(-1),0!==o.getValue()?u.timeout(60,i,!0):(t.objects.remove(s),t.resume(),u.EveryPlay.resume())},o=h({z:u.Constants.Layer.CAT,image:t.assets.getImage("numberssmall"),frameWidth:24,frameHeight:24,alignment:"center",spacing:e(-16,0),position:e(n.width/2,n.height/2-24)}),s=a({z:u.Constants.Layer.PAUSE+10,name:"overlay",components:[r],fill:{color:[0,0,0,.5]},addNow:!0,updateWhenPaused:!0,init:function(){o.setValue(4)}}).attach(o);return t.pause(),i(),s}}),bento.define("gui/counter",["bento","bento/entity","bento/math/vector2","bento/components/sprite","bento/components/translation","bento/components/rotation","bento/components/scale","utils"],function(t,e,n,i,r,o,a,s){"use strict";return function(r){var o=r.value||0,a=r.spacing||n(0,0),u=r.align||r.alignment||"right",c=0,h=[],l=function(){return Math.floor(o).toString().length},f=function(){return e({components:[i],sprite:{image:r.image,frameWidth:r.frameWidth,frameHeight:r.frameHeight,animations:{0:{frames:[0]},1:{frames:[1]},2:{frames:[2]},3:{frames:[3]},4:{frames:[4]},5:{frames:[5]},6:{frames:[6]},7:{frames:[7]},8:{frames:[8]},9:{frames:[9]}}},init:function(){c=r.frameWidth}})},d=function(){var t,e,i,r=o.toString(),s=l(),d=h.length-s;if(0>d)for(t=0;t<Math.abs(d);++t)i=f(),h.push(i),p.attach(i);else if(d>0)for(t=0;t<Math.abs(d);++t)i=h.pop(),p.remove(i);for(t=0;t<h.length;++t)i=h[t],i.setPosition(n((c+a.x)*t,0)),i.sprite.setAnimation(r.substr(t,1));if("right"===u)for(t=0;t<h.length;++t)i=h[t],e=i.getPosition().clone(),e.substractFrom(n((c+a.x)*s-a.x,0)),i.setPosition(e);else if("center"===u)for(t=0;t<h.length;++t)i=h[t],e=i.getPosition(),e.addTo(n(((c+a.x)*s-a.x)/-2,0))},p=e({z:r.z||s.Constants.Layer.GUI+2,name:r.name||"counter",position:r.position,components:[i],sprite:{image:t.assets.getImage("nothing")}}).extend({init:function(){d()},setValue:function(t){o=t,d()},getValue:function(){return o},addValue:function(t){o+=t,d()},getDigits:function(){return l()}});return p}}),bento.define("gui/dotpages",["bento","bento/math/vector2","bento/math/rectangle","bento/components/translation","bento/components/rotation","bento/components/scale","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u,c,h,l){"use strict";return function(n){var i,r=(t.getViewport(),0),o=[],s=8,c=u({z:h.Constants.Layer.GUI,name:"pages",addNow:!1,useHshg:!1,position:e(0,0),originRelative:e(0,0),components:[a],sprite:{image:t.assets.getImage("dot"),frameWidth:1,frameHeight:1},init:function(){}}).extend({setCurrentPage:function(t){var e=0;for(r=t,e=0;e<o.length;++e)o[e].opacity.setOpacity(.5);o[t].opacity.setOpacity(1)},getOffset:function(){return e((o.length-1)*s/2,0)}}),l=function(){var n=u({z:0,name:"dot",position:e(8*o.length,0),originRelative:e(.5,.5),components:[a],family:[""],sprite:{image:t.assets.getImage("dot")},init:function(){}});o.push(n),c.attach(n)};for(i=0;n>i;++i)l();return c.setCurrentPage(0),c}}),bento.define("gui/pausebutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/fill","bento/entity","bento/utils","bento/tween","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","store","bento/eventsystem","gui/countdown"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p){"use strict";var g=!1;return navigator.isCocoonJS&&document.addEventListener("pause",function(){var e=t.objects.get("gameState"),n=t.objects.get("pauseButton"),i=Date.now(),r=i-s.SaveState.load("sessionTime",Date.now());t.objects.isPaused()||!e||e.isGameOver()||!n||g||n.doCallback(),s.Analytics.event("Game","sessionTime_minutes",Math.floor(r/1e3/60)),s.SaveState.save("sessionTime",i)}),function(){var n=t.getViewport(),m=c({name:"pauseButton",image:t.assets.getImage("buttonpause"),frameWidth:48,frameHeight:48,position:e(16,16),sfx:"sfx_button",onClick:function(){t.pause(),g=!0,x(),s.EveryPlay.pause()}}),v=!1,b=l({position:e(n.width/2,n.height/2),name:"wait",font:"font",fontSize:16,fontSettings:s.Fonts["font-"+s.Fonts.getFontLang()],text:"Restoring...",align:"center",fontColor:"#ffffff",maxWidth:n.width}),y=(t.saveState.load("unlocked",["cat"]),a({z:s.Constants.Layer.PAUSE+10,name:"overlay",components:[o],fill:{color:[0,0,0,.5]},updateWhenPaused:!0,init:function(){}}).attach(b)),x=function(){var g=a({z:s.Constants.Layer.PAUSE,name:"overlay",updateWhenPaused:!0,components:[o],fill:{color:[0,0,0,.5]}}),x=a({position:e(0,-32),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("luckykat80")}}),w=l({position:e(0,-32),name:"creditsText",font:"font",fontSize:16,fontSettings:s.Fonts["font-"+s.Fonts.getFontLang()],text:"NOM CAT\n\n"+s.Localization.getText("credits")+"\n\nHernan Zhou\nHerdjie Zhou\nJasper Boerstra\nNikola Pilipovic\nMounim el-Meziani",align:"center",fontColor:"#ffffff",maxWidth:n.width}),_=a({z:0,name:"",position:e(-32,w.getBoundingBox().height),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("grumpy")}}),S=a({z:0,name:"",position:e(32,w.getBoundingBox().height),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("nyan")}}),E=a({z:s.Constants.Layer.PAUSE+10,name:"credits",position:e(n.width/2,n.height/2),originRelative:e(.5,.5),components:[i,r],sprite:{image:t.assets.getImage("backgroundwallpaper")},updateWhenPaused:!0,clickable:{onClick:function(){v&&(s.timeout(30,function(){B()},!0),E.setVisible(!1),console.log("clicked"))}}}).attach(w).attach(x).attach(_).attach(S),T=c({z:s.Constants.Layer.PAUSE,image:t.assets.getImage("buttonplay"),position:e(n.width/2,n.height/2+24),updateWhenPaused:!0,frameWidth:128,frameHeight:48,sfx:"sfx_button",onClick:function(){t.objects.remove(g),t.resume(),L=!1,p()}}),A=c({z:s.Constants.Layer.PAUSE,updateWhenPaused:!0,image:t.assets.getImage("buttoncontroller"),position:e(24,n.height-24),frameWidth:48,frameHeight:48,onClick:function(){s.isNativeIos()?s.Cocoon.openUrl("itms-apps://itunes.apple.com/ca/artist/lucky-kat-studios/id498980984"):s.isAmazon()?s.Cocoon.openUrl("amzn://apps/android?p=com.heigames.nomcat&showAll=1"):s.Cocoon.openUrl("https://play.google.com/store/apps/developer?id=Lucky+Kat+Studios")}}),C=c({z:s.Constants.Layer.PAUSE,updateWhenPaused:!0,image:t.assets.getImage("buttonrestore"),position:e(n.width/2,n.height-24),frameWidth:48,frameHeight:48,onClick:function(){var e=f.restore();t.objects.add(y),b.setText("Restoring purchases..."),L(),d.addEventListener("restore_success",N),d.addEventListener("restore_error",F),e||F(s.isCocoonJS()?s.Localization.getText("errorstore"):"Only available in the App version!")}}),P=c({z:s.Constants.Layer.PAUSE,updateWhenPaused:!0,image:t.assets.getImage("buttonhome"),position:e(n.width-24,24),frameWidth:48,frameHeight:48,onClick:function(){t.objects.remove(g),t.resume(),t.screens.show("screens/main",!0)}}),I=c({z:s.Constants.Layer.PAUSE,updateWhenPaused:!0,image:t.assets.getImage("buttonleaderboards"),position:e(24,24),frameWidth:48,frameHeight:48,onClick:function(){var e=t.saveState.load("expert",!1);s.GooglePlay.show(function(){},{leaderboardID:e?"CgkI3NDPhKAbEAIQCA":"CgkI3NDPhKAbEAIQAQ"})}}),R=c({z:s.Constants.Layer.PAUSE,updateWhenPaused:!0,image:t.assets.getImage("buttonachievements"),position:e(24,72),frameWidth:48,frameHeight:48,onClick:function(){s.GooglePlay.showAchievement(function(){})}}),M=c({z:s.Constants.Layer.PAUSE,image:t.assets.getImage("buttoncredits"),position:e(n.width-24,n.height-24),updateWhenPaused:!0,frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){
var t=function(){u({from:n.height,to:-(w.getBoundingBox().height+n.height+128),"in":3e3,ease:"linear",updateWhenPaused:!0,"do":function(t,e){w.setPositionY(t-64),x.setPositionY(t-64),_.setPositionY(t+w.getBoundingBox().height),S.setPositionY(t+w.getBoundingBox().height)},onComplete:t})};E.setVisible(!0),L(),t(),E.translation.setSubPixel(!0)}}),k=h({z:s.Constants.Layer.PAUSE,toggled:s.SaveState.load("muteMusic",!1),image:t.assets.getImage("buttonmusic"),position:e(n.width/2-32,n.height/2-24),frameWidth:48,updateWhenPaused:!0,frameHeight:48,sfx:"sfx_button",onToggle:function(){t.audio.muteMusic(this.isToggled(),!0),s.SaveState.save("muteMusic",this.isToggled())}}),O=h({z:s.Constants.Layer.PAUSE,toggled:s.SaveState.load("disableEveryplay",!1),image:t.assets.getImage("buttoneveryplay"),position:e(n.width/2+48,n.height/2-24),frameWidth:48,updateWhenPaused:!0,frameHeight:48,sfx:"sfx_button",onToggle:function(){s.SaveState.save("disableEveryplay",this.isToggled()),s.EveryPlay.setEnabled(!this.isToggled())}}),D=h({z:s.Constants.Layer.PAUSE,toggled:s.SaveState.load("muteSound",!1),image:t.assets.getImage("buttonsound"),position:e(n.width/2+32,n.height/2-24),frameWidth:48,updateWhenPaused:!0,frameHeight:48,sfx:"sfx_button",onToggle:function(){t.audio.muteSound(this.isToggled()),s.SaveState.save("muteSound",this.isToggled())}}),L=function(){m.updateWhenPaused=!1,T.updateWhenPaused=!1,M.updateWhenPaused=!1,A.updateWhenPaused=!1,C.updateWhenPaused=!1,P.updateWhenPaused=!1,I.updateWhenPaused=!1,R.updateWhenPaused=!1,k.updateWhenPaused=!1,O.updateWhenPaused=!1,D.updateWhenPaused=!1,v=!0},B=function(){m.updateWhenPaused=!0,T.updateWhenPaused=!0,M.updateWhenPaused=!0,A.updateWhenPaused=!0,C.updateWhenPaused=!0,P.updateWhenPaused=!0,I.updateWhenPaused=!0,R.updateWhenPaused=!0,k.updateWhenPaused=!0,O.updateWhenPaused=!0,D.updateWhenPaused=!0,t.objects.remove(y),console.log("clean up events"),d.removeEventListener("restore_success",N),d.removeEventListener("restore_error",F),v=!1},N=function(){b.setText("Products restored!"),s.timeout(120,B,!0)},F=function(e){console.log("purchase failed!",e),t.audio.playSound("sfx_error"),b.setText(s.Localization.getText("error")+"\n"+e),s.timeout(60,B,!0)};g.attach(T),g.attach(M),g.attach(A),g.attach(k),s.isNativeIos()&&g.attach(O),g.attach(D),g.attach(P),s.isNativeAndroid()&&!s.isAmazon()&&(g.attach(I),g.attach(R)),g.attach(E),t.objects.add(g),E.setVisible(!1)};return m}}),bento.define("gui/photosnap",["bento","bento/math/vector2","bento/math/rectangle","bento/components/fill","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u,c){"use strict";return function(){var n=(t.getViewport(),a({z:u.Constants.Layer.FADEOUT-1,name:"photosnap",addNow:!0,useHshg:!1,position:e(0,0),originRelative:e(0,0),components:[i],init:function(){t.audio.stopSound("sfx_camera"),t.audio.playSound("sfx_camera")}}));return c({from:1,to:0,"in":30,ease:"linear",alpha:0,beta:0,"do":function(t,e){n.fill.setup({color:[1,1,1,t]})},onComplete:function(){t.objects.remove(n)}}),n}}),bento.define("gui/text",["bento","bento/math/vector2","bento/math/rectangle","bento/entity","bento/utils","bento/components/sprite","bento/components/translation","bento/components/rotation","bento/components/scale","bento/components/opacity","bento/packedimage"],function(t,e,n,i,r,o,a,s,u,c,h){"use strict";var l=function(t){var e;if(""===t||0===t||"0"===t||null===t||t===!1||!r.isDefined(t))return!0;if(r.isArray(t)&&0===t.length)return!0;if(r.isObject(t)){for(e in t)if(r.has(t,e))return!1;return!0}return!1};return function(t){var a,s,u,c,f="",d=!0,p="normal",g=["black","white"],m="left",v="arial",b=37,y=32,x="black",w=[0],_=0,S=["black"],E=[!1],T="top",A=[],C=0,P=e(8,16),I=0,R=null,M=document.createElement("canvas"),k=M.getContext("2d"),O=1,D=1,L="source-over",B=h(M),N=1,F={},j=function(n){var i,o,h;if(n.fontSettings&&r.extend(n,n.fontSettings),N=4,V.scale.setScale(e(1/N,1/N)),n.fontSize&&(n.fontSize*=N),n.maxWidth&&(n.maxWidth*=N),n.gradient&&(c=n.gradient),n.gradientColors)for(g=[],i=0,o=n.gradientColors.length;o>i;++i)g[i]=n.gradientColors[i];for(n.overlaySprite&&(R=n.overlaySprite,R.initialized||(R.init(),R.initialized=!0)),n.align&&(m=n.align),r.isDefined(n.ySpacing)&&(I=n.ySpacing*N),n.font&&(v=n.font),r.isDefined(n.fontSize)&&(b=n.fontSize,y=b),n.fontColor&&(x=n.fontColor),n.textBaseline&&(T=n.textBaseline),r.isDefined(n.fontWeight)&&(p=n.fontWeight),r.isDefined(n.lineWidth)&&(w=r.isArray(n.lineWidth)?n.lineWidth*N:[n.lineWidth*N]),n.strokeStyle&&(S=r.isArray(n.strokeStyle)?n.strokeStyle:[n.strokeStyle]),n.innerStroke&&(E=r.isArray(n.innerStroke)?n.innerStroke:[n.innerStroke]),h=Math.max(w.length,S.length,E.length);w.length<h;)w.push(0);for(;S.length<h;)S.push("black");for(;E.length<h;)E.push(!1);for(_=0,i=0,o=w.length;o>i;++i)_=Math.max(_,2*w[i]);r.isDefined(n.linebreaks)&&(d=n.linebreaks),s=r.isDefined(n.maxWidth)?n.maxWidth:null,u=r.isDefined(n.maxHeight)?n.maxHeight*N:null,r.isDefined(n.margin)&&(P=n.margin),n.textID?(a=n.textID,V.setTextID(a,s,u)):n.text?V.setText(t.text):V.setText(f)},U=function(){var t,i,o,a,s,u=e(_/2,_/2),c=V.getOrigin();V.getPosition();switch(M.width=O+_+2*P.x,M.height=D+_+2*P.y,k.clearRect(0,0,M.width,M.height),V.setDimension(n(0,0,M.width,M.height)),R&&(s=M.width/R.getDimension().width,R.scalable&&R.scalable.setScale(e(s,s))),m){default:case"left":c.x=0;break;case"center":c.x=P.x+O/2;break;case"right":c.x=P.x+O}switch(T){default:case"top":c.y=0;break;case"middle":c.y=D/2;break;case"bottom":c.y=D}for(G(k),t=0;t<A.length;++t){for(r.isDefined(A[t].gradient)?k.fillStyle=A[t].gradient:k.fillStyle=x,o=u.x+c.x+A[t].spaceWidth/2,a=u.y+(t+1)*b+P.y+I*t,k.globalCompositeOperation="source-over",k.fillText(A[t].string,~~o,~~a+(navigator.isCocoonJS?0:.5)),l(R)||(k.globalCompositeOperation="source-atop",R.setPosition(e(o,a-b)),R.draw({canvas:M,context:k})),k.globalCompositeOperation="source-atop",i=0;i<w.length;++i)w[i]&&E[i]&&(k.lineWidth=2*w[i],k.strokeStyle=S[i],k.strokeText(A[t].string,~~o,~~a));for(k.globalCompositeOperation="destination-over",i=w.length-1;i>=0;--i)w[i]&&!E[i]&&(k.lineWidth=2*w[i],k.strokeStyle=S[i],k.strokeText(A[t].string,~~o,~~a))}z(k),M.texture&&(M.texture=null),B=h(M),V.sprite.setup({image:B})},z=function(t){t.textAlign="left",t.textBaseline="bottom",t.lineWidth=0,t.strokeStyle="black",t.fillStyle="black",t.globalCompositeOperation=L,t.restore()},G=function(t){t.save(),t.textAlign=m,t.textBaseline="bottom",t.font=p+" "+b.toString()+"px "+v,L=t.globalCompositeOperation},H=function(){var e,n,i,r,o,a,u,c,h=(""+f).split("\n");for(A=[],O=1,D=1,G(k),i=0;i<h.length;++i){if(C=0,n=h[i],t.centerOffset&&"center"===m&&n.length%2&&(n+=" ",C=k.measureText(" ").width),e=k.measureText(n).width,d&&!l(s)&&e>s){for(r=0;e>s;)if(++r,a=n.slice(0,n.length-r),e=k.measureText(a).width,r===n.length){r=n.length-1;break}c=a.lastIndexOf(" "),c>0&&c!=a.length&&(r+=a.length-c),u=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r),t.centerOffset&&"center"===m&&n.length%2&&(n+=" ",C=k.measureText(" ").width)," "===u.charAt(0)&&(u=u.slice(1)),0!==u.length&&h.splice(i+1,0,u),e=k.measureText(n).width}e>O&&(O=e),o=W(e,i),A.push({string:n,width:e,gradient:o,spaceWidth:C}),D+=b+I}},W=function(t,e){var n,i,r,o,a,s={x:0,y:0},u={x:0,y:0};if(c){switch(o=(b+I)*e,a=(b+I)*(e+1),c){default:case"top-down":s.x=0,s.y=o,u.x=0,u.y=a;break;case"down-top":s.x=0,s.y=a,u.x=0,u.y=o;break;case"left-right":s.x=0,s.y=0,u.x=t,u.y=0;break;case"right-left":s.x=t,s.y=0,u.x=0,u.y=0;break;case"topleft-downright":s.x=0,s.y=o,u.x=t,u.y=a;break;case"topright-downleft":s.x=t,s.y=o,u.x=0,u.y=a;break;case"downleft-topright":s.x=0,s.y=a,u.x=t,u.y=o;break;case"downright-topleft":s.x=t,s.y=a,u.x=0,u.y=o}for(s.x+=_/2,s.y+=_/2,u.x+=_/2,u.y+=_/2,n=k.createLinearGradient(s.x,s.y,u.x,u.y),r=0;r<g.length;++r)i=r*(1/(g.length-1)),n.addColorStop(i,g[r]);return n}},V=i({z:t.z||0,name:t.name||"text",position:t.position||e(0,0),family:t.family,addNow:t.addNow,components:[o],sprite:{image:B},init:function(){}}).extend({getText:function(){return f},setText:function(t,e){var n;if(b=y,e&&j(e),f=t,H(),l(s)&&l(u)||(n=CryptoJS.MD5(t)),r.isDefined(F[n]))b=F[n],H();else{for(;b>0&&(!l(s)&&O>s||!l(u)&&D>u);)b-=1,H();F[n]=b}U()},setTextID:function(t,e,n){a=t},getRectangle:function(){return n(0,0,M.width,M.height)}});return j(t),V}}),bento.define("screens/background",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/fill","bento/entity","bento/utils","bento/tween","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","entities/backscroller","entities/fade","entities/backgroundselector","store","gui/counter","bento/eventsystem","gui/dotpages"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v,b,y){"use strict";var x=c({dimension:t.getViewport()});return s.extend(x,{onShow:function(){var n,c,l=t.getViewport(),b=(d("backgroundtile",3,4,0,0,-1,[8/255,.6,202/255,1]),s.backgrounds),x=0,w=0,_=!1,S=!1,E=y(b.length),T=f({position:e(l.width/2,l.height/2),name:"wait",font:"font",fontSize:16,text:"Purchasing...",align:"center",fontColor:"#ffffff",fontSettings:s.Fonts["font-"+s.Fonts.getFontLang()],maxWidth:l.width}),A=(a({z:s.Constants.Layer.GUI+10,name:"overlay",components:[o],fill:{color:[0,0,0,.5]},updateWhenPaused:!0,init:function(){}}).attach(T),f({z:1,position:e(l.width/2,l.height/2+32),font:"font",fontSize:16,fontSettings:s.Fonts["font-"+s.Fonts.getFontLang()],text:"",align:"center",addNow:!0,maxHeight:l.height<284?36:void 0,maxWidth:l.width-16,fontColor:"#ffffff"})),C=a({z:s.Constants.Layer.GUI+2,name:"fishIcon",position:e(l.width/2+48,l.height/2+44),originRelative:e(.5,.5),components:[i],family:[""],addNow:!0,sprite:{image:t.assets.getImage("goldfishicon")},init:function(){}}),P=h({z:1,image:t.assets.getImage("buttonresume"),position:e(l.width/2,l.height-24),frameWidth:48,frameHeight:48,addNow:!0,sfx:"sfx_button",onClick:function(){var e,n=(t.saveState.load("unlockedBackgrounds",["background0"]),t.saveState.load("goldfish",0));_?(t.objects.pause(),p(function(){t.objects.resume(),t.saveState.save("currentBackground",b[x]),t.screens.show("screens/main",!0)})):S&&(e=k(),e&&(w!==1/0&&(n-=w),t.saveState.save("goldfish",n),I.setText(n.toString()),s.Analytics.event("UI","unlock_"+b[x].resource)))}}),I=(h({z:s.Constants.Layer.GUI+10,image:t.assets.getImage("buttonback"),position:e(24,24),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){p(function(){t.screens.show("screens/main",!0)},!1,this.getPosition())}}),v({z:s.Constants.Layer.GUI+3,name:"goldfishtext",image:t.assets.getImage("numberstiny"),frameWidth:8,frameHeight:8,spacing:e(0,0),position:e(l.width-28,12),align:"right",value:t.saveState.load("goldfish",12)}).extend({setText:function(t){this.setValue(+t)},getText:function(){return this.getValue().toString()}})),R=(a({z:s.Constants.Layer.GUI+2,name:"fishIcon",position:e(l.width-18,16),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("goldfishicon")},addNow:!0,init:function(){t.objects.add(I)}}),s.Localization.getLang()),M="title-EN",k=function(){var e=D.unlock(function(){t.objects.resume(),P.setVisible(!0),A.setVisible(!0),A.setText("")});return t.objects.pause(),P.setVisible(!1),C.setVisible(!1),A.setVisible(!1),e&&(S=!1,_=!0,b=D.getAvailable(),O("buttonresume")),e},O=function(e){P.sprite.setup({image:t.assets.getImage(e),frameWidth:48,frameHeight:48,animations:{"default":{speed:0,frames:[0]},down:{speed:0,frames:[1]},up:{speed:0,frames:[0]}}})},D=g(function(e){var n=function(){var t;if(!c)return"$0.99";for(t=0;t<c.length;++t)if(c[t].productId===b[e].resource)return c[t].localizedPrice;return"$0.99"},i=b[e].price,r=b[e].turbo,o=t.saveState.load("unlockedBackgrounds",["background0"]);E.setCurrentPage(e),t.audio.stopAllMusic(),t.audio.playMusic(b[e].music),u({from:0,to:.3,"in":60,ease:"linear",alpha:0,beta:0,"do":function(n,i){t.audio.setVolume(n,b[e].music)},onComplete:function(){}}),c||(c=m.getProducts()),x=e,o.indexOf(b[e].resource)>=0?(t.saveState.save("currentBackground",b[e]),O("buttonresume"),A.setText(""),C.setVisible(!1),_=!0,S=!1):(_=!1,i!==1/0?(A.setText(s.Localization.getText("fishcost").replace("{0}",i)),C.setVisible(!0)):r?(t.saveState.load("highscoreTurbo",0)>=r?A.setText(""):A.setText(s.Localization.getText("unlockturbo").replace("{0}",r)),A.getPosition().x=l.width/2,C.setVisible(!1)):(A.setText(s.Localization.getText("iapcost2").replace("{0}",n())),A.getPosition().x=l.width/2,C.setVisible(!1)),w=b[e].price,t.saveState.load("goldfish",0)>=w||r&&t.saveState.load("highscoreTurbo",0)>=r?(O("buttonunlock"),S=!0):(O("buttonpurchase"),S=!1))});M="JA"===R?"title-JA":"KO"===R?"title-KO":"ZH"===R?"title-ZH":"ZHK"===R||"ZTW"===R?"title-ZT":"title-EN",n=a({z:10,name:"logo",position:e(l.width/2,0),originRelative:e(.5,0),components:[i,r],family:[""],sprite:{image:t.assets.getImage(M)},addNow:!1,init:function(){this.getPosition().y+=8},clickable:{onClick:function(){}}}),E.setPosition(P.getPosition().clone().add(e(0,-24)).substract(E.getOffset())),t.objects.add(E),C.setVisible(!1)}}),x}),bento.define("screens/buyfish",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","entities/fade"],function(t,e,n,i,r,o,a,s,u,c,h,l,f){"use strict";var d=new u({dimension:t.getViewport()});return a.extend(d,{onShow:function(){var n=t.getViewport(),r=new e(n.width/2,n.height/2),s=(new o({z:-1,name:"background",position:new e(n.width/2,n.height/2),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("backgroundtilegreen")},addNow:!0,updateWhenPaused:!0}),[n.height-32-48-48,n.height-32-48,n.height-32]),u=([new c({image:t.assets.getImage("buttonbuyfish"),position:new e(n.width-35,s[0]),frameWidth:60,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){console.log("buyfish1")}}).attach(new l({position:new e(0,-2),align:"center",textBaseline:"middle",text:a.BuyFish.Tier1.Price+" "+a.Localization.getText("yuansign"),font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:56,maxHeight:26})),new c({image:t.assets.getImage("buttonbuyfish"),position:new e(n.width-35,s[1]),frameWidth:60,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){console.log("buyfish2")}}).attach(new l({position:new e(0,-2),align:"center",textBaseline:"middle",text:a.BuyFish.Tier2.Price+" "+a.Localization.getText("yuansign"),font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:56,maxHeight:26})),new c({image:t.assets.getImage("buttonbuyfish"),position:new e(n.width-35,s[2]),frameWidth:60,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){console.log("buyfish3")}}).attach(new l({position:new e(0,-2),align:"center",textBaseline:"middle",text:a.BuyFish.Tier3.Price+" "+a.Localization.getText("yuansign"),font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:56,maxHeight:26}))],[new o({z:a.Constants.Layer.GUI,position:new e(r.x-7,s[0]),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("buyfishicon1")},addNow:!0}),new o({z:a.Constants.Layer.GUI,position:new e(r.x-7,s[1]),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("buyfishicon2")},addNow:!0}),new o({z:a.Constants.Layer.GUI,position:new e(r.x-7,s[2]),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("buyfishicon3"),frameWidth:32,frameHeight:36,animations:{shine:{speed:.25,frames:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5],loop:!0}}},addNow:!0,init:function(){this.animation.setAnimation("shine")}})],[new l({addNow:!0,position:new e(r.x-27,s[0]-2),align:"right",textBaseline:"middle",text:a.BuyFish.Tier1.Amount,font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:r.x-27,maxHeight:26}),new l({addNow:!0,position:new e(r.x-27,s[1]-2),align:"right",textBaseline:"middle",text:a.BuyFish.Tier2.Amount,font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:r.x-27,maxHeight:26}),new l({addNow:!0,position:new e(r.x-27,s[2]-2),align:"right",textBaseline:"middle",text:a.BuyFish.Tier3.Amount,font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:r.x-27,maxHeight:26})],new l({addNow:!0,position:new e(n.width-10,22),align:"right",textBaseline:"middle",text:"get goldfish",font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:a.Fonts["fontTight-"+a.Fonts.getFontLang()],maxWidth:n.width-5-48,maxHeight:40}),new c({image:t.assets.getImage("buttonback"),position:new e(24,24),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){new f(function(){t.screens.show("screens/main",!0)},!1,u.getPosition())}}))}}),d}),bento.define("screens/gacha",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","gui/counter","entities/fade","entities/prize","entities/confetti","entities/backscroller","entities/catselector"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v){"use strict";var b=u({dimension:t.getViewport()}),y=function(n,r,a,s){var u,c=s||n,h=t.assets.getImage(c);if(u=o({z:0,name:n,position:e(0,0),originRelative:e(.5,.75),components:[i],sprite:{image:h,frameCountX:s?1:2,frameCountY:s?1:2},init:function(){}}),"catglitch"===n){var l="catglitchanimation";u.sprite.setup({image:t.assets.getImage(l),frameCountX:4,frameCountY:4,animations:{closed:{speed:.2,frames:[0,0,0,0,0,0,1,2,3]}}}),u.sprite.setAnimation("closed")}return u};return a.extend(b,{onShow:function(){var u=t.getViewport(),h=!1,l=!1,v=a.cats,b=t.saveState.load("goldfish",0),x=f({z:a.Constants.Layer.GUI+3,name:"goldfishtext",image:t.assets.getImage("numberstiny"),frameWidth:8,frameHeight:8,spacing:e(0,0),position:e(u.width-28,12),align:"right",value:b}).extend({setText:function(t){this.setValue(+t)},getText:function(){return this.getValue().toString()}}),w=(o({z:a.Constants.Layer.GUI+2,name:"fishIcon",position:e(u.width-18,16),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("goldfishicon")},addNow:!0,init:function(){t.objects.add(x)}}),{image:t.assets.getImage("gachamachine"),frameCountX:4,frameCountY:2,animations:{"default":{speed:0,frames:[0]},shake:{speed:.2,frames:[0,1,2,3]},pull:{speed:.2,frames:[4,5,6,4]},nomouth:{speed:0,frames:[7]}}}),_=(m("backgroundtile",3,4,0,0,-1,[8/255,.6,202/255,1]),c({image:t.assets.getImage("buttonback"),position:e(24,24),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){t.objects.pause(),d(function(){t.objects.resume(),t.screens.show("screens/main",!0)},!1,_.getPosition())}})),S=c({z:a.Constants.Layer.GUI+2,image:t.assets.getImage("buttonregacha"),position:e(u.width/2,u.height-32),addNow:!0,frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){b>=a.gachaPrice&&(h=!0,b-=a.gachaPrice,t.saveState.save("goldfish",b),x.setValue(b),t.audio.playSound("sfx_extra-meow"),t.objects.remove(_),t.objects.remove(S),l=!0,t.audio.playSound("sfx_fish-throw"),t.audio.playSound("sfx_meow"),T())},init:function(){this.setBoundingBox(n(-24,-18,48,36))}}),E=new o({z:1,name:"machine",position:new e(u.width/2,u.height/2),originRelative:new e(.5,.5),components:[i,r],sprite:w}),T=function(){E.sprite.setAnimation("pull",A)},A=function(){E.sprite.setAnimation("shake"),a.timeout(60,C),new s({"in":60,"do":function(e,n){n%4===0&&t.audio.playSound("sfx_keybaordsound")}})},C=function(){var n=new o({z:2,name:"mouth",position:new e(15,-4),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("gachamouth")}});E.attach(n),new s({from:n.getPosition().y,to:n.getPosition().y+16,"in":30,ease:"exponential",alpha:-2,"do":function(t,e){n.getPosition().y=t},onComplete:function(){P()}}),E.sprite.setAnimation("nomouth")},P=function(){var n=new o({z:2,name:"ball",position:new e(u.width/2+15,u.height/2-4),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("gachaball"),frameCountX:8,frameCountY:2,animations:{rotate:{speed:.1,frames:[0,1,2,3,4,5,6,7,8,9]}}}});n.sprite.setAnimation("rotate"),t.objects.attach(n),t.audio.playSound("sfx_bomb-throw"),new s({from:0,to:1,"in":30,ease:"linear",alpha:0,beta:0,"do":function(t,i){n.scale.setScale(new e(t,t))},onComplete:function(){I(n)}})},I=function(n){new s({from:.1,to:.5,"in":60,ease:"linear","do":function(t,e){n.sprite.setCurrentSpeed(t)},onComplete:function(){t.audio.stopSound("sfx_elastic-slower"),t.audio.playSound("sfx_elastic-slower"),new s({from:1,to:.8,"in":30,ease:"exponential",alpha:-2,"do":function(t,i){n.scale.setScale(new e(t,t))},onComplete:function(){new s({"in":20,"do":function(t,i){n.scale.setScale(new e(.8+.05*Math.sin(1.5*i),.8+.05*Math.sin(1.5*i)))},onComplete:function(){M(n)}})}})}}),new s({from:1,to:0,"in":60,ease:"linear","do":function(t,e){E.opacity.setOpacity(t)}}),new s({from:n.getPosition().x,to:u.width/2,"in":60,ease:"linear","do":function(t,e){n.getPosition().x=t}})},R=function(t,e,n){t.attach({update:function(){var i=t.getPosition();i.x+=e,i.y+=n,n+=.1,t.rotation.addAngleDegree(e)}})},M=function(n){var r=new o({z:3,name:"ball",position:n.getPosition(),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("gachaball"),frameCountX:8,frameCountY:2,animations:{"default":{speed:.1,frames:[11]}}}}),a=new o({z:3,name:"ball",position:n.getPosition(),originRelative:new e(.5,.5),components:[i],sprite:{image:t.assets.getImage("gachaball"),frameCountX:8,frameCountY:2,animations:{"default":{speed:.1,frames:[12]}}}});t.objects.remove(n),t.objects.attach(r),t.objects.attach(a),R(r,-2,-4),R(a,1,0),k()},k=function(){var n,r,c,h=new p({lighten:!0}),l=t.saveState.load("unlocked",["cat"]),f=o({position:e(32,20),originRelative:e(.5,1),components:[i],sprite:{image:t.assets.getImage("newcat"),frameCountX:6,frameCountY:1,animations:{"new":{speed:.2,frames:[0,1,2,3,4,5]}}},init:function(){this.sprite.setAnimation("new")}});r=a.getRandom(v.length-1)+1,n=y(v[r].resource,r,v[r],v[r].selectImage),n.setPosition(new e(u.width/2,u.height/2)),t.objects.attach(n),c=v[r].name,"ZH"===a.Localization.getLang()&&v[r].name_ZH&&(c=v[r].name_ZH),"ZT"===a.Localization.getLang()&&v[r].name_ZT&&(c=v[r].name_ZT),h.raysAndText(c),h.z=1,n.z=2,t.objects.attach(h),new g({lifeTime:1/0}),l.indexOf(v[r].resource)<0&&(l.push(v[r].resource),t.saveState.save("unlocked",l),n.attach(f)),new s({from:1,to:0,"in":60,ease:"elastic",alpha:-10,beta:3,"do":function(t,i){n.scale.setScale(new e(1+t,1-t/1.2))},onComplete:function(){O(v[r])}})},O=function(i){var r=c({z:a.Constants.Layer.GUI+2,image:t.assets.getImage("buttonresume"),position:e(u.width/2+32,u.height-32),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){t.objects.pause(),d(function(){t.objects.resume(),t.saveState.save("currentCat",i),t.screens.show("screens/select")},!1,this.getPosition())},init:function(){this.setBoundingBox(n(-24,-18,48,36))}}),o=c({z:a.Constants.Layer.GUI+2,image:t.assets.getImage("buttonregacha"),position:e(u.width/2-32,u.height-32),frameWidth:48,frameHeight:48,sfx:"sfx_button",onClick:function(){return console.log(b,a.gachaPrice),b<a.gachaPrice?(t.audio.stopSound("sfx_button"),t.audio.stopSound("sfx_error"),void t.audio.playSound("sfx_error")):(t.objects.pause(),void d(function(){t.objects.resume(),t.screens.show("screens/gacha")},!1,this.getPosition()))},init:function(){this.setBoundingBox(n(-24,-18,48,36))}});t.objects.attach(r),b>=a.gachaPrice?t.objects.attach(o):r.getPosition().x=u.width/2,r.getPosition().y+=64,new s({from:r.getPosition().y,to:r.getPosition().y-64,"in":30,ease:"elastic",alpha:-6,beta:1,"do":function(t,e){r.getPosition().y=t}}),o.getPosition().y+=64,a.timeout(10,function(){new s({from:o.getPosition().y,to:o.getPosition().y-64,"in":30,ease:"elastic",alpha:-6,beta:1,"do":function(t,e){o.getPosition().y=t}})})};t.objects.attach(E),d(function(){},!0)}}),b}),bento.define("screens/logo",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/fill","bento/components/translation","bento/components/opacity","bento/entity","bento/utils","bento/tween","bento/screen","entities/luckykatlogo","entities/backscroller","entities/nomslotstimer","break","store"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m){"use strict";var v=l({dimension:t.getViewport()});return c.extend(v,{onShow:function(){var n=t.getViewport(),o=0,a=330,s=!1,l=u({z:20,name:"",position:e(0,0),originRelative:e(0,0),components:[],family:[""],init:function(){}}).extend({opacity:0,draw:function(t){t.renderer.fillRect([0,0,0,this.opacity],0,0,n.width,n.height)}}),d=!1,g=(u({z:0,name:"background",position:e(n.width/2,n.height/2),originRelative:e(.5,.5),components:[i,r],sprite:{image:t.assets.getImage("backgroundwallpaper")},addNow:!0,clickable:{pointerUp:function(){}},init:function(){}}).attach({update:function(){o+=1,o>a&&g()}}),function(){s||(s=!0,c.timeout(30,function(){t.objects.add(l),h({from:0,to:1,"in":60,ease:"linear","do":function(t,e){l.opacity=t},onComplete:function(){d||t.screens.show("screens/title")}})}))});v.base.onShow(),f(g),p(),m.init()}}),v}),bento.define("screens/main",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/fill","bento/entity","bento/utils","bento/tween","bento/screen","gui/counter","gui/text","entities/cat","entities/food","entities/foodmanager","entities/gamestate","entities/tutorial","gui/pausebutton","entities/titlescreen","entities/cherryblossom","entities/fade","entities/photo","bento/gui/clickbutton","gui/countdown"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v,b,y,x,w,_,S){"use strict";var E=c({dimension:t.getViewport()});return s.extend(E,{onShow:function(n){var r,c,l,d,m,_,E,T,A,C,P,I,R,M,k=t.getViewport(),O=e(k.width/2,k.height/2),D=(t.saveState.load("playCount",0),t.saveState.load("playCount"+s.version,0),s.getRandom(300)),L=s.getRandom(600),B=a({z:-100,name:"fill",components:[o]}),N=t.saveState.load("currentBackground",{resource:"background0"}).resource,F=!1,j=a({z:-9,name:"background",originRelative:e(.5,.5),position:e(k.width/2,k.height/2),components:[i],family:["background"],sprite:{image:t.assets.getImage(N)},init:function(){}}),U=t.saveState.load("unlocked",["cat"]),z=t.saveState.load("currentCat",{resource:"cat"}),G=t.saveState.load("currentCatLeft",t.saveState.load("currentCat",{resource:"cat"})),H=h({z:s.Constants.Layer.CAT,image:t.assets.getImage("numberslarge"),frameWidth:48,frameHeight:48,alignment:"center",spacing:e(-16,0),position:e(k.width/2,24)}),W=function(n,r){var o;a({z:-2,name:"star",addNow:!0,useHshg:!1,position:e(s.getRandom(1920)/10,s.getRandom(3400)/10),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("background4stars"),frameWidth:11,frameHeight:11,animations:{0:{speed:0,frames:[0]},1:{speed:0,frames:[1]},2:{speed:0,frames:[2]},3:{speed:0,frames:[3]},4:{speed:0,frames:[4]}}},init:function(){this.sprite.setAnimation(n.toString()),this.translation.setSubPixel(!0),o=this.getPosition()}}).attach({update:function(){o.y+=r,o.y>335&&(o.y-=340)}})},V=function(){var n,r=v(),o=(a({z:s.Constants.Layer.GUI+20,name:"fishIcon",position:e(k.width-18,16),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("goldfishicon")},addNow:!0,init:function(){}}),h({z:s.Constants.Layer.GUI+20,image:t.assets.getImage("numberssmall"),frameWidth:24,frameHeight:24,spacing:e(-8,0),position:e(k.width-48,2),value:123}),h({z:s.Constants.Layer.GUI+20,name:"goldfishtext",image:t.assets.getImage("numberstiny"),frameWidth:8,frameHeight:8,spacing:e(0,0),position:e(k.width-28,12),align:"right",value:t.saveState.load("goldfish",0)}).extend({setText:function(t){this.setValue(+t)},getText:function(){return this.getValue().toString()}}));t.add(H),t.add(o),t.add(g()),t.input.resetPointers(),t.add(p()),t.add(r),s.timeout(10,function(){n=w(),n.snap(),t.objects.add(n)}),t.saveState.save("justWonNomSlots",!1),s.EveryPlay.record(),t.audio.stopAllMusic(),"background0"===N?(t.audio.playMusic("bgm_cat-ingame"),t.audio.setVolume(1,"bgm_cat-ingame")):"background1"===N?(t.audio.playMusic("bgm_asian"),t.audio.setVolume(1,"bgm_asian")):"background2"===N?(t.audio.playMusic("bgm_french"),t.audio.setVolume(1,"bgm_french")):"background3"===N?(t.audio.playMusic("bgm_harbor"),t.audio.setVolume(1,"bgm_harbor")):"background5"===N&&(t.audio.playMusic("bgm_harbor"),t.audio.setVolume(1,"bgm_harbor"))},Y=function(){var e;for(e=0;10>e;++e)t.objects.add(y())},X=function(t){var e=0;for(e=0;e<s.cats.length;++e)if(s.cats[e].resource===t)return s.cats[e];return null};if(t.saveState.load("continueState",0)>0?(F=!0,H.setValue(t.saveState.load("continueState",0)),t.saveState.save("continueState",0),t.saveState.save("usedContinue",!0),S()):x(function(){},!0),t.input.resetPointers(),t.objects.add(B),t.add(j),"background0"===N)E=a({z:-10,name:"clouds",addNow:!1,useHshg:!1,position:e(k.width/2,k.height/2-180),originRelative:e(0,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background0clouds")},init:function(){var t=function(){u({from:k.width/2,to:k.width/2-128,"in":500,ease:"linear","do":function(t,e){E.setPositionX(t)},onComplete:function(){t()}})};t()}}).attach(a({z:0,name:"",position:e(128,0),components:[i],sprite:{image:t.assets.getImage("background0clouds")}})),_=a({z:-8,name:"faucet",addNow:!0,useHshg:!1,position:e(k.width/2+36,k.height/2-27),originRelative:e(0,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background0faucet"),frameWidth:16,frameHeight:18,animations:{"static":{speed:.2,frames:[0]},drip:{speed:.2,frames:[0,1,2,3,4,5,6,7,8,9]}}}}).attach({update:function(t){t.entity.timer%240===0&&t.entity.sprite.setAnimation("drip",function(){t.entity.sprite.setAnimation("static")})}}),T=a({z:0,name:"toaster",addNow:!0,useHshg:!1,position:e(k.width/2-65,k.height/2-45),originRelative:e(0,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background0toaster"),frameWidth:40,frameHeight:35,animations:{ready:{speed:0,frames:[0]},down:{speed:.2,backTo:4,frames:[0,1,2,3,4]},up:{speed:.2,backTo:4,frames:[5,6,7,8,9]}}},init:function(){this.translation.setSubPixel(!0)}}).attach({update:function(t){300===t.entity.timer&&t.entity.sprite.setAnimation("down"),600===t.entity.timer&&t.entity.sprite.setAnimation("up"),900===t.entity.timer&&(t.entity.timer=0)}});else if("background1"===N)d=a({z:-7,name:"foreground",addNow:!0,useHshg:!1,position:O,originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("background1front")},init:function(){}}),Y();else if("background2"===N)l=a({z:-8,name:"train",addNow:!0,useHshg:!1,position:O.add(e(-200,-67)),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("background2train")},init:function(){}}).attach({update:function(t){(t.entity.timer+D)%(600+L)===0&&u({from:-200,to:392,"in":120,ease:"linear",alpha:0,beta:0,"do":function(t,e){l.setPositionX(t)},onComplete:function(){}})}}),d=a({z:-7,name:"foreground",addNow:!0,useHshg:!1,position:O.add(e(0,-67)),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("background2front")},init:function(){}}),m=a({z:-10,name:"water",addNow:!0,position:e(k.width/2,k.height/2+8),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background2water")},init:function(){}}).attach({draw:function(e){var n,i=t.assets.getImage("background2water");for(n=0;n<i.height;++n)e.renderer.drawImage(i,0,n,i.width,1,-i.width/2+Math.min(n/20,2)*Math.sin(n/(Math.PI/2)-e.entity.timer/10),n,i.width,1);
}});else if("background3"===N)d=a({z:-7,name:"foreground",addNow:!0,useHshg:!1,position:O.add(e(0,-37)),originRelative:e(.5,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("background3front")},init:function(){}}),m=a({z:-10,name:"water",addNow:!0,position:e(k.width/2,k.height/2-39),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background3water")},init:function(){}}).attach({draw:function(e){var n,i=t.assets.getImage("background3water");for(n=0;n<i.height;++n)e.renderer.drawImage(i,0,n,i.width,1,-i.width/2+Math.min(n/10,3)*Math.sin(n/(Math.PI/4)-e.entity.timer/10),n,i.width,1)}}),A=a({z:-8,name:"boat",addNow:!0,useHshg:!1,position:e(k.width,k.height/2-43),originRelative:e(0,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background3boat")},init:function(){var t=function(){u({from:k.width,to:-64,"in":1800,ease:"linear",alpha:0,beta:0,"do":function(t,e){A.getPosition().x=t},onComplete:function(){s.timeout(2*L,t)}})};s.timeout(D,t),this.translation.setSubPixel(!0)}});else if("background4"===N){for(C=a({z:-1,name:"rainbow",addNow:!0,position:e(0,k.height/2+100),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background4rainbow"),frameWidth:1},init:function(){}}).attach({draw:function(e){var n,i=t.assets.getImage("background4rainbow");for(n=0;n<i.height;++n)e.renderer.drawImage(i,0,n,i.width,1,(k.width-i.width)/2+3*Math.sin(n/(Math.PI/.75)-e.entity.timer/6),n,i.width,1)}}),c=0;10>c;++c)W(1,.03);for(c=0;10>c;++c)W(2,.05);for(c=0;4>c;++c)W(3,.19);for(c=0;4>c;++c)W(4,.2)}else"background5"===N&&(M=a({z:-8,name:"foreground2",addNow:!0,useHshg:!1,position:O.add(e(0,-44)),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background5back")},init:function(){}}),d=a({z:-4,name:"foreground",addNow:!0,useHshg:!1,position:e(k.width/2,k.height/2+70),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background5front")},init:function(){}}),m=a({z:-10,name:"water",addNow:!0,position:e(k.width/2,k.height/2-8),originRelative:e(.5,0),components:[i],family:[""],sprite:{image:t.assets.getImage("background5water")},init:function(){}}).attach({draw:function(e){var n,i=t.assets.getImage("background5water");for(n=0;n<i.height;++n)e.renderer.drawImage(i,0,n,i.width,1,-i.width/2+Math.min(n/10,3)*Math.sin(n/(Math.PI/4)-e.entity.timer/10),n,i.width,1)}}),I=a({z:-6,name:"boat",addNow:!0,useHshg:!1,position:e(k.width+20,k.height/2+41),originRelative:e(1,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("background5boat1")},init:function(){this.pos=k.height/2+41,this.translation.setSubPixel(!0),this.timer=s.getRandom(1e3)}}).attach({update:function(t){t.entity.setPositionY(t.entity.pos+4*Math.sin(t.entity.timer/50)),t.entity.rotation.setAngleDegree(2*Math.cos(t.entity.timer/80))}}),R=a({z:-7,name:"boat",addNow:!0,useHshg:!1,position:e(k.width,k.height/2+41),originRelative:e(1,.5),components:[i],family:[""],sprite:{image:t.assets.getImage("background5boat2")},init:function(){this.pos=k.height/2+41,this.translation.setSubPixel(!0),this.timer=s.getRandom(1e3)}}).attach({update:function(t){t.entity.setPositionY(t.entity.pos+3*Math.sin(t.entity.timer/73)),t.entity.rotation.setAngleDegree(2*Math.cos(t.entity.timer/92))}}));if("catklaus"===z.resource?(z=X("catklaus2"),G=X("catoskar"),t.saveState.save("currentCat",z),t.saveState.save("currentCatLeft",G)):"catvenus"===z.resource&&(z=X("catvenus2"),G=X("catroo"),t.saveState.save("currentCat",z),t.saveState.save("currentCatLeft",G)),"catrandom"===z.resource){if(F)r=t.saveState.load("currentRandomCat","cat");else{for(r=U[s.getRandom(U.length)];"catrandom"===r||"cat"!==r.substring(0,3);)r=U[s.getRandom(U.length)];t.saveState.save("currentRandomCat",r)}t.add(f(-1,r))}else t.add(f(-1,z.resource));if("catrandom"===G.resource){if(F)r=t.saveState.load("currentRandomCatLeft","cat");else{for(r=U[s.getRandom(U.length)];"catrandom"===r||"cat"!==r.substring(0,3);)r=U[s.getRandom(U.length)];t.saveState.save("currentRandomCatLeft",r)}t.add(f(1,r))}else t.add(f(1,G.resource));"background4"===N&&(P=t.objects.get("shadow"),P&&t.objects.remove(P),P=t.objects.get("shadow"),P&&t.objects.remove(P)),t.saveState.save("previousBackground",N),t.saveState.save("background","background"+s.getRandom(4)),n?b(V):V()}}),E}),bento.define("screens/news",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","utils","bento/tween","bento/eventsystem","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","entities/backscroller"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d){"use strict";var p=c({dimension:t.getViewport()});return a.extend(p,{onShow:function(){var i=t.getViewport(),r=(d("backgroundtile",3,4,-.5,.5,-1,[8/255,.6,202/255,1]),window.innerWidth*(window.devicePixelRatio||1)/i.width,n(0,40,i.width-0,i.height-80)),s=!1,c=(h({z:200,image:t.assets.getImage("buttonclose"),position:e(i.width-20,20),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){t.screens.show("screens/main",!0),u.on("canShowNews",p),s&&Cocoon.App.hideTheWebView(),s=!0},init:function(){}}),o({z:10,name:"draw",useHshg:!1,init:function(){}}).attach({draw:function(t){t.renderer.fillRect([0,0,0,.25],r.x+4,r.y,r.width-8,r.height)}}),f({z:a.Constants.Layer.GUI+3,text:a.Localization.getText("loading"),addNow:!0,font:"font",align:"center",textBaseline:"middle",fontColor:"#fff",lineWidth:1,strokeStyle:"#084040",innerStroke:!1,fontSize:16,fontSettings:a.Fonts["fontStroked-"+a.Fonts.getFontLang()],position:e(i.width/2,i.height/2)}).attach({update:function(){a.newsEntity?(l(),p()):a.skipNews&&(console.log("skip"),t.screens.show("screens/main",!0))}})),l=function(){var n,i,r,o=t.getViewport();r=a.newsEntity.getDimension(),n=r.width/r.height,i=a.newsEntity.scale.getScale(),a.newsEntity.loadedNews?i=e(.25,.25):(console.log("promo width",r.width),i.x=(o.width-8)/r.width,i.y=i.x),console.log(r),a.newsEntity.scale.setScale(i),a.newsEntity.setPosition(e(o.width/2,o.height/2)),t.objects.get("news")||t.objects.add(a.newsEntity)},p=function(){t.objects.remove(c),a.settings.news>t.saveState.load("news",0)&&a.newsEntity&&a.newsEntity.loadedNews&&t.saveState.save("news",a.settings.news)};return a.skipNews||!a.isCocoonJS()?(console.log("skip"),void t.screens.show("screens/main",!0)):(t.audio.stopAllMusic(),t.audio.playMusic("bgm_cat-title"),void t.audio.setVolume(.75,"bgm_cat-title"))}}),p}),bento.define("screens/nomslots",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","entities/backscroller","entities/minigame","entities/fade"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p){"use strict";var g=u({dimension:t.getViewport()});return a.extend(g,{onShow:function(){d(function(){p(function(){t.screens.show("screens/main",!0)})})}}),g}),bento.define("screens/preloader",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/components/fill","bento/components/translation","bento/components/opacity","bento/entity","bento/utils","bento/tween","bento/screen","gui/text"],function(t,e,n,i,r,o,a,s,u,c,h,l,f){"use strict";var d=l({dimension:t.getViewport()});return c.extend(d,{onShow:function(){var n=t.getViewport(),i=!1,a=(u({z:-1,name:"background",components:[o,r],addNow:!0,clickable:{pointerDown:function(){t.audio.playSound("sfx_silence"),i&&t.screens.show("screens/logo")}}}),f({font:"font",fontSize:16,fontColor:"#ffffff",fontSettings:c.Fonts["font-"+c.Fonts.getFontLang()],text:"",align:"center",textBaseline:"middle",addNow:!0,position:e(n.width/2,n.height/2)})),s=window.location?window.location.hash:"";t.assets.load("cats",function(e){t.assets.load("catsbw",function(e){t.assets.load("assets",function(e){c.isApple()&&!c.isCocoonJS()?(console.log("loaded"),a.setText(c.Localization.getText("start")),i=!0,""!==s&&t.screens.show("screens/"+s.slice(1))):t.screens.show("screens/logo")},function(t,e){c.isCocoonJS()||a.setText(c.Localization.getText("loading")+"\n"+Math.floor(t/e*100)+"%")})},function(t,e){c.isCocoonJS()||a.setText(c.Localization.getText("loading")+"\n"+Math.floor(t/e*100)+"%")})},function(t,e){c.isCocoonJS()||a.setText(c.Localization.getText("loading")+"\n"+Math.floor(t/e*100)+"%")})}}),d}),bento.define("screens/promo",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","entities/backscroller","entities/catselector"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d){"use strict";var p=u({dimension:t.getViewport()});return a.extend(p,{onShow:function(){var n,r,s,u=(t.getViewport(),f("backgroundtile",3,4,-.5,.5,-1,[8/255,.6,202/255,1]),4),c=60,h=30,l=70,d=[],p=function(n){o({z:1,name:"",addNow:!0,useHshg:!1,position:e(h+c*(n%u),l+c*Math.floor(n/u)),originRelative:e(.5,1),components:[i],family:[""],sprite:{image:t.assets.getImage(a.cats[n].resource),frameCountX:2,frameCountY:2,animations:{"default":{speed:0,frames:[0]}}},init:function(){}})},g=function(t){for(n=0;n<a.cats.length;++n)if(a.cats[n].resource===t){a.cats.splice(n,1);break}},m=function(t){var e,n;for(n=0;n<a.cats.length;++n)if(a.cats[n].resource===t){e=a.cats.splice(n,1);break}e||alert(t),a.cats.unshift(e[0])};for(g("catcryptarch"),g("catcryptjobs"),g("cateinstein"),g("catwizard"),g("catpirate"),g("catmaid"),g("catfairy"),n=0;n<a.cats.length-6;++n)a.cats[n].partner&&d.push({resource:a.cats[n].partner});for(a.cats.unshift(d[0]),a.cats.unshift(d[1]),n=0;n<a.cats.length-6;++n)s=a.getRandom(a.cats.length-6),r=a.cats[n],a.cats[n]=a.cats[s],a.cats[s]=r;for(m("catgentleman"),m("catafro"),m("catwitch"),n=0;n<a.cats.length-6;++n)p(n)}}),p}),bento.define("screens/select",["bento","bento/math/vector2","bento/math/rectangle","bento/components/fill","bento/components/sprite","bento/components/clickable","bento/components/translation","bento/entity","bento/utils","bento/tween","bento/screen","gui/clickbutton","bento/gui/togglebutton","gui/text","bento/packedimage","filter","entities/backscroller","entities/catselector","store","gui/counter","bento/eventsystem","entities/fade"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d,p,g,m,v,b,y,x,w){"use strict";var _=h({dimension:t.getViewport()});return u.extend(_,{onHide:function(){console.log("hidden"),this.base.onHide()},onShow:function(n){var a,h=t.getViewport(),f=m("backgroundtile",3,4,-.5,.5,-1,[8/255,.6,202/255,1]),p=0,g=!1,x=!1,_=0,S=1,E=t.saveState.load("goldfish",0),T=s({z:2,name:"appstore",position:e(-100,4),originRelative:e(0,0),components:[r,o],family:[""],sprite:{image:t.assets.getImage("buttonshare"),frameCountX:1,frameCountY:2},clickable:{onClick:function(){console.log("clicked"),C.isVisible()&&(u.Cocoon.openUrl(C.link),u.Analytics.event("UI","famousCatLinkClicked"))}},addNow:!0,init:function(){this.setVisible(!1)}}).attach({update:function(t){}}).extend({link:"",tween:null}).attach(d({position:e(48,0),name:"visit",font:"font",fontSize:16,text:"Visit the\nwebsite!",fontColor:"#ffffff",fontSettings:u.Fonts["font-"+u.Fonts.getFontLang()]})),A=s({z:2,name:"appstore",position:e(-100,4),originRelative:e(0,0),components:[r,o],family:[""],sprite:{image:t.assets.getImage(u.isNativeIos()?"appstore":u.isAmazon()?"amazonstore":"androidstore")},clickable:{onClick:function(){console.log("clicked"),C.isVisible()&&(u.Cocoon.openUrl(C.link),u.Analytics.event("UI","crossPromotionClicked",0,C.link))}},addNow:!0,init:function(){this.setVisible(!1)}}).attach({update:function(t){}}).extend({link:"",tween:null}),C=A,P=d({position:e(h.width/2,h.height/2),name:"wait",font:"font",fontSize:16,text:"Purchasing...",align:"center",fontColor:"#ffffff",fontSettings:u.Fonts["font-"+u.Fonts.getFontLang()],maxWidth:h.width}),I=(s({z:u.Constants.Layer.GUI+10,name:"overlay",components:[i],fill:{color:[0,0,0,.5]},updateWhenPaused:!0,init:function(){}}).attach(P),t.saveState.load("unlocked",["cat"])),R=u.cats,M=l({image:t.assets.getImage("buttonback"),position:e(24,24),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){M.isActive&&w(function(){t.screens.show("screens/main",!0)},!1,M.getPosition())}}).attach({update:function(){C.isVisible()||""!==B.getText()?(M.isActive=!1,M.setVisible(!1)):(M.setVisible(!0),M.isActive=!0)}}),k=s({z:1,name:"leftCat",addNow:!0,useHshg:!1,position:e((h.width/2-48)/2-80,h.height+32),originRelative:e(.5,1),components:[r],sprite:{image:t.assets.getImage("catunknown"),frameCountX:2,frameCountY:2},init:function(){this.scale.setScale(e(-S,S))}}).extend({bounce:function(){c({from:(h.width/2-48)/2-80,to:(h.width/2-48)/2,"in":30,ease:"elastic",alpha:-5,beta:1,updateWhenPaused:!0,"do":function(t,e){k.getPosition().x=t},onComplete:function(){}})}}),O=s({z:1,name:"leftCat",addNow:!0,useHshg:!1,position:e(h.width-(h.width/2-48)/2+80,h.height+32),originRelative:e(.5,1),components:[r],family:[""],sprite:{image:t.assets.getImage("catunknown"),frameCountX:2,frameCountY:2},init:function(){this.scale.setScale(e(S,S))}}).extend({bounce:function(){c({from:h.width-(h.width/2-48)/2+80,to:h.width-(h.width/2-48)/2,"in":30,ease:"elastic",updateWhenPaused:!0,alpha:-5,beta:1,"do":function(t,e){O.getPosition().x=t},onComplete:function(){}})}}),D=l({image:t.assets.getImage("buttonresume"),position:e(h.width/2,h.height-32),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,font:"font",fontSize:32,fontSettings:u.Fonts["fontLarge-"+u.Fonts.getFontLang()],labelOffset:"EN"===u.Fonts.getFontLang()?e(0,-4):e(0,0),labelMaxWidth:92,labelMaxHeight:32,onClick:function(){t.saveState.load("goldfish",0);g?"catrandom"===R[p].resource?(t.saveState.save("currentCatLeft",R[p]),t.saveState.save("currentCat",R[p]),t.objects.pause(),W.updateWhenPaused=!1,u.timeout(30,function(){w(function(){t.objects.resume(),t.screens.show("screens/main",!0)})},!0)):k.currentCat?(t.saveState.save("currentCat",R[p]),O.sprite.setup({image:t.assets.getImage(R[p].resource),frameCountX:2,frameCountY:2}),O.setOriginRelative(e(.5,1)),t.audio.stopSound("sfx_meow"),t.audio.playSound("sfx_meow"),O.bounce(),t.objects.pause(),W.updateWhenPaused=!1,u.timeout(30,function(){w(function(){t.objects.resume(),t.screens.show("screens/main",!0)})},!0)):(t.saveState.save("currentCatLeft",R[p]),k.currentCat=R[p],k.sprite.setup({image:t.assets.getImage(R[p].resource),frameCountX:2,frameCountY:2}),k.setOriginRelative(e(.5,1)),t.audio.stopSound("sfx_meow"),t.audio.playSound("sfx_meow"),k.bounce(),"catvenus2"===R[p].resource?k.scale.setScale(e(S,S)):k.scale.setScale(e(-S,S))):(t.objects.pause(),w(function(){t.objects.resume(),t.screens.show("screens/gacha")},!1,D.getPosition()))}}),L=d({z:1,position:e(h.width/2,h.height/2),font:"font",fontSize:32,text:t.saveState.load("currentCat",{name:"Nom Cat",resource:"cat"}).name,maxWidth:h.width-16,maxHeight:32,linebreaks:!1,margin:e(16,32),ySpacing:-8,textBaseline:"middle",align:"center",addNow:!0,fontColor:"#ffffff"}),B=d({z:1,position:e(8,0),fontSettings:u.Fonts["font-"+u.Fonts.getFontLang()],align:"left",addNow:!0,maxWidth:h.width-40,maxHeight:64,fontColor:"#ffffff"}),N=d({z:1,position:e(h.width/2-16,h.height/2+32),font:"font",fontSize:16,fontSettings:u.Fonts["font-"+u.Fonts.getFontLang()],text:"You unlocked this cat!",align:"center",maxHeight:h.height<284?36:64,maxWidth:h.width-16,fontColor:"#ffffff"}),F=y({z:u.Constants.Layer.GUI+3,name:"goldfishtext",image:t.assets.getImage("numberstiny"),frameWidth:8,frameHeight:8,spacing:e(0,0),position:e(h.width-28,12),align:"right",value:t.saveState.load("goldfish",0)}).extend({setText:function(t){this.setValue(+t)},getText:function(){return this.getValue().toString()}}),j=(s({z:u.Constants.Layer.GUI+2,name:"fishIcon",position:e(h.width-18,16),originRelative:e(.5,.5),components:[r],family:[""],sprite:{image:t.assets.getImage("goldfishicon")},addNow:!0,init:function(){t.objects.add(F)}}),y({z:u.Constants.Layer.GUI+2,name:"goldfishtext",image:t.assets.getImage("numberstiny"),frameWidth:8,frameHeight:8,spacing:e(0,0),position:e(-32,-4),align:"left",value:0}).extend({setText:function(t){this.setValue(+t)},getText:function(){return this.getValue().toString()}})),U=s({z:u.Constants.Layer.GUI+2,name:"fishIcon",position:e(h.width/2+32,h.height/2+44),originRelative:e(.5,.5),components:[r],family:[""],sprite:{image:t.assets.getImage("goldfishicon")},init:function(){}}),z=l({image:t.assets.getImage("buttongachalarge"),position:e(h.width-24,h.height/6),frameWidth:48,frameHeight:48,sfx:"sfx_button",addNow:!0,onClick:function(){t.objects.pause(),w(function(){t.objects.resume(),t.screens.show("screens/gacha")},!1,z.getPosition())}}).attach({start:function(){u.timeout(1,function(){E<u.gachaPrice&&(z.setActive(!1),z.setVisible(!1))})}}),G=function(){var e,n,i=t.saveState.load("seenCats",["cat"]),r=t.saveState.load("goldfish",0),o=!1;for(e=0;e<u.cats.length;++e)r>=u.cats[e].price&&(n=u.cats[e],-1===i.indexOf(n.resource)&&(i.push(n.resource),o=!0));return t.saveState.save("seenCats",i),o},H=function(e){return"buttonresume"!==e?(D.setVisible(!1),void D.setActive(!1)):(D.setVisible(!0),D.setActive(!0),void D.sprite.setup({image:t.assets.getImage(e),frameWidth:48,frameHeight:48,animations:{"default":{speed:0,frames:[0]},down:{speed:0,frames:[1]},up:{speed:0,frames:[0]},inactive:{speed:0,frames:[0]}}}))},W=v(function(n){var i=function(){var t;if(!a)return"$0.99";for(t=0;t<a.length;++t)if(a[t].productId===R[n].resource)return a[t].localizedPrice;return"$0.99"},r=(R[n].resource,R[n].price),o=R[n].turbo,s=R[n].watchAds,l=R[n].unlockOnly;a||(a=b.getProducts()),I=t.saveState.load("unlocked",["cat"]),L.setText(R[n].name),"ZH"===u.Localization.getLang()&&R[n].name_ZH&&(L.setText(R[n].name_ZH,{fontSettings:u.Fonts["fontLarge-"+u.Fonts.getFontLang()],maxWidth:h.width-32,ySpacing:0}),L.setPosition(e(h.width/2,h.height/2+8))),"ZHK"!==u.Localization.getLang()&&"ZTW"!==u.Localization.getLang()||!R[n].name_ZT||(L.setText(R[n].name_ZT,{fontSettings:u.Fonts["fontLarge-"+u.Fonts.getFontLang()],maxWidth:h.width-32,ySpacing:0}),L.setPosition(e(h.width/2,h.height/2+8))),p=n,I.indexOf(R[n].resource)>=0||"catrandom"===R[n].resource?(H("buttonresume"),g=!0,x=!1,N.setText(""),U.setVisible(!1)):(g=!1,r!==1/0?(l?N.setText(u.Localization.getText("fishcost").replace("{0}",r)):N.setText(u.Localization.getText("fishcost").replace("{0}",r)+"\n"+u.Localization.getText("iapcost").replace("{0}",i())),U.setVisible(!0),j.setValue(r),N.getPosition().x=h.width/2-8):u.isDefined(s)?(console.log(s),t.saveState.load("adsWatched",0)>=s?N.setText(""):N.setText(u.Localization.getText("unlockads").replace("{0}",s-t.saveState.load("adsWatched",0))+""+u.Localization.getText("iapcost").replace("{0}",i())),N.getPosition().x=h.width/2,U.setVisible(!1)):u.isDefined(o)?(t.saveState.load("highscoreTurbo",0)>=o?N.setText(""):N.setText(u.Localization.getText("unlockturbo").replace("{0}",o)+""+u.Localization.getText("iapcost").replace("{0}",i())),N.getPosition().x=h.width/2,U.setVisible(!1)):(N.setText(u.Localization.getText("iapcost2").replace("{0}",i())),N.getPosition().x=h.width/2,U.setVisible(!1)),_=R[n].price,t.saveState.load("goldfish",0)>=_||u.isDefined(o)&&t.saveState.load("highscoreTurbo",0)>=o||u.isDefined(s)&&t.saveState.load("adsWatched",0)>=s?(H("buttonunlock"),x=!0):(l?r!==1/0?(N.setText(u.Localization.getText("fishcost").replace("{0}",r)),H("buttonunlock")):(H("buttonunlock"),N.setText(u.Localization.getText(R[n].description))):H("buttonpurchase"),x=!1)),R[n].extraLabel?B.setText(R[n].extraLabel):B.setText("");var f;f=u.isNativeIos()?R[n].iosLink:u.isAmazon()?R[n].amazonLink:R[n].androidLink,f||R[n].link?(R[n].iosLink?(u.isNativeIos()?C.link=R[n].iosLink:u.isAmazon()?C.link=R[n].amazonLink:C.link=R[n].androidLink,C=A,A.setVisible(!0),T.setVisible(!1)):R[n].link&&(C.link=R[n].link,C=T,A.setVisible(!1),T.setVisible(!0)),C.setPosition(e(-108,4)),C.tween&&(C.tween.stop(),t.objects.remove(C.tween),C.timeout&&(t.objects.remove(C.timeout),C.timeout=null),C.tween=null),C.tween=c({from:-108,to:4,"in":30,ease:"elastic",alpha:-10,beta:1,"do":function(t,e){C.getPosition().x=t},onComplete:function(){C.tween=null}}),C.tween.stop(),C.timeout=u.timeout(R[n].delay||60,function(){C.timeout=null,C.tween&&C.tween.begin()})):(C.tween&&(C.tween.stop(),t.objects.remove(C.tween),C.tween=null,C.timeout&&(t.objects.remove(C.timeout),C.timeout=null)),A.setVisible(!1),T.setVisible(!1))},n);n&&n.background?(t.objects.remove(f),f=n.background,t.objects.add(f)):(t.audio.stopAllMusic(),t.audio.playMusic("bgm_cat-title"),t.audio.setVolume(.75,"bgm_cat-title")),G(),c({from:0,to:1,"in":20,ease:"linear","do":function(t,e){U.setVisible(!1),N.setText("")},onComplete:function(){}}),w(function(){},!0)}}),_}),bento.define("screens/selectcat",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/screen","gui/clickbutton","bento/gui/togglebutton","gui/text","entities/backscroller"],function(t,e,n,i,r,o,a,s,u,c,h,l,f){"use strict";var d=u({dimension:t.getViewport()});return a.extend(d,{onShow:function(r){var u=t.getViewport(),h=10,l=r.background,f=c({image:t.assets.getImage("buttonempty"),position:e(u.width/2,u.height-32),frameWidth:128,frameHeight:48,addNow:!0,sfx:"sfx_button",label:a.Localization.getText("play"),font:"font",fontSize:32,fontSettings:a.Fonts["fontLarge-"+a.Fonts.getFontLang()],labelOffset:"EN"===a.Fonts.getFontLang()?e(0,-4):e(0,0),labelMaxWidth:92,labelMaxHeight:32,onDown:function(){this.getText().setPosition(e(0,4)),"EN"===a.Fonts.getFontLang()&&this.getText().setPosition(e(0,0))},onUp:function(){this.getText().setPosition(e(0,0)),"EN"===a.Fonts.getFontLang()&&this.getText().setPosition(e(0,-4))},onClick:function(){t.screens.show("screens/main")}}),d=(c({z:1,image:t.assets.getImage("buttonback"),position:e(24,24),frameWidth:48,frameHeight:48,addNow:!0,sfx:"sfx_button",onClick:function(){t.screens.show("screens/select",{background:l})}}),-1),p=t.saveState.load("currentCatLeft",t.saveState.load("currentCat",{resource:"cat"})),g=o({z:1,name:"leftCat",addNow:!1,position:e(u.width/2-40,u.height/2+40-h),originRelative:e(.5,1),components:[i],family:[""],sprite:{image:t.assets.getImage(p.resource),frameCountX:2,frameCountY:2},init:function(){"catvenus2"===p.resource&&(d=1),this.scale.setScaleX(d)}}).extend({current:p.resource,bounce:function(){"catvenus2"===r.cat&&(d=1),s({from:1.2,to:1,"in":20,ease:"elastic",alpha:-3,beta:1,"do":function(t,e){g.scale.setScaleX(d*t),g.scale.setScaleY(1/t)},onComplete:function(){}})}}),m=t.saveState.load("currentCat",{resource:"cat"}),v=o({z:1,name:"rightCat",addNow:!1,position:e(u.width/2+40,u.height/2+40-h),originRelative:e(.5,1),components:[i],family:[""],sprite:{image:t.assets.getImage(m.resource),frameCountX:2,frameCountY:2},init:function(){}}).extend({current:m.resource,bounce:function(){s({from:1.2,to:1,"in":20,ease:"elastic",alpha:-3,beta:1,"do":function(t,e){v.scale.setScaleX(t),v.scale.setScaleY(1/t)},onComplete:function(){}})}}),b=o({z:0,name:"currentCat",addNow:!0,useHshg:!1,position:e(u.width/2,u.height/2-h),originRelative:e(.5,1),components:[i],family:[""],sprite:{image:t.assets.getImage(a.cats[t.saveState.load("currentCatChoice",0)].resource),frameCountX:2,frameCountY:2},init:function(){}}),y=c({z:1,image:t.assets.getImage("buttonselect"),position:e(u.width/2-40,u.height/2+62-h),frameWidth:48,frameHeight:36,addNow:!1,sfx:"sfx_button",onClick:function(){r.cat!==g.current?(g.sprite.setup(w(r.cat)),g.current=r.cat,t.audio.stopSound("sfx_meow"),t.audio.playSound("sfx_meow"),g.bounce(),t.saveState.save("currentCatLeft",_(r.cat))):(g.sprite.setup(w(p.resource)),g.current=p.resource,t.saveState.save("currentCatLeft",p)),g.setOriginRelative(e(.5,1))}}),x=c({z:1,image:t.assets.getImage("buttonselect"),position:e(u.width/2+40,u.height/2+62-h),frameWidth:48,frameHeight:36,addNow:!1,sfx:"sfx_button",onClick:function(){r.cat!==v.current?(v.sprite.setup(w(r.cat)),v.current=r.cat,t.audio.playSound("sfx_meow"),v.bounce(),t.saveState.save("currentCat",_(r.cat))):(v.sprite.setup(w(m.resource)),v.current=m.resource,t.saveState.save("currentCat",m)),v.setOriginRelative(e(.5,1))}}),w=(o({z:1,addNow:!0,name:"arrowR",position:e(u.width/2+32,u.height/2-48-h),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("arrowset")},init:function(){this.opacity.setOpacity(.9)}}),o({z:1,addNow:!0,name:"arrowL",position:e(u.width/2-32,u.height/2-48-h),originRelative:e(.5,.5),components:[i],sprite:{image:t.assets.getImage("arrowset")},init:function(){this.opacity.setOpacity(.9),this.scale.setScaleX(-1)}}),function(e){return{image:t.assets.getImage(e),frameCountX:2,frameCountY:2}}),_=function(t){var e=0;for(e=0;e<a.cats.length;++e)if(a.cats[e].resource===t)return a.cats[e];return{resource:"cat"}};t.objects.add(r.background),s({from:1,to:.5,"in":40,ease:"elastic",alpha:-10,beta:1,"do":function(t,n){b.scale.setScale(e(t,t))},onComplete:function(){}}),s({from:u.height/2,to:u.height/2-40-h,"in":40,ease:"elastic",alpha:-10,beta:1,"do":function(t,e){b.setPositionY(t)},onComplete:function(){}}),a.timeout(10,function(){t.objects.add(g),t.objects.add(v),t.objects.add(y),t.objects.add(x),s({from:-120,to:-40,"in":30,ease:"elastic",alpha:-6,beta:1,"do":function(t,e){g.setPositionX(u.width/2+t),y.setPositionX(u.width/2+t),v.setPositionX(u.width/2-t),x.setPositionX(u.width/2-t)},onComplete:function(){}})}),f.setBoundingBox(n(-64,-18,128,36))}}),d}),bento.define("screens/title",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/screen","bento/gui/clickbutton","bento/gui/togglebutton","gui/text","entities/backscroller","entities/catselector"],function(t,e,n,i,r,o,a,s,u,c,h,l,f,d){"use strict";var p=u({dimension:t.getViewport()});return a.extend(p,{onShow:function(){t.screens.show("screens/news",!0)}}),p}),bento.define("singletons/analytics",[],function(){"use strict";var t="unidentified",e=Date.now().toString(),n="UA-59807613-1",i="5de98d0a9e90d4842d682d9315181675",r="bd52ed66291d88326e0b08e6df556e68832ed2ad",o={init:function(e){var i=new XMLHttpRequest,r="v=1&tid="+n+"&cid="+t+"&t=pageview&dp=%2F";i.open("POST","http://www.google-analytics.com/collect",!0),i.send(r)},event:function(e,i,r,o){if(navigator.onLine&&navigator.isCocoonJS){var a=new XMLHttpRequest,s="v=1&tid="+n+"&cid="+t+"&t=event&ec="+e+"&ea="+i;"undefined"!=typeof o&&(s+="&el="+o),"undefined"!=typeof r&&(s+="&ev="+r),a.open("POST","http://www.google-analytics.com/collect",!0),a.send(s),this.send(i,r,"design"),window.facebookConnect&&window.facebookConnect.logEvent(i,{category:e,action:i,value:r,label:o},r,function(){console.log("fb event logged:"+i)},function(){})}},send:function(n,o,a,s,u){var c,h,l,f=new XMLHttpRequest,d="http://api.gameanalytics.com/1/"+i+"/"+a,p={};p.user_id=t,p.session_id=e,p.build="NomCat_v1.0",p.event_id=n,"design"===a?p.value=o||0:"business"===a&&(p.currency=s||"USD",p.amount=u||0,console.log("business event",s,u)),l=JSON.stringify(p),c=CryptoJS.MD5(l+r),h=CryptoJS.enc.Hex.stringify(c),f.open("POST",d,!0),f.setRequestHeader("Content-Type","text/plain"),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.setRequestHeader("Authorization",h),f.send(l),f.onreadystatechange=function(){4===f.readyState&&200===f.status}}};return navigator.isCocoonJS&&window.Cocoon&&window.Cocoon.Device&&(t=window.Cocoon.Device.getDeviceId()),o}),bento.define("singletons/cocoon",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){var c={share:function(){},openUrl:function(t){window.Cocoon.App.openURL(t)},setAntiAlias:function(t){window.Cocoon.Utils.setAntialias(t)},prompt:function(t,e){window.Cocoon.Dialog.prompt(t,e)},getDeviceId:function(){return window.Cocoon.Device.getDeviceId()}};return c}),bento.define("singletons/crittercism",["bento","bento/eventsystem"],function(t,e){"use strict"}),bento.define("singletons/currency",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/eventsystem","bento/utils","bento/tween"],function(t,e,n,i,r,o,a,s,u){"use strict";var c=function(t){for(var e=t.length,n=[];e--;){var i=t[e].charCodeAt();65>i||i>127||i>90&&97>i?n[e]="&#"+i+";":n[e]=t[e]}return n.join("")},h=[],l=[];return h[0]="ALL",l[0]="&#76;&#101;&#107;",h[1]="USD",l[1]="&#36;",h[2]="AFN",l[2]="&#1547;",h[3]="ARS ",l[3]="&#36;",h[4]="AWG",l[4]="&#402;",h[5]="AUD",l[5]="&#36;",h[6]="AZN",l[6]="&#1084;&#1072;&#1085;",h[7]="BSD;",l[7]="&#36;",h[8]="BBD",l[8]="&#36;",h[9]="BYR",l[9]="&#112;&#46;",h[10]="BEF",l[10]="&#8355;",h[11]="BZD",l[11]="&#66;&#90;&#36;",h[12]="BMD",l[12]="&#36;",h[13]="BOB",l[13]="&#36;&#98;",h[14]="BAM",l[14]="&#75;&#77;",h[15]="BWP ",l[15]="&#80;",h[16]="BGN",l[16]="&#1083;&#1074;",h[17]="BRL",l[17]="&#82;&#36;",h[18]="BRC",l[18]="&#8354;",h[19]="GBP",l[19]="&#163;",h[20]="BND",l[20]="&#36;",h[21]="KHR",l[21]="&#6107;",h[22]="CAD ",l[22]="&#36;",h[23]="KYD",l[23]="&#36;",h[24]="CLP",l[24]="&#36;",h[25]="CNY",l[25]="&#20803;",h[26]="COP ",l[26]="&#36;",h[27]="CRC ",l[27]="&#8353;",h[28]="HRK",l[28]="&#107;&#110;",h[29]="CUP",l[29]="&#8369;",h[30]="CYP",l[30]="&#163;",h[31]="CZK ",l[31]="&#75;&#269;",h[32]="DKK ",l[32]="&#107;&#114;",h[33]="DOP",l[33]="&#82;&#68;&#36;",h[34]="XCD ",l[34]="&#36;",h[35]="EGP",l[35]="&#163;",h[36]="SVC ",l[36]="&#36;",h[37]="GBP ",l[37]="&#163;",h[38]="EEK",l[38]="&#107;&#114;",h[39]="EUR",l[39]="&#8364;",h[40]="XEU ",l[40]="&#8352;",h[41]="FKP",l[41]="&#163;",h[42]="FJD",l[42]="&#36;",h[43]="FRF",l[43]="&#8355;",h[44]="GHC",l[44]="&#162;",h[45]="GIP ",l[45]="&#163;",h[46]="GRD ",l[46]="&#8367;",h[47]="GTQ",l[47]="&#81;",h[48]="GGP",l[48]="&#163;",h[49]="GYD",l[49]="&#36;",h[50]="NLG ",l[50]="&#402;",h[51]="HNL",l[51]="&#76;",h[52]="HKD",l[52]="&#72;&#75;&#36;",h[53]="HKD ",l[53]="&#22291;",h[54]="HKD ",l[54]="&#22291;",h[55]="HKD ",l[55]="&#20803;",h[56]="HUF",l[56]="&#70;&#116;",h[57]="ISK",l[57]="&#107;&#114;",h[58]="INR ",l[58]="",h[59]="IDR ",l[59]="&#82;&#112;",h[60]="IRR",l[60]="&#65020;",h[61]="IEP ",l[61]="&#163;",h[62]="IMP",l[62]="&#163;",h[63]="ILS",l[63]="&#8362;",h[64]="ITL",l[64]="&#8356;",h[65]="JMD",l[65]="&#74;&#36;",h[66]="JPY ",l[66]="&#165;",h[67]="JEP ",l[67]="&#163;",h[68]="KZT ",l[68]="&#1083;&#1074;",h[69]="KPW ",l[69]="&#8361;",h[70]="KRW ",l[70]="&#8361;",h[71]="KGS ",l[71]="&#1083;&#1074;",h[72]="LAK ",l[72]="&#8365;",h[73]="LVL ",l[73]="&#76;&#115;",h[74]="LBP ",l[74]="&#163;",h[75]="LRD ",l[75]="&#36;",h[76]="CHF ",l[76]="&#67;&#72;&#70;",h[77]="LTL ",l[77]="&#76;&#116;",h[78]="LUF ",l[78]="&#8355;",h[79]="MKD ",l[79]="&#1076;&#1077;&#1085;",h[80]="MYR ",l[80]="&#82;&#77;",h[81]="MTL ",l[81]="&#76;&#109;",h[82]="MUR ",l[82]="&#8360;",h[83]="MXN ",l[83]="&#36;",h[84]="MNT ",l[84]="&#8366;",h[85]="MZN ",l[85]="&#77;&#84;",h[86]="NAD ",l[86]="&#36;",h[87]="NPR ",l[87]="&#8360;",h[88]="ANG ",l[88]="&#402;",h[89]="NLG ",l[89]="&#402;",h[90]="NZD ",l[90]="&#36;",h[91]="NIO ",l[91]="&#67;&#36;",h[92]="NGN ",l[92]="&#8358;",h[93]="KPW ",l[93]="&#8361;",h[94]="NOK ",l[94]="&#107;&#114;",h[95]="OMR ",l[95]="&#65020;",h[96]="PKR ",l[96]="&#8360;",h[97]="PAB ",l[97]="&#66;&#47;&#46;",h[98]="PYG ",l[98]="&#71;&#115;",h[99]="PEN ",l[99]="&#83;&#47;&#46;",h[100]="PHP ",l[100]="&#80;&#104;&#112;",h[101]="PLN ",l[101]="&#122;&#322;",h[102]="QAR ",l[102]="&#65020;",h[103]="RON ",l[103]="&#108;&#101;&#105;",h[104]="RUB ",l[104]="&#1088;&#1091;&#1073;",h[105]="SHP ",l[105]="&#163;",h[106]="SAR ",l[106]="&#65020;",h[107]="RSD ",l[107]="&#1044;&#1080;&#1085;&#46;",h[108]="SCR ",l[108]="&#8360;",h[109]="SGD ",l[109]="&#36;",h[110]="SKK ",
l[110]="&#83;&#73;&#84;",h[111]="EUR ",l[111]="&#8364;",h[112]="SBD ",l[112]="&#36;",h[113]="SOS ",l[113]="&#83;",h[114]="ZAR ",l[114]="&#82;",h[115]="KRW ",l[115]="&#8361;",h[116]="ESP ",l[116]="&#8359;",h[117]="LKR ",l[117]="&#8360;",h[118]="SEK ",l[118]="&#107;&#114;",h[119]="CHF ",l[119]="&#67;&#72;&#70;",h[120]="SRD ",l[120]="&#36;",h[121]="SYP ",l[121]="&#163;",h[122]="TWD ",l[122]="&#78;&#84;&#36;",h[123]="THB",l[123]="&#3647;",h[124]="TTD",l[124]="&#84;&#84;&#36;",h[125]="TRY",l[125]="&#89;&#84;&#76;",h[126]="TRL",l[126]="&#8356;",h[127]="TVD ",l[127]="&#36;",h[128]="UAH ",l[128]="&#8372;",h[129]="GBP ",l[129]="&#163;",h[130]="USD ",l[130]="&#36;",h[131]="UYU ",l[131]="&#36;&#85;",h[132]="UZS ",l[132]="&#1083;&#1074;",h[133]="VAL ",l[133]="&#8356;",h[134]="VEB ",l[134]="&#66;&#115;",h[135]="VND ",l[135]="&#8363;",h[136]="YER ",l[136]="&#65020;",h[137]="ZWD ",l[137]="&#90;&#3;",{getCurrencyCode:function(t){var e=-1,n=t.replace(/[0-9]/g,"");return n=n.replace(",",""),n=n.replace(".",""),e=l.indexOf(c(n)),0>e?n:h[e]},getCurrencyValue:function(t){var e,n=-1,i=t.replace(/[0-9]/g,""),r=function(t,e,n,i){return t.slice(0,e)+(i||"")+t.slice(e+n)};return i=i.replace(",",""),i=i.replace(".",""),n=t.indexOf(i),e=r(t,n,i.length),e=e.replace(",",".")}}}),bento.define("singletons/everyplay",["bento"],function(t){"use strict";var e=function(){},n=window.everyplay,i=!0,r=!t.saveState.load("disableEveryplay",!1);return n?(n.isDisableSingleCoreDevices(function(t){console.log("Everyplay isDisableSingleCoreDevices",t)}),{record:function(){return r?void n.startRecording(function(){},function(t){console.log(t)}):void console.log("everyplay disabled")},stop:function(){n.stopRecording(function(){},function(t){console.log(t)}),n.isRecordingSupported(function(t){i=t})},replay:function(){return r?(n.isRecordingSupported(function(t){i=t}),i?void n.playLastRecording(function(){},function(t){console.log(t)}):void alert("Sorry, this device is not supported by EveryPlay.")):void alert("EveryPlay is disabled. You can turn it on in the pause screen.")},isRecording:function(){},resume:function(){r&&n.resumeRecording(function(){},function(){})},pause:function(){r&&n.pauseRecording(function(){},function(){})},setData:function(t){n.mergeSessionDeveloperData(t,function(){},function(){})},setEnabled:function(t){r=t,r||n.stopRecording(function(){},function(t){console.log(t)}),console.log("everyplay",r)}}):(console.log("everyplay not available"),{record:e,stop:e,replay:e,isRecording:e,resume:e,pause:e,setData:e,setEnabled:e})}),bento.define("singletons/gamecenter",[],function(){"use strict";var t=!1,e=function(){return t},n=function(){},i=function(e){Cocoon.Social.GameCenter.login(function(e,n){return n?void console.log("GC error",n.message):(console.log("GC response",e),void(t=!0))})},r=function(e,n,i){if(t){var r=Cocoon.Social.GameCenter.getSocialInterface();r.submitScore(e,i,{leaderboardID:n})}},o=function(t,e){Cocoon.Social.GameCenter.showLeaderboards(n,{identifier:e,category:e})},a=function(t,e){var n=Cocoon.Social.GameCenter.getSocialInterface();n.submitAchievement(t,function(t){e&&e()})},s=function(t){Cocoon.Social.GameCenter.showAchievements(t)};return navigator.isCocoonJS&&"ios"===Cocoon.getPlatform()?{isLoggedIn:e,login:i,post:r,show:o,postAchievement:a,showAchievement:s}:{isLoggedIn:e,login:n,post:n,show:n,postAchievement:n,showAchievement:n}}),bento.define("singletons/googleplay",[],function(){"use strict";var t,e="936312563804-sp0jvjd3dklbsvjmks6102kld7v3vh9m.apps.googleusercontent.com",n=!1,i=function(){},r=function(i){t=Cocoon.Social.GooglePlayGames,t.init({clientId:e,defaultLeaderboard:"CgkI3NDPhKAbEAIQAQ",showAchievementNotifications:!0},function(){i&&i()}),n=!0},o=function(){if(!n)return!1;var e=t.getSocialInterface();return console.log("is logged in",e.isLoggedIn()),e.isLoggedIn()},a=function(e){var n;e=e||function(){},n=t.getSocialInterface(),n.login(e)};return window.Cocoon&&navigator.isCocoonJS?{init:function(t){n||r(t)},isLoggedIn:o,login:function(e){var i,o=this;return n?(i=t.getSocialInterface(),i.isLoggedIn()?void(e&&e(!1)):void i.login(function(t,n){n?(e&&e(n),Cocoon.Dialog.confirm({title:"Error",message:"login error: "+n.message+" "+n.code},function(t){})):e&&e()})):void r(function(){o.login(e)})},post:function(e,i,r){if(n){var a=t.getSocialInterface();o()&&a.submitScore(e,r,{leaderboardID:i})}},show:function(e,i){if(n){var r=t.getSocialInterface();o()?r.showLeaderboard(function(t){console.log("show leaderboard",JSON.stringify(t))},i):a(function(){console.log("logged in"),r.showLeaderboard(function(t){console.log("show leaderboard",JSON.stringify(t))},i)})}},postAchievement:function(e,i){if(n){var r=t.getSocialInterface();o()&&r.submitAchievement(e,function(t){console.log("achievement unlocked",t),t.newlyUnlocked&&i&&i()})}},showAchievement:function(e){if(n){var i=t.getSocialInterface();o()?i.showAchievements(function(t){console.log("show leaderboard",JSON.stringify(t))}):a(function(){i.showAchievements(function(t){console.log("show leaderboard",JSON.stringify(t))})})}}}:{isLoggedIn:i,login:i,post:i,show:i,postAchievement:i,showAchievement:i}}),bento.define("singletons/localization",["bento"],function(t){"use strict";var e="EN",n={};return{getText:function(t){return n.strings&&n.strings[t]?n.strings[t]:""},setLanguage:function(i){console.log("set language to "+i),n=t.assets.getJson("text-"+i),e=i},initLanguage:function(){var t,n=window.navigator.userLanguage||window.navigator.language;console.log("system lang",n),n&&n.substr&&(t=n.substr(0,2).toUpperCase(),e="ZH"===t||"PT"===t||"DE"===t||"ES"===t||"FR"===t||"ID"===t||"IT"===t||"JA"===t||"KO"===t||"RU"===t?t:"EN"),"zh-TW"===n?e="ZTW":"zh-HK"===n&&(e="ZHK"),this.setLanguage(e)},getLang:function(){return e}}}),bento.define("singletons/notification",[],function(){"use strict";return{}}),bento.define("singletons/savestate",["bento/utils"],function(t){"use strict";var e,n=document.URL,i={setItem:function(t,e){var n,r=0;i[t]=e;for(n in i)i.hasOwnProperty(n)&&++r;this.length=r},getItem:function(e){var n=i[e];return t.isDefined(n)?n:null},removeItem:function(t){delete i[t]},clear:function(){this.length=0},length:0};try{if(e=window.localStorage,!window.localStorage)throw"No local storage available";window.localStorage.setItem(n+"save","0")}catch(r){alert("Warning: you have disabled cookies on your browser. You cannot save progress in your game."),e=i}return{save:function(t,i){"string"!=typeof t&&(t=JSON.stringify(t)),e.setItem(n+t,JSON.stringify(i))},load:function(t,i){var r;return r=e.getItem(n+t),null===r?i:JSON.parse(r)},remove:function(t){e.removeItem(n+t)},clear:function(){e.clear()},debug:function(){console.log(localStorage)},isEmpty:function(){return 0===e.length}}});